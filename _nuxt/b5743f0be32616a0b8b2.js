(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{167:function(e,t,n){"use strict";n(56);var o=n(184),r=n(185),c=n(165),d=n(186),h=function(){function e(t,n,r){Object(o.a)(this,e),this.id=t,this.position=n,this.velocity=r,this.force=new c.Vector3(0,0,0)}return Object(r.a)(e,[{key:"orientation",get:function(){return this.velocity.normalize()}}]),e}(),l=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(o.a)(this,e),this.cohesion=.3,this.separation=.4,this.alignment=1,this.separationMinDistance=3,this.maxSpeed=1,this.boundsMin=new c.Vector3(n.x-d,n.y-d,n.z-d),this.boundsMax=new c.Vector3(n.x+d,n.y+d,n.z+d),this.otherForces=[],this.birds=[],this.debug={show:!1,influences:[],arrows:[]},l||(l=new c.Vector3(0,0,0));this.center=n.clone(),this.avgVel=new c.Vector3(0,0,0);for(var i=0;i<t;i++){var f=this.center.add(new c.Vector3((Math.random()-.5)*r,(Math.random()-.5)*r,(Math.random()-.5)*r)),m=(this.center.add(new c.Vector3(.93*(Math.random()-.5),.93*(Math.random()-.5),.93*(Math.random()-.5))),new h(i,f,l));this.birds.push(m)}}return Object(r.a)(e,[{key:"update",value:function(e){var t=this;this._updateCenter();var n=this.maxSpeed*this.maxSpeed;this.birds.forEach((function(o){var r=t._forceCentreMass(o),c=t._forceSeparation(o),d=t._forceMatchVelocity(o),h=t._forceBoundaries(o),l=r.add(c).add(d).add(h);t.otherForces.forEach((function(e){l.add(e(t,o))})),o.force.copyFrom(l),o.velocity.addInPlace(l.scale(e)),o.velocity.lengthSquared()>n&&(o.velocity=o.velocity.normalize().scale(t.maxSpeed)),o.position.addInPlace(o.velocity.scale(e))})),this._updateDebug()}},{key:"_updateCenter",value:function(){if(this.birds.length){var e=new c.Vector3(0,0,0),t=new c.Vector3(0,0,0);this.birds.forEach((function(n){e.addInPlace(n.position),t.addInPlace(n.velocity)})),e.scaleInPlace(1/this.birds.length),t.scaleInPlace(1/this.birds.length),this.center=e,this.avgVel=t}}},{key:"_forceCentreMass",value:function(e){return this.center.subtract(e.position).scale(this.cohesion)}},{key:"_forceSeparation",value:function(e){var t=this,n=new c.Vector3(0,0,0);return this.birds.forEach((function(o){if(e.id!==o.id){var r=e.position.subtract(o.position),c=r.length();c<t.separationMinDistance&&n.addInPlace(r.scale(t.separationMinDistance-c))}})),n.scale(this.separation)}},{key:"_forceMatchVelocity",value:function(e){return this.avgVel.subtract(e.velocity).scale(this.alignment)}},{key:"_forceObstacles",value:function(e){}},{key:"_forceBoundaries",value:function(e){var t=new c.Vector3(0,0,0);return e.position.x<.9*this.boundsMin.x?t.x=.2:e.position.x>.9*this.boundsMax.x&&(t.x=-.2),e.position.y<.9*this.boundsMin.y?t.y=.2:e.position.y>.9*this.boundsMax.y&&(t.y=-.2),e.position.z<.9*this.boundsMin.z?t.z=.2:e.position.z>.9*this.boundsMax.z&&(t.z=-.2),t}},{key:"addForce",value:function(e){this.otherForces.push(e)}},{key:"showDebug",value:function(e){var t=this;if(this.debug.show=!0,!this.debug.center){var n=new c.StandardMaterial("debug_center",e);n.diffuseColor=c.Color3.FromHexString("#FF0000"),this.debug.center=c.MeshBuilder.CreateSphere("center",{diameter:.1,segments:8});var o=new c.StandardMaterial("debug_bbox",e);o.diffuseColor=c.Color3.FromHexString("#00FF00"),o.wireframe=!0,this.debug.center.material=n,this.debug.bbox=c.Mesh.CreateBox("boids_bbox",1,e),this.debug.bbox.scaling.x=Math.abs(this.boundsMax.x-this.boundsMin.x),this.debug.bbox.scaling.y=Math.abs(this.boundsMax.y-this.boundsMin.y),this.debug.bbox.scaling.z=Math.abs(this.boundsMax.z-this.boundsMin.z),this.debug.bbox.position.x=Math.abs(this.boundsMax.x-this.boundsMin.x)/2,this.debug.bbox.position.y=Math.abs(this.boundsMax.y-this.boundsMin.y)/2,this.debug.bbox.position.z=Math.abs(this.boundsMax.z-this.boundsMin.z)/2,this.debug.bbox.material=o;var r=new c.StandardMaterial("debug_wireframe",e);r.diffuseColor=c.Color3.FromHexString("#FFFFFF"),r.wireframe=!0,this.birds.forEach((function(n){n.debug={},n.debug.force=c.MeshBuilder.CreateTube("bird_arrow_"+n.uniqueId,{path:[n.position.add(n.velocity),n.position.clone()],radius:.01,updatable:!0},e),n.debug.influence=c.MeshBuilder.CreateSphere("bird_influence_"+n.uniqueId,{diameter:1,segments:8}),n.debug.influence.scaling.setAll(t.separationMinDistance),n.debug.influence.material=r}))}}},{key:"_updateDebug",value:function(){this.debug.show&&(this.debug.center.position.copyFrom(this.center),this.birds.forEach((function(e){var path=[e.position.add(e.force.scale(20)),e.position.clone()];e.debug.force=c.MeshBuilder.CreateTube(e.debug.force.name,{path:path,radius:.01,instance:e.debug.force}),e.debug.influence.position.copyFrom(e.position)})))}},{key:"gui",value:function(e){var header,t,n=this,o=d.AdvancedDynamicTexture.CreateFullscreenUI("UI",void 0,void 0,e),r=new d.StackPanel;r.width="220px",r.horizontalAlignment=d.Control.HORIZONTAL_ALIGNMENT_RIGHT,r.verticalAlignment=d.Control.VERTICAL_ALIGNMENT_CENTER,o.addControl(r);var c=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};(header=new d.TextBlock).text=e+" "+n[e],header.height="30px",header.color="white",r.addControl(header),(t=new d.Slider).minimum=0,t.maximum=o,t.value=n[e],t.height="20px",t.width="200px";var h=function(e,header,t){return function(n){e[t]=n,header.text=t+" "+n,c.apply(e)}}(n,header,e);t.onValueChangedObservable.add(h),r.addControl(t)};c("cohesion"),c("separation"),c("alignment"),c("separationMinDistance",10,(function(e){console.log(e),n.debug.center&&n.birds.forEach((function(e){e.debug.influence.scaling.setAll(n.separationMinDistance)}))}))}}]),e}();t.a=l},168:function(e,t,n){var content=n(194);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(14).default)("5b9b605c",content,!0,{sourceMap:!1})},193:function(e,t,n){"use strict";var o=n(168);n.n(o).a},194:function(e,t,n){var o=n(13);(e.exports=o(!1)).push([e.i,"#underwater{position:relative}#underwater,#underwater-3d{height:100vh;width:100vw}#underwater-debug{top:0;right:0}#underwater-debug,#underwater-hud{position:absolute;padding:10px;z-index:1000;border-radius:10px;background:#000;font-family:Oxygen,monospace;color:#fff;text-align:right}#underwater-hud{bottom:0;left:0;width:160px;height:200px;font-size:64px}#inspector-host .label,#sceneExplorer .label{color:#fff;font-weight:400;font-size:14px}#inspector-host .title,#sceneExplorer .title{color:#fff;font-weight:400;font-size:14px;line-height:normal;font-family:Arial;line-height:1}",""])},240:function(e,t,n){"use strict";n.r(t);n(71),n(37),n(28);var o=n(165),r=(n(182),n(183),n(167)),c={props:{},data:function(){return{engine:null,scene:null,camera:null,assetsManager:null}},mounted:function(){var e=this,t=document.getElementById("underwater-3d");this.bootScene(t),this.lights();var n=this.loadCubes(30);this.engine.runRenderLoop((function(){var t=e.engine.getDeltaTime()/1e3,o=document.getElementById("inspector-host");o&&(o.style.position="absolute"),n.update(t),e.scene.render()})),window.addEventListener("resize",this.resize)},beforeDestroy:function(){window.removeEventListener("resize",this.resize),this.engine.stopRenderLoop(),this.scene.dispose(),this.scene=null,this.engine=null},methods:{bootScene:function(e){function t(){this.loadingUIText="Mergulho na Laje de Santos"}t.prototype.displayLoadingUI=function(){alert(this.loadingUIText)},t.prototype.hideLoadingUI=function(){alert("Loaded!")},this.engine=new o.Engine(e,!0),this.engine.loadingUIText="BoidsTest",this.scene=new o.Scene(this.engine),this.camera=new o.UniversalCamera("Camera",new o.Vector3(10,10,10),this.scene),this.camera.setTarget(new o.Vector3(0,0,0)),this.camera.applyGravity=!1,this.camera.speed=.1,this.camera.ellipsoid=new o.Vector3(.5,1,.5),this.camera.keysUp.push("w".charCodeAt(0)),this.camera.keysUp.push("W".charCodeAt(0)),this.camera.minZ=.1,this.camera.maxZ=1e3,this.camera.attachControl(e,!0),this.scene.collisionsEnabled=!0,this.camera.checkCollisions=!0},debugUtils:function(){this.scene.debugLayer.show(),document.querySelector("footer.footer").style.display="none"},resize:function(){this.engine.resize()},lights:function(){var e=new o.HemisphericLight("light1",new o.Vector3(1,1,0),this.scene);e.diffuse=o.Color3.FromHexString("#CCCCCC"),e.intensity=.4,new o.DirectionalLight("DirectionalLight",new o.Vector3(.2,-1,0),this.scene).diffuse=o.Color3.FromHexString("#FFFFFF"),e.intensity=.8},loadCubes:function(e){var t,n,c=new r.a(e,new o.Vector3(0,0,0),10,10),d=[],h=new o.StandardMaterial("brickMaterial",this.scene);h.diffuseTexture=new o.Texture("/brick_diffuse.jpg",this.scene);for(var i=0;i<e;i++){var l=o.MeshBuilder.CreateBox("box"+i,{width:.3,height:.5,depth:1});l.bird=c.birds[i],l.material=h,d.push(l)}return c.showDebug(),c.gui(this.scene),{models:d,boids:c,update:(t=c,n=d,function(e){t.update(e),n.forEach((function(e){e.position.copyFrom(e.bird.position),e.setDirection(e.bird.orientation)}))})}},loadFishFlock:function(e,t,n){var c,d,h=new r.a(n,new o.Vector3(0,10,0),50),l=[];return o.SceneLoader.LoadAssetContainer(e,t,this.scene,(function(e){e.addAllToScene(),e.meshes.forEach((function(e){e.position.y=10,e.setEnabled(!1),e.material&&e.material.freeze()}));for(var t=function(i){var t=e.instantiateModelsToScene((function(p){return"fish"+p+i})),n=!0,o=!1,r=void 0;try{for(var c,d=t.rootNodes[Symbol.iterator]();!(n=(c=d.next()).done);n=!0){c.value.position.x+=10*(i+1)}}catch(e){o=!0,r=e}finally{try{n||null==d.return||d.return()}finally{if(o)throw r}}t.bird=h.birds[i],l.push(t)},i=0;i<n;i++)t(i)})),h.showDebug(),{models:l,boids:h,update:(c=h,d=l,function(e){c.update(e),d.forEach((function(e){var t=!0,n=!1,o=void 0;try{for(var r,c=e.rootNodes[Symbol.iterator]();!(t=(r=c.next()).done);t=!0)r.value.position.copyFrom(e.bird.position)}catch(e){n=!0,o=e}finally{try{t||null==c.return||c.return()}finally{if(n)throw o}}}))})}},clamp:function(e,t,n){return Math.min(Math.max(e,t),n)}},head:function(){return{link:[]}}},d=(n(193),n(9)),h={components:{BoidsTest:Object(d.a)(c,(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"underwater"}},[t("canvas",{attrs:{id:"underwater-3d","touch-action":"none"}})])}],!1,null,null,null).exports},data:function(){return{}}},l=Object(d.a)(h,(function(){var e=this.$createElement,t=this._self._c||e;return t("article",[t("section",[t("boids-test")],1)])}),[],!1,null,null,null);t.default=l.exports}}]);