(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{171:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(166);t.textAlign={center:new n.Vector2(0,0),left:new n.Vector2(1,0),top:new n.Vector2(0,-1),topLeft:new n.Vector2(1,-1),topRight:new n.Vector2(-1,-1),right:new n.Vector2(-1,0),bottom:new n.Vector2(0,1),bottomLeft:new n.Vector2(1,1),bottomRight:new n.Vector2(-1,1)};var o={};t.getFontHeight=function(e){var t=o[e];if(!t){var body=document.getElementsByTagName("body")[0],r=document.createElement("div"),n=document.createTextNode("MÃ‰q");r.appendChild(n),r.setAttribute("style","font:"+e+";position:absolute;top:0;left:0"),body.appendChild(r),t=r.offsetHeight,o[e]=t,body.removeChild(r)}return t}},190:function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,b){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])})(e,b)},function(e,b){function t(){this.constructor=e}n(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(t,"__esModule",{value:!0});var c=r(166),l=r(171),d=r(201),h=function(e){function t(text,t){void 0===text&&(text=""),void 0===t&&(t={});var r=e.call(this)||this;return r._align=new c.Vector2,r._font=t.font||"30px Arial",r._fillStyle=t.fillStyle||"#FFFFFF",r._shadowColor=t.shadowColor||"rgba(0, 0, 0, 0)",r._shadowBlur=t.shadowBlur||0,r._shadowOffsetX=t.shadowOffsetX||0,r._shadowOffsetY=t.shadowOffsetY||0,r._lineHeight=t.lineHeight||1.2,r.canvas=new d.CanvasText,r.align=t.align||l.textAlign.center,r.side=t.side||c.DoubleSide,r.antialias=void 0===t.antialias||t.antialias,r.text=text,r}return o(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this.updateText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this._font},set:function(e){this._font!==e&&(this._font=e,this.updateText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillStyle",{get:function(){return this._fillStyle},set:function(e){this._fillStyle!==e&&(this._fillStyle=e,this.updateText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align.copy(e)},enumerable:!0,configurable:!0}),t.prototype.cleanUp=function(){this.texture&&this.texture.dispose()},t.prototype.applyAntiAlias=function(){!1===this.antialias&&(this.texture.magFilter=c.NearestFilter,this.texture.minFilter=c.LinearMipMapLinearFilter)},t}(c.Object3D);t.Text2D=h},198:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(166),o=function(object,e){void 0===e&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');var t=this,r={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=object,this.domElement=e,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.mouseButtons={LEFT:n.MOUSE.ROTATE,MIDDLE:n.MOUSE.ZOOM,RIGHT:n.MOUSE.PAN},this.target=new n.Vector3;var o=new n.Vector3,c=1,l=r.NONE,d=r.NONE,h=new n.Vector3,f=new n.Vector2,m=new n.Vector2,v=new n.Vector3,y=0,w=new n.Vector2,x=new n.Vector2,N=0,A=0,T=new n.Vector2,k=new n.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom;var E={type:"change"},_={type:"start"},O={type:"end"};this.handleResize=function(){var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height};var C,j,M,L,R,P,S,H,V,D,I,z=(C=new n.Vector2,function(e,r){return C.set((e-t.screen.left)/t.screen.width,(r-t.screen.top)/t.screen.height),C}),F=function(){var e=new n.Vector2;return function(r,n){return e.set((r-.5*t.screen.width-t.screen.left)/(.5*t.screen.width),(t.screen.height+2*(t.screen.top-n))/t.screen.width),e}}();function U(e){!1!==t.enabled&&(window.removeEventListener("keydown",U),d===r.NONE&&(e.keyCode!==t.keys[r.ROTATE]||t.noRotate?e.keyCode!==t.keys[r.ZOOM]||t.noZoom?e.keyCode!==t.keys[r.PAN]||t.noPan||(d=r.PAN):d=r.ZOOM:d=r.ROTATE))}function B(){!1!==t.enabled&&(d=r.NONE,window.addEventListener("keydown",U,!1))}function X(e){if(!1!==t.enabled){if(e.preventDefault(),e.stopPropagation(),l===r.NONE)switch(e.button){case t.mouseButtons.LEFT:l=r.ROTATE;break;case t.mouseButtons.MIDDLE:l=r.ZOOM;break;case t.mouseButtons.RIGHT:l=r.PAN;break;default:l=r.NONE}var n=d!==r.NONE?d:l;n!==r.ROTATE||t.noRotate?n!==r.ZOOM||t.noZoom?n!==r.PAN||t.noPan||(T.copy(z(e.pageX,e.pageY)),k.copy(T)):(w.copy(z(e.pageX,e.pageY)),x.copy(w)):(m.copy(F(e.pageX,e.pageY)),f.copy(m)),document.addEventListener("mousemove",Y,!1),document.addEventListener("mouseup",W,!1),t.dispatchEvent(_)}}function Y(e){if(!1!==t.enabled){e.preventDefault(),e.stopPropagation();var n=d!==r.NONE?d:l;n!==r.ROTATE||t.noRotate?n!==r.ZOOM||t.noZoom?n!==r.PAN||t.noPan||k.copy(z(e.pageX,e.pageY)):x.copy(z(e.pageX,e.pageY)):(f.copy(m),m.copy(F(e.pageX,e.pageY)))}}function W(e){!1!==t.enabled&&(e.preventDefault(),e.stopPropagation(),l=r.NONE,document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",W),t.dispatchEvent(O))}function G(e){if(!1!==t.enabled&&!0!==t.noZoom){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:w.y-=.025*e.deltaY;break;case 1:w.y-=.01*e.deltaY;break;default:w.y-=25e-5*e.deltaY}t.dispatchEvent(_),t.dispatchEvent(O)}}function Z(e){if(!1!==t.enabled){switch(e.preventDefault(),e.touches.length){case 1:l=r.TOUCH_ROTATE,m.copy(F(e.touches[0].pageX,e.touches[0].pageY)),f.copy(m);break;default:l=r.TOUCH_ZOOM_PAN;var n=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;A=N=Math.sqrt(n*n+o*o);var c=(e.touches[0].pageX+e.touches[1].pageX)/2,d=(e.touches[0].pageY+e.touches[1].pageY)/2;T.copy(z(c,d)),k.copy(T)}t.dispatchEvent(_)}}function J(e){if(!1!==t.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:f.copy(m),m.copy(F(e.touches[0].pageX,e.touches[0].pageY));break;default:var r=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;A=Math.sqrt(r*r+n*n);var o=(e.touches[0].pageX+e.touches[1].pageX)/2,c=(e.touches[0].pageY+e.touches[1].pageY)/2;k.copy(z(o,c))}}function Q(e){if(!1!==t.enabled){switch(e.touches.length){case 0:l=r.NONE;break;case 1:l=r.TOUCH_ROTATE,m.copy(F(e.touches[0].pageX,e.touches[0].pageY)),f.copy(m)}t.dispatchEvent(O)}}function K(e){!1!==t.enabled&&e.preventDefault()}this.rotateCamera=(M=new n.Vector3,L=new n.Quaternion,R=new n.Vector3,P=new n.Vector3,S=new n.Vector3,H=new n.Vector3,function(){H.set(m.x-f.x,m.y-f.y,0),(j=H.length())?(h.copy(t.object.position).sub(t.target),R.copy(h).normalize(),P.copy(t.object.up).normalize(),S.crossVectors(P,R).normalize(),P.setLength(m.y-f.y),S.setLength(m.x-f.x),H.copy(P.add(S)),M.crossVectors(H,h).normalize(),j*=t.rotateSpeed,L.setFromAxisAngle(M,j),h.applyQuaternion(L),t.object.up.applyQuaternion(L),v.copy(M),y=j):!t.staticMoving&&y&&(y*=Math.sqrt(1-t.dynamicDampingFactor),h.copy(t.object.position).sub(t.target),L.setFromAxisAngle(v,y),h.applyQuaternion(L),t.object.up.applyQuaternion(L)),f.copy(m)}),this.zoomCamera=function(){var e;l===r.TOUCH_ZOOM_PAN?(e=N/A,N=A,t.object.isPerspectiveCamera?h.multiplyScalar(e):t.object.isOrthographicCamera?(t.object.zoom*=e,t.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(1!==(e=1+(x.y-w.y)*t.zoomSpeed)&&e>0&&(t.object.isPerspectiveCamera?h.multiplyScalar(e):t.object.isOrthographicCamera?(t.object.zoom/=e,t.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),t.staticMoving?w.copy(x):w.y+=(x.y-w.y)*this.dynamicDampingFactor)},this.panCamera=(V=new n.Vector2,D=new n.Vector3,I=new n.Vector3,function(){if(V.copy(k).sub(T),V.lengthSq()){if(t.object.isOrthographicCamera){var e=(t.object.right-t.object.left)/t.object.zoom/t.domElement.clientWidth,r=(t.object.top-t.object.bottom)/t.object.zoom/t.domElement.clientWidth;V.x*=e,V.y*=r}V.multiplyScalar(h.length()*t.panSpeed),I.copy(h).cross(t.object.up).setLength(V.x),I.add(D.copy(t.object.up).setLength(V.y)),t.object.position.add(I),t.target.add(I),t.staticMoving?T.copy(k):T.add(V.subVectors(k,T).multiplyScalar(t.dynamicDampingFactor))}}),this.checkDistances=function(){t.noZoom&&t.noPan||(h.lengthSq()>t.maxDistance*t.maxDistance&&(t.object.position.addVectors(t.target,h.setLength(t.maxDistance)),w.copy(x)),h.lengthSq()<t.minDistance*t.minDistance&&(t.object.position.addVectors(t.target,h.setLength(t.minDistance)),w.copy(x)))},this.update=function(){h.subVectors(t.object.position,t.target),t.noRotate||t.rotateCamera(),t.noZoom||t.zoomCamera(),t.noPan||t.panCamera(),t.object.position.addVectors(t.target,h),t.object.isPerspectiveCamera?(t.checkDistances(),t.object.lookAt(t.target),o.distanceToSquared(t.object.position)>1e-6&&(t.dispatchEvent(E),o.copy(t.object.position))):t.object.isOrthographicCamera?(t.object.lookAt(t.target),(o.distanceToSquared(t.object.position)>1e-6||c!==t.object.zoom)&&(t.dispatchEvent(E),o.copy(t.object.position),c=t.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){l=r.NONE,d=r.NONE,t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.up.copy(t.up0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),h.subVectors(t.object.position,t.target),t.object.lookAt(t.target),t.dispatchEvent(E),o.copy(t.object.position),c=t.object.zoom},this.dispose=function(){this.domElement.removeEventListener("contextmenu",K,!1),this.domElement.removeEventListener("mousedown",X,!1),this.domElement.removeEventListener("wheel",G,!1),this.domElement.removeEventListener("touchstart",Z,!1),this.domElement.removeEventListener("touchend",Q,!1),this.domElement.removeEventListener("touchmove",J,!1),document.removeEventListener("mousemove",Y,!1),document.removeEventListener("mouseup",W,!1),window.removeEventListener("keydown",U,!1),window.removeEventListener("keyup",B,!1)},this.domElement.addEventListener("contextmenu",K,!1),this.domElement.addEventListener("mousedown",X,!1),this.domElement.addEventListener("wheel",G,!1),this.domElement.addEventListener("touchstart",Z,!1),this.domElement.addEventListener("touchend",Q,!1),this.domElement.addEventListener("touchmove",J,!1),window.addEventListener("keydown",U,!1),window.addEventListener("keyup",B,!1),this.handleResize(),this.update()};o.prototype=Object.create(n.EventDispatcher.prototype),o.prototype.constructor=o},199:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(200);t.SpriteText2D=n.SpriteText2D;var o=r(202);t.MeshText2D=o.MeshText2D;var c=r(171);t.textAlign=c.textAlign},200:function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,b){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])})(e,b)},function(e,b){function t(){this.constructor=e}n(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(t,"__esModule",{value:!0});var c=r(166),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.raycast=function(){return this.sprite.raycast.apply(this.sprite,arguments)},t.prototype.updateText=function(){this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle,shadowBlur:this._shadowBlur,shadowColor:this._shadowColor,shadowOffsetX:this._shadowOffsetX,shadowOffsetY:this._shadowOffsetY,lineHeight:this._lineHeight,align:this.align}),this.cleanUp(),this.texture=new c.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:this.material=new c.SpriteMaterial({map:this.texture}),this.sprite||(this.sprite=new c.Sprite(this.material),this.add(this.sprite)),this.sprite.scale.set(this.canvas.width,this.canvas.height,1),this.updateAlign()},t.prototype.updateAlign=function(){this.sprite&&(this.sprite.center.x=(.5-.5*this._align.x)*this.canvas.textWidth/this.canvas.width,this.sprite.center.y=1-(.5*this._align.y+.5)*this.canvas.textHeight/this.canvas.height)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align.copy(e),this.updateAlign()},enumerable:!0,configurable:!0}),t}(r(190).Text2D);t.SpriteText2D=l},201:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(166),o=r(171),c=function(){function e(){this.textWidth=null,this.textHeight=null,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}return Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.height},enumerable:!0,configurable:!0}),e.prototype.drawText=function(text,e){var t=this;this.ctx.font=e.font;var r=o.getFontHeight(e.font),c=(text||"").toString().split("\n");this.textWidth=Math.max.apply(null,c.map((function(line){return Math.ceil(t.ctx.measureText(line).width)}))),this.textHeight=r+r*e.lineHeight*(c.length-1),this.canvas.width=Math.max(2,n.Math.ceilPowerOfTwo(this.textWidth)),this.canvas.height=Math.max(2,n.Math.ceilPowerOfTwo(this.textHeight)),this.ctx.font=e.font,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=e.fillStyle,1===e.align.x?this.ctx.textAlign="left":0===e.align.x?this.ctx.textAlign="center":this.ctx.textAlign="right",this.ctx.textBaseline="top",this.ctx.shadowColor=e.shadowColor,this.ctx.shadowBlur=e.shadowBlur,this.ctx.shadowOffsetX=e.shadowOffsetX,this.ctx.shadowOffsetY=e.shadowOffsetY;for(var l=this.textWidth*(.5-.5*e.align.x),i=0;i<c.length;i++)this.ctx.fillText(c[i],l,r*e.lineHeight*i);return this.canvas},e}();t.CanvasText=c},202:function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,b){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])})(e,b)},function(e,b){function t(){this.constructor=e}n(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(t,"__esModule",{value:!0});var c=r(166),l=function(e){function t(text,t){return void 0===text&&(text=""),void 0===t&&(t={}),e.call(this,text,t)||this}return o(t,e),t.prototype.raycast=function(){this.mesh.raycast.apply(this.mesh,arguments)},t.prototype.updateText=function(){this.cleanUp(),this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle,shadowBlur:this._shadowBlur,shadowColor:this._shadowColor,shadowOffsetX:this._shadowOffsetX,shadowOffsetY:this._shadowOffsetY,lineHeight:this._lineHeight,align:this.align}),this.texture=new c.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:(this.material=new c.MeshBasicMaterial({map:this.texture,side:this.side}),this.material.transparent=!0),this.mesh||(this.geometry=new c.PlaneGeometry(this.canvas.width,this.canvas.height),this.mesh=new c.Mesh(this.geometry,this.material),this.add(this.mesh)),this.mesh.position.x=this.canvas.width/2-this.canvas.textWidth/2+this.canvas.textWidth/2*this.align.x,this.mesh.position.y=-this.canvas.height/2+this.canvas.textHeight/2*this.align.y,this.geometry.vertices[0].x=this.geometry.vertices[2].x=-this.canvas.width/2,this.geometry.vertices[1].x=this.geometry.vertices[3].x=this.canvas.width/2,this.geometry.vertices[0].y=this.geometry.vertices[1].y=this.canvas.height/2,this.geometry.vertices[2].y=this.geometry.vertices[3].y=-this.canvas.height/2,this.geometry.verticesNeedUpdate=!0},t}(r(190).Text2D);t.MeshText2D=l},238:function(e,t,r){"use strict";var n=r(166),o=function(e){n.Loader.call(this,e)};o.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:o,load:function(e,t,r,o){var c=this,l=new n.Texture,d=new n.FileLoader(this.manager);return d.setResponseType("arraybuffer"),d.setPath(this.path),d.load(e,(function(e){l.image=c.parse(e),l.needsUpdate=!0,void 0!==t&&t(l)}),r,o),l},parse:function(e){var t=0,r=1,n=2,o=3,c=9,l=10,d=11,h=48,f=4,m=0,v=1,y=2,w=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");var content=new Uint8Array(e),x=0,header={id_length:content[x++],colormap_type:content[x++],image_type:content[x++],colormap_index:content[x++]|content[x++]<<8,colormap_length:content[x++]|content[x++]<<8,colormap_size:content[x++],origin:[content[x++]|content[x++]<<8,content[x++]|content[x++]<<8],width:content[x++]|content[x++]<<8,height:content[x++]|content[x++]<<8,pixel_size:content[x++],flags:content[x++]};!function(header){switch(header.image_type){case r:case c:(header.colormap_length>256||24!==header.colormap_size||1!==header.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case n:case o:case l:case d:header.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case t:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',header.image_type)}(header.width<=0||header.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==header.pixel_size&&16!==header.pixel_size&&24!==header.pixel_size&&32!==header.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',header.pixel_size)}(header),header.id_length+x>e.length&&console.error("THREE.TGALoader: No data."),x+=header.id_length;var N=!1,A=!1,T=!1;switch(header.image_type){case c:N=!0,A=!0;break;case r:A=!0;break;case l:N=!0;break;case n:break;case d:N=!0,T=!0;break;case o:T=!0}var k="undefined"!=typeof OffscreenCanvas,canvas=k?new OffscreenCanvas(header.width,header.height):document.createElement("canvas");canvas.width=header.width,canvas.height=header.height;var E=canvas.getContext("2d"),_=E.createImageData(header.width,header.height),O=function(e,t,header,r,data){var n,o,c,l;if(o=header.pixel_size>>3,c=header.width*header.height*o,t&&(l=data.subarray(r,r+=header.colormap_length*(header.colormap_size>>3))),e){var d,h,i;n=new Uint8Array(c);for(var f=0,m=new Uint8Array(o);f<c;)if(h=1+(127&(d=data[r++])),128&d){for(i=0;i<o;++i)m[i]=data[r++];for(i=0;i<h;++i)n.set(m,f+i*o);f+=o*h}else{for(h*=o,i=0;i<h;++i)n[f+i]=data[r++];f+=h}}else n=data.subarray(r,r+=t?header.width*header.height:c);return{pixel_data:n,palettes:l}}(N,A,header,x,content);!function(data,e,t,image,r){var n,o,c,l,d,x;switch((header.flags&h)>>f){default:case y:n=0,c=1,d=e,o=0,l=1,x=t;break;case m:n=0,c=1,d=e,o=t-1,l=-1,x=-1;break;case w:n=e-1,c=-1,d=-1,o=0,l=1,x=t;break;case v:n=e-1,c=-1,d=-1,o=t-1,l=-1,x=-1}if(T)switch(header.pixel_size){case 8:!function(e,t,r,n,o,c,l,image){var d,h,f,i=0,m=header.width;for(f=t;f!==n;f+=r)for(h=o;h!==l;h+=c,i++)d=image[i],e[4*(h+m*f)+0]=d,e[4*(h+m*f)+1]=d,e[4*(h+m*f)+2]=d,e[4*(h+m*f)+3]=255}(data,o,l,x,n,c,d,image);break;case 16:!function(e,t,r,n,o,c,l,image){var d,h,i=0,f=header.width;for(h=t;h!==n;h+=r)for(d=o;d!==l;d+=c,i+=2)e[4*(d+f*h)+0]=image[i+0],e[4*(d+f*h)+1]=image[i+0],e[4*(d+f*h)+2]=image[i+0],e[4*(d+f*h)+3]=image[i+1]}(data,o,l,x,n,c,d,image);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(header.pixel_size){case 8:!function(e,t,r,n,o,c,l,image,d){var h,f,m,v=d,i=0,y=header.width;for(m=t;m!==n;m+=r)for(f=o;f!==l;f+=c,i++)h=image[i],e[4*(f+y*m)+3]=255,e[4*(f+y*m)+2]=v[3*h+0],e[4*(f+y*m)+1]=v[3*h+1],e[4*(f+y*m)+0]=v[3*h+2]}(data,o,l,x,n,c,d,image,r);break;case 16:!function(e,t,r,n,o,c,l,image){var d,h,f,i=0,m=header.width;for(f=t;f!==n;f+=r)for(h=o;h!==l;h+=c,i+=2)d=image[i+0]+(image[i+1]<<8),e[4*(h+m*f)+0]=(31744&d)>>7,e[4*(h+m*f)+1]=(992&d)>>2,e[4*(h+m*f)+2]=(31&d)>>3,e[4*(h+m*f)+3]=32768&d?0:255}(data,o,l,x,n,c,d,image);break;case 24:!function(e,t,r,n,o,c,l,image){var d,h,i=0,f=header.width;for(h=t;h!==n;h+=r)for(d=o;d!==l;d+=c,i+=3)e[4*(d+f*h)+3]=255,e[4*(d+f*h)+2]=image[i+0],e[4*(d+f*h)+1]=image[i+1],e[4*(d+f*h)+0]=image[i+2]}(data,o,l,x,n,c,d,image);break;case 32:!function(e,t,r,n,o,c,l,image){var d,h,i=0,f=header.width;for(h=t;h!==n;h+=r)for(d=o;d!==l;d+=c,i+=4)e[4*(d+f*h)+2]=image[i+0],e[4*(d+f*h)+1]=image[i+1],e[4*(d+f*h)+0]=image[i+2],e[4*(d+f*h)+3]=image[i+3]}(data,o,l,x,n,c,d,image);break;default:console.error("THREE.TGALoader: Format not supported.")}}(_.data,header.width,header.height,O.pixel_data,O.palettes);return E.putImageData(_,0,0),k?canvas.transferToImageBitmap():canvas}}),r.d(t,"a",(function(){return c}));var c=function(e){n.Loader.call(this,e)};c.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:c,load:function(e,t,r,o){var c=this,path=""===c.path?n.LoaderUtils.extractUrlBase(e):c.path,l=new n.FileLoader(c.manager);l.setPath(c.path),l.load(e,(function(text){t(c.parse(text,path))}),r,o)},options:{set convertUpAxis(e){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},parse:function(text,path){function e(e,t){for(var r=[],n=e.childNodes,i=0,o=n.length;i<o;i++){var c=n[i];c.nodeName===t&&r.push(c)}return r}function t(text){if(0===text.length)return[];for(var e=text.trim().split(/\s+/),t=new Array(e.length),i=0,r=e.length;i<r;i++)t[i]=e[i];return t}function r(text){if(0===text.length)return[];for(var e=text.trim().split(/\s+/),t=new Array(e.length),i=0,r=e.length;i<r;i++)t[i]=parseFloat(e[i]);return t}function c(text){if(0===text.length)return[];for(var e=text.trim().split(/\s+/),t=new Array(e.length),i=0,r=e.length;i<r;i++)t[i]=parseInt(e[i]);return t}function l(text){return text.substring(1)}function d(object){return 0===Object.keys(object).length}function h(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function f(e){return void 0!==e?e.textContent:"Y_UP"}function m(t,r,n,o){var c=e(t,r)[0];if(void 0!==c)for(var l=e(c,n),i=0;i<l.length;i++)o(l[i])}function v(data,e){for(var t in data){data[t].build=e(data[t])}}function y(data,e){return void 0!==data.build?data.build:(data.build=e(data),data.build)}function w(e){for(var data={inputs:{}},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"input":var n=l(r.getAttribute("source")),o=r.getAttribute("semantic");data.inputs[o]=n}}return data}function x(e){var data={},t=e.getAttribute("target").split("/"),r=t.shift(),n=t.shift(),o=-1!==n.indexOf("("),c=-1!==n.indexOf(".");if(c)t=n.split("."),n=t.shift(),data.member=t.shift();else if(o){var d=n.split("(");n=d.shift();for(var i=0;i<d.length;i++)d[i]=parseInt(d[i].replace(/\)/,""));data.indices=d}return data.id=r,data.sid=n,data.arraySyntax=o,data.memberSyntax=c,data.sampler=l(e.getAttribute("source")),data}function N(data){var e=[],t=data.channels,r=data.samplers,n=data.sources;for(var o in t)if(t.hasOwnProperty(o)){var c=t[o],l=r[c.sampler],d=l.inputs.INPUT,h=l.inputs.OUTPUT;O(T(c,n[d],n[h]),e)}return e}function A(e){return y(it.animations[e],N)}function T(e,t,r){var time,n,i,o,c,l,d=it.nodes[e.id],h=qe(d.id),f=d.transforms[e.sid],m=d.matrix.clone().transpose(),data={};switch(f){case"matrix":for(i=0,o=t.array.length;i<o;i++)if(time=t.array[i],n=i*r.stride,void 0===data[time]&&(data[time]={}),!0===e.arraySyntax){var v=r.array[n],y=e.indices[0]+4*e.indices[1];data[time][y]=v}else for(c=0,l=r.stride;c<l;c++)data[time][c]=r.array[n+c];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',f)}var w=function(data,e){var t=[];for(var time in data)t.push({time:parseFloat(time),value:data[time]});t.sort((function(a,b){return a.time-b.time}));for(var i=0;i<16;i++)C(t,i,e.elements[i]);return t}(data,m);return{name:h.uuid,keyframes:w}}var k=new n.Vector3,E=new n.Vector3,_=new n.Quaternion;function O(e,t){for(var r=e.keyframes,o=e.name,c=[],l=[],d=[],h=[],i=0,f=r.length;i<f;i++){var m=r[i],time=m.time,v=m.value;Le.fromArray(v).transpose(),Le.decompose(k,_,E),c.push(time),l.push(k.x,k.y,k.z),d.push(_.x,_.y,_.z,_.w),h.push(E.x,E.y,E.z)}return l.length>0&&t.push(new n.VectorKeyframeTrack(o+".position",c,l)),d.length>0&&t.push(new n.QuaternionKeyframeTrack(o+".quaternion",c,d)),h.length>0&&t.push(new n.VectorKeyframeTrack(o+".scale",c,h)),t}function C(e,t,r){var n,i,o,c=!0;for(i=0,o=e.length;i<o;i++)void 0===(n=e[i]).value[t]?n.value[t]=null:c=!1;if(!0===c)for(i=0,o=e.length;i<o;i++)(n=e[i]).value[t]=r;else!function(e,t){for(var r,n,i=0,o=e.length;i<o;i++){var c=e[i];if(null===c.value[t]){if(r=j(e,i,t),n=M(e,i,t),null===r){c.value[t]=n.value[t];continue}if(null===n){c.value[t]=r.value[t];continue}L(c,r,n,t)}}}(e,t)}function j(e,i,t){for(;i>=0;){var r=e[i];if(null!==r.value[t])return r;i--}return null}function M(e,i,t){for(;i<e.length;){var r=e[i];if(null!==r.value[t])return r;i++}return null}function L(e,t,r,n){r.time-t.time!=0?e.value[n]=(e.time-t.time)*(r.value[n]-t.value[n])/(r.time-t.time)+t.value[n]:e.value[n]=t.value[n]}function R(data){for(var e=[],t=data.name,r=data.end-data.start||-1,o=data.animations,i=0,c=o.length;i<c;i++)for(var l=A(o[i]),d=0,h=l.length;d<h;d++)e.push(l[d]);return new n.AnimationClip(t,r,e)}function P(e){return y(it.clips[e],R)}function S(e){for(var data={sources:{}},i=0,t=e.childNodes.length;i<t;i++){var n=e.childNodes[i];if(1===n.nodeType)switch(n.nodeName){case"bind_shape_matrix":data.bindShapeMatrix=r(n.textContent);break;case"source":var o=n.getAttribute("id");data.sources[o]=he(n);break;case"joints":data.joints=H(n);break;case"vertex_weights":data.vertexWeights=V(n)}}return data}function H(e){for(var data={inputs:{}},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"input":var n=r.getAttribute("semantic"),o=l(r.getAttribute("source"));data.inputs[n]=o}}return data}function V(e){for(var data={inputs:{}},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"input":var n=r.getAttribute("semantic"),o=l(r.getAttribute("source")),d=parseInt(r.getAttribute("offset"));data.inputs[n]={id:o,offset:d};break;case"vcount":data.vcount=c(r.textContent);break;case"v":data.v=c(r.textContent)}}return data}function D(data){var e={id:data.id},t=it.geometries[e.id];return void 0!==data.skin&&(e.skin=function(data){var i,e,t,r={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},o=data.sources,c=data.vertexWeights,l=c.vcount,d=c.v,h=c.inputs.JOINT.offset,f=c.inputs.WEIGHT.offset,m=data.sources[data.joints.inputs.JOINT],v=data.sources[data.joints.inputs.INV_BIND_MATRIX],y=o[c.inputs.WEIGHT.id].array,w=0;for(i=0,t=l.length;i<t;i++){var x=l[i],N=[];for(e=0;e<x;e++){var A=d[w+h],T=d[w+f],k=y[T];N.push({index:A,weight:k}),w+=2}for(N.sort(C),e=0;e<4;e++){var E=N[e];void 0!==E?(r.indices.array.push(E.index),r.weights.array.push(E.weight)):(r.indices.array.push(0),r.weights.array.push(0))}}data.bindShapeMatrix?r.bindMatrix=(new n.Matrix4).fromArray(data.bindShapeMatrix).transpose():r.bindMatrix=(new n.Matrix4).identity();for(i=0,t=m.array.length;i<t;i++){var _=m.array[i],O=(new n.Matrix4).fromArray(v.array,i*v.stride).transpose();r.joints.push({name:_,boneInverse:O})}return r;function C(a,b){return b.weight-a.weight}}(data.skin),t.sources.skinIndices=e.skin.indices,t.sources.skinWeights=e.skin.weights),e}function I(data){return void 0!==data.build?data.build:data.init_from}function z(e){var data=it.images[e];return void 0!==data?y(data,I):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",e),null)}function F(e){for(var data={surfaces:{},samplers:{}},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"newparam":U(r,data);break;case"technique":data.technique=Y(r);break;case"extra":data.extra=K(r)}}return data}function U(e,data){for(var t=e.getAttribute("sid"),i=0,r=e.childNodes.length;i<r;i++){var n=e.childNodes[i];if(1===n.nodeType)switch(n.nodeName){case"surface":data.surfaces[t]=B(n);break;case"sampler2D":data.samplers[t]=X(n)}}}function B(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"init_from":data.init_from=r.textContent}}return data}function X(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"source":data.source=r.textContent}}return data}function Y(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"constant":case"lambert":case"blinn":case"phong":data.type=r.nodeName,data.parameters=W(r)}}return data}function W(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":data[r.nodeName]=G(r);break;case"transparent":data[r.nodeName]={opaque:r.getAttribute("opaque"),data:G(r)}}}return data}function G(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var n=e.childNodes[i];if(1===n.nodeType)switch(n.nodeName){case"color":data[n.nodeName]=r(n.textContent);break;case"float":data[n.nodeName]=parseFloat(n.textContent);break;case"texture":data[n.nodeName]={id:n.getAttribute("texture"),extra:Z(n)}}}return data}function Z(e){for(var data={technique:{}},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"extra":J(r,data)}}return data}function J(e,data){for(var i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"technique":Q(r,data)}}}function Q(e,data){for(var i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":data.technique[r.nodeName]=parseFloat(r.textContent);break;case"wrapU":case"wrapV":"TRUE"===r.textContent.toUpperCase()?data.technique[r.nodeName]=1:"FALSE"===r.textContent.toUpperCase()?data.technique[r.nodeName]=0:data.technique[r.nodeName]=parseInt(r.textContent)}}}function K(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"technique":data.technique=$(r)}}return data}function $(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"double_sided":data[r.nodeName]=parseInt(r.textContent)}}return data}function ee(data){return data}function te(data){var e,t,r=(e=data.url,y(it.effects[e],ee)),o=r.profile.technique,c=r.profile.extra;switch(o.type){case"phong":case"blinn":t=new n.MeshPhongMaterial;break;case"lambert":t=new n.MeshLambertMaterial;break;default:t=new n.MeshBasicMaterial}function l(e){var t=r.profile.samplers[e.id],image=null;void 0!==t?image=z(r.profile.surfaces[t.source].init_from):(console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),image=z(e.id));if(null!==image){var o=function(image){var e,t=image.slice(2+(image.lastIndexOf(".")-1>>>0));switch(t=t.toLowerCase()){case"tga":e=Ke;break;default:e=et}return e}(image);if(void 0!==o){var c=o.load(image),l=e.extra;if(void 0!==l&&void 0!==l.technique&&!1===d(l.technique)){var h=l.technique;c.wrapS=h.wrapU?n.RepeatWrapping:n.ClampToEdgeWrapping,c.wrapT=h.wrapV?n.RepeatWrapping:n.ClampToEdgeWrapping,c.offset.set(h.offsetU||0,h.offsetV||0),c.repeat.set(h.repeatU||1,h.repeatV||1)}else c.wrapS=n.RepeatWrapping,c.wrapT=n.RepeatWrapping;return c}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",image),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",e.id),null}t.name=data.name||"";var h=o.parameters;for(var f in h){var m=h[f];switch(f){case"diffuse":m.color&&t.color.fromArray(m.color),m.texture&&(t.map=l(m.texture));break;case"specular":m.color&&t.specular&&t.specular.fromArray(m.color),m.texture&&(t.specularMap=l(m.texture));break;case"bump":m.texture&&(t.normalMap=l(m.texture));break;case"ambient":m.texture&&(t.lightMap=l(m.texture));break;case"shininess":m.float&&t.shininess&&(t.shininess=m.float);break;case"emission":m.color&&t.emissive&&t.emissive.fromArray(m.color),m.texture&&(t.emissiveMap=l(m.texture))}}var v=h.transparent,w=h.transparency;if(void 0===w&&v&&(w={float:1}),void 0===v&&w&&(v={opaque:"A_ONE",data:{color:[1,1,1,1]}}),v&&w)if(v.data.texture)t.transparent=!0;else{var x=v.data.color;switch(v.opaque){case"A_ONE":t.opacity=x[3]*w.float;break;case"RGB_ZERO":t.opacity=1-x[0]*w.float;break;case"A_ZERO":t.opacity=1-x[3]*w.float;break;case"RGB_ONE":t.opacity=x[0]*w.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',v.opaque)}t.opacity<1&&(t.transparent=!0)}return void 0!==c&&void 0!==c.technique&&1===c.technique.double_sided&&(t.side=n.DoubleSide),t}function ae(e){return y(it.materials[e],te)}function re(e){for(var i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];switch(t.nodeName){case"technique_common":return ne(t)}}return{}}function ne(e){for(var data={},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];switch(t.nodeName){case"perspective":case"orthographic":data.technique=t.nodeName,data.parameters=ie(t)}}return data}function ie(e){for(var data={},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];switch(t.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":data[t.nodeName]=parseFloat(t.textContent)}}return data}function oe(data){var e;switch(data.optics.technique){case"perspective":e=new n.PerspectiveCamera(data.optics.parameters.yfov,data.optics.parameters.aspect_ratio,data.optics.parameters.znear,data.optics.parameters.zfar);break;case"orthographic":var t=data.optics.parameters.ymag,r=data.optics.parameters.xmag,o=data.optics.parameters.aspect_ratio;r=void 0===r?t*o:r,t=void 0===t?r/o:t,r*=.5,t*=.5,e=new n.OrthographicCamera(-r,r,t,-t,data.optics.parameters.znear,data.optics.parameters.zfar);break;default:e=new n.PerspectiveCamera}return e.name=data.name||"",e}function se(e){var data=it.cameras[e];return void 0!==data?y(data,oe):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e),null)}function ce(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"directional":case"point":case"spot":case"ambient":data.technique=r.nodeName,data.parameters=le(r)}}return data}function le(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var o=e.childNodes[i];if(1===o.nodeType)switch(o.nodeName){case"color":var c=r(o.textContent);data.color=(new n.Color).fromArray(c);break;case"falloff_angle":data.falloffAngle=parseFloat(o.textContent);break;case"quadratic_attenuation":var l=parseFloat(o.textContent);data.distance=l?Math.sqrt(1/l):0}}return data}function de(data){var e;switch(data.technique){case"directional":e=new n.DirectionalLight;break;case"point":e=new n.PointLight;break;case"spot":e=new n.SpotLight;break;case"ambient":e=new n.AmbientLight}return data.parameters.color&&e.color.copy(data.parameters.color),data.parameters.distance&&(e.distance=data.parameters.distance),e}function ue(e){var data=it.lights[e];return void 0!==data?y(data,de):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e),null)}function he(n){for(var data={array:[],stride:3},i=0;i<n.childNodes.length;i++){var o=n.childNodes[i];if(1===o.nodeType)switch(o.nodeName){case"float_array":data.array=r(o.textContent);break;case"Name_array":data.array=t(o.textContent);break;case"technique_common":var c=e(o,"accessor")[0];void 0!==c&&(data.stride=parseInt(c.getAttribute("stride")))}}return data}function pe(e){for(var data={},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];1===t.nodeType&&(data[t.getAttribute("semantic")]=l(t.getAttribute("source")))}return data}function fe(e){for(var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},i=0,r=e.childNodes.length;i<r;i++){var n=e.childNodes[i];if(1===n.nodeType)switch(n.nodeName){case"input":var o=l(n.getAttribute("source")),d=n.getAttribute("semantic"),h=parseInt(n.getAttribute("offset")),f=parseInt(n.getAttribute("set")),m=f>0?d+f:d;t.inputs[m]={id:o,offset:h},t.stride=Math.max(t.stride,h+1),"TEXCOORD"===d&&(t.hasUV=!0);break;case"vcount":t.vcount=c(n.textContent);break;case"p":t.p=c(n.textContent)}}return t}function me(e){for(var t=0,i=0,r=e.length;i<r;i++){!0===e[i].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function ge(data){var e={},t=data.sources,r=data.vertices,n=data.primitives;if(0===n.length)return{};var o=function(e){for(var t={},i=0;i<e.length;i++){var r=e[i];void 0===t[r.type]&&(t[r.type]=[]),t[r.type].push(r)}return t}(n);for(var c in o){var l=o[c];me(l),e[c]=ve(l,t,r)}return e}function ve(e,t,r){for(var o={},c={array:[],stride:0},l={array:[],stride:0},d={array:[],stride:0},h={array:[],stride:0},f={array:[],stride:0},m=[],v=4,y=[],w=4,x=new n.BufferGeometry,N=[],A=0,p=0;p<e.length;p++){var T=e[p],k=T.inputs,E=0;switch(T.type){case"lines":case"linestrips":E=2*T.count;break;case"triangles":E=3*T.count;break;case"polylist":for(var g=0;g<T.count;g++){var _=T.vcount[g];switch(_){case 3:E+=3;break;case 4:E+=6;break;default:E+=3*(_-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",T.type)}for(var O in x.addGroup(A,E,p),A+=E,T.material&&N.push(T.material),k){var input=k[O];switch(O){case"VERTEX":for(var C in r){var j=r[C];switch(C){case"POSITION":var M=c.array.length;if(ye(T,t[j],input.offset,c.array),c.stride=t[j].stride,t.skinWeights&&t.skinIndices&&(ye(T,t.skinIndices,input.offset,m),ye(T,t.skinWeights,input.offset,y)),!1===T.hasUV&&!0===e.uvsNeedsFix){E=(c.array.length-M)/c.stride;for(var i=0;i<E;i++)d.array.push(0,0)}break;case"NORMAL":ye(T,t[j],input.offset,l.array),l.stride=t[j].stride;break;case"COLOR":ye(T,t[j],input.offset,f.array),f.stride=t[j].stride;break;case"TEXCOORD":ye(T,t[j],input.offset,d.array),d.stride=t[j].stride;break;case"TEXCOORD1":ye(T,t[j],input.offset,h.array),d.stride=t[j].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',C)}}break;case"NORMAL":ye(T,t[input.id],input.offset,l.array),l.stride=t[input.id].stride;break;case"COLOR":ye(T,t[input.id],input.offset,f.array),f.stride=t[input.id].stride;break;case"TEXCOORD":ye(T,t[input.id],input.offset,d.array),d.stride=t[input.id].stride;break;case"TEXCOORD1":ye(T,t[input.id],input.offset,h.array),h.stride=t[input.id].stride}}}return c.array.length>0&&x.setAttribute("position",new n.Float32BufferAttribute(c.array,c.stride)),l.array.length>0&&x.setAttribute("normal",new n.Float32BufferAttribute(l.array,l.stride)),f.array.length>0&&x.setAttribute("color",new n.Float32BufferAttribute(f.array,f.stride)),d.array.length>0&&x.setAttribute("uv",new n.Float32BufferAttribute(d.array,d.stride)),h.array.length>0&&x.setAttribute("uv2",new n.Float32BufferAttribute(h.array,h.stride)),m.length>0&&x.setAttribute("skinIndex",new n.Float32BufferAttribute(m,v)),y.length>0&&x.setAttribute("skinWeight",new n.Float32BufferAttribute(y,w)),o.data=x,o.type=e[0].type,o.materialKeys=N,o}function ye(e,source,t,r){var n=e.p,o=e.stride,c=e.vcount;function l(i){for(var e=n[i+t]*h,o=e+h;e<o;e++)r.push(d[e])}var d=source.array,h=source.stride;if(void 0!==e.vcount)for(var f=0,i=0,m=c.length;i<m;i++){var v=c[i];if(4===v){var b=f+1*o,y=f+2*o,w=f+3*o;l(f+0*o),l(b),l(w),l(b),l(y),l(w)}else if(3===v){b=f+1*o,y=f+2*o;l(f+0*o),l(b),l(y)}else if(v>4)for(var x=1,N=v-2;x<=N;x++){b=f+o*x,y=f+o*(x+1);l(f+0*o),l(b),l(y)}f+=o*v}else for(i=0,m=n.length;i<m;i+=o)l(i)}function be(e){return y(it.geometries[e],ge)}function we(data){return void 0!==data.build?data.build:data}function xe(e,data){for(var i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"joint":data.joints[t.getAttribute("sid")]=Ne(t);break;case"link":data.links.push(Te(t))}}}function Ne(e){for(var data,i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"prismatic":case"revolute":data=Ae(t)}}return data}function Ae(e,data){data={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new n.Vector3,limits:{min:0,max:0},type:e.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"axis":var o=r(t.textContent);data.axis.fromArray(o);break;case"limits":var c=t.getElementsByTagName("max")[0],l=t.getElementsByTagName("min")[0];data.limits.max=parseFloat(c.textContent),data.limits.min=parseFloat(l.textContent)}}return data.limits.min>=data.limits.max&&(data.static=!0),data.middlePosition=(data.limits.min+data.limits.max)/2,data}function Te(e){for(var data={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"attachment_full":data.attachments.push(ke(t));break;case"matrix":case"translate":case"rotate":data.transforms.push(Ee(t))}}return data}function ke(e){for(var data={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"link":data.links.push(Te(t));break;case"matrix":case"translate":case"rotate":data.transforms.push(Ee(t))}}return data}function Ee(e){var data={type:e.nodeName},t=r(e.textContent);switch(data.type){case"matrix":data.obj=new n.Matrix4,data.obj.fromArray(t).transpose();break;case"translate":data.obj=new n.Vector3,data.obj.fromArray(t);break;case"rotate":data.obj=new n.Vector3,data.obj.fromArray(t),data.angle=n.Math.degToRad(t[3])}return data}function _e(e,data){for(var i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"technique_common":Oe(t,data)}}}function Oe(e,data){for(var i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"inertia":data.inertia=r(t.textContent);break;case"mass":data.mass=r(t.textContent)[0]}}}function Ce(e){for(var data={target:e.getAttribute("target").split("/").pop()},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"axis":var param=t.getElementsByTagName("param")[0];data.axis=param.textContent;var r=data.axis.split("inst_").pop().split("axis")[0];data.jointIndex=r.substr(0,r.length-1)}}return data}function je(data){return void 0!==data.build?data.build:data}function Me(e){for(var t=[],o=We.querySelector('[id="'+e.id+'"]'),i=0;i<o.childNodes.length;i++){var c=o.childNodes[i];if(1===c.nodeType)switch(c.nodeName){case"matrix":var l=r(c.textContent),d=(new n.Matrix4).fromArray(l).transpose();t.push({sid:c.getAttribute("sid"),type:c.nodeName,obj:d});break;case"translate":case"scale":l=r(c.textContent);var h=(new n.Vector3).fromArray(l);t.push({sid:c.getAttribute("sid"),type:c.nodeName,obj:h});break;case"rotate":l=r(c.textContent),h=(new n.Vector3).fromArray(l);var f=n.Math.degToRad(l[3]);t.push({sid:c.getAttribute("sid"),type:c.nodeName,obj:h,angle:f})}}return t}var Le=new n.Matrix4,Re=new n.Vector3;function Pe(e){for(var data={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new n.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"node":data.nodes.push(t.getAttribute("id")),Pe(t);break;case"instance_camera":data.instanceCameras.push(l(t.getAttribute("url")));break;case"instance_controller":data.instanceControllers.push(Se(t));break;case"instance_light":data.instanceLights.push(l(t.getAttribute("url")));break;case"instance_geometry":data.instanceGeometries.push(Se(t));break;case"instance_node":data.instanceNodes.push(l(t.getAttribute("url")));break;case"matrix":var o=r(t.textContent);data.matrix.multiply(Le.fromArray(o).transpose()),data.transforms[t.getAttribute("sid")]=t.nodeName;break;case"translate":o=r(t.textContent);Re.fromArray(o),data.matrix.multiply(Le.makeTranslation(Re.x,Re.y,Re.z)),data.transforms[t.getAttribute("sid")]=t.nodeName;break;case"rotate":o=r(t.textContent);var c=n.Math.degToRad(o[3]);data.matrix.multiply(Le.makeRotationAxis(Re.fromArray(o),c)),data.transforms[t.getAttribute("sid")]=t.nodeName;break;case"scale":o=r(t.textContent);data.matrix.scale(Re.fromArray(o)),data.transforms[t.getAttribute("sid")]=t.nodeName;break;case"extra":break;default:console.log(t)}}return Ue(data.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",data.id):it.nodes[data.id]=data,data}function Se(e){for(var data={id:l(e.getAttribute("url")),materials:{},skeletons:[]},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];switch(t.nodeName){case"bind_material":for(var r=t.getElementsByTagName("instance_material"),n=0;n<r.length;n++){var o=r[n],symbol=o.getAttribute("symbol"),c=o.getAttribute("target");data.materials[symbol]=l(c)}break;case"skeleton":data.skeletons.push(l(t.textContent))}}return data}function He(e,t){var i,data,r,o=[],c=[];for(i=0;i<e.length;i++){var l=e[i];if(Ue(l))Ve(qe(l),t,o);else if(r=l,void 0!==it.visualScenes[r])for(var d=it.visualScenes[l].children,h=0;h<d.length;h++){var f=d[h];if("JOINT"===f.type)Ve(qe(f.id),t,o)}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",l)}for(i=0;i<t.length;i++)for(h=0;h<o.length;h++)if((data=o[h]).bone.name===t[i].name){c[i]=data,data.processed=!0;break}for(i=0;i<o.length;i++)!1===(data=o[i]).processed&&(c.push(data),data.processed=!0);var m=[],v=[];for(i=0;i<c.length;i++)data=c[i],m.push(data.bone),v.push(data.boneInverse);return new n.Skeleton(m,v)}function Ve(e,t,r){e.traverse((function(object){if(!0===object.isBone){for(var e,i=0;i<t.length;i++){var o=t[i];if(o.name===object.name){e=o.boneInverse;break}}void 0===e&&(e=new n.Matrix4),r.push({bone:object,boneInverse:e,processed:!1})}}))}function De(data){for(var e,t=[],r=data.matrix,o=data.nodes,c=data.type,l=data.instanceCameras,d=data.instanceControllers,h=data.instanceLights,f=data.instanceGeometries,m=data.instanceNodes,i=0,v=o.length;i<v;i++)t.push(qe(o[i]));for(i=0,v=l.length;i<v;i++){var w=se(l[i]);null!==w&&t.push(w.clone())}for(i=0,v=d.length;i<v;i++)for(var x=d[i],N=(e=x.id,y(it.controllers[e],D)),A=Fe(be(N.id),x.materials),T=He(x.skeletons,N.skin.joints),k=0,E=A.length;k<E;k++){var object;(object=A[k]).isSkinnedMesh&&(object.bind(T,N.skin.bindMatrix),object.normalizeSkinWeights()),t.push(object)}for(i=0,v=h.length;i<v;i++){var _=ue(h[i]);null!==_&&t.push(_.clone())}for(i=0,v=f.length;i<v;i++)for(k=0,E=(A=Fe(be((x=f[i]).id),x.materials)).length;k<E;k++)t.push(A[k]);for(i=0,v=m.length;i<v;i++)t.push(qe(m[i]).clone());if(0===o.length&&1===t.length)object=t[0];else{object="JOINT"===c?new n.Bone:new n.Group;for(i=0;i<t.length;i++)object.add(t[i])}return""===object.name&&(object.name="JOINT"===c?data.sid:data.name),object.matrix.copy(r),object.matrix.decompose(object.position,object.quaternion,object.scale),object}var Ie=new n.MeshBasicMaterial({color:16711935});function ze(e,t){for(var r=[],i=0,n=e.length;i<n;i++){var o=t[e[i]];void 0===o?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",e[i]),r.push(Ie)):r.push(ae(o))}return r}function Fe(e,t){var r=[];for(var o in e){var c=e[o],l=ze(c.materialKeys,t);0===l.length&&("lines"===o||"linestrips"===o?l.push(new n.LineBasicMaterial):l.push(new n.MeshPhongMaterial));var d=void 0!==c.data.attributes.skinIndex;if(d)for(var i=0,h=l.length;i<h;i++)l[i].skinning=!0;var object,f=1===l.length?l[0]:l;switch(o){case"lines":object=new n.LineSegments(c.data,f);break;case"linestrips":object=new n.Line(c.data,f);break;case"triangles":case"polylist":object=d?new n.SkinnedMesh(c.data,f):new n.Mesh(c.data,f)}r.push(object)}return r}function Ue(e){return void 0!==it.nodes[e]}function qe(e){return y(it.nodes[e],De)}function Be(data){var e=new n.Group;e.name=data.name;for(var t=data.children,i=0;i<t.length;i++){var r=t[i];e.add(qe(r.id))}return e}function Xe(e){return y(it.visualScenes[e],Be)}if(0===text.length)return{scene:new n.Scene};var Ye=(new DOMParser).parseFromString(text,"application/xml"),We=e(Ye,"COLLADA")[0],Ge=Ye.getElementsByTagName("parsererror")[0];if(void 0!==Ge){var Ze,Je=e(Ge,"div")[0];return Ze=Je?Je.textContent:function(e){for(var t="",r=[e];r.length;){var n=r.shift();n.nodeType===Node.TEXT_NODE?t+=n.textContent:(t+="\n",r.push.apply(r,n.childNodes))}return t.trim()}(Ge),console.error("THREE.ColladaLoader: Failed to parse collada file.\n",Ze),null}var Qe=We.getAttribute("version");console.log("THREE.ColladaLoader: File version",Qe);var Ke,$e=function(t){return{unit:h(e(t,"unit")[0]),upAxis:f(e(t,"up_axis")[0])}}(e(We,"asset")[0]),et=new n.TextureLoader(this.manager);et.setPath(this.resourcePath||path).setCrossOrigin(this.crossOrigin),o&&(Ke=new o(this.manager)).setPath(this.resourcePath||path);var tt=[],at={},nt=0,it={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};m(We,"library_animations","animation",(function(e){for(var data={sources:{},samplers:{},channels:{}},i=0,t=e.childNodes.length;i<t;i++){var r,n=e.childNodes[i];if(1===n.nodeType)switch(n.nodeName){case"source":r=n.getAttribute("id"),data.sources[r]=he(n);break;case"sampler":r=n.getAttribute("id"),data.samplers[r]=w(n);break;case"channel":r=n.getAttribute("target"),data.channels[r]=x(n);break;default:console.log(n)}}it.animations[e.getAttribute("id")]=data})),m(We,"library_animation_clips","animation_clip",(function(e){for(var data={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"instance_animation":data.animations.push(l(r.getAttribute("url")))}}it.clips[e.getAttribute("id")]=data})),m(We,"library_controllers","controller",(function(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"skin":data.id=l(r.getAttribute("source")),data.skin=S(r);break;case"morph":data.id=l(r.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}it.controllers[e.getAttribute("id")]=data})),m(We,"library_images","image",(function(t){var data={init_from:e(t,"init_from")[0].textContent};it.images[t.getAttribute("id")]=data})),m(We,"library_effects","effect",(function(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"profile_COMMON":data.profile=F(r)}}it.effects[e.getAttribute("id")]=data})),m(We,"library_materials","material",(function(e){for(var data={name:e.getAttribute("name")},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"instance_effect":data.url=l(r.getAttribute("url"))}}it.materials[e.getAttribute("id")]=data})),m(We,"library_cameras","camera",(function(e){for(var data={name:e.getAttribute("name")},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"optics":data.optics=re(r)}}it.cameras[e.getAttribute("id")]=data})),m(We,"library_lights","light",(function(e){for(var data={},i=0,t=e.childNodes.length;i<t;i++){var r=e.childNodes[i];if(1===r.nodeType)switch(r.nodeName){case"technique_common":data=ce(r)}}it.lights[e.getAttribute("id")]=data})),m(We,"library_geometries","geometry",(function(t){var data={name:t.getAttribute("name"),sources:{},vertices:{},primitives:[]},r=e(t,"mesh")[0];if(void 0!==r){for(var i=0;i<r.childNodes.length;i++){var n=r.childNodes[i];if(1===n.nodeType){var o=n.getAttribute("id");switch(n.nodeName){case"source":data.sources[o]=he(n);break;case"vertices":data.vertices=pe(n);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",n.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":data.primitives.push(fe(n));break;default:console.log(n)}}}it.geometries[t.getAttribute("id")]=data}})),m(We,"library_nodes","node",Pe),m(We,"library_visual_scenes","visual_scene",(function(t){var data={name:t.getAttribute("name"),children:[]};!function(e){for(var t=e.getElementsByTagName("node"),i=0;i<t.length;i++){var element=t[i];!1===element.hasAttribute("id")&&element.setAttribute("id","three_default_"+nt++)}}(t);for(var r=e(t,"node"),i=0;i<r.length;i++)data.children.push(Pe(r[i]));it.visualScenes[t.getAttribute("id")]=data})),m(We,"library_kinematics_models","kinematics_model",(function(e){for(var data={name:e.getAttribute("name")||"",joints:{},links:[]},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"technique_common":xe(t,data)}}it.kinematicsModels[e.getAttribute("id")]=data})),m(We,"library_physics_models","physics_model",(function(e){for(var data={name:e.getAttribute("name")||"",rigidBodies:{}},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"rigid_body":data.rigidBodies[t.getAttribute("name")]={},_e(t,data.rigidBodies[t.getAttribute("name")])}}it.physicsModels[e.getAttribute("id")]=data})),m(We,"scene","instance_kinematics_scene",(function(e){for(var data={bindJointAxis:[]},i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];if(1===t.nodeType)switch(t.nodeName){case"bind_joint_axis":data.bindJointAxis.push(Ce(t))}}it.kinematicsScenes[l(e.getAttribute("url"))]=data})),v(it.animations,N),v(it.clips,R),v(it.controllers,D),v(it.images,I),v(it.effects,ee),v(it.materials,te),v(it.cameras,oe),v(it.lights,de),v(it.geometries,ge),v(it.visualScenes,Be),function(){var e=it.clips;if(!0===d(e)){if(!1===d(it.animations)){var t=[];for(var r in it.animations)for(var o=A(r),i=0,c=o.length;i<c;i++)t.push(o[i]);tt.push(new n.AnimationClip("default",-1,t))}}else for(var r in e)tt.push(P(r))}(),function(){var e=Object.keys(it.kinematicsModels)[0],t=Object.keys(it.kinematicsScenes)[0],r=Object.keys(it.visualScenes)[0];if(void 0!==e&&void 0!==t){for(var o,c=(o=e,y(it.kinematicsModels[o],we)),l=function(e){return y(it.kinematicsScenes[e],je)}(t),d=Xe(r),h=l.bindJointAxis,f={},i=0,m=h.length;i<m;i++){var v=h[i],w=We.querySelector('[sid="'+v.target+'"]');if(w){var x=w.parentElement;A(v.jointIndex,x)}}var N=new n.Matrix4;at={joints:c&&c.joints,getJointValue:function(e){var t=f[e];if(t)return t.position;console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){var r=f[e];if(r){var o=r.joint;if(t>o.limits.max||t<o.limits.min)console.warn("THREE.ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+o.limits.min+", max: "+o.limits.max+").");else if(o.static)console.warn("THREE.ColladaLoader: Joint "+e+" is static.");else{var object=r.object,c=o.axis,l=r.transforms;Le.identity();for(var i=0;i<l.length;i++){var d=l[i];if(d.sid&&-1!==d.sid.indexOf(e))switch(o.type){case"revolute":Le.multiply(N.makeRotationAxis(c,n.Math.degToRad(t)));break;case"prismatic":Le.multiply(N.makeTranslation(c.x*t,c.y*t,c.z*t));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+o.type)}else switch(d.type){case"matrix":Le.multiply(d.obj);break;case"translate":Le.multiply(N.makeTranslation(d.obj.x,d.obj.y,d.obj.z));break;case"scale":Le.scale(d.obj);break;case"rotate":Le.multiply(N.makeRotationAxis(d.obj,d.angle))}}object.matrix.copy(Le),object.matrix.decompose(object.position,object.quaternion,object.scale),f[e].position=t}}else console.log("THREE.ColladaLoader: "+e+" does not exist.")}}}function A(e,t){var r=t.getAttribute("name"),n=c.joints[e];d.traverse((function(object){object.name===r&&(f[e]={object:object,transforms:Me(t),joint:n,position:n.zeroPosition})}))}}();var ot=function(t){return Xe(l(e(t,"instance_visual_scene")[0].getAttribute("url")))}(e(We,"scene")[0]);return"Z_UP"===$e.upAxis&&ot.quaternion.setFromEuler(new n.Euler(-Math.PI/2,0,0)),ot.scale.multiplyScalar($e.unit),{animations:tt,kinematics:at,library:it,scene:ot}}})}}]);