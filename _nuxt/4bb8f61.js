(window.webpackJsonp=window.webpackJsonp||[]).push([[6,14],{195:function(e,t,n){"use strict";n.r(t);var r={data:function(){return{headerOverlay:!1,head:{title:"",description:""}}},watch:{headerOverlay:function(e,t){this.$root.$emit("headerOverlay",e)}},mounted:function(){this.$root.$emit("headerOverlay",this.headerOverlay)},head:function(){return{title:this.head.title,meta:[{hid:"description",name:"description",content:this.head.description}]}}},o=n(4),component=Object(o.a)(r,(function(){var e=this.$createElement;return(this._self._c||e)("div")}),[],!1,null,null,null);t.default=component.exports},197:function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},222:function(e,t,n){"use strict";function r(){return new Worker(n.p+"ab58597.worker.js")}n.d(t,"a",(function(){return r}))},223:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(35),n(15),n(21),n(38),n(36),n(37),n(96),n(97),n(224),n(27),n(210);var r=n(194);function o(e,t,n,o,d,c){var l={boids:[]},h=new r.StandardMaterial("debug_center",t);h.diffuseColor=r.Color3.FromHexString("#FF00FF"),l.center=r.MeshBuilder.CreateSphere("center",{diameter:.1,segments:8}),l.center.material=h;var m=new r.StandardMaterial("debug_bbox",t);m.emissiveColor=r.Color3.FromHexString("#00FF00"),m.disableLighting=!0,m.wireframe=!0,l.bbox=r.MeshBuilder.CreateBox("boids_bbox",{},t),l.bbox.scaling.x=Math.abs(d.x-o.x),l.bbox.scaling.y=Math.abs(d.y-o.y),l.bbox.scaling.z=Math.abs(d.z-o.z),l.bbox.position=o.add(d.subtract(o).scale(.5)),l.bbox.material=m;var f=new r.StandardMaterial("debug_wireframe",t);f.diffuseColor=r.Color3.FromHexString("#FFFFFF"),f.wireframe=!0,l.influenceMesh=r.MeshBuilder.CreateSphere("boid_influence_".concat(e),{diameter:c,segments:8}),l.influenceMesh.material=f,l.influenceMatrices=new Float32Array(16*n.length);for(var i=0;i<n.length;i++){r.Matrix.IdentityReadOnly.copyToArray(l.influenceMatrices,16*i),i++,l.boids.push({})}return l.influenceMesh.thinInstanceSetBuffer("matrix",l.influenceMatrices,16),l}},224:function(e,t,n){var r=n(2),o=n(197);r(r.S,"Math",{cbrt:function(e){return o(e=+e)*Math.pow(Math.abs(e),1/3)}})},242:function(e,t,n){var content=n(266);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(34).default)("637ecc2e",content,!0,{sourceMap:!1})},265:function(e,t,n){"use strict";n(242)},266:function(e,t,n){var r=n(33)(!1);r.push([e.i,"#underwater[data-v-7a2205d1]{height:100vh;width:100%;position:relative}#underwater-3d[data-v-7a2205d1]{height:100vh;width:100vw}#underwater-debug[data-v-7a2205d1]{top:0;right:0;z-index:1000}#underwater-debug[data-v-7a2205d1],#underwater-hud[data-v-7a2205d1]{position:absolute;padding:10px;border-radius:10px;background:#000;color:#fff;text-align:right}#underwater-hud[data-v-7a2205d1]{bottom:0;left:0;width:190px;height:220px;z-index:10;font-family:monospace}#underwater-hud span[data-v-7a2205d1]{display:inline-block}#underwater-hud #underwater-hud-compass[data-v-7a2205d1],#underwater-hud #underwater-hud-time[data-v-7a2205d1]{margin-top:10px}#underwater-hud #underwater-hud-compass-value[data-v-7a2205d1],#underwater-hud #underwater-hud-depth-value[data-v-7a2205d1],#underwater-hud #underwater-hud-time-value[data-v-7a2205d1]{line-height:.9;font-size:42px;font-family:monospace}#underwater-hud #underwater-hud-depth-ascent[data-v-7a2205d1]{-ms-writing-mode:tb-rl;writing-mode:vertical-rl;font-size:13px}#underwater-hud #underwater-hud-compass-name[data-v-7a2205d1],#underwater-hud #underwater-hud-depth-name[data-v-7a2205d1],#underwater-hud #underwater-hud-time-name[data-v-7a2205d1]{color:#4c70ff}#underwater-hud #underwater-hud-depth-unit[data-v-7a2205d1],#underwater-hud #underwater-hud-time-unit[data-v-7a2205d1]{vertical-align:top}#underwater-fullscreen[data-v-7a2205d1]{position:absolute;top:20px;left:0;padding:20px;margin:0;z-index:1;max-width:80%;line-height:1.2em;border-radius:10px;font-size:42px;background:#004;color:#fff;text-align:center}#underwater-settings[data-v-7a2205d1]{position:absolute;bottom:0;right:0;padding:10px;z-index:1000;color:#fff;text-align:right}#underwater-settings svg[data-v-7a2205d1]{cursor:pointer}",""]),e.exports=r},424:function(e,t,n){"use strict";n.r(t);var r=n(195),o=n(96),d=n(97),c=(n(27),n(210),n(35),n(15),n(21),n(38),n(36),n(37),n(194)),l=(n(206),n(222)),h=n(223);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,d=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){c=!0,o=e},f:function(){try{d||null==n.return||n.return()}finally{if(c)throw o}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var v=function(e,t,n){return new c.Vector3(e,t,n)},w=function(){function e(t){var n=this;Object(o.a)(this,e),this.base="",this.engine=null,this.scene=null,this.camera=null,this.assetsManager=null,this.sunLight=null;var r=document.getElementById("underwater-3d");document.onfullscreenchange=function(e){t.isFullscreen=!!document.fullscreenElement},this.base=t.base,this.bootScene(r),this.lights();var d=c.Mesh.CreateSphere("cPoint0",16,.1,this.scene);d.position=v(0,0,0);var l=new c.StandardMaterial("sp0Material",this.scene);l.emissiveColor=new c.Color3(1,0,0),l.disableLighting=!0,d.material=l;var h=c.Mesh.CreateSphere("cPoint1",16,.1,this.scene);h.position=v(20,10,10);var m=new c.StandardMaterial("sp1Material",this.scene);m.emissiveColor=new c.Color3(0,0,1),m.disableLighting=!0,h.material=m;var f=this.loadBoidsModel(this.base+"models/","sargentinho.glb",1e3,d.position,h.position,[{from:1,to:30,name:"swim"}]);[].push(f.promise),this.scene.onKeyboardObservable.add((function(e){if(e.type===c.KeyboardEventTypes.KEYUP)"x"===e.event.key&&f.boidsWorkerThread.postMessage({command:"dump"})})),this.assetsManager.load(),this.camera.speed=.5,t.$route.query.debug&&this.debugUtils();new Date;this.engine.runRenderLoop((function(){new Date;var e=n.engine.getDeltaTime()/1e3;if(t.$route.query.debug){var r=document.getElementById("inspector-host");r&&(r.style.position="absolute")}f.update(e),n.scene.render()})),window.addEventListener("resize",this.resize.bind(this))}return Object(d.a)(e,[{key:"beforeDestroy",value:function(){window.removeEventListener("resize",this.resize.bind(this)),document.onfullscreenchange=null,this.engine.stopRenderLoop(),this.scene.dispose(),this.scene=null,this.engine=null}},{key:"bootScene",value:function(e){var t=this;function n(){this.loadingUIText="Mergulho na Laje de Santos"}n.prototype.displayLoadingUI=function(){alert(this.loadingUIText)},n.prototype.hideLoadingUI=function(){alert("Loaded!")},this.engine=new c.Engine(e,!0),this.engine.loadingUIText="Mergulho na Laje de Santos",this.scene=new c.Scene(this.engine),this.scene.clearColor=new c.Color3(0,0,0);var r=new c.Vector3(5,5,5);"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?this.camera=new c.VirtualJoysticksCamera("Camera",r,this.scene):this.camera=new c.UniversalCamera("Camera",r,this.scene),this.camera.applyGravity=!1,this.camera.speed=.05,this.camera.ellipsoid=new c.Vector3(.5,1,.5),this.camera.keysUp.push("w".charCodeAt(0)),this.camera.keysUp.push("W".charCodeAt(0)),new URL(document.location).searchParams.has("debug")&&this.scene.debugLayer.show(),this.scene.onKeyboardObservable.add((function(e){switch(e.type){case c.KeyboardEventTypes.KEYDOWN:console.log("KEY DOWN: ",e.event.key);break;case c.KeyboardEventTypes.KEYUP:console.log("KEY UP: ",e.event.keyCode)}})),this.camera.minZ=.1,this.camera.maxZ=700,this.camera.setTarget(new c.Vector3(12.89001753167552,1.708562384403646,25.710433418293825)),this.camera.attachControl(e,!0),this.camera.inputs.attached.virtualJoystick&&this.camera.inputs.attached.virtualJoystick._rightjoystick.setJoystickSensibility(.01),this.assetsManager=new c.AssetsManager(this.scene),this.assetsManager.onTaskErrorObservable.add((function(e){console.error("task failed",e.name,e.errorObject.message,e.errorObject.exception)})),this.assetsManager.onTaskSuccessObservable.add((function(e){console.log("task successful",e.name)})),this.assetsManager.onProgress=function(e,n,r){t.engine.loadingUIText="We are loading the scene. "+e+" out of "+n+" items still need to be loaded."}}},{key:"debugUtils",value:function(){this.scene.debugLayer.show()}},{key:"instrumentation",value:function(){var e=new c.EngineInstrumentation(this.engine);e.captureGPUFrameTime=!0,e.captureShaderCompilationTime=!0;var i=0;this.scene.registerBeforeRender((function(){i%30==0&&console.log("current frame time (GPU): "+(1e-6*e.gpuFrameTimeCounter.current).toFixed(2)+"ms\naverage frame time (GPU): "+(1e-6*e.gpuFrameTimeCounter.average).toFixed(2)+"ms\ntotal shader compilation time: "+e.shaderCompilationTimeCounter.total.toFixed(2)+"ms\naverage shader compilation time: "+e.shaderCompilationTimeCounter.average.toFixed(2)+"ms\ncompiler shaders count: "+e.shaderCompilationTimeCounter.count),i++}))}},{key:"resize",value:function(){this.engine.resize()}},{key:"lights",value:function(){var e=new c.HemisphericLight("light1",new c.Vector3(0,1,0),this.scene);e.diffuse=c.Color3.FromHexString("#CCCCCC"),e.intensity=.4,this.sunLight=new c.DirectionalLight("DirectionalLight",new c.Vector3(-.5,-1,.6).normalize(),this.scene),this.sunLight.diffuse=c.Color3.FromHexString("#FFFFFF"),this.sunLight.intensity=.8}},{key:"loadBoidsModel",value:function(e,t,n,r,o,d){var f=this,v=[],w={},y=.001,x=.03,M=.2,C=.5,F=.2,S=Math.min(Math.abs(o.x-r.x),Math.abs(o.y-r.y),Math.abs(o.z-r.z))/2,k=new l.a;k.onmessage=function(e){"started"===e.data.command?w=Object(h.a)(t,f.scene,e.data.boids,(new c.Vector3).copyFrom(e.data.boundsMin),(new c.Vector3).copyFrom(e.data.boundsMax),C):(v=e.data.boids,w.center.position.copyFrom(e.data.center))},k.postMessage({command:"bundle",list:[{command:"construct",total:n,center:r.add(o.subtract(r).scale(.5)),initialRadius:1,boundRadiusScale:30},{command:"set",name:"boundsMin",value:r},{command:"set",name:"boundsMax",value:o},{command:"calculateBounds"},{command:"set",name:"cohesion",value:y},{command:"set",name:"alignment",value:x},{command:"set",name:"separation",value:M},{command:"set",name:"separationMinDistance",value:C},{command:"set",name:"maxSpeed",value:F},{command:"reset",total:n,initialRadius:S},{command:"start"}]});for(var T=null,z=new Float32Array(16*n),L=c.Matrix.Identity(),i=0;i<n;i++)L.copyToArray(z,16*i);new Float32Array(4*n);var p=c.SceneLoader.ImportMeshAsync("",e,t,this.scene,void 0).then((function(e){var t,n=e.meshes,r=m(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.material&&o.material.freeze(),f.scene.stopAnimation(o)}}catch(e){r.e(e)}finally{r.f()}var d=n[0];T=n[1],d.scaling.z=1,d.scaling.y=1,d.scaling.x=1,d.rotationQuaternion.y=0,d.rotationQuaternion.z=0,d.rotationQuaternion.w=1,d.computeWorldMatrix(),T.parent.rotationQuaternion.x=0,T.parent.rotationQuaternion.y=0,T.parent.rotationQuaternion.z=0,T.parent.rotationQuaternion.w=1,T.parent.rotationQuaternion.normalize(),T.computeWorldMatrix(),T.thinInstanceSetBuffer("matrix",z,16)})).catch((function(e){console.error(e)}));return{models:[T],boidsWorkerThread:k,promise:p,update:function(e,t){var n=new c.Vector3(1,1,1),r=new c.Vector3(1,1,1),o=new c.Vector3(0,1,0),d=(new c.Quaternion.RotationAxis(new c.Vector3(0,0,1),Math.PI),c.Matrix.Identity()),l=c.Quaternion.Zero(),h=new c.Vector3(1,1,1),m=new c.Vector3(1,1,1),f=new c.Vector3(1,1,1),y=new c.Vector3(1,1,1);return function(e){if(T){for(var t=0;t<v.length;t++){var x=v[t];f.copyFrom(x.position),y.copyFrom(x.velocity),y.normalizeToRef(r),c.Vector3.CrossToRef(r,o,m),c.Vector3.CrossToRef(m,r,h),c.Quaternion.RotationQuaternionFromAxisToRef(m,r,h,l),c.Matrix.ComposeToRef(n,l,f,d),d.copyToArray(z,16*t),w.boids&&d.copyToArray(w.influenceMatrices,16*t)}T.thinInstanceSetBuffer("matrix",z,16),w.influenceMesh&&w.influenceMesh.thinInstanceSetBuffer("matrix",w.influenceMatrices,16)}}}()}}},{key:"random",value:function(e,t){return Math.random()*(t-e)+e}},{key:"clamp",value:function(e,t,n){return Math.min(Math.max(e,t),n)}}]),e}(),y={props:{},data:function(){return{isFullscreen:!1}},computed:{base:function(){return this.$router.options.base}},mounted:function(){this.underwater=new w(this),window.underwater=this.underwater},methods:{fullscreen:function(){document.getElementById("underwater").requestFullscreen()}}},x=(n(265),n(4)),M={components:{Boids:Object(x.a)(y,(function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"underwater"}},[t("canvas",{attrs:{id:"underwater-3d","touch-action":"none"}})])}],!1,null,"7a2205d1",null).exports},extends:r.default,data:function(){return{}},mounted:function(){this.head.title=this.$gettext("Mergulho virtual"),this.head.description=this.$gettext("Boids")}},C=Object(x.a)(M,(function(){var e=this.$createElement,t=this._self._c||e;return t("article",[t("section",[t("Boids")],1)])}),[],!1,null,null,null);t.default=C.exports}}]);