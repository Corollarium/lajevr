(window.webpackJsonp=window.webpackJsonp||[]).push([[7,16],{194:function(e,t,n){"use strict";n.r(t);var r={data:function(){return{headerOverlay:!1,head:{title:"",description:""}}},watch:{headerOverlay:function(e,t){this.$root.$emit("headerOverlay",e)}},mounted:function(){this.$root.$emit("headerOverlay",this.headerOverlay)},head:function(){return{title:this.head.title,meta:[{hid:"description",name:"description",content:this.head.description}]}}},o=n(4),component=Object(o.a)(r,(function(){var e=this.$createElement;return(this._self._c||e)("div")}),[],!1,null,null,null);t.default=component.exports},240:function(e,t,n){var content=n(266);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(34).default)("0843bdca",content,!0,{sourceMap:!1})},265:function(e,t,n){"use strict";n(240)},266:function(e,t,n){var r=n(33)(!1);r.push([e.i,"#underwater[data-v-76bb6752]{height:100vh;width:100%;position:relative}#underwater-3d[data-v-76bb6752]{height:100vh;width:100vw}#underwater-debug[data-v-76bb6752]{top:0;right:0;z-index:1000}#underwater-debug[data-v-76bb6752],#underwater-hud[data-v-76bb6752]{position:absolute;padding:10px;border-radius:10px;background:#000;color:#fff;text-align:right}#underwater-hud[data-v-76bb6752]{bottom:0;left:0;width:160px;height:220px;z-index:10;font-family:monospace}#underwater-hud span[data-v-76bb6752]{display:inline-block}#underwater-hud #underwater-hud-compass[data-v-76bb6752],#underwater-hud #underwater-hud-time[data-v-76bb6752]{margin-top:10px}#underwater-hud #underwater-hud-compass-value[data-v-76bb6752],#underwater-hud #underwater-hud-depth-value[data-v-76bb6752],#underwater-hud #underwater-hud-time-value[data-v-76bb6752]{line-height:.9;font-size:42px;font-family:monospace}#underwater-hud #underwater-hud-depth-ascent[data-v-76bb6752]{-ms-writing-mode:tb-rl;writing-mode:vertical-rl}#underwater-hud #underwater-hud-compass-name[data-v-76bb6752],#underwater-hud #underwater-hud-depth-name[data-v-76bb6752],#underwater-hud #underwater-hud-time-name[data-v-76bb6752]{color:#4c70ff}#underwater-hud #underwater-hud-depth-unit[data-v-76bb6752],#underwater-hud #underwater-hud-time-unit[data-v-76bb6752]{vertical-align:top}#underwater-fullscreen[data-v-76bb6752]{position:absolute;top:20px;left:0;padding:20px;margin:0;z-index:1;max-width:80%;line-height:1.2em;border-radius:10px;font-size:42px;background:#004;color:#fff;text-align:center}#underwater-settings[data-v-76bb6752]{position:absolute;bottom:0;right:0;padding:10px;z-index:1000;color:#fff;text-align:right}#underwater-settings svg[data-v-76bb6752]{cursor:pointer}",""]),e.exports=r},421:function(e,t,n){"use strict";n.r(t);var r=n(194),o=n(95),d=n(96),c=(n(27),n(210),n(35),n(15),n(21),n(38),n(36),n(37),n(193));n(206);function l(){return new Worker(n.p+"76b4257.worker.js")}function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,d=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){c=!0,o=e},f:function(){try{d||null==n.return||n.return()}finally{if(c)throw o}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var f=function(e,t,n){return new c.Vector3(e,t,n)},v=function(){function e(t){var n=this;Object(o.a)(this,e),this.base="",this.engine=null,this.scene=null,this.camera=null,this.assetsManager=null,this.sunLight=null;var r=document.getElementById("underwater-3d");document.onfullscreenchange=function(e){t.isFullscreen=!!document.fullscreenElement},this.base=t.base,this.bootScene(r),this.lights();var d=c.Mesh.CreateSphere("cPoint0",16,.1,this.scene);d.position=f(0,0,0);var l=new c.StandardMaterial("sp0Material",this.scene);l.emissiveColor=new c.Color3(1,0,0),l.disableLighting=!0,d.material=l;var h=c.Mesh.CreateSphere("cPoint1",16,.1,this.scene);h.position=f(20,10,10);var m=new c.StandardMaterial("sp1Material",this.scene);m.emissiveColor=new c.Color3(0,0,1),m.disableLighting=!0,h.material=m;var v=this.loadBoidsModel(this.base+"models/","sargentinho.glb",1e3,d.position,h.position,[{from:1,to:30,name:"swim"}]);[].push(v.promise),this.scene.onKeyboardObservable.add((function(e){if(e.type===c.KeyboardEventTypes.KEYUP)"x"===e.event.key&&v.boidsWorkerThread.postMessage({command:"dump"})})),this.assetsManager.load(),this.camera.speed=.5,t.$route.query.debug&&this.debugUtils();new Date;this.engine.runRenderLoop((function(){new Date;var e=n.engine.getDeltaTime()/1e3;if(t.$route.query.debug){var r=document.getElementById("inspector-host");r&&(r.style.position="absolute")}v.update(e),n.scene.render()})),window.addEventListener("resize",this.resize.bind(this))}return Object(d.a)(e,[{key:"beforeDestroy",value:function(){window.removeEventListener("resize",this.resize.bind(this)),document.onfullscreenchange=null,this.engine.stopRenderLoop(),this.scene.dispose(),this.scene=null,this.engine=null}},{key:"bootScene",value:function(e){var t=this;function n(){this.loadingUIText="Mergulho na Laje de Santos"}n.prototype.displayLoadingUI=function(){alert(this.loadingUIText)},n.prototype.hideLoadingUI=function(){alert("Loaded!")},this.engine=new c.Engine(e,!0),this.engine.loadingUIText="Mergulho na Laje de Santos",this.scene=new c.Scene(this.engine),this.scene.clearColor=new c.Color3(0,0,0);var r=new c.Vector3(5,5,5);"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?this.camera=new c.VirtualJoysticksCamera("Camera",r,this.scene):this.camera=new c.UniversalCamera("Camera",r,this.scene),this.camera.applyGravity=!1,this.camera.speed=.05,this.camera.ellipsoid=new c.Vector3(.5,1,.5),this.camera.keysUp.push("w".charCodeAt(0)),this.camera.keysUp.push("W".charCodeAt(0)),new URL(document.location).searchParams.has("debug")&&this.scene.debugLayer.show(),this.scene.onKeyboardObservable.add((function(e){switch(e.type){case c.KeyboardEventTypes.KEYDOWN:console.log("KEY DOWN: ",e.event.key);break;case c.KeyboardEventTypes.KEYUP:console.log("KEY UP: ",e.event.keyCode)}})),this.camera.minZ=.1,this.camera.maxZ=700,this.camera.setTarget(new c.Vector3(12.89001753167552,1.708562384403646,25.710433418293825)),this.camera.attachControl(e,!0),this.camera.inputs.attached.virtualJoystick&&this.camera.inputs.attached.virtualJoystick._rightjoystick.setJoystickSensibility(.01),this.assetsManager=new c.AssetsManager(this.scene),this.assetsManager.onTaskErrorObservable.add((function(e){console.error("task failed",e.name,e.errorObject.message,e.errorObject.exception)})),this.assetsManager.onTaskSuccessObservable.add((function(e){console.log("task successful",e.name)})),this.assetsManager.onProgress=function(e,n,r){t.engine.loadingUIText="We are loading the scene. "+e+" out of "+n+" items still need to be loaded."}}},{key:"debugUtils",value:function(){this.scene.debugLayer.show()}},{key:"instrumentation",value:function(){var e=new c.EngineInstrumentation(this.engine);e.captureGPUFrameTime=!0,e.captureShaderCompilationTime=!0;var i=0;this.scene.registerBeforeRender((function(){i%30==0&&console.log("current frame time (GPU): "+(1e-6*e.gpuFrameTimeCounter.current).toFixed(2)+"ms\naverage frame time (GPU): "+(1e-6*e.gpuFrameTimeCounter.average).toFixed(2)+"ms\ntotal shader compilation time: "+e.shaderCompilationTimeCounter.total.toFixed(2)+"ms\naverage shader compilation time: "+e.shaderCompilationTimeCounter.average.toFixed(2)+"ms\ncompiler shaders count: "+e.shaderCompilationTimeCounter.count),i++}))}},{key:"resize",value:function(){this.engine.resize()}},{key:"lights",value:function(){var e=new c.HemisphericLight("light1",new c.Vector3(0,1,0),this.scene);e.diffuse=c.Color3.FromHexString("#CCCCCC"),e.intensity=.4,this.sunLight=new c.DirectionalLight("DirectionalLight",new c.Vector3(-.5,-1,.6).normalize(),this.scene),this.sunLight.diffuse=c.Color3.FromHexString("#FFFFFF"),this.sunLight.intensity=.8}},{key:"loadBoidsModel",value:function(e,t,n,r,o,d){var m=this,f=[],v={},w=.001,y=.03,x=.2,M=.5,C=1,F=new l;F.onmessage=function(e){"started"===e.data.command?v=m.showBoidsDebug(m.scene,e.data.boids,(new c.Vector3).copyFrom(e.data.boundsMin),(new c.Vector3).copyFrom(e.data.boundsMax),M):(f=e.data.boids,v.center.position.copyFrom(e.data.center))},F.postMessage({command:"bundle",list:[{command:"construct",total:n,center:r.add(o.subtract(r).scale(.5)),initialRadius:1,boundRadiusScale:30},{command:"set",name:"boundsMin",value:r},{command:"set",name:"boundsMax",value:o},{command:"calculateBounds"},{command:"set",name:"cohesion",value:w},{command:"set",name:"alignment",value:y},{command:"set",name:"separation",value:x},{command:"set",name:"separationMinDistance",value:M},{command:"set",name:"maxSpeed",value:C},{command:"start"}]});for(var k=null,S=new Float32Array(16*n),T=c.Matrix.Identity(),i=0;i<n;i++)T.copyToArray(S,16*i);new Float32Array(4*n);var p=c.SceneLoader.ImportMeshAsync("",e,t,this.scene,void 0).then((function(e){var t,n=e.meshes,r=h(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.material&&o.material.freeze(),m.scene.stopAnimation(o)}}catch(e){r.e(e)}finally{r.f()}c.BoxBuilder.CreateBox("rooxxt",{size:1},m.scene);var d=n[0];k=n[1],d.scaling.z=1,d.scaling.y=1,d.scaling.x=1,d.rotationQuaternion.y=0,k.computeWorldMatrix(),k.thinInstanceSetBuffer("matrix",S,16)})).catch((function(e){console.error(e)}));return{models:[k],boidsWorkerThread:F,promise:p,update:function(e,t){var n=new c.Vector3(1,1,1),r=new c.Vector3(1,1,1),o=new c.Vector3(0,1,0),d=new c.Quaternion.RotationAxis(new c.Vector3(0,0,1),Math.PI),l=c.Matrix.Identity(),h=c.Quaternion.Zero(),m=new c.Vector3(1,1,1),w=new c.Vector3(1,1,1),y=new c.Vector3(1,1,1),x=new c.Vector3(1,1,1);return function(e){if(k){for(var t=0;t<f.length;t++){var M=f[t];y.copyFrom(M.position),x.copyFrom(M.velocity),x.normalizeToRef(r),c.Vector3.CrossToRef(r,o,w),c.Vector3.CrossToRef(w,r,m),c.Quaternion.RotationQuaternionFromAxisToRef(w,r,m,h),h.multiplyInPlace(d),c.Matrix.ComposeToRef(n,h,M.position,l),l.copyToArray(S,16*t),v.boids&&l.copyToArray(v.influenceMatrices,16*t)}k.thinInstanceSetBuffer("matrix",S,16),v.influenceMesh&&v.influenceMesh.thinInstanceSetBuffer("matrix",v.influenceMatrices,16)}}}()}}},{key:"showBoidsDebug",value:function(e,t,n,r,o){var d={boids:[]},l=new c.StandardMaterial("debug_center",e);l.diffuseColor=c.Color3.FromHexString("#FF00FF"),d.center=c.MeshBuilder.CreateSphere("center",{diameter:.1,segments:8}),d.center.material=l;var m=new c.StandardMaterial("debug_bbox",e);m.emissiveColor=c.Color3.FromHexString("#00FF00"),m.disableLighting=!0,m.wireframe=!0,d.bbox=c.MeshBuilder.CreateBox("boids_bbox",{},e),d.bbox.scaling.x=Math.abs(r.x-n.x),d.bbox.scaling.y=Math.abs(r.y-n.y),d.bbox.scaling.z=Math.abs(r.z-n.z),d.bbox.position=n.add(r.subtract(n).scale(.5)),d.bbox.material=m;var f=new c.StandardMaterial("debug_wireframe",e);f.diffuseColor=c.Color3.FromHexString("#FFFFFF"),f.wireframe=!0,d.influenceMesh=c.MeshBuilder.CreateSphere("boid_influence_".concat("xxx"),{diameter:o,segments:8}),d.influenceMesh.material=f,d.influenceMatrices=new Float32Array(16*t.length);var v,i=0,w=h(t);try{for(w.s();!(v=w.n()).done;){v.value;c.Matrix.IdentityReadOnly.copyToArray(d.influenceMatrices,16*i),i++,d.boids.push({})}}catch(e){w.e(e)}finally{w.f()}return d.influenceMesh.thinInstanceSetBuffer("matrix",d.influenceMatrices,16),d}},{key:"random",value:function(e,t){return Math.random()*(t-e)+e}},{key:"clamp",value:function(e,t,n){return Math.min(Math.max(e,t),n)}}]),e}(),w={props:{},data:function(){return{isFullscreen:!1}},computed:{base:function(){return this.$router.options.base}},mounted:function(){this.underwater=new v(this),window.underwater=this.underwater},methods:{fullscreen:function(){document.getElementById("underwater").requestFullscreen()}}},y=(n(265),n(4)),x={components:{Boids:Object(y.a)(w,(function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"underwater"}},[t("canvas",{attrs:{id:"underwater-3d","touch-action":"none"}})])}],!1,null,"76bb6752",null).exports},extends:r.default,data:function(){return{}},mounted:function(){this.head.title=this.$gettext("Mergulho virtual"),this.head.description=this.$gettext("Boids")}},M=Object(y.a)(x,(function(){var e=this.$createElement,t=this._self._c||e;return t("article",[t("section",[t("Boids")],1)])}),[],!1,null,null,null);t.default=M.exports}}]);