(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{179:function(e,t,n){"use strict";var r=n(3),o=n(19),c=n(23),l=n(108),h=n(58),d=n(10),m=n(39).f,f=n(59).f,v=n(8).f,T=n(210).trim,M=r.Number,E=M,y=M.prototype,S="Number"==c(n(73)(y)),L="trim"in String.prototype,R=function(e){var t=h(e,!1);if("string"==typeof t&&t.length>2){var n,r,o,c=(t=L?t.trim():T(t,3)).charCodeAt(0);if(43===c||45===c){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===c){switch(t.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+t}for(var code,l=t.slice(2),i=0,d=l.length;i<d;i++)if((code=l.charCodeAt(i))<48||code>o)return NaN;return parseInt(l,r)}}return+t};if(!M(" 0o1")||!M("0b1")||M("+0x1")){M=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof M&&(S?d((function(){y.valueOf.call(n)})):"Number"!=c(n))?l(new E(R(t)),n,M):R(t)};for(var A,w=n(7)?m(E):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;w.length>_;_++)o(E,A=w[_])&&!o(M,A)&&v(M,A,f(E,A));M.prototype=y,y.constructor=M,n(11)(r,"Number",M)}},180:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(166),o=function(object,e){var t,n,o,c,l;void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=object,this.domElement=e,this.enabled=!0,this.target=new r.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:r.MOUSE.ROTATE,MIDDLE:r.MOUSE.DOLLY,RIGHT:r.MOUSE.PAN},this.touches={ONE:r.TOUCH.ROTATE,TWO:r.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return E.phi},this.getAzimuthalAngle=function(){return E.theta},this.saveState=function(){h.target0.copy(h.target),h.position0.copy(h.object.position),h.zoom0=h.object.zoom},this.reset=function(){h.target.copy(h.target0),h.object.position.copy(h.position0),h.object.zoom=h.zoom0,h.object.updateProjectionMatrix(),h.dispatchEvent(d),h.update(),T=v.NONE},this.update=(t=new r.Vector3,n=(new r.Quaternion).setFromUnitVectors(object.up,new r.Vector3(0,1,0)),o=n.clone().inverse(),c=new r.Vector3,l=new r.Quaternion,function(){var e=h.object.position;return t.copy(e).sub(h.target),t.applyQuaternion(n),E.setFromVector3(t),h.autoRotate&&T===v.NONE&&F(2*Math.PI/60/60*h.autoRotateSpeed),h.enableDamping?(E.theta+=y.theta*h.dampingFactor,E.phi+=y.phi*h.dampingFactor):(E.theta+=y.theta,E.phi+=y.phi),E.theta=Math.max(h.minAzimuthAngle,Math.min(h.maxAzimuthAngle,E.theta)),E.phi=Math.max(h.minPolarAngle,Math.min(h.maxPolarAngle,E.phi)),E.makeSafe(),E.radius*=S,E.radius=Math.max(h.minDistance,Math.min(h.maxDistance,E.radius)),!0===h.enableDamping?h.target.addScaledVector(L,h.dampingFactor):h.target.add(L),t.setFromSpherical(E),t.applyQuaternion(o),e.copy(h.target).add(t),h.object.lookAt(h.target),!0===h.enableDamping?(y.theta*=1-h.dampingFactor,y.phi*=1-h.dampingFactor,L.multiplyScalar(1-h.dampingFactor)):(y.set(0,0,0),L.set(0,0,0)),S=1,!!(R||c.distanceToSquared(h.object.position)>M||8*(1-l.dot(h.object.quaternion))>M)&&(h.dispatchEvent(d),c.copy(h.object.position),l.copy(h.object.quaternion),R=!1,!0)}),this.dispose=function(){h.domElement.removeEventListener("contextmenu",ie,!1),h.domElement.removeEventListener("mousedown",$,!1),h.domElement.removeEventListener("wheel",ae,!1),h.domElement.removeEventListener("touchstart",re,!1),h.domElement.removeEventListener("touchend",se,!1),h.domElement.removeEventListener("touchmove",oe,!1),document.removeEventListener("mousemove",ee,!1),document.removeEventListener("mouseup",te,!1),h.domElement.removeEventListener("keydown",ne,!1)};var h=this,d={type:"change"},m={type:"start"},f={type:"end"},v={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},T=v.NONE,M=1e-6,E=new r.Spherical,y=new r.Spherical,S=1,L=new r.Vector3,R=!1,A=new r.Vector2,w=new r.Vector2,_=new r.Vector2,x=new r.Vector2,O=new r.Vector2,N=new r.Vector2,P=new r.Vector2,I=new r.Vector2,U=new r.Vector2;function C(){return Math.pow(.95,h.zoomSpeed)}function F(e){y.theta-=e}function H(e){y.phi-=e}var D,k=(D=new r.Vector3,function(e,t){D.setFromMatrixColumn(t,0),D.multiplyScalar(-e),L.add(D)}),G=function(){var e=new r.Vector3;return function(t,n){!0===h.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(h.object.up,e)),e.multiplyScalar(t),L.add(e)}}(),j=function(){var e=new r.Vector3;return function(t,n){var element=h.domElement;if(h.object.isPerspectiveCamera){var r=h.object.position;e.copy(r).sub(h.target);var o=e.length();o*=Math.tan(h.object.fov/2*Math.PI/180),k(2*t*o/element.clientHeight,h.object.matrix),G(2*n*o/element.clientHeight,h.object.matrix)}else h.object.isOrthographicCamera?(k(t*(h.object.right-h.object.left)/h.object.zoom/element.clientWidth,h.object.matrix),G(n*(h.object.top-h.object.bottom)/h.object.zoom/element.clientHeight,h.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),h.enablePan=!1)}}();function B(e){h.object.isPerspectiveCamera?S/=e:h.object.isOrthographicCamera?(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom*e)),h.object.updateProjectionMatrix(),R=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function V(e){h.object.isPerspectiveCamera?S*=e:h.object.isOrthographicCamera?(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom/e)),h.object.updateProjectionMatrix(),R=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function K(e){A.set(e.clientX,e.clientY)}function Y(e){x.set(e.clientX,e.clientY)}function z(e){if(1==e.touches.length)A.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);A.set(t,n)}}function X(e){if(1==e.touches.length)x.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);x.set(t,n)}}function Z(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);P.set(0,r)}function W(e){if(1==e.touches.length)w.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(t,n)}_.subVectors(w,A).multiplyScalar(h.rotateSpeed);var element=h.domElement;F(2*Math.PI*_.x/element.clientHeight),H(2*Math.PI*_.y/element.clientHeight),A.copy(w)}function Q(e){if(1==e.touches.length)O.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);O.set(t,n)}N.subVectors(O,x).multiplyScalar(h.panSpeed),j(N.x,N.y),x.copy(O)}function J(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);I.set(0,r),U.set(0,Math.pow(I.y/P.y,h.zoomSpeed)),B(U.y),P.copy(I)}function $(e){if(!1!==h.enabled){switch(e.preventDefault(),h.domElement.focus?h.domElement.focus():window.focus(),e.button){case 0:switch(h.mouseButtons.LEFT){case r.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===h.enablePan)return;Y(e),T=v.PAN}else{if(!1===h.enableRotate)return;K(e),T=v.ROTATE}break;case r.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===h.enableRotate)return;K(e),T=v.ROTATE}else{if(!1===h.enablePan)return;Y(e),T=v.PAN}break;default:T=v.NONE}break;case 1:switch(h.mouseButtons.MIDDLE){case r.MOUSE.DOLLY:if(!1===h.enableZoom)return;!function(e){P.set(e.clientX,e.clientY)}(e),T=v.DOLLY;break;default:T=v.NONE}break;case 2:switch(h.mouseButtons.RIGHT){case r.MOUSE.ROTATE:if(!1===h.enableRotate)return;K(e),T=v.ROTATE;break;case r.MOUSE.PAN:if(!1===h.enablePan)return;Y(e),T=v.PAN;break;default:T=v.NONE}}T!==v.NONE&&(document.addEventListener("mousemove",ee,!1),document.addEventListener("mouseup",te,!1),h.dispatchEvent(m))}}function ee(e){if(!1!==h.enabled)switch(e.preventDefault(),T){case v.ROTATE:if(!1===h.enableRotate)return;!function(e){w.set(e.clientX,e.clientY),_.subVectors(w,A).multiplyScalar(h.rotateSpeed);var element=h.domElement;F(2*Math.PI*_.x/element.clientHeight),H(2*Math.PI*_.y/element.clientHeight),A.copy(w),h.update()}(e);break;case v.DOLLY:if(!1===h.enableZoom)return;!function(e){I.set(e.clientX,e.clientY),U.subVectors(I,P),U.y>0?B(C()):U.y<0&&V(C()),P.copy(I),h.update()}(e);break;case v.PAN:if(!1===h.enablePan)return;!function(e){O.set(e.clientX,e.clientY),N.subVectors(O,x).multiplyScalar(h.panSpeed),j(N.x,N.y),x.copy(O),h.update()}(e)}}function te(e){!1!==h.enabled&&(document.removeEventListener("mousemove",ee,!1),document.removeEventListener("mouseup",te,!1),h.dispatchEvent(f),T=v.NONE)}function ae(e){!1===h.enabled||!1===h.enableZoom||T!==v.NONE&&T!==v.ROTATE||(e.preventDefault(),e.stopPropagation(),h.dispatchEvent(m),function(e){e.deltaY<0?V(C()):e.deltaY>0&&B(C()),h.update()}(e),h.dispatchEvent(f))}function ne(e){!1!==h.enabled&&!1!==h.enableKeys&&!1!==h.enablePan&&function(e){var t=!1;switch(e.keyCode){case h.keys.UP:j(0,h.keyPanSpeed),t=!0;break;case h.keys.BOTTOM:j(0,-h.keyPanSpeed),t=!0;break;case h.keys.LEFT:j(h.keyPanSpeed,0),t=!0;break;case h.keys.RIGHT:j(-h.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),h.update())}(e)}function re(e){if(!1!==h.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(h.touches.ONE){case r.TOUCH.ROTATE:if(!1===h.enableRotate)return;z(e),T=v.TOUCH_ROTATE;break;case r.TOUCH.PAN:if(!1===h.enablePan)return;X(e),T=v.TOUCH_PAN;break;default:T=v.NONE}break;case 2:switch(h.touches.TWO){case r.TOUCH.DOLLY_PAN:if(!1===h.enableZoom&&!1===h.enablePan)return;!function(e){h.enableZoom&&Z(e),h.enablePan&&X(e)}(e),T=v.TOUCH_DOLLY_PAN;break;case r.TOUCH.DOLLY_ROTATE:if(!1===h.enableZoom&&!1===h.enableRotate)return;!function(e){h.enableZoom&&Z(e),h.enableRotate&&z(e)}(e),T=v.TOUCH_DOLLY_ROTATE;break;default:T=v.NONE}break;default:T=v.NONE}T!==v.NONE&&h.dispatchEvent(m)}}function oe(e){if(!1!==h.enabled)switch(e.preventDefault(),e.stopPropagation(),T){case v.TOUCH_ROTATE:if(!1===h.enableRotate)return;W(e),h.update();break;case v.TOUCH_PAN:if(!1===h.enablePan)return;Q(e),h.update();break;case v.TOUCH_DOLLY_PAN:if(!1===h.enableZoom&&!1===h.enablePan)return;!function(e){h.enableZoom&&J(e),h.enablePan&&Q(e)}(e),h.update();break;case v.TOUCH_DOLLY_ROTATE:if(!1===h.enableZoom&&!1===h.enableRotate)return;!function(e){h.enableZoom&&J(e),h.enableRotate&&W(e)}(e),h.update();break;default:T=v.NONE}}function se(e){!1!==h.enabled&&(h.dispatchEvent(f),T=v.NONE)}function ie(e){!1!==h.enabled&&e.preventDefault()}h.domElement.addEventListener("contextmenu",ie,!1),h.domElement.addEventListener("mousedown",$,!1),h.domElement.addEventListener("wheel",ae,!1),h.domElement.addEventListener("touchstart",re,!1),h.domElement.addEventListener("touchend",se,!1),h.domElement.addEventListener("touchmove",oe,!1),h.domElement.addEventListener("keydown",ne,!1),-1===h.domElement.tabIndex&&(h.domElement.tabIndex=0),this.update()};o.prototype=Object.create(r.EventDispatcher.prototype),o.prototype.constructor=o;var c=function(object,e){o.call(this,object,e),this.mouseButtons.LEFT=r.MOUSE.PAN,this.mouseButtons.RIGHT=r.MOUSE.ROTATE,this.touches.ONE=r.TOUCH.PAN,this.touches.TWO=r.TOUCH.DOLLY_ROTATE};(c.prototype=Object.create(r.EventDispatcher.prototype)).constructor=c},181:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(166),o=function(){function e(e){r.Loader.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,object){e[t]=object},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(r.Loader.prototype),{constructor:e,load:function(e,t,n,o){var c,l=this;c=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:r.LoaderUtils.extractUrlBase(e),l.manager.itemStart(e);var h=function(t){o?o(t):console.error(t),l.manager.itemError(e),l.manager.itemEnd(e)},d=new r.FileLoader(l.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),"use-credentials"===l.crossOrigin&&d.setWithCredentials(!0),d.load(e,(function(data){try{l.parse(data,c,(function(n){t(n),l.manager.itemEnd(e)}),h)}catch(e){h(e)}}),n,h)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(data,path,e,t){var content,d={};if("string"==typeof data)content=data;else if(r.LoaderUtils.decodeText(new Uint8Array(data,0,4))===h){try{d[n.KHR_BINARY_GLTF]=new f(data)}catch(e){return void(t&&t(e))}content=d[n.KHR_BINARY_GLTF].content}else content=r.LoaderUtils.decodeText(new Uint8Array(data));var m=JSON.parse(content);if(void 0===m.asset||m.asset.version[0]<2)t&&t(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(m.extensionsUsed)for(var i=0;i<m.extensionsUsed.length;++i){var y=m.extensionsUsed[i],S=m.extensionsRequired||[];switch(y){case n.KHR_LIGHTS_PUNCTUAL:d[y]=new c(m);break;case n.KHR_MATERIALS_UNLIT:d[y]=new l;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:d[y]=new M;break;case n.KHR_DRACO_MESH_COMPRESSION:d[y]=new v(m,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:d[y]=new o(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:d[y]=new T;break;case n.KHR_MESH_QUANTIZATION:d[y]=new E;break;default:S.indexOf(y)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+y+'".')}}new X(m,d,{path:path||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(e,t)}}});var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function o(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=e}function c(e){this.name=n.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[n.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function l(){this.name=n.KHR_MATERIALS_UNLIT}c.prototype.loadLight=function(e){var t,n=this.lightDefs[e],o=new r.Color(16777215);void 0!==n.color&&o.fromArray(n.color);var c=void 0!==n.range?n.range:0;switch(n.type){case"directional":(t=new r.DirectionalLight(o)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new r.PointLight(o)).distance=c;break;case"spot":(t=new r.SpotLight(o)).distance=c,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,t.angle=n.spot.outerConeAngle,t.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==n.intensity&&(t.intensity=n.intensity),t.name=n.name||"light_"+e,Promise.resolve(t)},l.prototype.getMaterialType=function(){return r.MeshBasicMaterial},l.prototype.extendParams=function(e,t,n){var o=[];e.color=new r.Color(1,1,1),e.opacity=1;var c=t.pbrMetallicRoughness;if(c){if(Array.isArray(c.baseColorFactor)){var l=c.baseColorFactor;e.color.fromArray(l),e.opacity=l[3]}void 0!==c.baseColorTexture&&o.push(n.assignTexture(e,"map",c.baseColorTexture))}return Promise.all(o)};var h="glTF",d=12,m={JSON:1313821514,BIN:5130562};function f(data){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(data,0,d);if(this.header={magic:r.LoaderUtils.decodeText(new Uint8Array(data.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==h)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var t=new DataView(data,d),o=0;o<t.byteLength;){var c=t.getUint32(o,!0);o+=4;var l=t.getUint32(o,!0);if(o+=4,l===m.JSON){var f=new Uint8Array(data,d+o,c);this.content=r.LoaderUtils.decodeText(f)}else if(l===m.BIN){var v=d+o;this.body=data.slice(v,v+c)}o+=c}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function v(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function T(){this.name=n.KHR_TEXTURE_TRANSFORM}function M(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return r.ShaderMaterial},extendParams:function(e,t,n){var o=t.extensions[this.name],c=r.ShaderLib.standard,l=r.UniformsUtils.clone(c.uniforms),h=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),d=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),m=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),f=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),v=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),T=c.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",h).replace("#include <metalnessmap_pars_fragment>",d).replace("#include <roughnessmap_fragment>",m).replace("#include <metalnessmap_fragment>",f).replace("#include <lights_physical_fragment>",v);delete l.roughness,delete l.metalness,delete l.roughnessMap,delete l.metalnessMap,l.specular={value:(new r.Color).setHex(1118481)},l.glossiness={value:.5},l.specularMap={value:null},l.glossinessMap={value:null},e.vertexShader=c.vertexShader,e.fragmentShader=T,e.uniforms=l,e.defines={STANDARD:""},e.color=new r.Color(1,1,1),e.opacity=1;var M=[];if(Array.isArray(o.diffuseFactor)){var E=o.diffuseFactor;e.color.fromArray(E),e.opacity=E[3]}if(void 0!==o.diffuseTexture&&M.push(n.assignTexture(e,"map",o.diffuseTexture)),e.emissive=new r.Color(0,0,0),e.glossiness=void 0!==o.glossinessFactor?o.glossinessFactor:1,e.specular=new r.Color(1,1,1),Array.isArray(o.specularFactor)&&e.specular.fromArray(o.specularFactor),void 0!==o.specularGlossinessTexture){var y=o.specularGlossinessTexture;M.push(n.assignTexture(e,"glossinessMap",y)),M.push(n.assignTexture(e,"specularMap",y))}return Promise.all(M)},createMaterial:function(e){var t=new r.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(source){var e=source.clone();e.isGLTFSpecularGlossinessMaterial=!0;for(var t=this.specularGlossinessParams,i=0,n=t.length;i<n;i++){var r=source[t[i]];e[t[i]]=r&&r.isColor?r.clone():r}return e},refreshUniforms:function(e,t,n,r,o){if(!0===o.isGLTFSpecularGlossinessMaterial){var c,l=o.uniforms,h=o.defines;l.opacity.value=o.opacity,l.diffuse.value.copy(o.color),l.emissive.value.copy(o.emissive).multiplyScalar(o.emissiveIntensity),l.map.value=o.map,l.specularMap.value=o.specularMap,l.alphaMap.value=o.alphaMap,l.lightMap.value=o.lightMap,l.lightMapIntensity.value=o.lightMapIntensity,l.aoMap.value=o.aoMap,l.aoMapIntensity.value=o.aoMapIntensity,o.map?c=o.map:o.specularMap?c=o.specularMap:o.displacementMap?c=o.displacementMap:o.normalMap?c=o.normalMap:o.bumpMap?c=o.bumpMap:o.glossinessMap?c=o.glossinessMap:o.alphaMap?c=o.alphaMap:o.emissiveMap&&(c=o.emissiveMap),void 0!==c&&(c.isWebGLRenderTarget&&(c=c.texture),!0===c.matrixAutoUpdate&&c.updateMatrix(),l.uvTransform.value.copy(c.matrix)),o.envMap&&(l.envMap.value=o.envMap,l.envMapIntensity.value=o.envMapIntensity,l.flipEnvMap.value=o.envMap.isCubeTexture?-1:1,l.reflectivity.value=o.reflectivity,l.refractionRatio.value=o.refractionRatio,l.maxMipLevel.value=e.properties.get(o.envMap).__maxMipLevel),l.specular.value.copy(o.specular),l.glossiness.value=o.glossiness,l.glossinessMap.value=o.glossinessMap,l.emissiveMap.value=o.emissiveMap,l.bumpMap.value=o.bumpMap,l.normalMap.value=o.normalMap,l.displacementMap.value=o.displacementMap,l.displacementScale.value=o.displacementScale,l.displacementBias.value=o.displacementBias,null!==l.glossinessMap.value&&void 0===h.USE_GLOSSINESSMAP&&(h.USE_GLOSSINESSMAP="",h.USE_ROUGHNESSMAP=""),null===l.glossinessMap.value&&void 0!==h.USE_GLOSSINESSMAP&&(delete h.USE_GLOSSINESSMAP,delete h.USE_ROUGHNESSMAP)}}}}function E(){this.name=n.KHR_MESH_QUANTIZATION}function y(e,t,n,o){r.Interpolant.call(this,e,t,n,o)}v.prototype.decodePrimitive=function(e,t){var n=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,c=e.extensions[this.name].attributes,l={},h={},d={};for(var m in c){var f=C[m]||m.toLowerCase();l[f]=c[m]}for(m in e.attributes){f=C[m]||m.toLowerCase();if(void 0!==c[m]){var v=n.accessors[e.attributes[m]],T=N[v.componentType];d[f]=T,h[f]=!0===v.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],o=h[n];void 0!==o&&(r.normalized=o)}t(e)}),l,d)}))}))},T.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},y.prototype=Object.create(r.Interpolant.prototype),y.prototype.constructor=y,y.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r*3+r,i=0;i!==r;i++)t[i]=n[o+i];return t},y.prototype.beforeStart_=y.prototype.copySampleValue_,y.prototype.afterEnd_=y.prototype.copySampleValue_,y.prototype.interpolate_=function(e,t,n,r){for(var o=this.resultBuffer,c=this.sampleValues,l=this.valueSize,h=2*l,d=3*l,td=r-t,p=(n-t)/td,m=p*p,f=m*p,v=e*d,T=v-d,M=-2*f+3*m,E=f-m,y=1-M,S=E-m+p,i=0;i!==l;i++){var L=c[T+i+l],R=c[T+i+h]*td,A=c[v+i+l],w=c[v+i]*td;o[i]=y*L+S*R+M*A+E*w}return o};var S,L=0,R=1,A=2,w=3,_=4,x=5,O=6,N={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},P={9728:r.NearestFilter,9729:r.LinearFilter,9984:r.NearestMipmapNearestFilter,9985:r.LinearMipmapNearestFilter,9986:r.NearestMipmapLinearFilter,9987:r.LinearMipmapLinearFilter},I={33071:r.ClampToEdgeWrapping,33648:r.MirroredRepeatWrapping,10497:r.RepeatWrapping},U={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},C={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},F={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},H={CUBICSPLINE:void 0,LINEAR:r.InterpolateLinear,STEP:r.InterpolateDiscrete},D="OPAQUE",k="MASK",G="BLEND",j={"image/png":r.RGBAFormat,"image/jpeg":r.RGBFormat};function B(e,path){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(path)&&/^\//.test(e)&&(path=path.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:path+e)}function V(e,object,t){for(var n in t.extensions)void 0===e[n]&&(object.userData.gltfExtensions=object.userData.gltfExtensions||{},object.userData.gltfExtensions[n]=t.extensions[n])}function K(object,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(object.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Y(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var i=0,n=t.weights.length;i<n;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){var r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(i=0,n=r.length;i<n;i++)e.morphTargetDictionary[r[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function z(e){for(var t="",n=Object.keys(e).sort(),i=0,r=n.length;i<r;i++)t+=n[i]+":"+e[n[i]]+";";return t}function X(e,n,o){this.json=e||{},this.extensions=n||{},this.options=o||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new r.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new r.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function Z(e,t,n){var o=t.attributes,c=[];function l(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(var h in o){var d=C[h]||h.toLowerCase();d in e.attributes||c.push(l(o[h],d))}if(void 0!==t.indices&&!e.index){var m=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));c.push(m)}return K(e,t),function(e,t,n){var o=t.attributes,c=new r.Box3;if(void 0!==o.POSITION){var l=(T=n.json.accessors[o.POSITION]).min,h=T.max;c.set(new r.Vector3(l[0],l[1],l[2]),new r.Vector3(h[0],h[1],h[2]));var d=t.targets;if(void 0!==d)for(var m=new r.Vector3,i=0,f=d.length;i<f;i++){var v=d[i];if(void 0!==v.POSITION){var T;l=(T=n.json.accessors[v.POSITION]).min,h=T.max;m.setX(Math.max(Math.abs(l[0]),Math.abs(h[0]))),m.setY(Math.max(Math.abs(l[1]),Math.abs(h[1]))),m.setZ(Math.max(Math.abs(l[2]),Math.abs(h[2]))),c.expandByVector(m)}}e.boundingBox=c;var M=new r.Sphere;c.getCenter(M.center),M.radius=c.min.distanceTo(c.max)/2,e.boundingSphere=M}}(e,t,n),Promise.all(c).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,o=!1,i=0,c=t.length;i<c;i++){if(void 0!==(d=t[i]).POSITION&&(r=!0),void 0!==d.NORMAL&&(o=!0),r&&o)break}if(!r&&!o)return Promise.resolve(e);var l=[],h=[];for(i=0,c=t.length;i<c;i++){var d=t[i];if(r){var m=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):e.attributes.position;l.push(m)}if(o){m=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):e.attributes.normal;h.push(m)}}return Promise.all([Promise.all(l),Promise.all(h)]).then((function(t){var n=t[0],c=t[1];return r&&(e.morphAttributes.position=n),o&&(e.morphAttributes.normal=c),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}return X.prototype.parse=function(e,t){var n=this,r=this.json,o=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var c={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};V(o,c,r),K(c,r),e(c)})).catch(t)},X.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r={},o={},c=0,l=t.length;c<l;c++)for(var h=t[c].joints,i=0,d=h.length;i<d;i++)e[h[i]].isBone=!0;for(var m=0,f=e.length;m<f;m++){var v=e[m];void 0!==v.mesh&&(void 0===r[v.mesh]&&(r[v.mesh]=o[v.mesh]=0),r[v.mesh]++,void 0!==v.skin&&(n[v.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=o},X.prototype.getDependency=function(e,t){var r=e+":"+t,o=this.cache.get(r);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this.loadMesh(t);break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this.loadBufferView(t);break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this.loadMaterial(t);break;case"texture":o=this.loadTexture(t);break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;case"light":o=this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,o)}return o},X.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,defs=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(defs.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t},X.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(e,n){r.load(B(t.uri,o.path),e,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},X.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))},X.prototype.loadAccessor=function(e){var t=this,n=this.json,o=this.json.accessors[e];if(void 0===o.bufferView&&void 0===o.sparse)return Promise.resolve(null);var c=[];return void 0!==o.bufferView?c.push(this.getDependency("bufferView",o.bufferView)):c.push(null),void 0!==o.sparse&&(c.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),c.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(c).then((function(e){var c,l,h=e[0],d=U[o.type],m=N[o.componentType],f=m.BYTES_PER_ELEMENT,v=f*d,T=o.byteOffset||0,M=void 0!==o.bufferView?n.bufferViews[o.bufferView].byteStride:void 0,E=!0===o.normalized;if(M&&M!==v){var y=Math.floor(T/M),S="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+y+":"+o.count,L=t.cache.get(S);L||(c=new m(h,y*M,o.count*M/f),L=new r.InterleavedBuffer(c,M/f),t.cache.add(S,L)),l=new r.InterleavedBufferAttribute(L,d,T%M/f,E)}else c=null===h?new m(o.count*d):new m(h,T,o.count*d),l=new r.BufferAttribute(c,d,E);if(void 0!==o.sparse){var R=U.SCALAR,A=N[o.sparse.indices.componentType],w=o.sparse.indices.byteOffset||0,_=o.sparse.values.byteOffset||0,x=new A(e[1],w,o.sparse.count*R),O=new m(e[2],_,o.sparse.count*d);null!==h&&(l=new r.BufferAttribute(l.array.slice(),l.itemSize,l.normalized));for(var i=0,P=x.length;i<P;i++){var I=x[i];if(l.setX(I,O[i*d]),d>=2&&l.setY(I,O[i*d+1]),d>=3&&l.setZ(I,O[i*d+2]),d>=4&&l.setW(I,O[i*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return l}))},X.prototype.loadTexture=function(e){var source,t=this,o=this.json,c=this.options,l=this.textureLoader,h=window.URL||window.webkitURL,d=o.textures[e],m=d.extensions||{},f=(source=m[n.MSFT_TEXTURE_DDS]?o.images[m[n.MSFT_TEXTURE_DDS].source]:o.images[d.source]).uri,v=!1;return void 0!==source.bufferView&&(f=t.getDependency("bufferView",source.bufferView).then((function(e){v=!0;var t=new Blob([e],{type:source.mimeType});return f=h.createObjectURL(t)}))),Promise.resolve(f).then((function(e){var r=c.manager.getHandler(e);return r||(r=m[n.MSFT_TEXTURE_DDS]?t.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:l),new Promise((function(t,n){r.load(B(e,c.path),t,void 0,n)}))})).then((function(e){!0===v&&h.revokeObjectURL(f),e.flipY=!1,void 0!==d.name&&(e.name=d.name),source.mimeType in j&&(e.format=j[source.mimeType]);var t=(o.samplers||{})[d.sampler]||{};return e.magFilter=P[t.magFilter]||r.LinearFilter,e.minFilter=P[t.minFilter]||r.LinearMipmapLinearFilter,e.wrapS=I[t.wrapS]||r.RepeatWrapping,e.wrapT=I[t.wrapT]||r.RepeatWrapping,e}))},X.prototype.assignTexture=function(e,t,o){var c=this;return this.getDependency("texture",o.index).then((function(l){if(!l.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":l.format=r.RGBFormat}if(c.extensions[n.KHR_TEXTURE_TRANSFORM]){var h=void 0!==o.extensions?o.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;h&&(l=c.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(l,h))}e[t]=l}))},X.prototype.assignFinalMaterial=function(e){var t=e.geometry,o=e.material,c=this.extensions,l=void 0!==t.attributes.tangent,h=void 0!==t.attributes.color,d=void 0===t.attributes.normal,m=!0===e.isSkinnedMesh,f=Object.keys(t.morphAttributes).length>0,v=f&&void 0!==t.morphAttributes.normal;if(e.isPoints){var T="PointsMaterial:"+o.uuid,M=this.cache.get(T);M||(M=new r.PointsMaterial,r.Material.prototype.copy.call(M,o),M.color.copy(o.color),M.map=o.map,M.sizeAttenuation=!1,this.cache.add(T,M)),o=M}else if(e.isLine){T="LineBasicMaterial:"+o.uuid;var E=this.cache.get(T);E||(E=new r.LineBasicMaterial,r.Material.prototype.copy.call(E,o),E.color.copy(o.color),this.cache.add(T,E)),o=E}if(l||h||d||m||f){T="ClonedMaterial:"+o.uuid+":";o.isGLTFSpecularGlossinessMaterial&&(T+="specular-glossiness:"),m&&(T+="skinning:"),l&&(T+="vertex-tangents:"),h&&(T+="vertex-colors:"),d&&(T+="flat-shading:"),f&&(T+="morph-targets:"),v&&(T+="morph-normals:");var y=this.cache.get(T);y||(y=o.isGLTFSpecularGlossinessMaterial?c[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(o):o.clone(),m&&(y.skinning=!0),l&&(y.vertexTangents=!0),h&&(y.vertexColors=r.VertexColors),d&&(y.flatShading=!0),f&&(y.morphTargets=!0),v&&(y.morphNormals=!0),this.cache.add(T,y)),o=y}o.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),t.setAttribute("uv2",new r.BufferAttribute(t.attributes.uv.array,2))),o.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=c[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=o},X.prototype.loadMaterial=function(e){var t,o=this.json,c=this.extensions,l=o.materials[e],h={},d=l.extensions||{},m=[];if(d[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var f=c[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=f.getMaterialType(),m.push(f.extendParams(h,l,this))}else if(d[n.KHR_MATERIALS_UNLIT]){var v=c[n.KHR_MATERIALS_UNLIT];t=v.getMaterialType(),m.push(v.extendParams(h,l,this))}else{t=r.MeshStandardMaterial;var T=l.pbrMetallicRoughness||{};if(h.color=new r.Color(1,1,1),h.opacity=1,Array.isArray(T.baseColorFactor)){var M=T.baseColorFactor;h.color.fromArray(M),h.opacity=M[3]}void 0!==T.baseColorTexture&&m.push(this.assignTexture(h,"map",T.baseColorTexture)),h.metalness=void 0!==T.metallicFactor?T.metallicFactor:1,h.roughness=void 0!==T.roughnessFactor?T.roughnessFactor:1,void 0!==T.metallicRoughnessTexture&&(m.push(this.assignTexture(h,"metalnessMap",T.metallicRoughnessTexture)),m.push(this.assignTexture(h,"roughnessMap",T.metallicRoughnessTexture)))}!0===l.doubleSided&&(h.side=r.DoubleSide);var E=l.alphaMode||D;return E===G?h.transparent=!0:(h.transparent=!1,E===k&&(h.alphaTest=void 0!==l.alphaCutoff?l.alphaCutoff:.5)),void 0!==l.normalTexture&&t!==r.MeshBasicMaterial&&(m.push(this.assignTexture(h,"normalMap",l.normalTexture)),h.normalScale=new r.Vector2(1,1),void 0!==l.normalTexture.scale&&h.normalScale.set(l.normalTexture.scale,l.normalTexture.scale)),void 0!==l.occlusionTexture&&t!==r.MeshBasicMaterial&&(m.push(this.assignTexture(h,"aoMap",l.occlusionTexture)),void 0!==l.occlusionTexture.strength&&(h.aoMapIntensity=l.occlusionTexture.strength)),void 0!==l.emissiveFactor&&t!==r.MeshBasicMaterial&&(h.emissive=(new r.Color).fromArray(l.emissiveFactor)),void 0!==l.emissiveTexture&&t!==r.MeshBasicMaterial&&m.push(this.assignTexture(h,"emissiveMap",l.emissiveTexture)),Promise.all(m).then((function(){var e;return e=t===r.ShaderMaterial?c[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(h):new t(h),void 0!==l.name&&(e.name=l.name),e.map&&(e.map.encoding=r.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=r.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=r.sRGBEncoding),K(e,l),l.extensions&&V(c,e,l),e}))},X.prototype.loadGeometries=function(e){var t=this,o=this.extensions,c=this.primitiveCache;function l(e){return o[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return Z(n,e,t)}))}for(var h,d,m=[],i=0,f=e.length;i<f;i++){var v,T=e[i],M=(d=void 0,(d=(h=T).extensions&&h.extensions[n.KHR_DRACO_MESH_COMPRESSION])?"draco:"+d.bufferView+":"+d.indices+":"+z(d.attributes):h.indices+":"+z(h.attributes)+":"+h.mode),E=c[M];if(E)m.push(E.promise);else v=T.extensions&&T.extensions[n.KHR_DRACO_MESH_COMPRESSION]?l(T):Z(new r.BufferGeometry,T,t),c[M]={primitive:T,promise:v},m.push(v)}return Promise.all(m)},X.prototype.loadMesh=function(e){for(var t=this,n=this.json.meshes[e],o=n.primitives,c=[],i=0,l=o.length;i<l;i++){var h=void 0===o[i].material?S=S||new r.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:r.FrontSide}):this.getDependency("material",o[i].material);c.push(h)}return Promise.all(c).then((function(c){return t.loadGeometries(o).then((function(l){for(var h=[],i=0,d=l.length;i<d;i++){var m,f=l[i],v=o[i],T=c[i];if(v.mode===_||v.mode===x||v.mode===O||void 0===v.mode)!0!==(m=!0===n.isSkinnedMesh?new r.SkinnedMesh(f,T):new r.Mesh(f,T)).isSkinnedMesh||m.geometry.attributes.skinWeight.normalized||m.normalizeSkinWeights(),v.mode===x?m.drawMode=r.TriangleStripDrawMode:v.mode===O&&(m.drawMode=r.TriangleFanDrawMode);else if(v.mode===R)m=new r.LineSegments(f,T);else if(v.mode===w)m=new r.Line(f,T);else if(v.mode===A)m=new r.LineLoop(f,T);else{if(v.mode!==L)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);m=new r.Points(f,T)}Object.keys(m.geometry.morphAttributes).length>0&&Y(m,n),m.name=n.name||"mesh_"+e,l.length>1&&(m.name+="_"+i),K(m,n),t.assignFinalMaterial(m),h.push(m)}if(1===h.length)return h[0];var M=new r.Group;for(i=0,d=h.length;i<d;i++)M.add(h[i]);return M}))}))},X.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],o=n[n.type];if(o)return"perspective"===n.type?t=new r.PerspectiveCamera(r.Math.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):"orthographic"===n.type&&(t=new r.OrthographicCamera(o.xmag/-2,o.xmag/2,o.ymag/2,o.ymag/-2,o.znear,o.zfar)),void 0!==n.name&&(t.name=n.name),K(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},X.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))},X.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],n=[],o=[],c=[],l=[],h=[],i=0,d=t.channels.length;i<d;i++){var m=t.channels[i],f=t.samplers[m.sampler],v=m.target,T=void 0!==v.node?v.node:v.id,input=void 0!==t.parameters?t.parameters[f.input]:f.input,output=void 0!==t.parameters?t.parameters[f.output]:f.output;n.push(this.getDependency("node",T)),o.push(this.getDependency("accessor",input)),c.push(this.getDependency("accessor",output)),l.push(f),h.push(v)}return Promise.all([Promise.all(n),Promise.all(o),Promise.all(c),Promise.all(l),Promise.all(h)]).then((function(n){for(var o=n[0],c=n[1],l=n[2],h=n[3],d=n[4],m=[],i=0,f=o.length;i<f;i++){var v=o[i],T=c[i],M=l[i],E=h[i],S=d[i];if(void 0!==v){var L;switch(v.updateMatrix(),v.matrixAutoUpdate=!0,F[S.path]){case F.weights:L=r.NumberKeyframeTrack;break;case F.rotation:L=r.QuaternionKeyframeTrack;break;case F.position:case F.scale:default:L=r.VectorKeyframeTrack}var R=v.name?v.name:v.uuid,A=void 0!==E.interpolation?H[E.interpolation]:r.InterpolateLinear,w=[];F[S.path]===F.weights?v.traverse((function(object){!0===object.isMesh&&object.morphTargetInfluences&&w.push(object.name?object.name:object.uuid)})):w.push(R);var _=M.array;if(M.normalized){var x;if(_.constructor===Int8Array)x=1/127;else if(_.constructor===Uint8Array)x=1/255;else if(_.constructor==Int16Array)x=1/32767;else{if(_.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");x=1/65535}for(var O=new Float32Array(_.length),N=0,P=_.length;N<P;N++)O[N]=_[N]*x;_=O}for(N=0,P=w.length;N<P;N++){var track=new L(w[N]+"."+F[S.path],T.array,_,A);"CUBICSPLINE"===E.interpolation&&(track.createInterpolant=function(e){return new y(this.times,this.values,this.getValueSize()/3,e)},track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),m.push(track)}}}var I=void 0!==t.name?t.name:"animation_"+e;return new r.AnimationClip(I,void 0,m)}))},X.prototype.loadNode=function(e){var t,o=this.json,c=this.extensions,l=this,h=o.meshReferences,d=o.meshUses,m=o.nodes[e];return(t=[],void 0!==m.mesh&&t.push(l.getDependency("mesh",m.mesh).then((function(e){var t;if(h[m.mesh]>1){var n=d[m.mesh]++;(t=e.clone()).name+="_instance_"+n,t.onBeforeRender=e.onBeforeRender;for(var i=0,r=t.children.length;i<r;i++)t.children[i].name+="_instance_"+n,t.children[i].onBeforeRender=e.children[i].onBeforeRender}else t=e;return void 0!==m.weights&&t.traverse((function(e){if(e.isMesh)for(var i=0,t=m.weights.length;i<t;i++)e.morphTargetInfluences[i]=m.weights[i]})),t}))),void 0!==m.camera&&t.push(l.getDependency("camera",m.camera)),m.extensions&&m.extensions[n.KHR_LIGHTS_PUNCTUAL]&&void 0!==m.extensions[n.KHR_LIGHTS_PUNCTUAL].light&&t.push(l.getDependency("light",m.extensions[n.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then((function(e){var t;if((t=!0===m.isBone?new r.Bone:e.length>1?new r.Group:1===e.length?e[0]:new r.Object3D)!==e[0])for(var i=0,n=e.length;i<n;i++)t.add(e[i]);if(void 0!==m.name&&(t.userData.name=m.name,t.name=r.PropertyBinding.sanitizeNodeName(m.name)),K(t,m),m.extensions&&V(c,t,m),void 0!==m.matrix){var o=new r.Matrix4;o.fromArray(m.matrix),t.applyMatrix(o)}else void 0!==m.translation&&t.position.fromArray(m.translation),void 0!==m.rotation&&t.quaternion.fromArray(m.rotation),void 0!==m.scale&&t.scale.fromArray(m.scale);return t}))},X.prototype.loadScene=function(){function e(t,n,o,c){var l=o.nodes[t];return c.getDependency("node",t).then((function(e){return void 0===l.skin?e:c.getDependency("skin",l.skin).then((function(e){for(var n=[],i=0,r=(t=e).joints.length;i<r;i++)n.push(c.getDependency("node",t.joints[i]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var o=[],c=[],l=0,h=n.length;l<h;l++){var d=n[l];if(d){o.push(d);var m=new r.Matrix4;void 0!==t.inverseBindMatrices&&m.fromArray(t.inverseBindMatrices.array,16*l),c.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}e.bind(new r.Skeleton(o,c),e.matrixWorld)}})),e}));var t})).then((function(t){n.add(t);var r=[];if(l.children)for(var h=l.children,i=0,d=h.length;i<d;i++){var m=h[i];r.push(e(m,t,o,c))}return Promise.all(r)}))}return function(t){var n=this.json,o=this.extensions,c=this.json.scenes[t],l=new r.Scene;void 0!==c.name&&(l.name=c.name),K(l,c),c.extensions&&V(o,l,c);for(var h=c.nodes||[],d=[],i=0,m=h.length;i<m;i++)d.push(e(h[i],l,n,this));return Promise.all(d).then((function(){return l}))}}(),e}()},182:function(e,t,n){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},210:function(e,t,n){var r=n(6),o=n(22),c=n(10),l=n(211),h="["+l+"]",d=RegExp("^"+h+h+"*"),m=RegExp(h+h+"*$"),f=function(e,t,n){var o={},h=c((function(){return!!l[e]()||"​"!="​"[e]()})),d=o[e]=h?t(v):l[e];n&&(o[n]=d),r(r.P+r.F*h,"String",o)},v=f.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(d,"")),2&t&&(e=e.replace(m,"")),e};e.exports=f},211:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);