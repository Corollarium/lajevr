(window.webpackJsonp=window.webpackJsonp||[]).push([[6,14],{194:function(e,t,n){"use strict";n.r(t);var r={data:function(){return{headerOverlay:!1,head:{title:"",description:""}}},watch:{headerOverlay:function(e,t){this.$root.$emit("headerOverlay",e)}},mounted:function(){this.$root.$emit("headerOverlay",this.headerOverlay)},head:function(){return{title:this.head.title,meta:[{hid:"description",name:"description",content:this.head.description}]}}},o=n(4),component=Object(o.a)(r,(function(){var e=this.$createElement;return(this._self._c||e)("div")}),[],!1,null,null,null);t.default=component.exports},222:function(e,t,n){"use strict";n(35),n(15),n(21),n(38),n(36),n(37);var r=n(96),o=n(97);n(27);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){h=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(h)throw o}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var h=function(){function e(t,n,o){Object(r.a)(this,e),this.id=t,this.position=n,this.velocity=o,this.force=new BABYLON.Vector3(0,0,0)}return Object(o.a)(e,[{key:"orientation",get:function(){return this.velocity.normalize()}}]),e}(),l=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(r.a)(this,e),this.cohesion=.3,this.separation=.4,this.alignment=1,this.separationMinDistance=3,this.maxSpeed=1,this.boundsMin=new BABYLON.Vector3(n.x-c,n.y-c,n.z-c),this.boundsMax=new BABYLON.Vector3(n.x+c,n.y+c,n.z+c),this.otherForces=[],this.boids=[],this.debug={show:!1,influences:[],arrows:[]},d||(d=new BABYLON.Vector3(.3,.1,.3));var l=d.length();this.center=n.clone(),this.avgVel=new BABYLON.Vector3(0,0,0);for(var i=0;i<t;i++){var f=this.center.add(new BABYLON.Vector3((Math.random()-.5)*o,(Math.random()-.5)*o,(Math.random()-.5)*o)),m=new BABYLON.Vector3(d.x+(Math.random()-.5)/10*l,d.y+(Math.random()-.5)/10*l,d.z+(Math.random()-.5)/10*l),v=new h(i,f,m);this.boids.push(v)}}return Object(o.a)(e,[{key:"update",value:function(e){var t=this;this._updateCenter();var n=this.maxSpeed*this.maxSpeed;this.boids.forEach((function(r){var o=t._forceCentreMass(r),c=t._forceSeparation(r),d=t._forceMatchVelocity(r),h=t._forceBoundaries(r),l=o.add(c).add(d).add(h);t.otherForces.forEach((function(e){l.add(e(t,r))})),r.force.copyFrom(l),r.velocity.addInPlace(l.scale(e)),r.velocity.lengthSquared()>n&&(r.velocity=r.velocity.normalize().scale(t.maxSpeed)),r.position.addInPlace(r.velocity.scale(e))})),this._updateDebug()}},{key:"_updateCenter",value:function(){if(this.boids.length){var e=new BABYLON.Vector3(0,0,0),t=new BABYLON.Vector3(0,0,0);this.boids.forEach((function(n){e.addInPlace(n.position),t.addInPlace(n.velocity)})),e.scaleInPlace(1/this.boids.length),t.scaleInPlace(1/this.boids.length),this.center=e,this.avgVel=t}}},{key:"_forceCentreMass",value:function(e){return this.center.subtract(e.position).scale(this.cohesion)}},{key:"_forceSeparation",value:function(e){var t=this,n=new BABYLON.Vector3(0,0,0);return this.boids.forEach((function(r){if(e.id!==r.id){var o=e.position.subtract(r.position),c=o.length();c<t.separationMinDistance&&n.addInPlace(o.scale(t.separationMinDistance-c))}})),n.scale(this.separation)}},{key:"_forceMatchVelocity",value:function(e){return this.avgVel.subtract(e.velocity).scale(this.alignment)}},{key:"_forceBoundaries",value:function(e){var t=new BABYLON.Vector3(0,0,0),n=.2;return e.position.x<.9*this.boundsMin.x?t.x=n:e.position.x>.9*this.boundsMax.x&&(t.x=-.2),e.position.y<.9*this.boundsMin.y?t.y=n:e.position.y>.9*this.boundsMax.y&&(t.y=-.2),e.position.z<.9*this.boundsMin.z?t.z=n:e.position.z>.9*this.boundsMax.z&&(t.z=-.2),t}},{key:"addForce",value:function(e){this.otherForces.push(e)}},{key:"showDebug",value:function(e){if(!this.debug.show){var t=new BABYLON.StandardMaterial("debug_center",e);t.diffuseColor=BABYLON.Color3.FromHexString("#FF0000"),this.debug.center=BABYLON.MeshBuilder.CreateSphere("center",{diameter:.1,segments:8});var n=new BABYLON.StandardMaterial("debug_bbox",e);n.diffuseColor=BABYLON.Color3.FromHexString("#00FF00"),n.wireframe=!0,this.debug.center.material=t,this.debug.bbox=BABYLON.Mesh.CreateBox("boids_bbox",1,e),this.debug.bbox.scaling.x=Math.abs(this.boundsMax.x-this.boundsMin.x),this.debug.bbox.scaling.y=Math.abs(this.boundsMax.y-this.boundsMin.y),this.debug.bbox.scaling.z=Math.abs(this.boundsMax.z-this.boundsMin.z),this.debug.bbox.position.x=Math.abs(this.boundsMax.x-this.boundsMin.x)/2,this.debug.bbox.position.y=Math.abs(this.boundsMax.y-this.boundsMin.y)/2,this.debug.bbox.position.z=Math.abs(this.boundsMax.z-this.boundsMin.z)/2,this.debug.bbox.material=n;var r=new BABYLON.StandardMaterial("debug_wireframe",e);r.diffuseColor=BABYLON.Color3.FromHexString("#FFFFFF"),r.wireframe=!0;var o,d=c(this.boids);try{for(d.s();!(o=d.n()).done;){var h=o.value;h.debug={},h.debug.force=BABYLON.MeshBuilder.CreateTube("boid_arrow_".concat(h.uniqueId),{path:[h.position.add(h.velocity),h.position.clone()],radius:.01,updatable:!0},e),h.debug.influence=BABYLON.MeshBuilder.CreateSphere("boid_influence_".concat(h.uniqueId),{diameter:1,segments:8}),h.debug.influence.scaling.setAll(this.separationMinDistance),h.debug.influence.material=r}}catch(e){d.e(e)}finally{d.f()}this.debug.show=!0}}},{key:"hideDebug",value:function(e){this.debug.show=!1,this.debug.center=void 0;var t,n=c(this.boids);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.debug&&(r.debug.force.dispose(),r.debug.influence.dispose(),r.debug={})}}catch(e){n.e(e)}finally{n.f()}}},{key:"_updateDebug",value:function(){if(this.debug.show){this.debug.center.position.copyFrom(this.center);var e,t=c(this.boids);try{for(t.s();!(e=t.n()).done;){var n=e.value,path=[n.position.add(n.force.scale(20)),n.position.clone()];n.debug.force=BABYLON.MeshBuilder.CreateTube(n.debug.force.name,{path:path,radius:.01,instance:n.debug.force}),n.debug.influence.position.copyFrom(n.position)}}catch(e){t.e(e)}finally{t.f()}}}},{key:"gui",value:function(e){var t=this,n=BABYLON.GUI,r=n.AdvancedDynamicTexture.CreateFullscreenUI("UI",void 0,void 0,e),o=new n.StackPanel;o.width="220px",o.horizontalAlignment=n.Control.HORIZONTAL_ALIGNMENT_RIGHT,o.verticalAlignment=n.Control.VERTICAL_ALIGNMENT_CENTER,r.addControl(o);var c=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},header=new n.TextBlock;header.text="".concat(e," ").concat(t[e]),header.height="30px",header.color="white",o.addControl(header);var d=new n.Slider;d.minimum=0,d.maximum=r,d.value=t[e],d.height="20px",d.width="200px";var h=function(e,header,t){return function(n){e[t]=n,header.text="".concat(t," ").concat(n),c.apply(e)}}(t,header,e);d.onValueChangedObservable.add(h),o.addControl(d)};c("cohesion",1.5),c("separation"),c("alignment"),c("separationMinDistance",50,(function(e){t.debug.center&&t.boids.forEach((function(e){e.debug.influence.scaling.setAll(t.separationMinDistance)}))}));var header=new n.TextBlock;header.text="show debug helpers",header.height="30px",header.color="white",o.addControl(header);var d=new n.Checkbox;d.width="20px",d.height="20px",d.isChecked=this.debug.show,d.color="green",d.onIsCheckedChangedObservable.add((function(n){n?t.showDebug(e):t.hideDebug(e)})),o.addControl(d)}}]),e}();t.a=l},240:function(e,t,n){var content=n(264);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(34).default)("aae3a836",content,!0,{sourceMap:!1})},263:function(e,t,n){"use strict";n(240)},264:function(e,t,n){var r=n(33)(!1);r.push([e.i,"#underwater[data-v-af663c14]{height:100vh;width:100%;position:relative}#underwater-3d[data-v-af663c14]{height:100vh;width:100vw}#underwater-debug[data-v-af663c14]{top:0;right:0;z-index:1000}#underwater-debug[data-v-af663c14],#underwater-hud[data-v-af663c14]{position:absolute;padding:10px;border-radius:10px;background:#000;color:#fff;text-align:right}#underwater-hud[data-v-af663c14]{bottom:0;left:0;width:160px;height:220px;z-index:10;font-family:monospace}#underwater-hud span[data-v-af663c14]{display:inline-block}#underwater-hud #underwater-hud-compass[data-v-af663c14],#underwater-hud #underwater-hud-time[data-v-af663c14]{margin-top:10px}#underwater-hud #underwater-hud-compass-value[data-v-af663c14],#underwater-hud #underwater-hud-depth-value[data-v-af663c14],#underwater-hud #underwater-hud-time-value[data-v-af663c14]{line-height:.9;font-size:42px;font-family:monospace}#underwater-hud #underwater-hud-depth-ascent[data-v-af663c14]{-ms-writing-mode:tb-rl;writing-mode:vertical-rl}#underwater-hud #underwater-hud-compass-name[data-v-af663c14],#underwater-hud #underwater-hud-depth-name[data-v-af663c14],#underwater-hud #underwater-hud-time-name[data-v-af663c14]{color:#4c70ff}#underwater-hud #underwater-hud-depth-unit[data-v-af663c14],#underwater-hud #underwater-hud-time-unit[data-v-af663c14]{vertical-align:top}#underwater-fullscreen[data-v-af663c14]{position:absolute;top:20px;left:0;padding:20px;margin:0;z-index:1;max-width:80%;line-height:1.2em;border-radius:10px;font-size:42px;background:#004;color:#fff;text-align:center}#underwater-settings[data-v-af663c14]{position:absolute;bottom:0;right:0;padding:10px;z-index:1000;color:#fff;text-align:right}#underwater-settings svg[data-v-af663c14]{cursor:pointer}",""]),e.exports=r},422:function(e,t,n){"use strict";n.r(t);var r=n(194),o=(n(35),n(21),n(38),n(96)),c=n(97),d=(n(36),n(15),n(37),n(27),n(216),n(195)),h=(n(206),n(222));function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,d=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){d=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(d)throw o}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var m=function(){function e(t){var n=this;Object(o.a)(this,e),this.base="",this.engine=null,this.scene=null,this.camera=null,this.assetsManager=null,this.sunLight=null;var r=document.getElementById("underwater-3d");document.onfullscreenchange=function(e){t.isFullscreen=!!document.fullscreenElement},this.base=t.base,this.bootScene(r),this.lights();var c=[],h=this.loadBoids(this.base+"models/","salema.glb",50,new d.Vector3(-12.12,-13.2,27.19),[{from:1,to:30,name:"swim"}]);c.push(h.promise),Promise.all(c).then((function(){console.log("all loaded")})),this.assetsManager.load(),this.camera.speed=.5,t.$route.query.debug&&this.debugUtils();new Date;this.engine.runRenderLoop((function(){new Date;var e=n.engine.getDeltaTime()/1e3;if(t.$route.query.debug){var r=document.getElementById("inspector-host");r&&(r.style.position="absolute")}h.update(e),n.scene.render()})),window.addEventListener("resize",this.resize.bind(this))}return Object(c.a)(e,[{key:"beforeDestroy",value:function(){window.removeEventListener("resize",this.resize.bind(this)),document.onfullscreenchange=null,this.engine.stopRenderLoop(),this.scene.dispose(),this.scene=null,this.engine=null}},{key:"bootScene",value:function(e){var t=this;function n(){this.loadingUIText="Mergulho na Laje de Santos"}n.prototype.displayLoadingUI=function(){alert(this.loadingUIText)},n.prototype.hideLoadingUI=function(){alert("Loaded!")},this.engine=new d.Engine(e,!0),this.engine.loadingUIText="Mergulho na Laje de Santos",this.scene=new d.Scene(this.engine),this.scene.clearColor=new d.Color3(0,0,0);var r=new d.Vector3(-15.51978616737642,1.3786253122458585,29.13296827068854);"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?this.camera=new d.VirtualJoysticksCamera("Camera",r,this.scene):this.camera=new d.UniversalCamera("Camera",r,this.scene),this.camera.applyGravity=!1,this.camera.speed=.05,this.camera.ellipsoid=new d.Vector3(.5,1,.5),this.camera.keysUp.push("w".charCodeAt(0)),this.camera.keysUp.push("W".charCodeAt(0)),this.scene.onKeyboardObservable.add((function(e){switch(e.type){case d.KeyboardEventTypes.KEYDOWN:console.log("KEY DOWN: ",e.event.key);break;case d.KeyboardEventTypes.KEYUP:console.log("KEY UP: ",e.event.keyCode)}})),this.camera.minZ=.1,this.camera.maxZ=700,this.camera.setTarget(new d.Vector3(-12.89001753167552,1.708562384403646,25.710433418293825)),this.camera.attachControl(e,!0),this.camera.inputs.attached.virtualJoystick&&this.camera.inputs.attached.virtualJoystick._rightjoystick.setJoystickSensibility(.01),this.assetsManager=new d.AssetsManager(this.scene),this.assetsManager.onTaskErrorObservable.add((function(e){console.error("task failed",e.name,e.errorObject.message,e.errorObject.exception)})),this.assetsManager.onTaskSuccessObservable.add((function(e){console.log("task successful",e.name)})),this.assetsManager.onProgress=function(e,n,r){t.engine.loadingUIText="We are loading the scene. "+e+" out of "+n+" items still need to be loaded."}}},{key:"debugUtils",value:function(){this.scene.debugLayer.show()}},{key:"instrumentation",value:function(){var e=new d.EngineInstrumentation(this.engine);e.captureGPUFrameTime=!0,e.captureShaderCompilationTime=!0;var i=0;this.scene.registerBeforeRender((function(){i%30==0&&console.log("current frame time (GPU): "+(1e-6*e.gpuFrameTimeCounter.current).toFixed(2)+"ms\naverage frame time (GPU): "+(1e-6*e.gpuFrameTimeCounter.average).toFixed(2)+"ms\ntotal shader compilation time: "+e.shaderCompilationTimeCounter.total.toFixed(2)+"ms\naverage shader compilation time: "+e.shaderCompilationTimeCounter.average.toFixed(2)+"ms\ncompiler shaders count: "+e.shaderCompilationTimeCounter.count),i++}))}},{key:"resize",value:function(){this.engine.resize()}},{key:"lights",value:function(){var e=new d.HemisphericLight("light1",new d.Vector3(0,1,0),this.scene);e.diffuse=d.Color3.FromHexString("#CCCCCC"),e.intensity=.4,this.sunLight=new d.DirectionalLight("DirectionalLight",new d.Vector3(-.5,-1,.6).normalize(),this.scene),this.sunLight.diffuse=d.Color3.FromHexString("#FFFFFF"),this.sunLight.intensity=.8}},{key:"_importMeshVAT",value:function(e,t,n,r){var o=this,c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],p=d.SceneLoader.ImportMeshAsync("",e,t,this.scene,void 0),h=null,f=null,m=null;p.then((function(e){var t,n=(m=e).meshes,v=c?o.getCausticMaterial():null,y=l(n);try{for(y.s();!(t=y.n()).done;){var w=t.value;w.material,w.alwaysSelectAsActiveMesh=!0}}catch(e){y.e(e)}finally{y.f()}return h=d.Mesh.CreateBox("tmp",1,o.scene),v&&(h.rttMaterial=v,o.renderTargetCaustic.renderList.push(h)),(f=new d.VertexAnimationBaker(o.scene,h)).bakeVertexData(r)})).then((function(e){var t=f.textureFromBakedVertexData(e);return new d.BakedVertexAnimationManager(o.scene).texture=t,{container:m,mainMesh:h}}))}},{key:"_importMeshVATThin",value:function(e,t,n,r,o){var c=this,h=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=new Float32Array(16*n),f=new Float32Array(4*n);this._importMeshVAT(e,t,r,o,h).then((function(e){for(var t=e.container,r=e.mainMesh,i=0;i<n;i++){var h=d.Matrix.Translation(c.random(-1,1),c.random(-1,1),c.random(-1,1));l.set(h.toArray(),16*i);var m=new d.Vector4(o[0].from,o[0].to,Math.floor(Math.random()*(o[0].from-o[0].to)),30);f.set(m.asArray(),4*i)}return r.thinInstanceSetBuffer("matrix",l,16),r.thinInstanceSetBuffer("bakedVertexAnimationSettingsInstanced",f,4),{container:t,mainMesh:r,bufferMatrices:l,animParameters:f}})).catch((function(e){console.error(e)}))}},{key:"loadBoids",value:function(e,t,n,r,o){var c=this,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:6,m=new d.Vector3(0,0,0),v=new h.a(n,m,1,30);v.boundsMin.y=-15,v.boundsMax.y=0,v.cohesion=.001,v.alignment=.03,v.separationMinDistance=.5,v.maxSpeed=1,v.showDebug(this.scene),v.addForce((function(e,t){return r.subtract(t.position).scale(-5000.4)}));var y=null,w=new Float32Array(16*n),x=new Float32Array(4*n),p=d.SceneLoader.ImportMeshAsync("",e,t,this.scene,void 0).then((function(e){var t=e.meshes,r=l?c.getCausticMaterial():null;y=t[1],r&&(y.rttMaterial=r,c.renderTargetCaustic.renderList.push(y));var h=new d.VertexAnimationBaker(c.scene,y);h.bakeVertexData(o).then((function(e){var t=h.textureFromBakedVertexData(e),r=new d.BakedVertexAnimationManager(c.scene);r.texture=t,y.bakedVertexAnimationManager=r;for(var i=0;i<n;i++){var l=new d.Vector4(o[0].from,o[0].to,Math.floor(Math.random()*(o[0].from-o[0].to)),30+(Math.random()-.5)*f);x.set(l.asArray(),4*i)}y.thinInstanceSetBuffer("bakedVertexAnimationSettingsInstanced",x,4)}))})).catch((function(e){console.error(e)}));return{models:[y],boidsManager:v,promise:p,update:function(e,t,n){var r=new d.Vector3(1,1,1),o=d.Matrix.Identity(),q=d.Quaternion.Identity();return function(t){if(y&&y.bakedVertexAnimationManager){y.bakedVertexAnimationManager.time+=t,e.update(t);for(var i=0;i<n;i++){var c=e.boids[i];q.x=c.velocity.x,q.y=c.velocity.y,q.z=c.velocity.z,q.w=Math.PI,q.normalize(),d.Matrix.ComposeToRef(r,q,c.position,o),o.copyToArray(w,16*i)}y.thinInstanceSetBuffer("matrix",w,16)}}}(v,0,n)}}},{key:"random",value:function(e,t){return Math.random()*(t-e)+e}},{key:"clamp",value:function(e,t,n){return Math.min(Math.max(e,t),n)}}]),e}(),v={props:{},data:function(){return{isFullscreen:!1}},computed:{base:function(){return this.$router.options.base}},mounted:function(){this.underwater=new m(this),window.underwater=this.underwater},methods:{fullscreen:function(){document.getElementById("underwater").requestFullscreen()}}},y=(n(263),n(4)),w={components:{Boids:Object(y.a)(v,(function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"underwater"}},[t("canvas",{attrs:{id:"underwater-3d","touch-action":"none"}})])}],!1,null,"af663c14",null).exports},extends:r.default,data:function(){return{}},mounted:function(){this.head.title=this.$gettext("Mergulho virtual"),this.head.description=this.$gettext("Boids")}},x=Object(y.a)(w,(function(){var e=this.$createElement,t=this._self._c||e;return t("article",[t("section",[t("Boids")],1)])}),[],!1,null,null,null);t.default=x.exports}}]);