/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{216:function(e,t,n){var o=n(2),r=n(68),l=n(54),_=n(7),h=n(12),c=n(8),d=n(225),f=(n(5).Reflect||{}).construct,m=c((function(){function e(){}return!(f((function(){}),[],e)instanceof e)})),v=!c((function(){f((function(){}))}));o(o.S+o.F*(m||v),"Reflect",{construct:function(e,t){l(e),_(t);var n=arguments.length<3?e:l(arguments[2]);if(v&&!m)return f(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var o=[null];return o.push.apply(o,t),new(d.apply(e,o))}var c=n.prototype,y=r(h(c)?c:Object.prototype),x=Function.apply.call(e,y,t);return h(x)?x:y}})},217:function(e,t,n){"use strict";function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}n.d(t,"a",(function(){return o}))},219:function(e,t,n){"use strict";function o(e,p){return o=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},o(e,p)}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}n.d(t,"a",(function(){return r}))},220:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(17);function r(e,t){return!t||"object"!==Object(o.a)(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}},222:function(e,t,n){"use strict";n(35),n(15),n(21),n(36),n(37),n(38);var o=n(96),r=n(97);n(27);function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){h=!0,r=e},f:function(){try{l||null==n.return||n.return()}finally{if(h)throw r}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var h=function(){function e(t,n,r){Object(o.a)(this,e),this.id=t,this.position=n,this.velocity=r,this.force=new BABYLON.Vector3(0,0,0)}return Object(r.a)(e,[{key:"orientation",get:function(){return this.velocity.normalize()}}]),e}(),c=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,_=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(o.a)(this,e),this.cohesion=.3,this.separation=.4,this.alignment=1,this.separationMinDistance=3,this.maxSpeed=1,this.boundsMin=new BABYLON.Vector3(n.x-l,n.y-l,n.z-l),this.boundsMax=new BABYLON.Vector3(n.x+l,n.y+l,n.z+l),this.otherForces=[],this.boids=[],this.debug={show:!1,influences:[],arrows:[]},_||(_=new BABYLON.Vector3(.3,.1,.3));var c=_.length();this.center=n.clone(),this.avgVel=new BABYLON.Vector3(0,0,0);for(var i=0;i<t;i++){var d=this.center.add(new BABYLON.Vector3((Math.random()-.5)*r,(Math.random()-.5)*r,(Math.random()-.5)*r)),f=new BABYLON.Vector3(_.x+(Math.random()-.5)/10*c,_.y+(Math.random()-.5)/10*c,_.z+(Math.random()-.5)/10*c),m=new h(i,d,f);this.boids.push(m)}}return Object(r.a)(e,[{key:"update",value:function(e){var t=this;this._updateCenter();var n=this.maxSpeed*this.maxSpeed;this.boids.forEach((function(o){var r=t._forceCentreMass(o),l=t._forceSeparation(o),_=t._forceMatchVelocity(o),h=t._forceBoundaries(o),c=r.add(l).add(_).add(h);t.otherForces.forEach((function(e){c.add(e(t,o))})),o.force.copyFrom(c),o.velocity.addInPlace(c.scale(e)),o.velocity.lengthSquared()>n&&(o.velocity=o.velocity.normalize().scale(t.maxSpeed)),o.position.addInPlace(o.velocity.scale(e))})),this._updateDebug()}},{key:"_updateCenter",value:function(){if(this.boids.length){var e=new BABYLON.Vector3(0,0,0),t=new BABYLON.Vector3(0,0,0);this.boids.forEach((function(n){e.addInPlace(n.position),t.addInPlace(n.velocity)})),e.scaleInPlace(1/this.boids.length),t.scaleInPlace(1/this.boids.length),this.center=e,this.avgVel=t}}},{key:"_forceCentreMass",value:function(e){return this.center.subtract(e.position).scale(this.cohesion)}},{key:"_forceSeparation",value:function(e){var t=this,n=new BABYLON.Vector3(0,0,0);return this.boids.forEach((function(o){if(e.id!==o.id){var r=e.position.subtract(o.position),l=r.length();l<t.separationMinDistance&&n.addInPlace(r.scale(t.separationMinDistance-l))}})),n.scale(this.separation)}},{key:"_forceMatchVelocity",value:function(e){return this.avgVel.subtract(e.velocity).scale(this.alignment)}},{key:"_forceBoundaries",value:function(e){var t=new BABYLON.Vector3(0,0,0),n=.2;return e.position.x<.9*this.boundsMin.x?t.x=n:e.position.x>.9*this.boundsMax.x&&(t.x=-.2),e.position.y<.9*this.boundsMin.y?t.y=n:e.position.y>.9*this.boundsMax.y&&(t.y=-.2),e.position.z<.9*this.boundsMin.z?t.z=n:e.position.z>.9*this.boundsMax.z&&(t.z=-.2),t}},{key:"addForce",value:function(e){this.otherForces.push(e)}},{key:"showDebug",value:function(e){if(!this.debug.show){var t=new BABYLON.StandardMaterial("debug_center",e);t.diffuseColor=BABYLON.Color3.FromHexString("#FF0000"),this.debug.center=BABYLON.MeshBuilder.CreateSphere("center",{diameter:.1,segments:8});var n=new BABYLON.StandardMaterial("debug_bbox",e);n.diffuseColor=BABYLON.Color3.FromHexString("#00FF00"),n.wireframe=!0,this.debug.center.material=t,this.debug.bbox=BABYLON.Mesh.CreateBox("boids_bbox",1,e),this.debug.bbox.scaling.x=Math.abs(this.boundsMax.x-this.boundsMin.x),this.debug.bbox.scaling.y=Math.abs(this.boundsMax.y-this.boundsMin.y),this.debug.bbox.scaling.z=Math.abs(this.boundsMax.z-this.boundsMin.z),this.debug.bbox.position.x=Math.abs(this.boundsMax.x-this.boundsMin.x)/2,this.debug.bbox.position.y=Math.abs(this.boundsMax.y-this.boundsMin.y)/2,this.debug.bbox.position.z=Math.abs(this.boundsMax.z-this.boundsMin.z)/2,this.debug.bbox.material=n;var o=new BABYLON.StandardMaterial("debug_wireframe",e);o.diffuseColor=BABYLON.Color3.FromHexString("#FFFFFF"),o.wireframe=!0;var r,_=l(this.boids);try{for(_.s();!(r=_.n()).done;){var h=r.value;h.debug={},h.debug.force=BABYLON.MeshBuilder.CreateTube("boid_arrow_".concat(h.uniqueId),{path:[h.position.add(h.velocity),h.position.clone()],radius:.01,updatable:!0},e),h.debug.influence=BABYLON.MeshBuilder.CreateSphere("boid_influence_".concat(h.uniqueId),{diameter:1,segments:8}),h.debug.influence.scaling.setAll(this.separationMinDistance),h.debug.influence.material=o}}catch(e){_.e(e)}finally{_.f()}this.debug.show=!0}}},{key:"hideDebug",value:function(e){this.debug.show=!1,this.debug.center=void 0;var t,n=l(this.boids);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.debug&&(o.debug.force.dispose(),o.debug.influence.dispose(),o.debug={})}}catch(e){n.e(e)}finally{n.f()}}},{key:"_updateDebug",value:function(){if(this.debug.show){this.debug.center.position.copyFrom(this.center);var e,t=l(this.boids);try{for(t.s();!(e=t.n()).done;){var n=e.value,path=[n.position.add(n.force.scale(20)),n.position.clone()];n.debug.force=BABYLON.MeshBuilder.CreateTube(n.debug.force.name,{path:path,radius:.01,instance:n.debug.force}),n.debug.influence.position.copyFrom(n.position)}}catch(e){t.e(e)}finally{t.f()}}}},{key:"gui",value:function(e){var t=this,n=BABYLON.GUI,o=n.AdvancedDynamicTexture.CreateFullscreenUI("UI",void 0,void 0,e),r=new n.StackPanel;r.width="220px",r.horizontalAlignment=n.Control.HORIZONTAL_ALIGNMENT_RIGHT,r.verticalAlignment=n.Control.VERTICAL_ALIGNMENT_CENTER,o.addControl(r);var l=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},header=new n.TextBlock;header.text="".concat(e," ").concat(t[e]),header.height="30px",header.color="white",r.addControl(header);var _=new n.Slider;_.minimum=0,_.maximum=o,_.value=t[e],_.height="20px",_.width="200px";var h=function(e,header,t){return function(n){e[t]=n,header.text="".concat(t," ").concat(n),l.apply(e)}}(t,header,e);_.onValueChangedObservable.add(h),r.addControl(_)};l("cohesion",1.5),l("separation"),l("alignment"),l("separationMinDistance",50,(function(e){t.debug.center&&t.boids.forEach((function(e){e.debug.influence.scaling.setAll(t.separationMinDistance)}))}));var header=new n.TextBlock;header.text="show debug helpers",header.height="30px",header.color="white",r.addControl(header);var _=new n.Checkbox;_.width="20px",_.height="20px",_.isChecked=this.debug.show,_.color="green",_.onIsCheckedChangedObservable.add((function(n){n?t.showDebug(e):t.hideDebug(e)})),r.addControl(_)}}]),e}();t.a=c},225:function(e,t,n){"use strict";var o=n(54),r=n(12),l=n(138),_=[].slice,h={},c=function(e,t,n){if(!(t in h)){for(var o=[],i=0;i<t;i++)o[i]="a["+i+"]";h[t]=Function("F,a","return new F("+o.join(",")+")")}return h[t](e,n)};e.exports=Function.bind||function(e){var t=o(this),n=_.call(arguments,1),h=function(){var o=n.concat(_.call(arguments));return this instanceof h?c(t,o.length,o):l(t,o,e)};return r(t.prototype)&&(h.prototype=t.prototype),h}},327:function(e,t,n){"use strict";function o(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{_(o.next(e))}catch(e){a(e)}}function l(e){try{_(o.throw(e))}catch(e){a(e)}}function _(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}_((o=o.apply(e,t||[])).next())}))}n.d(t,"a",(function(){return f}));const r=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","radeon r9 200","sgx 543","sgx543"],l=e=>e.toLowerCase().replace(/^angle ?\((.+)\)*$/,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,""),_="undefined"==typeof window,h=(()=>{if(_)return;const{userAgent:e,platform:t,maxTouchPoints:n}=window.navigator,o=/(iphone|ipod|ipad)/i.test(e),a="iPad"===t||"MacIntel"===t&&n>0&&!window.MSStream;return{isIpad:a,isMobile:/android/i.test(e)||o||a,isSafari12:/Version\/12.+Safari/.test(e)}})(),i=[],c=[],d=(e,t)=>{if(e===t)return 0;const n=e;e.length>t.length&&(e=t,t=n);let o=e.length,r=t.length;for(;o>0&&e.charCodeAt(~-o)===t.charCodeAt(~-r);)o--,r--;let a,l=0;for(;l<o&&e.charCodeAt(l)===t.charCodeAt(l);)l++;if(o-=l,r-=l,0===o)return r;let _,h,s=0,g=0,p=0;for(;g<o;)c[g]=e.charCodeAt(l+g),i[g]=++g;for(;p<r;)for(a=t.charCodeAt(l+p),_=p++,s=p,g=0;g<o;g++)h=a===c[g]?_:_+1,_=i[g],s=i[g]=_>s?h>s?s+1:h:h>_?_+1:h;return s},f=({mobileTiers:i=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:t={},glContext:n,failIfMajorPerformanceCaveat:s=!1,benchmarksURL:g="https://unpkg.com/detect-gpu@3.1.27/dist/benchmarks"}={})=>o(void 0,void 0,void 0,(function*(){const p={};if(_)return{tier:0,type:"SSR"};const{isIpad:u=!!(null==h?void 0:h.isIpad),isMobile:c=!!(null==h?void 0:h.isMobile),screenSize:f=window.screen,loadBenchmarks:m=(e=>o(void 0,void 0,void 0,(function*(){const t=yield fetch(`${g}/${e}`).then((e=>e.json()));return t.shift(),t})))}=t;let{renderer:v}=t;const y=(e,t,n,o,r)=>({device:r,fps:o,gpu:n,isMobile:c,tier:e,type:t});let x,P="";if(v)v=l(v),x=[v];else{const e=n||((e,t=!1)=>{const n={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:t,powerPreference:"high-performance",stencil:!1};e&&delete n.powerPreference;const o=window.document.createElement("canvas"),r=o.getContext("webgl",n)||o.getContext("experimental-webgl",n);return null!=r?r:void 0})(null==h?void 0:h.isSafari12,s);if(!e)return y(0,"WEBGL_UNSUPPORTED");const t=e.getExtension("WEBGL_debug_renderer_info");if(t&&(v=e.getParameter(t.UNMASKED_RENDERER_WEBGL)),!v)return y(1,"FALLBACK");P=v,v=l(v),x=((e,t,n)=>"apple gpu"===t?((e,t,n)=>{let o=[t];if(n){const t="\n      precision highp float;\n      attribute vec3 aPosition;\n      varying float vvv;\n      void main() {\n        vvv = 0.31622776601683794;\n        gl_Position = vec4(aPosition, 1.0);\n      }\n    ",n="\n      precision highp float;\n      varying float vvv;\n      void main() {\n        vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;\n        enc = fract(enc);\n        enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n        gl_FragColor = enc;\n      }\n    ",a=e.createShader(35633),i=e.createShader(35632),r=e.createProgram();if(i&&a&&r){e.shaderSource(a,t),e.shaderSource(i,n),e.compileShader(a),e.compileShader(i),e.attachShader(r,a),e.attachShader(r,i),e.linkProgram(r),e.detachShader(r,a),e.detachShader(r,i),e.deleteShader(a),e.deleteShader(i),e.useProgram(r);const l=e.createBuffer();e.bindBuffer(34962,l),e.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const _=e.getAttribLocation(r,"aPosition");e.vertexAttribPointer(_,3,5126,!1,0,0),e.enableVertexAttribArray(_),e.clearColor(1,1,1,1),e.clear(16384),e.viewport(0,0,1,1),e.drawArrays(4,0,3);const c=new Uint8Array(4);e.readPixels(0,0,1,1,6408,5121,c),e.deleteProgram(r),e.deleteBuffer(l),o={801621810:(null==h?void 0:h.isIpad)?["apple a12x gpu"]:["apple a11 gpu","apple a12 gpu","apple a13 gpu","apple a14 gpu"],8016218135:(null==h?void 0:h.isIpad)?["apple a9x gpu","apple a10 gpu","apple a10x gpu"]:["apple a9 gpu","apple a10 gpu"]}[c.join("")]||o}}return o})(e,t,n):[t])(e,v,c)}const b=(yield Promise.all(x.map((e=>o(void 0,void 0,void 0,(function*(){const t=(e=>{const t=c?["adreno","apple","mali-t","mali","nvidia","powervr"]:["intel","amd","radeon","nvidia","geforce"];for(const n of t)if(e.includes(n))return n})(e);if(!t)return;const n=`${c?"m":"d"}-${t}.json`,o=p[n]=p[n]||m(n);let r;try{r=yield o}catch(t){return}const a=(e=>{var t;const n=(e=e.replace(/\([^)]+\)/,"")).match(/\d+/)||e.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return null!==(t=null==n?void 0:n.join("").replace(/\W|amd/g,""))&&void 0!==t?t:""})(e),i="apple"===t;let l=r.filter((([,e])=>e===a));l.length||(l=r.filter((([t])=>t.includes(e))));const _=l.length;if(0===_)return;let h,[s,,,g]=_>1?l.map((t=>[t,d(e,t[0])])).sort((([,e],[,t])=>e-t))[0][0]:l[0],v=Number.MAX_VALUE;const{devicePixelRatio:y}=window,x=f.width*y*(f.height*y);i&&c&&(g=g.filter((([,,,e])=>{var t;return(null!==(t=null==e?void 0:e.indexOf(u?"ipad":"iphone"))&&void 0!==t?t:-1)>-1})));for(const e of g){const[t,n]=e,o=t*n,r=Math.abs(x-o);r<v&&(v=r,h=e)}if(!h)return;const[,,P,b]=h;return[v,P,s,b]})))))).filter((e=>!!e));if(!b.length){const e=r.find((e=>v.includes(e)));return e?y(0,"BLOCKLISTED",e):y(1,"FALLBACK",`${v} (${P})`)}const[,O,B,C]=b.sort((([e=Number.MAX_VALUE],[t=Number.MAX_VALUE])=>e-t))[0];if(-1===O)return y(0,"BLOCKLISTED",B,O,C);const T=c?i:e;let I=0;for(let e=0;e<T.length;e++)O>=T[e]&&(I=e);return y(I,"BENCHMARK",B,O,C)}))},328:function(e,t,n){(function(t){var o;"undefined"!=typeof self&&self,e.exports=(o=n(196),function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,i){e.exports=o},function(e,t,i){"use strict";i.r(t),i.d(t,"Button",(function(){return O})),i.d(t,"Checkbox",(function(){return C})),i.d(t,"ColorPicker",(function(){return R})),i.d(t,"Container",(function(){return m})),i.d(t,"Control",(function(){return g})),i.d(t,"Ellipse",(function(){return w})),i.d(t,"FocusableButton",(function(){return M})),i.d(t,"Grid",(function(){return S})),i.d(t,"Image",(function(){return P})),i.d(t,"InputText",(function(){return I})),i.d(t,"InputPassword",(function(){return E})),i.d(t,"Line",(function(){return D})),i.d(t,"MultiLine",(function(){return F})),i.d(t,"RadioButton",(function(){return N})),i.d(t,"StackPanel",(function(){return B})),i.d(t,"SelectorGroup",(function(){return z})),i.d(t,"CheckboxGroup",(function(){return Q})),i.d(t,"RadioGroup",(function(){return V})),i.d(t,"SliderGroup",(function(){return j})),i.d(t,"SelectionPanel",(function(){return H})),i.d(t,"ScrollViewer",(function(){return Y})),i.d(t,"TextWrapping",(function(){return v})),i.d(t,"TextBlock",(function(){return x})),i.d(t,"TextWrapper",(function(){return T})),i.d(t,"ToggleButton",(function(){return X})),i.d(t,"KeyPropertySet",(function(){return K})),i.d(t,"VirtualKeyboard",(function(){return Z})),i.d(t,"Rectangle",(function(){return y})),i.d(t,"DisplayGrid",(function(){return q})),i.d(t,"BaseSlider",(function(){return k})),i.d(t,"Slider",(function(){return A})),i.d(t,"ImageBasedSlider",(function(){return $})),i.d(t,"ScrollBar",(function(){return G})),i.d(t,"ImageScrollBar",(function(){return U})),i.d(t,"name",(function(){return J})),i.d(t,"AdvancedDynamicTexture",(function(){return te})),i.d(t,"AdvancedDynamicTextureInstrumentation",(function(){return ie})),i.d(t,"Vector2WithInfo",(function(){return p})),i.d(t,"Matrix2D",(function(){return b})),i.d(t,"Measure",(function(){return f})),i.d(t,"MultiLinePoint",(function(){return L})),i.d(t,"Style",(function(){return ee})),i.d(t,"ValueAndUnit",(function(){return _})),i.d(t,"XmlLoader",(function(){return ne})),i.d(t,"AbstractButton3D",(function(){return ae})),i.d(t,"Button3D",(function(){return se})),i.d(t,"Container3D",(function(){return le})),i.d(t,"Control3D",(function(){return rt})),i.d(t,"CylinderPanel",(function(){return he})),i.d(t,"HolographicButton",(function(){return fe})),i.d(t,"HolographicSlate",(function(){return Le})),i.d(t,"HandMenu",(function(){return Ne})),i.d(t,"MeshButton3D",(function(){return ke})),i.d(t,"NearMenu",(function(){return Ae})),i.d(t,"PlanePanel",(function(){return ze})),i.d(t,"ScatterPanel",(function(){return Qe})),i.d(t,"Slider3D",(function(){return Je})),i.d(t,"SpherePanel",(function(){return et})),i.d(t,"StackPanel3D",(function(){return tt})),i.d(t,"TouchButton3D",(function(){return ve})),i.d(t,"TouchMeshButton3D",(function(){return it})),i.d(t,"TouchHolographicButton",(function(){return ye})),i.d(t,"TouchHolographicMenu",(function(){return Fe})),i.d(t,"TouchToggleButton3D",(function(){return nt})),i.d(t,"VolumeBasedPanel",(function(){return _e})),i.d(t,"HolographicBackplate",(function(){return ot})),i.d(t,"FluentMaterialDefines",(function(){return ue})),i.d(t,"FluentMaterial",(function(){return de})),i.d(t,"FluentButtonMaterial",(function(){return me})),i.d(t,"FluentBackplateMaterial",(function(){return De})),i.d(t,"HandleMaterial",(function(){return Be})),i.d(t,"MRDLSliderBarMaterial",(function(){return We})),i.d(t,"MRDLSliderThumbMaterial",(function(){return Xe})),i.d(t,"MRDLBackplateMaterial",(function(){return $e})),i.d(t,"SlateGizmo",(function(){return Se})),i.d(t,"HandleState",(function(){return Oe})),i.d(t,"GizmoHandle",(function(){return Ce})),i.d(t,"SideHandle",(function(){return Te})),i.d(t,"CornerHandle",(function(){return Ie})),i.d(t,"GUI3DManager",(function(){return at})),i.d(t,"Vector3WithInfo",(function(){return oe}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function r(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a}function a(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function s(e,t){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}Object.create,Object.create;var l=i(0),_=function(){function e(t,i,n){void 0===i&&(i=e.UNITMODE_PIXEL),void 0===n&&(n=!0),this.negativeValueAllowed=n,this._value=1,this._unit=e.UNITMODE_PIXEL,this.ignoreAdaptiveScaling=!1,this.onChangedObservable=new l.Observable,this._value=t,this._unit=i,this._originalUnit=i}return Object.defineProperty(e.prototype,"isPercentage",{get:function(){return this._unit===e.UNITMODE_PERCENTAGE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPixel",{get:function(){return this._unit===e.UNITMODE_PIXEL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalValue",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){e!==this._value&&(this._value=e,this.onChangedObservable.notifyObservers())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unit",{get:function(){return this._unit},set:function(e){e!==this._unit&&(this._unit=e,this.onChangedObservable.notifyObservers())},enumerable:!1,configurable:!0}),e.prototype.getValueInPixel=function(e,t){return this.isPixel?this.getValue(e):this.getValue(e)*t},e.prototype.updateInPlace=function(t,i){return void 0===i&&(i=e.UNITMODE_PIXEL),this.value===t&&this.unit===i||(this._value=t,this._unit=i,this.onChangedObservable.notifyObservers()),this},e.prototype.getValue=function(t){if(t&&!this.ignoreAdaptiveScaling&&this.unit!==e.UNITMODE_PERCENTAGE){var i=0,n=0;if(t.idealWidth&&(i=this._value*t.getSize().width/t.idealWidth),t.idealHeight&&(n=this._value*t.getSize().height/t.idealHeight),t.useSmallestIdeal&&t.idealWidth&&t.idealHeight)return window.innerWidth<window.innerHeight?i:n;if(t.idealWidth)return i;if(t.idealHeight)return n}return this._value},e.prototype.toString=function(t,i){switch(this._unit){case e.UNITMODE_PERCENTAGE:var n=100*this.getValue(t);return(i?n.toFixed(i):n)+"%";case e.UNITMODE_PIXEL:var o=this.getValue(t);return(i?o.toFixed(i):o)+"px"}return this._unit.toString()},e.prototype.fromString=function(t){var i=e._Regex.exec(t.toString());if(!i||0===i.length)return!1;var n=parseFloat(i[1]),o=this._originalUnit;if(this.negativeValueAllowed||n<0&&(n=0),4===i.length)switch(i[3]){case"px":o=e.UNITMODE_PIXEL;break;case"%":o=e.UNITMODE_PERCENTAGE,n/=100}return(n!==this._value||o!==this._unit)&&(this._value=n,this._unit=o,this.onChangedObservable.notifyObservers(),!0)},Object.defineProperty(e,"UNITMODE_PERCENTAGE",{get:function(){return e._UNITMODE_PERCENTAGE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UNITMODE_PIXEL",{get:function(){return e._UNITMODE_PIXEL},enumerable:!1,configurable:!0}),e._Regex=/(^-?\d*(\.\d+)?)(%|px)?/,e._UNITMODE_PERCENTAGE=0,e._UNITMODE_PIXEL=1,e}(),h=[new l.Vector2(0,0),new l.Vector2(0,0),new l.Vector2(0,0),new l.Vector2(0,0)],c=[new l.Vector2(0,0),new l.Vector2(0,0),new l.Vector2(0,0),new l.Vector2(0,0)],u=new l.Vector2(0,0),d=new l.Vector2(0,0),f=function(){function e(e,t,i,n){this.left=e,this.top=t,this.width=i,this.height=n}return e.prototype.copyFrom=function(e){this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height},e.prototype.copyFromFloats=function(e,t,i,n){this.left=e,this.top=t,this.width=i,this.height=n},e.CombineToRef=function(e,t,i){var n=Math.min(e.left,t.left),o=Math.min(e.top,t.top),r=Math.max(e.left+e.width,t.left+t.width),a=Math.max(e.top+e.height,t.top+t.height);i.left=n,i.top=o,i.width=r-n,i.height=a-o},e.prototype.addAndTransformToRef=function(e,t,i,n,o,r){var a=this.left+t,s=this.top+i,l=this.width+n,_=this.height+o;h[0].copyFromFloats(a,s),h[1].copyFromFloats(a+l,s),h[2].copyFromFloats(a+l,s+_),h[3].copyFromFloats(a,s+_),u.copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE),d.copyFromFloats(0,0);for(var f=0;f<4;f++)e.transformCoordinates(h[f].x,h[f].y,c[f]),u.x=Math.floor(Math.min(u.x,c[f].x)),u.y=Math.floor(Math.min(u.y,c[f].y)),d.x=Math.ceil(Math.max(d.x,c[f].x)),d.y=Math.ceil(Math.max(d.y,c[f].y));r.left=u.x,r.top=u.y,r.width=d.x-u.x,r.height=d.y-u.y},e.prototype.transformToRef=function(e,t){this.addAndTransformToRef(e,0,0,0,0,t)},e.prototype.isEqualsTo=function(e){return this.left===e.left&&this.top===e.top&&this.width===e.width&&this.height===e.height},e.Empty=function(){return new e(0,0,0,0)},e}(),p=function(e){function t(t,i){void 0===i&&(i=0);var n=e.call(this,t.x,t.y)||this;return n.buttonIndex=i,n}return o(t,e),t}(l.Vector2),b=function(){function e(e,t,i,n,o,r){this.m=new Float32Array(6),this.fromValues(e,t,i,n,o,r)}return e.prototype.fromValues=function(e,t,i,n,o,r){return this.m[0]=e,this.m[1]=t,this.m[2]=i,this.m[3]=n,this.m[4]=o,this.m[5]=r,this},e.prototype.determinant=function(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]},e.prototype.invertToRef=function(e){var t=this.m[0],i=this.m[1],n=this.m[2],o=this.m[3],r=this.m[4],a=this.m[5],s=this.determinant();if(s<l.Epsilon*l.Epsilon)return e.m[0]=0,e.m[1]=0,e.m[2]=0,e.m[3]=0,e.m[4]=0,e.m[5]=0,this;var _=1/s,h=n*a-o*r,c=i*r-t*a;return e.m[0]=o*_,e.m[1]=-i*_,e.m[2]=-n*_,e.m[3]=t*_,e.m[4]=h*_,e.m[5]=c*_,this},e.prototype.multiplyToRef=function(e,t){var i=this.m[0],n=this.m[1],o=this.m[2],r=this.m[3],a=this.m[4],s=this.m[5],l=e.m[0],_=e.m[1],h=e.m[2],c=e.m[3],u=e.m[4],d=e.m[5];return t.m[0]=i*l+n*h,t.m[1]=i*_+n*c,t.m[2]=o*l+r*h,t.m[3]=o*_+r*c,t.m[4]=a*l+s*h+u,t.m[5]=a*_+s*c+d,this},e.prototype.transformCoordinates=function(e,t,i){return i.x=e*this.m[0]+t*this.m[2]+this.m[4],i.y=e*this.m[1]+t*this.m[3]+this.m[5],this},e.Identity=function(){return new e(1,0,0,1,0,0)},e.IdentityToRef=function(e){e.m[0]=1,e.m[1]=0,e.m[2]=0,e.m[3]=1,e.m[4]=0,e.m[5]=0},e.TranslationToRef=function(e,t,i){i.fromValues(1,0,0,1,e,t)},e.ScalingToRef=function(e,t,i){i.fromValues(e,0,0,t,0,0)},e.RotationToRef=function(e,t){var i=Math.sin(e),n=Math.cos(e);t.fromValues(n,i,-i,n,0,0)},e.ComposeToRef=function(t,i,n,o,r,a,s){e.TranslationToRef(t,i,e._TempPreTranslationMatrix),e.ScalingToRef(o,r,e._TempScalingMatrix),e.RotationToRef(n,e._TempRotationMatrix),e.TranslationToRef(-t,-i,e._TempPostTranslationMatrix),e._TempPreTranslationMatrix.multiplyToRef(e._TempScalingMatrix,e._TempCompose0),e._TempCompose0.multiplyToRef(e._TempRotationMatrix,e._TempCompose1),a?(e._TempCompose1.multiplyToRef(e._TempPostTranslationMatrix,e._TempCompose2),e._TempCompose2.multiplyToRef(a,s)):e._TempCompose1.multiplyToRef(e._TempPostTranslationMatrix,s)},e._TempPreTranslationMatrix=e.Identity(),e._TempPostTranslationMatrix=e.Identity(),e._TempRotationMatrix=e.Identity(),e._TempScalingMatrix=e.Identity(),e._TempCompose0=e.Identity(),e._TempCompose1=e.Identity(),e._TempCompose2=e.Identity(),e}(),g=function(){function e(t){this.name=t,this._alpha=1,this._alphaSet=!1,this._zIndex=0,this._currentMeasure=f.Empty(),this._tempPaddingMeasure=f.Empty(),this._fontFamily="Arial",this._fontStyle="",this._fontWeight="",this._fontSize=new _(18,_.UNITMODE_PIXEL,!1),this._width=new _(1,_.UNITMODE_PERCENTAGE,!1),this._height=new _(1,_.UNITMODE_PERCENTAGE,!1),this._color="",this._style=null,this._horizontalAlignment=e.HORIZONTAL_ALIGNMENT_CENTER,this._verticalAlignment=e.VERTICAL_ALIGNMENT_CENTER,this._isDirty=!0,this._wasDirty=!1,this._tempParentMeasure=f.Empty(),this._prevCurrentMeasureTransformedIntoGlobalSpace=f.Empty(),this._cachedParentMeasure=f.Empty(),this._descendantsOnlyPadding=!1,this._paddingLeft=new _(0),this._paddingRight=new _(0),this._paddingTop=new _(0),this._paddingBottom=new _(0),this._left=new _(0),this._top=new _(0),this._scaleX=1,this._scaleY=1,this._rotation=0,this._transformCenterX=.5,this._transformCenterY=.5,this._transformMatrix=b.Identity(),this._invertTransformMatrix=b.Identity(),this._transformedPosition=l.Vector2.Zero(),this._isMatrixDirty=!0,this._isVisible=!0,this._isHighlighted=!1,this._highlightColor="#4affff",this._highlightLineWidth=2,this._fontSet=!1,this._dummyVector2=l.Vector2.Zero(),this._downCount=0,this._enterCount=-1,this._doNotRender=!1,this._downPointerIds={},this._evaluatedMeasure=new f(0,0,0,0),this._evaluatedParentMeasure=new f(0,0,0,0),this._isEnabled=!0,this._disabledColor="#9a9a9a",this._disabledColorItem="#6a6a6a",this._isReadOnly=!1,this._rebuildLayout=!1,this._customData={},this._isClipped=!1,this._automaticSize=!1,this.metadata=null,this.isHitTestVisible=!0,this.isPointerBlocker=!1,this.isFocusInvisible=!1,this.clipChildren=!0,this.clipContent=!0,this.useBitmapCache=!1,this._shadowOffsetX=0,this._shadowOffsetY=0,this._shadowBlur=0,this._previousShadowBlur=0,this._shadowColor="black",this.hoverCursor="",this._linkOffsetX=new _(0),this._linkOffsetY=new _(0),this.onWheelObservable=new l.Observable,this.onPointerMoveObservable=new l.Observable,this.onPointerOutObservable=new l.Observable,this.onPointerDownObservable=new l.Observable,this.onPointerUpObservable=new l.Observable,this.onPointerClickObservable=new l.Observable,this.onPointerEnterObservable=new l.Observable,this.onDirtyObservable=new l.Observable,this.onBeforeDrawObservable=new l.Observable,this.onAfterDrawObservable=new l.Observable,this.onDisposeObservable=new l.Observable,this.fixedRatio=0,this._fixedRatioMasterIsWidth=!0,this._tmpMeasureA=new f(0,0,0,0)}return Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return this._isReadOnly},set:function(e){this._isReadOnly=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformedMeasure",{get:function(){return this._evaluatedMeasure},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowOffsetX",{get:function(){return this._shadowOffsetX},set:function(e){this._shadowOffsetX!==e&&(this._shadowOffsetX=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowOffsetY",{get:function(){return this._shadowOffsetY},set:function(e){this._shadowOffsetY!==e&&(this._shadowOffsetY=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowBlur",{get:function(){return this._shadowBlur},set:function(e){this._shadowBlur!==e&&(this._previousShadowBlur=this._shadowBlur,this._shadowBlur=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{get:function(){return this._shadowColor},set:function(e){this._shadowColor!==e&&(this._shadowColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return this._getTypeName()},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontOffset",{get:function(){return this._fontOffset},set:function(e){this._fontOffset=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha!==e&&(this._alphaSet=!0,this._alpha=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"highlightLineWidth",{get:function(){return this._highlightLineWidth},set:function(e){this._highlightLineWidth!==e&&(this._highlightLineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighlighted",{get:function(){return this._isHighlighted},set:function(e){this._isHighlighted!==e&&(this._isHighlighted=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this._highlightColor},set:function(e){this._highlightColor!==e&&(this._highlightColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},set:function(e){this._scaleX!==e&&(this._scaleX=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},set:function(e){this._scaleY!==e&&(this._scaleY=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformCenterY",{get:function(){return this._transformCenterY},set:function(e){this._transformCenterY!==e&&(this._transformCenterY=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformCenterX",{get:function(){return this._transformCenterX},set:function(e){this._transformCenterX!==e&&(this._transformCenterX=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalAlignment",{get:function(){return this._horizontalAlignment},set:function(e){this._horizontalAlignment!==e&&(this._horizontalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this._verticalAlignment},set:function(e){this._verticalAlignment!==e&&(this._verticalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._fixedRatioMasterIsWidth=!0,this._width.toString(this._host)!==e&&this._width.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"widthInPixels",{get:function(){return this._width.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this._fixedRatioMasterIsWidth=!0,this.width=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(e){this._fixedRatioMasterIsWidth=!1,this._height.toString(this._host)!==e&&this._height.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heightInPixels",{get:function(){return this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this._fixedRatioMasterIsWidth=!1,this.height=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this._fontFamily!==e&&(this._fontFamily=e,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(e){var t=this;this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this._style=e,this._style&&(this._styleObserver=this._style.onChangedObservable.add((function(){t._markAsDirty(),t._resetFontCache()}))),this._markAsDirty(),this._resetFontCache()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_isFontSizeInPercentage",{get:function(){return this._fontSize.isPercentage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizeInPixels",{get:function(){var e=this._style?this._style._fontSize:this._fontSize;return e.isPixel?e.getValue(this._host):e.getValueInPixel(this._host,this._tempParentMeasure.height||this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.fontSize=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(e){this._fontSize.toString(this._host)!==e&&this._fontSize.fromString(e)&&(this._markAsDirty(),this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(e){this._color!==e&&(this._color=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this.zIndex!==e&&(this._zIndex=e,this.parent&&this.parent._reOrderControl(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"notRenderable",{get:function(){return this._doNotRender},set:function(e){this._doNotRender!==e&&(this._doNotRender=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){this._isVisible!==e&&(this._isVisible=e,this._markAsDirty(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkedMesh",{get:function(){return this._linkedMesh},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"descendantsOnlyPadding",{get:function(){return this._descendantsOnlyPadding},set:function(e){this._descendantsOnlyPadding!==e&&(this._descendantsOnlyPadding=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this._paddingLeft.toString(this._host)},set:function(e){this._paddingLeft.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeftInPixels",{get:function(){return this._paddingLeft.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.paddingLeft=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_paddingLeftInPixels",{get:function(){return this._descendantsOnlyPadding?0:this.paddingLeftInPixels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this._paddingRight.toString(this._host)},set:function(e){this._paddingRight.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingRightInPixels",{get:function(){return this._paddingRight.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.paddingRight=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_paddingRightInPixels",{get:function(){return this._descendantsOnlyPadding?0:this.paddingRightInPixels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this._paddingTop.toString(this._host)},set:function(e){this._paddingTop.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingTopInPixels",{get:function(){return this._paddingTop.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.paddingTop=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_paddingTopInPixels",{get:function(){return this._descendantsOnlyPadding?0:this.paddingTopInPixels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this._paddingBottom.toString(this._host)},set:function(e){this._paddingBottom.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottomInPixels",{get:function(){return this._paddingBottom.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.paddingBottom=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_paddingBottomInPixels",{get:function(){return this._descendantsOnlyPadding?0:this.paddingBottomInPixels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this._left.toString(this._host)},set:function(e){this._left.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftInPixels",{get:function(){return this._left.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.left=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._top.toString(this._host)},set:function(e){this._top.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topInPixels",{get:function(){return this._top.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.top=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetX",{get:function(){return this._linkOffsetX.toString(this._host)},set:function(e){this._linkOffsetX.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetXInPixels",{get:function(){return this._linkOffsetX.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.linkOffsetX=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetY",{get:function(){return this._linkOffsetY.toString(this._host)},set:function(e){this._linkOffsetY.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetYInPixels",{get:function(){return this._linkOffsetY.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.linkOffsetY=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerX",{get:function(){return this._currentMeasure.left+this._currentMeasure.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerY",{get:function(){return this._currentMeasure.top+this._currentMeasure.height/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabledColor",{get:function(){return this._disabledColor},set:function(e){this._disabledColor!==e&&(this._disabledColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabledColorItem",{get:function(){return this._disabledColorItem},set:function(e){this._disabledColorItem!==e&&(this._disabledColorItem=e,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Control"},e.prototype.getAscendantOfClass=function(e){return this.parent?this.parent.getClassName()===e?this.parent:this.parent.getAscendantOfClass(e):null},e.prototype._resetFontCache=function(){this._fontSet=!0,this._markAsDirty()},e.prototype.isAscendant=function(e){return!!this.parent&&(this.parent===e||this.parent.isAscendant(e))},e.prototype.getLocalCoordinates=function(e){var t=l.Vector2.Zero();return this.getLocalCoordinatesToRef(e,t),t},e.prototype.getLocalCoordinatesToRef=function(e,t){return t.x=e.x-this._currentMeasure.left,t.y=e.y-this._currentMeasure.top,this},e.prototype.getParentLocalCoordinates=function(e){var t=l.Vector2.Zero();return t.x=e.x-this._cachedParentMeasure.left,t.y=e.y-this._cachedParentMeasure.top,t},e.prototype.moveToVector3=function(t,i){if(this._host&&this.parent===this._host._rootContainer){this.horizontalAlignment=e.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=e.VERTICAL_ALIGNMENT_TOP;var n=this._host._getGlobalViewport(),o=l.Vector3.Project(t,l.Matrix.Identity(),i.getTransformMatrix(),n);this._moveToProjectedPosition(o),o.z<0||o.z>1?this.notRenderable=!0:this.notRenderable=!1}else l.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},e.prototype.getDescendantsToRef=function(e,t,i){void 0===t&&(t=!1)},e.prototype.getDescendants=function(e,t){var i=new Array;return this.getDescendantsToRef(i,e,t),i},e.prototype.linkWithMesh=function(t){if(!this._host||this.parent&&this.parent!==this._host._rootContainer)t&&l.Tools.Error("Cannot link a control to a mesh if the control is not at root level");else{var i=this._host._linkedControls.indexOf(this);if(-1!==i)return this._linkedMesh=t,void(t||this._host._linkedControls.splice(i,1));t&&(this.horizontalAlignment=e.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=e.VERTICAL_ALIGNMENT_TOP,this._linkedMesh=t,this._host._linkedControls.push(this))}},e.prototype.setPadding=function(e,t,i,n){var o=e,r=null!=t?t:o,a=null!=i?i:o,s=null!=n?n:r;this.paddingTop=o,this.paddingRight=r,this.paddingBottom=a,this.paddingLeft=s},e.prototype.setPaddingInPixels=function(e,t,i,n){var o=e,r=null!=t?t:o,a=null!=i?i:o,s=null!=n?n:r;this.paddingTopInPixels=o,this.paddingRightInPixels=r,this.paddingBottomInPixels=a,this.paddingLeftInPixels=s},e.prototype._moveToProjectedPosition=function(e){var t,i=this._left.getValue(this._host),n=this._top.getValue(this._host);if(0===this._currentMeasure.width&&0===this._currentMeasure.height){var o=null===(t=this.parent)||void 0===t?void 0:t._currentMeasure;o&&this._processMeasures(o,this._host.getContext())}var r=e.x+this._linkOffsetX.getValue(this._host)-this._currentMeasure.width/2,a=e.y+this._linkOffsetY.getValue(this._host)-this._currentMeasure.height/2;this._left.ignoreAdaptiveScaling&&this._top.ignoreAdaptiveScaling&&(Math.abs(r-i)<.5&&(r=i),Math.abs(a-n)<.5&&(a=n)),this.left=r+"px",this.top=a+"px",this._left.ignoreAdaptiveScaling=!0,this._top.ignoreAdaptiveScaling=!0,this._markAsDirty()},e.prototype._offsetLeft=function(e){this._isDirty=!0,this._currentMeasure.left+=e},e.prototype._offsetTop=function(e){this._isDirty=!0,this._currentMeasure.top+=e},e.prototype._markMatrixAsDirty=function(){this._isMatrixDirty=!0,this._flagDescendantsAsMatrixDirty()},e.prototype._flagDescendantsAsMatrixDirty=function(){},e.prototype._intersectsRect=function(e){return this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),!(this._tmpMeasureA.left>=e.left+e.width||this._tmpMeasureA.top>=e.top+e.height||this._tmpMeasureA.left+this._tmpMeasureA.width<=e.left||this._tmpMeasureA.top+this._tmpMeasureA.height<=e.top)},e.prototype._computeAdditionnalOffsetX=function(){return 0},e.prototype._computeAdditionnalOffsetY=function(){return 0},e.prototype.invalidateRect=function(){if(this._transform(),this.host&&this.host.useInvalidateRectOptimization){this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),f.CombineToRef(this._tmpMeasureA,this._prevCurrentMeasureTransformedIntoGlobalSpace,this._tmpMeasureA);var e=this.shadowOffsetX,t=this.shadowOffsetY,i=Math.max(this._previousShadowBlur,this.shadowBlur),n=Math.min(Math.min(e,0)-2*i,0),o=Math.max(Math.max(e,0)+2*i,0),r=Math.min(Math.min(t,0)-2*i,0),a=Math.max(Math.max(t,0)+2*i,0),s=this._computeAdditionnalOffsetX(),l=this._computeAdditionnalOffsetY();this.host.invalidateRect(Math.floor(this._tmpMeasureA.left+n-s),Math.floor(this._tmpMeasureA.top+r-l),Math.ceil(this._tmpMeasureA.left+this._tmpMeasureA.width+o+s),Math.ceil(this._tmpMeasureA.top+this._tmpMeasureA.height+a+l))}},e.prototype._markAsDirty=function(e){void 0===e&&(e=!1),(this._isVisible||e)&&(this._isDirty=!0,this._host&&this._host.markAsDirty())},e.prototype._markAllAsDirty=function(){this._markAsDirty(),this._font&&this._prepareFont()},e.prototype._link=function(e){this._host=e,this._host&&(this.uniqueId=this._host.getScene().getUniqueId())},e.prototype._transform=function(e){if(this._isMatrixDirty||1!==this._scaleX||1!==this._scaleY||0!==this._rotation){var t=this._currentMeasure.width*this._transformCenterX+this._currentMeasure.left,i=this._currentMeasure.height*this._transformCenterY+this._currentMeasure.top;e&&(e.translate(t,i),e.rotate(this._rotation),e.scale(this._scaleX,this._scaleY),e.translate(-t,-i)),(this._isMatrixDirty||this._cachedOffsetX!==t||this._cachedOffsetY!==i)&&(this._cachedOffsetX=t,this._cachedOffsetY=i,this._isMatrixDirty=!1,this._flagDescendantsAsMatrixDirty(),b.ComposeToRef(-t,-i,this._rotation,this._scaleX,this._scaleY,this.parent?this.parent._transformMatrix:null,this._transformMatrix),this._transformMatrix.invertToRef(this._invertTransformMatrix))}},e.prototype._renderHighlight=function(e){this.isHighlighted&&(e.save(),e.strokeStyle=this._highlightColor,e.lineWidth=this._highlightLineWidth,this._renderHighlightSpecific(e),e.restore())},e.prototype._renderHighlightSpecific=function(e){e.strokeRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)},e.prototype._applyStates=function(t){this._isFontSizeInPercentage&&(this._fontSet=!0),this._host&&this._host.useSmallestIdeal&&!this._font&&(this._fontSet=!0),this._fontSet&&(this._prepareFont(),this._fontSet=!1),this._font&&(t.font=this._font),this._color&&(t.fillStyle=this._color),e.AllowAlphaInheritance?t.globalAlpha*=this._alpha:this._alphaSet&&(t.globalAlpha=this.parent&&!this.parent.renderToIntermediateTexture?this.parent.alpha*this._alpha:this._alpha)},e.prototype._layout=function(e,t){if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;if(this._isDirty||!this._cachedParentMeasure.isEqualsTo(e)){this.host._numLayoutCalls++,this._currentMeasure.addAndTransformToRef(this._transformMatrix,0|-this._paddingLeftInPixels,0|-this._paddingTopInPixels,0|this._paddingRightInPixels,0|this._paddingBottomInPixels,this._prevCurrentMeasureTransformedIntoGlobalSpace),t.save(),this._applyStates(t);var i=0;do{this._rebuildLayout=!1,this._processMeasures(e,t),i++}while(this._rebuildLayout&&i<3);i>=3&&l.Logger.Error("Layout cycle detected in GUI (Control name="+this.name+", uniqueId="+this.uniqueId+")"),t.restore(),this.invalidateRect(),this._evaluateClippingState(e)}return this._wasDirty=this._isDirty,this._isDirty=!1,!0},e.prototype._processMeasures=function(e,t){this._tempPaddingMeasure.copyFrom(e),this.parent&&this.parent.descendantsOnlyPadding&&(this._tempPaddingMeasure.left+=this.parent.paddingLeftInPixels,this._tempPaddingMeasure.top+=this.parent.paddingTopInPixels,this._tempPaddingMeasure.width-=this.parent.paddingLeftInPixels+this.parent.paddingRightInPixels,this._tempPaddingMeasure.height-=this.parent.paddingTopInPixels+this.parent.paddingBottomInPixels),this._currentMeasure.copyFrom(this._tempPaddingMeasure),this._preMeasure(this._tempPaddingMeasure,t),this._measure(),this._computeAlignment(this._tempPaddingMeasure,t),this._currentMeasure.left=0|this._currentMeasure.left,this._currentMeasure.top=0|this._currentMeasure.top,this._currentMeasure.width=0|this._currentMeasure.width,this._currentMeasure.height=0|this._currentMeasure.height,this._additionalProcessing(this._tempPaddingMeasure,t),this._cachedParentMeasure.copyFrom(this._tempPaddingMeasure),this._currentMeasure.transformToRef(this._transformMatrix,this._evaluatedMeasure),this.onDirtyObservable.hasObservers()&&this.onDirtyObservable.notifyObservers(this)},e.prototype._evaluateClippingState=function(e){if(this.parent&&this.parent.clipChildren){if(e.transformToRef(this.parent._transformMatrix,this._evaluatedParentMeasure),this._evaluatedMeasure.left>this._evaluatedParentMeasure.left+this._evaluatedParentMeasure.width)return void(this._isClipped=!0);if(this._evaluatedMeasure.left+this._evaluatedMeasure.width<this._evaluatedParentMeasure.left)return void(this._isClipped=!0);if(this._evaluatedMeasure.top>this._evaluatedParentMeasure.top+this._evaluatedParentMeasure.height)return void(this._isClipped=!0);if(this._evaluatedMeasure.top+this._evaluatedMeasure.height<this._evaluatedParentMeasure.top)return void(this._isClipped=!0)}this._isClipped=!1},e.prototype._measure=function(){this._width.isPixel?this._currentMeasure.width=this._width.getValue(this._host):this._currentMeasure.width*=this._width.getValue(this._host),this._height.isPixel?this._currentMeasure.height=this._height.getValue(this._host):this._currentMeasure.height*=this._height.getValue(this._host),0!==this.fixedRatio&&(this._fixedRatioMasterIsWidth?this._currentMeasure.height=this._currentMeasure.width*this.fixedRatio:this._currentMeasure.width=this._currentMeasure.height*this.fixedRatio)},e.prototype._computeAlignment=function(t,i){var n=this._currentMeasure.width,o=this._currentMeasure.height,r=t.width,a=t.height,s=0,l=0;switch(this.horizontalAlignment){case e.HORIZONTAL_ALIGNMENT_LEFT:s=0;break;case e.HORIZONTAL_ALIGNMENT_RIGHT:s=r-n;break;case e.HORIZONTAL_ALIGNMENT_CENTER:s=(r-n)/2}switch(this.verticalAlignment){case e.VERTICAL_ALIGNMENT_TOP:l=0;break;case e.VERTICAL_ALIGNMENT_BOTTOM:l=a-o;break;case e.VERTICAL_ALIGNMENT_CENTER:l=(a-o)/2}this.descendantsOnlyPadding||(this._paddingLeft.isPixel?(this._currentMeasure.left+=this._paddingLeft.getValue(this._host),this._currentMeasure.width-=this._paddingLeft.getValue(this._host)):(this._currentMeasure.left+=r*this._paddingLeft.getValue(this._host),this._currentMeasure.width-=r*this._paddingLeft.getValue(this._host)),this._paddingRight.isPixel?this._currentMeasure.width-=this._paddingRight.getValue(this._host):this._currentMeasure.width-=r*this._paddingRight.getValue(this._host),this._paddingTop.isPixel?(this._currentMeasure.top+=this._paddingTop.getValue(this._host),this._currentMeasure.height-=this._paddingTop.getValue(this._host)):(this._currentMeasure.top+=a*this._paddingTop.getValue(this._host),this._currentMeasure.height-=a*this._paddingTop.getValue(this._host)),this._paddingBottom.isPixel?this._currentMeasure.height-=this._paddingBottom.getValue(this._host):this._currentMeasure.height-=a*this._paddingBottom.getValue(this._host)),this._left.isPixel?this._currentMeasure.left+=this._left.getValue(this._host):this._currentMeasure.left+=r*this._left.getValue(this._host),this._top.isPixel?this._currentMeasure.top+=this._top.getValue(this._host):this._currentMeasure.top+=a*this._top.getValue(this._host),this._currentMeasure.left+=s,this._currentMeasure.top+=l},e.prototype._preMeasure=function(e,t){},e.prototype._additionalProcessing=function(e,t){},e.prototype._clipForChildren=function(e){},e.prototype._clip=function(t,i){if(t.beginPath(),e._ClipMeasure.copyFrom(this._currentMeasure),i){i.transformToRef(this._invertTransformMatrix,this._tmpMeasureA);var n=new f(0,0,0,0);n.left=Math.max(this._tmpMeasureA.left,this._currentMeasure.left),n.top=Math.max(this._tmpMeasureA.top,this._currentMeasure.top),n.width=Math.min(this._tmpMeasureA.left+this._tmpMeasureA.width,this._currentMeasure.left+this._currentMeasure.width)-n.left,n.height=Math.min(this._tmpMeasureA.top+this._tmpMeasureA.height,this._currentMeasure.top+this._currentMeasure.height)-n.top,e._ClipMeasure.copyFrom(n)}if(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY){var o=this.shadowOffsetX,r=this.shadowOffsetY,a=this.shadowBlur,s=Math.min(Math.min(o,0)-2*a,0),l=Math.max(Math.max(o,0)+2*a,0),_=Math.min(Math.min(r,0)-2*a,0),h=Math.max(Math.max(r,0)+2*a,0);t.rect(e._ClipMeasure.left+s,e._ClipMeasure.top+_,e._ClipMeasure.width+l-s,e._ClipMeasure.height+h-_)}else t.rect(e._ClipMeasure.left,e._ClipMeasure.top,e._ClipMeasure.width,e._ClipMeasure.height);t.clip()},e.prototype._render=function(e,t){return!this.isVisible||this.notRenderable||this._isClipped?(this._isDirty=!1,!1):(this.host._numRenderCalls++,e.save(),this._applyStates(e),this._transform(e),this.clipContent&&this._clip(e,t),this.onBeforeDrawObservable.hasObservers()&&this.onBeforeDrawObservable.notifyObservers(this),this.useBitmapCache&&!this._wasDirty&&this._cacheData?e.putImageData(this._cacheData,this._currentMeasure.left,this._currentMeasure.top):this._draw(e,t),this.useBitmapCache&&this._wasDirty&&(this._cacheData=e.getImageData(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._renderHighlight(e),this.onAfterDrawObservable.hasObservers()&&this.onAfterDrawObservable.notifyObservers(this),e.restore(),!0)},e.prototype._draw=function(e,t){},e.prototype.contains=function(e,t){return this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y,!(e<this._currentMeasure.left||e>this._currentMeasure.left+this._currentMeasure.width||t<this._currentMeasure.top||t>this._currentMeasure.top+this._currentMeasure.height||(this.isPointerBlocker&&(this._host._shouldBlockPointer=!0),0))},e.prototype._processPicking=function(e,t,i,n,o,r,a,s){return!(!this._isEnabled||!this.isHitTestVisible||!this.isVisible||this._doNotRender||!this.contains(e,t)||(this._processObservables(n,e,t,i,o,r,a,s),0))},e.prototype._onPointerMove=function(e,t,i,n){this.onPointerMoveObservable.notifyObservers(t,-1,e,this,n)&&null!=this.parent&&this.parent._onPointerMove(e,t,i,n)},e.prototype._onPointerEnter=function(e,t){return!(!this._isEnabled||this._enterCount>0||(-1===this._enterCount&&(this._enterCount=0),this._enterCount++,this.onPointerEnterObservable.notifyObservers(this,-1,e,this,t)&&null!=this.parent&&this.parent._onPointerEnter(e,t),0))},e.prototype._onPointerOut=function(e,t,i){if(void 0===i&&(i=!1),i||this._isEnabled&&e!==this){this._enterCount=0;var n=!0;e.isAscendant(this)||(n=this.onPointerOutObservable.notifyObservers(this,-1,e,this,t)),n&&null!=this.parent&&this.parent._onPointerOut(e,t,i)}},e.prototype._onPointerDown=function(e,t,i,n,o){return this._onPointerEnter(this,o),0===this._downCount&&(this._downCount++,this._downPointerIds[i]=!0,this.onPointerDownObservable.notifyObservers(new p(t,n),-1,e,this,o)&&null!=this.parent&&this.parent._onPointerDown(e,t,i,n,o),!0)},e.prototype._onPointerUp=function(e,t,i,n,o,r){if(this._isEnabled){this._downCount=0,delete this._downPointerIds[i];var a=o;o&&(this._enterCount>0||-1===this._enterCount)&&(a=this.onPointerClickObservable.notifyObservers(new p(t,n),-1,e,this,r)),this.onPointerUpObservable.notifyObservers(new p(t,n),-1,e,this,r)&&null!=this.parent&&this.parent._onPointerUp(e,t,i,n,a,r)}},e.prototype._forcePointerUp=function(e){if(void 0===e&&(e=null),null!==e)this._onPointerUp(this,l.Vector2.Zero(),e,0,!0);else for(var t in this._downPointerIds)this._onPointerUp(this,l.Vector2.Zero(),+t,0,!0)},e.prototype._onWheelScroll=function(e,t){this._isEnabled&&this.onWheelObservable.notifyObservers(new l.Vector2(e,t))&&null!=this.parent&&this.parent._onWheelScroll(e,t)},e.prototype._onCanvasBlur=function(){},e.prototype._processObservables=function(e,t,i,n,o,r,a,s){if(!this._isEnabled)return!1;if(this._dummyVector2.copyFromFloats(t,i),e===l.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,this._dummyVector2,o,n);var _=this._host._lastControlOver[o];return _&&_!==this&&_._onPointerOut(this,n),_!==this&&this._onPointerEnter(this,n),this._host._lastControlOver[o]=this,!0}return e===l.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,this._dummyVector2,o,r,n),this._host._registerLastControlDown(this,o),this._host._lastPickedControl=this,!0):e===l.PointerEventTypes.POINTERUP?(this._host._lastControlDown[o]&&this._host._lastControlDown[o]._onPointerUp(this,this._dummyVector2,o,r,!0,n),delete this._host._lastControlDown[o],!0):!(e!==l.PointerEventTypes.POINTERWHEEL||!this._host._lastControlOver[o]||(this._host._lastControlOver[o]._onWheelScroll(a,s),0))},e.prototype._prepareFont=function(){(this._font||this._fontSet)&&(this._style?this._font=this._style.fontStyle+" "+this._style.fontWeight+" "+this.fontSizeInPixels+"px "+this._style.fontFamily:this._font=this._fontStyle+" "+this._fontWeight+" "+this.fontSizeInPixels+"px "+this._fontFamily,this._fontOffset=e._GetFontOffset(this._font),this.getDescendants().forEach((function(e){return e._markAllAsDirty()})))},e.prototype.serialize=function(e){l.SerializationHelper.Serialize(this,e),e.name=this.name,e.className=this.getClassName(),this._font&&(e.fontFamily=this._fontFamily,e.fontSize=this.fontSize,e.fontWeight=this.fontWeight,e.fontStyle=this.fontStyle)},e.prototype._parseFromContent=function(e,t){e.fontFamily&&(this.fontFamily=e.fontFamily),e.fontSize&&(this.fontSize=e.fontSize),e.fontWeight&&(this.fontWeight=e.fontWeight),e.fontStyle&&(this.fontStyle=e.fontStyle)},e.prototype.dispose=function(){this.onDirtyObservable.clear(),this.onBeforeDrawObservable.clear(),this.onAfterDrawObservable.clear(),this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this.onWheelObservable.clear(),this._styleObserver&&this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this.parent&&(this.parent.removeControl(this),this.parent=null),this._host&&this._host._linkedControls.indexOf(this)>-1&&this.linkWithMesh(null),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},Object.defineProperty(e,"HORIZONTAL_ALIGNMENT_LEFT",{get:function(){return e._HORIZONTAL_ALIGNMENT_LEFT},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HORIZONTAL_ALIGNMENT_RIGHT",{get:function(){return e._HORIZONTAL_ALIGNMENT_RIGHT},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HORIZONTAL_ALIGNMENT_CENTER",{get:function(){return e._HORIZONTAL_ALIGNMENT_CENTER},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VERTICAL_ALIGNMENT_TOP",{get:function(){return e._VERTICAL_ALIGNMENT_TOP},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VERTICAL_ALIGNMENT_BOTTOM",{get:function(){return e._VERTICAL_ALIGNMENT_BOTTOM},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VERTICAL_ALIGNMENT_CENTER",{get:function(){return e._VERTICAL_ALIGNMENT_CENTER},enumerable:!1,configurable:!0}),e._GetFontOffset=function(t){if(e._FontHeightSizes[t])return e._FontHeightSizes[t];var i=l.Engine.LastCreatedEngine;if(!i)throw new Error("Invalid engine. Unable to create a canvas.");var n=i.getFontOffset(t);return e._FontHeightSizes[t]=n,n},e.Parse=function(e,t){var i=l.Tools.Instantiate("BABYLON.GUI."+e.className),n=l.SerializationHelper.Parse((function(){return new i}),e,null);return n.name=e.name,n._parseFromContent(e,t),n},e.drawEllipse=function(e,t,i,n,o){o.translate(e,t),o.scale(i,n),o.beginPath(),o.arc(0,0,1,0,2*Math.PI),o.closePath(),o.scale(1/i,1/n),o.translate(-e,-t)},e.AllowAlphaInheritance=!1,e._ClipMeasure=new f(0,0,0,0),e._HORIZONTAL_ALIGNMENT_LEFT=0,e._HORIZONTAL_ALIGNMENT_RIGHT=1,e._HORIZONTAL_ALIGNMENT_CENTER=2,e._VERTICAL_ALIGNMENT_TOP=0,e._VERTICAL_ALIGNMENT_BOTTOM=1,e._VERTICAL_ALIGNMENT_CENTER=2,e._FontHeightSizes={},e.AddHeader=function(){},r([Object(l.serialize)()],e.prototype,"metadata",void 0),r([Object(l.serialize)()],e.prototype,"isHitTestVisible",void 0),r([Object(l.serialize)()],e.prototype,"isPointerBlocker",void 0),r([Object(l.serialize)()],e.prototype,"isFocusInvisible",void 0),r([Object(l.serialize)()],e.prototype,"clipChildren",void 0),r([Object(l.serialize)()],e.prototype,"clipContent",void 0),r([Object(l.serialize)()],e.prototype,"useBitmapCache",void 0),r([Object(l.serialize)()],e.prototype,"shadowOffsetX",null),r([Object(l.serialize)()],e.prototype,"shadowOffsetY",null),r([Object(l.serialize)()],e.prototype,"shadowBlur",null),r([Object(l.serialize)()],e.prototype,"shadowColor",null),r([Object(l.serialize)()],e.prototype,"hoverCursor",void 0),r([Object(l.serialize)()],e.prototype,"fontOffset",null),r([Object(l.serialize)()],e.prototype,"alpha",null),r([Object(l.serialize)()],e.prototype,"scaleX",null),r([Object(l.serialize)()],e.prototype,"scaleY",null),r([Object(l.serialize)()],e.prototype,"rotation",null),r([Object(l.serialize)()],e.prototype,"transformCenterY",null),r([Object(l.serialize)()],e.prototype,"transformCenterX",null),r([Object(l.serialize)()],e.prototype,"horizontalAlignment",null),r([Object(l.serialize)()],e.prototype,"verticalAlignment",null),r([Object(l.serialize)()],e.prototype,"fixedRatio",void 0),r([Object(l.serialize)()],e.prototype,"width",null),r([Object(l.serialize)()],e.prototype,"height",null),r([Object(l.serialize)()],e.prototype,"style",null),r([Object(l.serialize)()],e.prototype,"color",null),r([Object(l.serialize)()],e.prototype,"zIndex",null),r([Object(l.serialize)()],e.prototype,"notRenderable",null),r([Object(l.serialize)()],e.prototype,"isVisible",null),r([Object(l.serialize)()],e.prototype,"descendantsOnlyPadding",null),r([Object(l.serialize)()],e.prototype,"paddingLeft",null),r([Object(l.serialize)()],e.prototype,"paddingRight",null),r([Object(l.serialize)()],e.prototype,"paddingTop",null),r([Object(l.serialize)()],e.prototype,"paddingBottom",null),r([Object(l.serialize)()],e.prototype,"left",null),r([Object(l.serialize)()],e.prototype,"top",null),r([Object(l.serialize)()],e.prototype,"linkOffsetX",null),r([Object(l.serialize)()],e.prototype,"linkOffsetY",null),r([Object(l.serialize)()],e.prototype,"isEnabled",null),r([Object(l.serialize)()],e.prototype,"disabledColor",null),r([Object(l.serialize)()],e.prototype,"disabledColorItem",null),r([Object(l.serialize)()],e.prototype,"overlapGroup",void 0),r([Object(l.serialize)()],e.prototype,"overlapDeltaMultiplier",void 0),e}();Object(l.RegisterClass)("BABYLON.GUI.Control",g);var m=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._children=new Array,i._measureForChildren=f.Empty(),i._background="",i._adaptWidthToChildren=!1,i._adaptHeightToChildren=!1,i._renderToIntermediateTexture=!1,i._intermediateTexture=null,i.logLayoutCycleErrors=!1,i.maxLayoutCycle=3,i}return o(t,e),Object.defineProperty(t.prototype,"renderToIntermediateTexture",{get:function(){return this._renderToIntermediateTexture},set:function(e){this._renderToIntermediateTexture!==e&&(this._renderToIntermediateTexture=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adaptHeightToChildren",{get:function(){return this._adaptHeightToChildren},set:function(e){this._adaptHeightToChildren!==e&&(this._adaptHeightToChildren=e,e&&(this.height="100%"),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adaptWidthToChildren",{get:function(){return this._adaptWidthToChildren},set:function(e){this._adaptWidthToChildren!==e&&(this._adaptWidthToChildren=e,e&&(this.width="100%"),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._isReadOnly},set:function(e){this._isReadOnly=e;for(var t=0,i=this._children;t<i.length;t++)i[t].isReadOnly=e},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Container"},t.prototype._flagDescendantsAsMatrixDirty=function(){for(var e=0,t=this.children;e<t.length;e++)t[e]._markMatrixAsDirty()},t.prototype.getChildByName=function(e){for(var t=0,i=this.children;t<i.length;t++){var n=i[t];if(n.name===e)return n}return null},t.prototype.getChildByType=function(e,t){for(var i=0,n=this.children;i<n.length;i++){var o=n[i];if(o.typeName===t)return o}return null},t.prototype.containsControl=function(e){return-1!==this.children.indexOf(e)},t.prototype.addControl=function(e){return e?(-1!==this._children.indexOf(e)||(e._link(this._host),e._markAllAsDirty(),this._reOrderControl(e),this._markAsDirty()),this):this},t.prototype.clearControls=function(){for(var e=0,t=this.children.slice();e<t.length;e++){var i=t[e];this.removeControl(i)}return this},t.prototype.removeControl=function(e){var t=this._children.indexOf(e);return-1!==t&&(this._children.splice(t,1),e.parent=null),e.linkWithMesh(null),this._host&&this._host._cleanControlAfterRemoval(e),this._markAsDirty(),this},t.prototype._reOrderControl=function(e){this.removeControl(e);for(var t=!1,i=0;i<this._children.length;i++)if(this._children[i].zIndex>e.zIndex){this._children.splice(i,0,e),t=!0;break}t||this._children.push(e),e.parent=this,this._markAsDirty()},t.prototype._offsetLeft=function(t){e.prototype._offsetLeft.call(this,t);for(var i=0,n=this._children;i<n.length;i++)n[i]._offsetLeft(t)},t.prototype._offsetTop=function(t){e.prototype._offsetTop.call(this,t);for(var i=0,n=this._children;i<n.length;i++)n[i]._offsetTop(t)},t.prototype._markAllAsDirty=function(){e.prototype._markAllAsDirty.call(this);for(var t=0;t<this._children.length;t++)this._children[t]._markAllAsDirty()},t.prototype._localDraw=function(e){this._background&&(e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),e.fillStyle=this._background,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),e.restore())},t.prototype._link=function(t){e.prototype._link.call(this,t);for(var i=0,n=this._children;i<n.length;i++)n[i]._link(t)},t.prototype._beforeLayout=function(){},t.prototype._processMeasures=function(t,i){!this._isDirty&&this._cachedParentMeasure.isEqualsTo(t)||(e.prototype._processMeasures.call(this,t,i),this._evaluateClippingState(t),this._renderToIntermediateTexture&&(this._intermediateTexture&&this._host.getScene()!=this._intermediateTexture.getScene()&&(this._intermediateTexture.dispose(),this._intermediateTexture=null),this._intermediateTexture?this._intermediateTexture.scaleTo(this._currentMeasure.width,this._currentMeasure.height):(this._intermediateTexture=new l.DynamicTexture("",{width:this._currentMeasure.width,height:this._currentMeasure.height},this._host.getScene(),!1,l.Texture.NEAREST_SAMPLINGMODE,l.Constants.TEXTUREFORMAT_RGBA,!1),this._intermediateTexture.hasAlpha=!0)))},t.prototype._layout=function(e,t){var i,n;if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;this.host._numLayoutCalls++,this._isDirty&&this._currentMeasure.transformToRef(this._transformMatrix,this._prevCurrentMeasureTransformedIntoGlobalSpace);var o=0;t.save(),this._applyStates(t),this._beforeLayout();do{var r=-1,a=-1;if(this._rebuildLayout=!1,this._processMeasures(e,t),!this._isClipped){for(var s=0,_=this._children;s<_.length;s++){var h=_[s];h._tempParentMeasure.copyFrom(this._measureForChildren),h._layout(this._measureForChildren,t)&&(this.adaptWidthToChildren&&h._width.isPixel&&(r=Math.max(r,h._currentMeasure.width+h._paddingLeftInPixels+h._paddingRightInPixels)),this.adaptHeightToChildren&&h._height.isPixel&&(a=Math.max(a,h._currentMeasure.height+h._paddingTopInPixels+h._paddingBottomInPixels)))}this.adaptWidthToChildren&&r>=0&&(r+=this.paddingLeftInPixels+this.paddingRightInPixels,this.width!==r+"px"&&(null===(i=this.parent)||void 0===i||i._markAsDirty(),this.width=r+"px",this._rebuildLayout=!0)),this.adaptHeightToChildren&&a>=0&&(a+=this.paddingTopInPixels+this.paddingBottomInPixels,this.height!==a+"px"&&(null===(n=this.parent)||void 0===n||n._markAsDirty(),this.height=a+"px",this._rebuildLayout=!0)),this._postMeasure()}o++}while(this._rebuildLayout&&o<this.maxLayoutCycle);return o>=3&&this.logLayoutCycleErrors&&l.Logger.Error("Layout cycle detected in GUI (Container name="+this.name+", uniqueId="+this.uniqueId+")"),t.restore(),this._isDirty&&(this.invalidateRect(),this._isDirty=!1),!0},t.prototype._postMeasure=function(){},t.prototype._draw=function(e,t){var i=this._renderToIntermediateTexture&&this._intermediateTexture,n=i?this._intermediateTexture.getContext():e;i&&(n.save(),n.translate(-this._currentMeasure.left,-this._currentMeasure.top),t?n.clearRect(t.left,t.top,t.width,t.height):n.clearRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._localDraw(n),e.save(),this.clipChildren&&this._clipForChildren(n);for(var o=0,r=this._children;o<r.length;o++){var a=r[o];t&&!a._intersectsRect(t)||a._render(n,t)}i&&(n.restore(),e.save(),e.globalAlpha=this.alpha,e.drawImage(n.canvas,this._currentMeasure.left,this._currentMeasure.top),e.restore()),e.restore()},t.prototype.getDescendantsToRef=function(e,t,i){if(void 0===t&&(t=!1),this.children)for(var n=0;n<this.children.length;n++){var o=this.children[n];i&&!i(o)||e.push(o),t||o.getDescendantsToRef(e,!1,i)}},t.prototype._processPicking=function(t,i,n,o,r,a,s,l){if(!this._isEnabled||!this.isVisible||this.notRenderable)return!1;if(!e.prototype.contains.call(this,t,i))return!1;for(var _=this._children.length-1;_>=0;_--){var h=this._children[_];if(h._processPicking(t,i,n,o,r,a,s,l))return h.hoverCursor&&this._host._changeCursor(h.hoverCursor),!0}return!!this.isHitTestVisible&&this._processObservables(o,t,i,n,r,a,s,l)},t.prototype._additionalProcessing=function(t,i){e.prototype._additionalProcessing.call(this,t,i),this._measureForChildren.copyFrom(this._currentMeasure)},t.prototype.serialize=function(t){if(e.prototype.serialize.call(this,t),this.children.length){t.children=[];for(var i=0,n=this.children;i<n.length;i++){var o={};n[i].serialize(o),t.children.push(o)}}},t.prototype.dispose=function(){var t;e.prototype.dispose.call(this);for(var i=this.children.length-1;i>=0;i--)this.children[i].dispose();null===(t=this._intermediateTexture)||void 0===t||t.dispose()},t.prototype._parseFromContent=function(t,i){if(e.prototype._parseFromContent.call(this,t,i),this._link(i),t.children)for(var n=0,o=t.children;n<o.length;n++){var r=o[n];this.addControl(g.Parse(r,i))}},r([Object(l.serialize)()],t.prototype,"renderToIntermediateTexture",null),r([Object(l.serialize)()],t.prototype,"maxLayoutCycle",void 0),r([Object(l.serialize)()],t.prototype,"adaptHeightToChildren",null),r([Object(l.serialize)()],t.prototype,"adaptWidthToChildren",null),r([Object(l.serialize)()],t.prototype,"background",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.Container",m);var v,y=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._thickness=1,i._cornerRadius=0,i}return o(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cornerRadius",{get:function(){return this._cornerRadius},set:function(e){e<0&&(e=0),this._cornerRadius!==e&&(this._cornerRadius=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Rectangle"},t.prototype._computeAdditionnalOffsetX=function(){return this._cornerRadius?1:0},t.prototype._computeAdditionnalOffsetY=function(){return this._cornerRadius?1:0},t.prototype._localDraw=function(e){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._background&&(e.fillStyle="Button"===this.typeName?this.isEnabled?this._background:this.disabledColor:this._background,this._cornerRadius?(this._drawRoundedRect(e,this._thickness/2),e.fill()):e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._thickness&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this.color&&(e.strokeStyle=this.color),e.lineWidth=this._thickness,this._cornerRadius?(this._drawRoundedRect(e,this._thickness/2),e.stroke()):e.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness)),e.restore()},t.prototype._additionalProcessing=function(t,i){e.prototype._additionalProcessing.call(this,t,i),this._measureForChildren.width-=2*this._thickness,this._measureForChildren.height-=2*this._thickness,this._measureForChildren.left+=this._thickness,this._measureForChildren.top+=this._thickness},t.prototype._drawRoundedRect=function(e,t){void 0===t&&(t=0);var i=this._currentMeasure.left+t,n=this._currentMeasure.top+t,o=this._currentMeasure.width-2*t,r=this._currentMeasure.height-2*t,a=Math.min(r/2-2,Math.min(o/2-2,this._cornerRadius));e.beginPath(),e.moveTo(i+a,n),e.lineTo(i+o-a,n),e.quadraticCurveTo(i+o,n,i+o,n+a),e.lineTo(i+o,n+r-a),e.quadraticCurveTo(i+o,n+r,i+o-a,n+r),e.lineTo(i+a,n+r),e.quadraticCurveTo(i,n+r,i,n+r-a),e.lineTo(i,n+a),e.quadraticCurveTo(i,n,i+a,n),e.closePath()},t.prototype._clipForChildren=function(e){this._cornerRadius&&(this._drawRoundedRect(e,this._thickness),e.clip())},r([Object(l.serialize)()],t.prototype,"thickness",null),r([Object(l.serialize)()],t.prototype,"cornerRadius",null),t}(m);Object(l.RegisterClass)("BABYLON.GUI.Rectangle",y),function(e){e[e.Clip=0]="Clip",e[e.WordWrap=1]="WordWrap",e[e.Ellipsis=2]="Ellipsis"}(v||(v={}));var x=function(e){function t(t,i){void 0===i&&(i="");var n=e.call(this,t)||this;return n.name=t,n._text="",n._textWrapping=v.Clip,n._textHorizontalAlignment=g.HORIZONTAL_ALIGNMENT_CENTER,n._textVerticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,n._resizeToFit=!1,n._lineSpacing=new _(0),n._outlineWidth=0,n._outlineColor="white",n._underline=!1,n._lineThrough=!1,n.onTextChangedObservable=new l.Observable,n.onLinesReadyObservable=new l.Observable,n.text=i,n}return o(t,e),Object.defineProperty(t.prototype,"lines",{get:function(){return this._lines},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resizeToFit",{get:function(){return this._resizeToFit},set:function(e){this._resizeToFit!==e&&(this._resizeToFit=e,this._resizeToFit&&(this._width.ignoreAdaptiveScaling=!0,this._height.ignoreAdaptiveScaling=!0),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWrapping",{get:function(){return this._textWrapping},set:function(e){this._textWrapping!==e&&(this._textWrapping=+e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e+"",this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHorizontalAlignment",{get:function(){return this._textHorizontalAlignment},set:function(e){this._textHorizontalAlignment!==e&&(this._textHorizontalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textVerticalAlignment",{get:function(){return this._textVerticalAlignment},set:function(e){this._textVerticalAlignment!==e&&(this._textVerticalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineSpacing",{get:function(){return this._lineSpacing.toString(this._host)},set:function(e){this._lineSpacing.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underline",{get:function(){return this._underline},set:function(e){this._underline!==e&&(this._underline=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineThrough",{get:function(){return this._lineThrough},set:function(e){this._lineThrough!==e&&(this._lineThrough=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor!==e&&(this._outlineColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"TextBlock"},t.prototype._processMeasures=function(t,i){this._fontOffset&&!this.isDirty||(this._fontOffset=g._GetFontOffset(i.font)),e.prototype._processMeasures.call(this,t,i),this._lines=this._breakLines(this._currentMeasure.width,i),this.onLinesReadyObservable.notifyObservers(this);for(var n=0,o=0;o<this._lines.length;o++){var r=this._lines[o];r.width>n&&(n=r.width)}if(this._resizeToFit){if(this._textWrapping===v.Clip){var a=this._paddingLeftInPixels+this._paddingRightInPixels+n|0;a!==this._width.internalValue&&(this._width.updateInPlace(a,_.UNITMODE_PIXEL),this._rebuildLayout=!0)}var s=this._paddingTopInPixels+this._paddingBottomInPixels+this._fontOffset.height*this._lines.length|0;if(this._lines.length>0&&0!==this._lineSpacing.internalValue){var l=0;l=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),s+=(this._lines.length-1)*l}s!==this._height.internalValue&&(this._height.updateInPlace(s,_.UNITMODE_PIXEL),this._rebuildLayout=!0)}},t.prototype._drawText=function(e,t,i,n){var o=this._currentMeasure.width,r=0;switch(this._textHorizontalAlignment){case g.HORIZONTAL_ALIGNMENT_LEFT:r=0;break;case g.HORIZONTAL_ALIGNMENT_RIGHT:r=o-t;break;case g.HORIZONTAL_ALIGNMENT_CENTER:r=(o-t)/2}(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY),this.outlineWidth&&n.strokeText(e,this._currentMeasure.left+r,i),n.fillText(e,this._currentMeasure.left+r,i),this._underline&&(n.beginPath(),n.lineWidth=Math.round(.05*this.fontSizeInPixels),n.moveTo(this._currentMeasure.left+r,i+3),n.lineTo(this._currentMeasure.left+r+t,i+3),n.stroke(),n.closePath()),this._lineThrough&&(n.beginPath(),n.lineWidth=Math.round(.05*this.fontSizeInPixels),n.moveTo(this._currentMeasure.left+r,i-this.fontSizeInPixels/3),n.lineTo(this._currentMeasure.left+r+t,i-this.fontSizeInPixels/3),n.stroke(),n.closePath())},t.prototype._draw=function(e,t){e.save(),this._applyStates(e),this._renderLines(e),e.restore()},t.prototype._applyStates=function(t){e.prototype._applyStates.call(this,t),this.outlineWidth&&(t.lineWidth=this.outlineWidth,t.strokeStyle=this.outlineColor,t.lineJoin="miter",t.miterLimit=2)},t.prototype._breakLines=function(e,t){var i=[],n=this.text.split("\n");if(this._textWrapping===v.Ellipsis)for(var o=0,r=n;o<r.length;o++){var a=r[o];i.push(this._parseLineEllipsis(a,e,t))}else if(this._textWrapping===v.WordWrap)for(var s=0,l=n;s<l.length;s++)a=l[s],i.push.apply(i,this._parseLineWordWrap(a,e,t));else for(var _=0,h=n;_<h.length;_++)a=h[_],i.push(this._parseLine(a,t));return i},t.prototype._parseLine=function(e,t){void 0===e&&(e="");var i=t.measureText(e);return{text:e,width:Math.abs(i.actualBoundingBoxLeft)+Math.abs(i.actualBoundingBoxRight)}},t.prototype._parseLineEllipsis=function(e,t,i){void 0===e&&(e="");var n=i.measureText(e),o=Math.abs(n.actualBoundingBoxLeft)+Math.abs(n.actualBoundingBoxRight);o>t&&(e+="");var r=Array.from&&Array.from(e);if(r)for(;r.length&&o>t;)r.pop(),e=r.join("")+"...",n=i.measureText(e),o=Math.abs(n.actualBoundingBoxLeft)+Math.abs(n.actualBoundingBoxRight);else for(;e.length>2&&o>t;)e=e.slice(0,-2)+"",n=i.measureText(e),o=Math.abs(n.actualBoundingBoxLeft)+Math.abs(n.actualBoundingBoxRight);return{text:e,width:o}},t.prototype._parseLineWordWrap=function(e,t,i){void 0===e&&(e="");for(var n=[],o=this.wordSplittingFunction?this.wordSplittingFunction(e):e.split(" "),r=i.measureText(e),a=Math.abs(r.actualBoundingBoxLeft)+Math.abs(r.actualBoundingBoxRight),s=0;s<o.length;s++){var l=s>0?e+" "+o[s]:o[0],_=i.measureText(l),h=Math.abs(_.actualBoundingBoxLeft)+Math.abs(_.actualBoundingBoxRight);h>t&&s>0?(n.push({text:e,width:a}),e=o[s],r=i.measureText(e),a=Math.abs(r.actualBoundingBoxLeft)+Math.abs(r.actualBoundingBoxRight)):(a=h,e=l)}return n.push({text:e,width:a}),n},t.prototype._renderLines=function(e){var t=this._currentMeasure.height,i=0;switch(this._textVerticalAlignment){case g.VERTICAL_ALIGNMENT_TOP:i=this._fontOffset.ascent;break;case g.VERTICAL_ALIGNMENT_BOTTOM:i=t-this._fontOffset.height*(this._lines.length-1)-this._fontOffset.descent;break;case g.VERTICAL_ALIGNMENT_CENTER:i=this._fontOffset.ascent+(t-this._fontOffset.height*this._lines.length)/2}i+=this._currentMeasure.top;for(var n=0;n<this._lines.length;n++){var o=this._lines[n];0!==n&&0!==this._lineSpacing.internalValue&&(this._lineSpacing.isPixel?i+=this._lineSpacing.getValue(this._host):i+=this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)),this._drawText(o.text,o.width,i,e),i+=this._fontOffset.height}},t.prototype.computeExpectedHeight=function(){var e;if(this.text&&this.widthInPixels){var t=null===(e=l.Engine.LastCreatedEngine)||void 0===e?void 0:e.createCanvas(0,0).getContext("2d");if(t){this._applyStates(t),this._fontOffset||(this._fontOffset=g._GetFontOffset(t.font));var i=this._lines?this._lines:this._breakLines(this.widthInPixels-this._paddingLeftInPixels-this._paddingRightInPixels,t),n=this._paddingTopInPixels+this._paddingBottomInPixels+this._fontOffset.height*i.length;if(i.length>0&&0!==this._lineSpacing.internalValue){var o=0;o=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),n+=(i.length-1)*o}return n}}return 0},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onTextChangedObservable.clear()},r([Object(l.serialize)()],t.prototype,"resizeToFit",null),r([Object(l.serialize)()],t.prototype,"textWrapping",null),r([Object(l.serialize)()],t.prototype,"text",null),r([Object(l.serialize)()],t.prototype,"textHorizontalAlignment",null),r([Object(l.serialize)()],t.prototype,"textVerticalAlignment",null),r([Object(l.serialize)()],t.prototype,"lineSpacing",null),r([Object(l.serialize)()],t.prototype,"outlineWidth",null),r([Object(l.serialize)()],t.prototype,"underline",null),r([Object(l.serialize)()],t.prototype,"lineThrough",null),r([Object(l.serialize)()],t.prototype,"outlineColor",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.TextBlock",x);var P=function(e){function t(i,n){void 0===n&&(n=null);var o=e.call(this,i)||this;return o.name=i,o._workingCanvas=null,o._loaded=!1,o._stretch=t.STRETCH_FILL,o._autoScale=!1,o._sourceLeft=0,o._sourceTop=0,o._sourceWidth=0,o._sourceHeight=0,o._svgAttributesComputationCompleted=!1,o._isSVG=!1,o._cellWidth=0,o._cellHeight=0,o._cellId=-1,o._populateNinePatchSlicesFromImage=!1,o._imageDataCache={data:null,key:""},o.onImageLoadedObservable=new l.Observable,o.onSVGAttributesComputedObservable=new l.Observable,o.source=n,o}return o(t,e),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return this._loaded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"detectPointerOnOpaqueOnly",{get:function(){return this._detectPointerOnOpaqueOnly},set:function(e){this._detectPointerOnOpaqueOnly!==e&&(this._detectPointerOnOpaqueOnly=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceLeft",{get:function(){return this._sliceLeft},set:function(e){this._sliceLeft!==e&&(this._sliceLeft=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceRight",{get:function(){return this._sliceRight},set:function(e){this._sliceRight!==e&&(this._sliceRight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceTop",{get:function(){return this._sliceTop},set:function(e){this._sliceTop!==e&&(this._sliceTop=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceBottom",{get:function(){return this._sliceBottom},set:function(e){this._sliceBottom!==e&&(this._sliceBottom=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceLeft",{get:function(){return this._sourceLeft},set:function(e){this._sourceLeft!==e&&(this._sourceLeft=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceTop",{get:function(){return this._sourceTop},set:function(e){this._sourceTop!==e&&(this._sourceTop=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceWidth",{get:function(){return this._sourceWidth},set:function(e){this._sourceWidth!==e&&(this._sourceWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceHeight",{get:function(){return this._sourceHeight},set:function(e){this._sourceHeight!==e&&(this._sourceHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imageWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imageHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"populateNinePatchSlicesFromImage",{get:function(){return this._populateNinePatchSlicesFromImage},set:function(e){this._populateNinePatchSlicesFromImage!==e&&(this._populateNinePatchSlicesFromImage=e,this._populateNinePatchSlicesFromImage&&this._loaded&&this._extractNinePatchSliceDataFromImage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSVG",{get:function(){return this._isSVG},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"svgAttributesComputationCompleted",{get:function(){return this._svgAttributesComputationCompleted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoScale",{get:function(){return this._autoScale},set:function(e){this._autoScale!==e&&(this._autoScale=e,e&&this._loaded&&this.synchronizeSizeWithContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stretch",{get:function(){return this._stretch},set:function(e){this._stretch!==e&&(this._stretch=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._rotate90=function(e,i){var n,o;void 0===i&&(i=!1);var r=this._domImage.width,a=this._domImage.height,s=(null===(o=null===(n=this._host)||void 0===n?void 0:n.getScene())||void 0===o?void 0:o.getEngine())||l.Engine.LastCreatedEngine;if(!s)throw new Error("Invalid engine. Unable to create a canvas.");var _=s.createCanvas(a,r),h=_.getContext("2d");h.translate(_.width/2,_.height/2),h.rotate(e*Math.PI/2),h.drawImage(this._domImage,0,0,r,a,-r/2,-a/2,r,a);var c=_.toDataURL("image/jpg"),u=new t(this.name+"rotated",c);return i&&(u._stretch=this._stretch,u._autoScale=this._autoScale,u._cellId=this._cellId,u._cellWidth=e%1?this._cellHeight:this._cellWidth,u._cellHeight=e%1?this._cellWidth:this._cellHeight),this._handleRotationForSVGImage(this,u,e),this._imageDataCache.data=null,u},t.prototype._handleRotationForSVGImage=function(e,t,i){var n=this;e._isSVG&&(e._svgAttributesComputationCompleted?(this._rotate90SourceProperties(e,t,i),this._markAsDirty()):e.onSVGAttributesComputedObservable.addOnce((function(){n._rotate90SourceProperties(e,t,i),n._markAsDirty()})))},t.prototype._rotate90SourceProperties=function(e,t,i){var n,o,r=e.sourceLeft,a=e.sourceTop,s=e.domImage.width,l=e.domImage.height,_=r,h=a,c=e.sourceWidth,u=e.sourceHeight;if(0!=i){var d=i<0?-1:1;i%=4;for(var f=0;f<Math.abs(i);++f)_=-(a-l/2)*d+l/2,h=(r-s/2)*d+s/2,c=(n=[u,c])[0],u=n[1],i<0?h-=u:_-=c,r=_,a=h,s=(o=[l,s])[0],l=o[1]}t.sourceLeft=_,t.sourceTop=h,t.sourceWidth=c,t.sourceHeight=u},t.prototype._extractNinePatchSliceDataFromImage=function(){var e,t,i=this._domImage.width,n=this._domImage.height;if(!this._workingCanvas){var o=(null===(t=null===(e=this._host)||void 0===e?void 0:e.getScene())||void 0===t?void 0:t.getEngine())||l.Engine.LastCreatedEngine;if(!o)throw new Error("Invalid engine. Unable to create a canvas.");this._workingCanvas=o.createCanvas(i,n)}var r=this._workingCanvas.getContext("2d");r.drawImage(this._domImage,0,0,i,n);var a=r.getImageData(0,0,i,n);this._sliceLeft=-1,this._sliceRight=-1;for(var s=0;s<i;s++)if((h=a.data[4*s+3])>127&&-1===this._sliceLeft)this._sliceLeft=s;else if(h<127&&this._sliceLeft>-1){this._sliceRight=s;break}this._sliceTop=-1,this._sliceBottom=-1;for(var _=0;_<n;_++){var h;if((h=a.data[_*i*4+3])>127&&-1===this._sliceTop)this._sliceTop=_;else if(h<127&&this._sliceTop>-1){this._sliceBottom=_;break}}},Object.defineProperty(t.prototype,"domImage",{get:function(){return this._domImage},set:function(e){var t=this;this._domImage=e,this._loaded=!1,this._imageDataCache.data=null,this._domImage.width?this._onImageLoaded():this._domImage.onload=function(){t._onImageLoaded()}},enumerable:!1,configurable:!0}),t.prototype._onImageLoaded=function(){this._imageDataCache.data=null,this._imageWidth=this._domImage.width,this._imageHeight=this._domImage.height,this._loaded=!0,this._populateNinePatchSlicesFromImage&&this._extractNinePatchSliceDataFromImage(),this._autoScale&&this.synchronizeSizeWithContent(),this.onImageLoadedObservable.notifyObservers(this),this._markAsDirty()},Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(e){var t,i,n=this;if(this._source!==e){this._loaded=!1,this._source=e,this._imageDataCache.data=null,e&&(e=this._svgCheck(e));var o=(null===(i=null===(t=this._host)||void 0===t?void 0:t.getScene())||void 0===i?void 0:i.getEngine())||l.Engine.LastCreatedEngine;if(!o)throw new Error("Invalid engine. Unable to create a canvas.");this._domImage=o.createCanvasImage(),this._domImage.onload=function(){n._onImageLoaded()},e&&(l.Tools.SetCorsBehavior(e,this._domImage),this._domImage.src=e)}},enumerable:!1,configurable:!0}),t.prototype._svgCheck=function(e){var t=this;if(window.SVGSVGElement&&-1!==e.search(/.svg#/gi)&&e.indexOf("#")===e.lastIndexOf("#")){this._isSVG=!0;var i=e.split("#")[0],n=e.split("#")[1],o=document.body.querySelector('object[data="'+i+'"]');if(o){var r=o.contentDocument;if(r&&r.documentElement){var a=r.documentElement.getAttribute("viewBox"),s=Number(r.documentElement.getAttribute("width")),l=Number(r.documentElement.getAttribute("height"));if(r.getElementById(n)&&a&&s&&l)return this._getSVGAttribs(o,n),e}o.addEventListener("load",(function(){t._getSVGAttribs(o,n)}))}else{var _=document.createElement("object");_.data=i,_.type="image/svg+xml",_.width="0%",_.height="0%",document.body.appendChild(_),_.onload=function(){var e=document.body.querySelector('object[data="'+i+'"]');e&&t._getSVGAttribs(e,n)}}return i}return e},t.prototype._getSVGAttribs=function(e,t){var i=e.contentDocument;if(i&&i.documentElement){var n=i.documentElement.getAttribute("viewBox"),o=Number(i.documentElement.getAttribute("width")),r=Number(i.documentElement.getAttribute("height")),a=i.getElementById(t);if(n&&o&&r&&a){var s=Number(n.split(" ")[2]),l=Number(n.split(" ")[3]),_=a.getBBox(),h=1,c=1,u=0,d=0,f=a.transform.baseVal.consolidate().matrix;a.transform&&a.transform.baseVal.consolidate()&&(h=f.a,c=f.d,u=f.e,d=f.f),this.sourceLeft=(h*_.x+u)*o/s,this.sourceTop=(c*_.y+d)*r/l,this.sourceWidth=_.width*h*(o/s),this.sourceHeight=_.height*c*(r/l),this._svgAttributesComputationCompleted=!0,this.onSVGAttributesComputedObservable.notifyObservers(this)}}},Object.defineProperty(t.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(e){this._cellWidth!==e&&(this._cellWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(e){this._cellHeight!==e&&(this._cellHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellId",{get:function(){return this._cellId},set:function(e){this._cellId!==e&&(this._cellId=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype.contains=function(t,i){if(!e.prototype.contains.call(this,t,i))return!1;if(!this._detectPointerOnOpaqueOnly||!this._workingCanvas)return!0;var n=0|this._currentMeasure.width,o=0|this._currentMeasure.height,r=n+"_"+o,a=this._imageDataCache.data;if(!a||this._imageDataCache.key!==r){var s=this._workingCanvas.getContext("2d");this._imageDataCache.data=a=s.getImageData(0,0,n,o).data,this._imageDataCache.key=r}return a[4*((t=t-this._currentMeasure.left|0)+(i=i-this._currentMeasure.top|0)*n)+3]>0},t.prototype._getTypeName=function(){return"Image"},t.prototype.synchronizeSizeWithContent=function(){this._loaded&&(this.width=this._domImage.width+"px",this.height=this._domImage.height+"px")},t.prototype._processMeasures=function(i,n){if(this._loaded)switch(this._stretch){case t.STRETCH_NONE:case t.STRETCH_FILL:case t.STRETCH_UNIFORM:case t.STRETCH_NINE_PATCH:break;case t.STRETCH_EXTEND:this._autoScale&&this.synchronizeSizeWithContent(),this.parent&&this.parent.parent&&(this.parent.adaptWidthToChildren=!0,this.parent.adaptHeightToChildren=!0)}e.prototype._processMeasures.call(this,i,n)},t.prototype._prepareWorkingCanvasForOpaqueDetection=function(){var e,t;if(this._detectPointerOnOpaqueOnly){var i=this._currentMeasure.width,n=this._currentMeasure.height;if(!this._workingCanvas){var o=(null===(t=null===(e=this._host)||void 0===e?void 0:e.getScene())||void 0===t?void 0:t.getEngine())||l.Engine.LastCreatedEngine;if(!o)throw new Error("Invalid engine. Unable to create a canvas.");this._workingCanvas=o.createCanvas(i,n)}this._workingCanvas.getContext("2d").clearRect(0,0,i,n)}},t.prototype._drawImage=function(e,t,i,n,o,r,a,s,l){e.drawImage(this._domImage,t,i,n,o,r,a,s,l),this._detectPointerOnOpaqueOnly&&(e=this._workingCanvas.getContext("2d")).drawImage(this._domImage,t,i,n,o,r-this._currentMeasure.left,a-this._currentMeasure.top,s,l)},t.prototype._draw=function(e){var i,n,o,r;if(e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),-1==this.cellId)i=this._sourceLeft,n=this._sourceTop,o=this._sourceWidth?this._sourceWidth:this._imageWidth,r=this._sourceHeight?this._sourceHeight:this._imageHeight;else{var a=this._domImage.naturalWidth/this.cellWidth,s=this.cellId/a>>0,l=this.cellId%a;i=this.cellWidth*l,n=this.cellHeight*s,o=this.cellWidth,r=this.cellHeight}if(this._prepareWorkingCanvasForOpaqueDetection(),this._applyStates(e),this._loaded)switch(this._stretch){case t.STRETCH_NONE:case t.STRETCH_FILL:this._drawImage(e,i,n,o,r,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case t.STRETCH_UNIFORM:var _=this._currentMeasure.width/o,h=this._currentMeasure.height/r,c=Math.min(_,h),u=(this._currentMeasure.width-o*c)/2,d=(this._currentMeasure.height-r*c)/2;this._drawImage(e,i,n,o,r,this._currentMeasure.left+u,this._currentMeasure.top+d,o*c,r*c);break;case t.STRETCH_EXTEND:this._drawImage(e,i,n,o,r,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case t.STRETCH_NINE_PATCH:this._renderNinePatch(e)}e.restore()},t.prototype._renderNinePatch=function(e){var t=this._sliceLeft,i=this._sliceTop,n=this._imageHeight-this._sliceBottom,o=this._imageWidth-this._sliceRight,r=this._sliceRight-this._sliceLeft,a=this._sliceBottom-this._sliceTop,s=this._currentMeasure.width-o-t+2,l=this._currentMeasure.height-n-i+2,_=this._currentMeasure.left+t-1,h=this._currentMeasure.top+i-1,c=this._currentMeasure.left+this._currentMeasure.width-o,u=this._currentMeasure.top+this._currentMeasure.height-n;this._drawImage(e,0,0,t,i,this._currentMeasure.left,this._currentMeasure.top,t,i),this._drawImage(e,this._sliceLeft,0,r,i,_,this._currentMeasure.top,s,i),this._drawImage(e,this.sliceRight,0,o,i,c,this._currentMeasure.top,o,i),this._drawImage(e,0,this._sliceTop,t,a,this._currentMeasure.left,h,t,l),this._drawImage(e,this._sliceLeft,this._sliceTop,r,a,_,h,s,l),this._drawImage(e,this._sliceRight,this._sliceTop,o,a,c,h,o,l),this._drawImage(e,0,this._sliceBottom,t,n,this._currentMeasure.left,u,t,n),this._drawImage(e,this.sliceLeft,this._sliceBottom,r,n,_,u,s,n),this._drawImage(e,this._sliceRight,this._sliceBottom,o,n,c,u,o,n)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onImageLoadedObservable.clear(),this.onSVGAttributesComputedObservable.clear()},t.STRETCH_NONE=0,t.STRETCH_FILL=1,t.STRETCH_UNIFORM=2,t.STRETCH_EXTEND=3,t.STRETCH_NINE_PATCH=4,r([Object(l.serialize)()],t.prototype,"detectPointerOnOpaqueOnly",null),r([Object(l.serialize)()],t.prototype,"sliceLeft",null),r([Object(l.serialize)()],t.prototype,"sliceRight",null),r([Object(l.serialize)()],t.prototype,"sliceTop",null),r([Object(l.serialize)()],t.prototype,"sliceBottom",null),r([Object(l.serialize)()],t.prototype,"sourceLeft",null),r([Object(l.serialize)()],t.prototype,"sourceTop",null),r([Object(l.serialize)()],t.prototype,"sourceWidth",null),r([Object(l.serialize)()],t.prototype,"sourceHeight",null),r([Object(l.serialize)()],t.prototype,"populateNinePatchSlicesFromImage",null),r([Object(l.serialize)()],t.prototype,"autoScale",null),r([Object(l.serialize)()],t.prototype,"stretch",null),r([Object(l.serialize)()],t.prototype,"source",null),r([Object(l.serialize)()],t.prototype,"cellWidth",null),r([Object(l.serialize)()],t.prototype,"cellHeight",null),r([Object(l.serialize)()],t.prototype,"cellId",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.Image",P);var O=function(e){function t(t){var i=e.call(this,t)||this;i.name=t,i.delegatePickingToChildren=!1,i.thickness=1,i.isPointerBlocker=!0;var n=null;return i.pointerEnterAnimation=function(){n=i.alpha,i.alpha-=.1},i.pointerOutAnimation=function(){null!==n&&(i.alpha=n)},i.pointerDownAnimation=function(){i.scaleX-=.05,i.scaleY-=.05},i.pointerUpAnimation=function(){i.scaleX+=.05,i.scaleY+=.05},i}return o(t,e),Object.defineProperty(t.prototype,"image",{get:function(){return this._image},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBlock",{get:function(){return this._textBlock},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Button"},t.prototype._processPicking=function(t,i,n,o,r,a,s,l){if(!this._isEnabled||!this.isHitTestVisible||!this.isVisible||this.notRenderable)return!1;if(!e.prototype.contains.call(this,t,i))return!1;if(this.delegatePickingToChildren){for(var _=!1,h=this._children.length-1;h>=0;h--){var c=this._children[h];if(c.isEnabled&&c.isHitTestVisible&&c.isVisible&&!c.notRenderable&&c.contains(t,i)){_=!0;break}}if(!_)return!1}return this._processObservables(o,t,i,n,r,a,s,l),!0},t.prototype._onPointerEnter=function(t,i){return!!e.prototype._onPointerEnter.call(this,t,i)&&(!this.isReadOnly&&this.pointerEnterAnimation&&this.pointerEnterAnimation(),!0)},t.prototype._onPointerOut=function(t,i,n){void 0===n&&(n=!1),!this.isReadOnly&&this.pointerOutAnimation&&this.pointerOutAnimation(),e.prototype._onPointerOut.call(this,t,i,n)},t.prototype._onPointerDown=function(t,i,n,o,r){return!!e.prototype._onPointerDown.call(this,t,i,n,o,r)&&(!this.isReadOnly&&this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},t.prototype._onPointerUp=function(t,i,n,o,r,a){!this.isReadOnly&&this.pointerUpAnimation&&this.pointerUpAnimation(),e.prototype._onPointerUp.call(this,t,i,n,o,r,a)},t.CreateImageButton=function(e,t,i){var n=new this(e),o=new x(e+"_button",t);o.textWrapping=!0,o.textHorizontalAlignment=g.HORIZONTAL_ALIGNMENT_CENTER,o.paddingLeft="20%",n.addControl(o);var r=new P(e+"_icon",i);return r.width="20%",r.stretch=P.STRETCH_UNIFORM,r.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,n.addControl(r),n._image=r,n._textBlock=o,n},t.CreateImageOnlyButton=function(e,t){var i=new this(e),n=new P(e+"_icon",t);return n.stretch=P.STRETCH_FILL,n.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,i.addControl(n),i._image=n,i},t.CreateSimpleButton=function(e,t){var i=new this(e),n=new x(e+"_button",t);return n.textWrapping=!0,n.textHorizontalAlignment=g.HORIZONTAL_ALIGNMENT_CENTER,i.addControl(n),i._textBlock=n,i},t.CreateImageWithCenterTextButton=function(e,t,i){var n=new this(e),o=new P(e+"_icon",i);o.stretch=P.STRETCH_FILL,n.addControl(o);var r=new x(e+"_button",t);return r.textWrapping=!0,r.textHorizontalAlignment=g.HORIZONTAL_ALIGNMENT_CENTER,n.addControl(r),n._image=o,n._textBlock=r,n},t}(y);Object(l.RegisterClass)("BABYLON.GUI.Button",O);var B=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._isVertical=!0,i._manualWidth=!1,i._manualHeight=!1,i._doNotTrackManualChanges=!1,i._spacing=0,i.ignoreLayoutWarnings=!1,i}return o(t,e),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){this._isVertical!==e&&(this._isVertical=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this._spacing},set:function(e){this._spacing!==e&&(this._spacing=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._doNotTrackManualChanges||(this._manualWidth=!0),this._width.toString(this._host)!==e&&this._width.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(e){this._doNotTrackManualChanges||(this._manualHeight=!0),this._height.toString(this._host)!==e&&this._height.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"StackPanel"},t.prototype._preMeasure=function(t,i){for(var n=0,o=this._children;n<o.length;n++){var r=o[n];this._isVertical?r.verticalAlignment=g.VERTICAL_ALIGNMENT_TOP:r.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT}e.prototype._preMeasure.call(this,t,i)},t.prototype._additionalProcessing=function(t,i){e.prototype._additionalProcessing.call(this,t,i),this._measureForChildren.copyFrom(t),this._measureForChildren.left=this._currentMeasure.left,this._measureForChildren.top=this._currentMeasure.top,this.isVertical&&!this._manualWidth||(this._measureForChildren.width=this._currentMeasure.width),(this.isVertical||this._manualHeight)&&(this._measureForChildren.height=this._currentMeasure.height)},t.prototype._postMeasure=function(){for(var t=0,i=0,n=this._children.length,o=0;o<n;o++){var r=this._children[o];r.isVisible&&!r.notRenderable&&(this._isVertical?(r.top!==i+"px"&&(r.top=i+"px",this._rebuildLayout=!0,r._top.ignoreAdaptiveScaling=!0),r._height.isPercentage&&!r._automaticSize?this.ignoreLayoutWarnings||l.Tools.Warn("Control (Name:"+r.name+", UniqueId:"+r.uniqueId+") is using height in percentage mode inside a vertical StackPanel"):i+=r._currentMeasure.height+r._paddingTopInPixels+r._paddingBottomInPixels+(o<n-1?this._spacing:0)):(r.left!==t+"px"&&(r.left=t+"px",this._rebuildLayout=!0,r._left.ignoreAdaptiveScaling=!0),r._width.isPercentage&&!r._automaticSize?this.ignoreLayoutWarnings||l.Tools.Warn("Control (Name:"+r.name+", UniqueId:"+r.uniqueId+") is using width in percentage mode inside a horizontal StackPanel"):t+=r._currentMeasure.width+r._paddingLeftInPixels+r._paddingRightInPixels+(o<n-1?this._spacing:0)))}t+=this._paddingLeftInPixels+this._paddingRightInPixels,i+=this._paddingTopInPixels+this._paddingBottomInPixels,this._doNotTrackManualChanges=!0;var a=!1,s=!1;if(!this._manualHeight&&this._isVertical){var _=this.height;this.height=i+"px",s=_!==this.height||!this._height.ignoreAdaptiveScaling}if(!this._manualWidth&&!this._isVertical){var h=this.width;this.width=t+"px",a=h!==this.width||!this._width.ignoreAdaptiveScaling}s&&(this._height.ignoreAdaptiveScaling=!0),a&&(this._width.ignoreAdaptiveScaling=!0),this._doNotTrackManualChanges=!1,(a||s)&&(this._rebuildLayout=!0),e.prototype._postMeasure.call(this)},t.prototype.serialize=function(t){e.prototype.serialize.call(this,t),t.manualWidth=this._manualWidth,t.manualHeight=this._manualHeight},t.prototype._parseFromContent=function(t,i){this._manualWidth=t.manualWidth,this._manualHeight=t.manualHeight,e.prototype._parseFromContent.call(this,t,i)},r([Object(l.serialize)()],t.prototype,"ignoreLayoutWarnings",void 0),r([Object(l.serialize)()],t.prototype,"isVertical",null),r([Object(l.serialize)()],t.prototype,"spacing",null),r([Object(l.serialize)()],t.prototype,"width",null),r([Object(l.serialize)()],t.prototype,"height",null),t}(m);Object(l.RegisterClass)("BABYLON.GUI.StackPanel",B);var C=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._isChecked=!1,i._background="black",i._checkSizeRatio=.8,i._thickness=1,i.onIsCheckedChangedObservable=new l.Observable,i.isPointerBlocker=!0,i}return o(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(e){e=Math.max(Math.min(1,e),0),this._checkSizeRatio!==e&&(this._checkSizeRatio=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(e){this._isChecked!==e&&(this._isChecked=e,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(e))},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Checkbox"},t.prototype._draw=function(e,t){e.save(),this._applyStates(e);var i=this._currentMeasure.width-this._thickness,n=this._currentMeasure.height-this._thickness;if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),e.fillStyle=this._isEnabled?this._background:this._disabledColor,e.fillRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,i,n),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._isChecked){e.fillStyle=this._isEnabled?this.color:this._disabledColorItem;var o=i*this._checkSizeRatio,r=n*this._checkSizeRatio;e.fillRect(this._currentMeasure.left+this._thickness/2+(i-o)/2,this._currentMeasure.top+this._thickness/2+(n-r)/2,o,r)}e.strokeStyle=this.color,e.lineWidth=this._thickness,e.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,i,n),e.restore()},t.prototype._onPointerDown=function(t,i,n,o,r){return!!e.prototype._onPointerDown.call(this,t,i,n,o,r)&&(this.isReadOnly||(this.isChecked=!this.isChecked),!0)},t.AddCheckBoxWithHeader=function(e,i){var n=new B;n.isVertical=!1,n.height="30px";var o=new t;o.width="20px",o.height="20px",o.isChecked=!0,o.color="green",o.onIsCheckedChangedObservable.add(i),n.addControl(o);var r=new x;return r.text=e,r.width="180px",r.paddingLeft="5px",r.textHorizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,r.color="white",n.addControl(r),n},r([Object(l.serialize)()],t.prototype,"thickness",null),r([Object(l.serialize)()],t.prototype,"checkSizeRatio",null),r([Object(l.serialize)()],t.prototype,"background",null),r([Object(l.serialize)()],t.prototype,"isChecked",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.Checkbox",C);var T=function(){function e(){}return Object.defineProperty(e.prototype,"text",{get:function(){return this._characters?this._characters.join(""):this._text},set:function(e){this._text=e,this._characters=Array.from&&Array.from(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._characters?this._characters.length:this._text.length},enumerable:!1,configurable:!0}),e.prototype.removePart=function(e,t,i){var n;if(this._text=this._text.slice(0,e)+(i||"")+this._text.slice(t),this._characters){var o=i?Array.from(i):[];(n=this._characters).splice.apply(n,function(e,t,i){if(i||2===arguments.length)for(var n,o=0,r=t.length;o<r;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}([e,t-e],o,!1))}},e.prototype.charAt=function(e){return this._characters?this._characters[e]:this._text.charAt(e)},e.prototype.substr=function(e,t){if(this._characters){e=isNaN(e)?0:e>=0?Math.min(e,this._characters.length):this._characters.length+Math.max(e,-this._characters.length),void 0===t?t=this._characters.length-e:(isNaN(t)||t<0)&&(t=0);for(var i=[];--t>=0;)i[t]=this._characters[e+t];return i.join("")}return this._text.substr(e,t)},e.prototype.substring=function(e,t){if(this._characters){isNaN(e)?e=0:e>this._characters.length?e=this._characters.length:e<0&&(e=0),void 0===t?t=this._characters.length:isNaN(t)?t=0:t>this._characters.length?t=this._characters.length:t<0&&(t=0);for(var i=[],n=0;e<t;)i[n++]=this._characters[e++];return i.join("")}return this._text.substring(e,t)},e.prototype.isWord=function(e){var t=/\w/g;return this._characters?-1!==this._characters[e].search(t):-1!==this._text.search(t)},e}(),I=function(e){function t(t,i){void 0===i&&(i="");var n=e.call(this,t)||this;return n.name=t,n._placeholderText="",n._background="#222222",n._focusedBackground="#000000",n._focusedColor="white",n._placeholderColor="gray",n._thickness=1,n._margin=new _(10,_.UNITMODE_PIXEL),n._autoStretchWidth=!0,n._maxWidth=new _(1,_.UNITMODE_PERCENTAGE,!1),n._isFocused=!1,n._blinkIsEven=!1,n._cursorOffset=0,n._deadKey=!1,n._addKey=!0,n._currentKey="",n._isTextHighlightOn=!1,n._textHighlightColor="#d5e0ff",n._highligherOpacity=.4,n._highlightedText="",n._startHighlightIndex=0,n._endHighlightIndex=0,n._cursorIndex=-1,n._onFocusSelectAll=!1,n._isPointerDown=!1,n.promptMessage="Please enter text:",n.disableMobilePrompt=!1,n.onTextChangedObservable=new l.Observable,n.onBeforeKeyAddObservable=new l.Observable,n.onFocusObservable=new l.Observable,n.onBlurObservable=new l.Observable,n.onTextHighlightObservable=new l.Observable,n.onTextCopyObservable=new l.Observable,n.onTextCutObservable=new l.Observable,n.onTextPasteObservable=new l.Observable,n.onKeyboardEventProcessedObservable=new l.Observable,n.text=i,n.isPointerBlocker=!0,n}return o(t,e),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth.toString(this._host)},set:function(e){this._maxWidth.toString(this._host)!==e&&this._maxWidth.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidthInPixels",{get:function(){return this._maxWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highligherOpacity",{get:function(){return this._highligherOpacity},set:function(e){this._highligherOpacity!==e&&(this._highligherOpacity=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocusSelectAll",{get:function(){return this._onFocusSelectAll},set:function(e){this._onFocusSelectAll!==e&&(this._onFocusSelectAll=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHighlightColor",{get:function(){return this._textHighlightColor},set:function(e){this._textHighlightColor!==e&&(this._textHighlightColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"margin",{get:function(){return this._margin.toString(this._host)},set:function(e){this._margin.toString(this._host)!==e&&this._margin.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"marginInPixels",{get:function(){return this._margin.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoStretchWidth",{get:function(){return this._autoStretchWidth},set:function(e){this._autoStretchWidth!==e&&(this._autoStretchWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusedBackground",{get:function(){return this._focusedBackground},set:function(e){this._focusedBackground!==e&&(this._focusedBackground=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusedColor",{get:function(){return this._focusedColor},set:function(e){this._focusedColor!==e&&(this._focusedColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderColor",{get:function(){return this._placeholderColor},set:function(e){this._placeholderColor!==e&&(this._placeholderColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderText",{get:function(){return this._placeholderText},set:function(e){this._placeholderText!==e&&(this._placeholderText=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deadKey",{get:function(){return this._deadKey},set:function(e){this._deadKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightedText",{get:function(){return this._highlightedText},set:function(e){this._highlightedText!==e&&(this._highlightedText=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addKey",{get:function(){return this._addKey},set:function(e){this._addKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentKey",{get:function(){return this._currentKey},set:function(e){this._currentKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._textWrapper.text},set:function(e){var t=e.toString();this._textWrapper||(this._textWrapper=new T),this._textWrapper.text!==t&&(this._textWrapper.text=t,this._textHasChanged())},enumerable:!1,configurable:!0}),t.prototype._textHasChanged=function(){this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._width.toString(this._host)!==e&&(this._width.fromString(e)&&this._markAsDirty(),this.autoStretchWidth=!1)},enumerable:!1,configurable:!0}),t.prototype.onBlur=function(){this._isFocused=!1,this._scrollLeft=null,this._cursorOffset=0,clearTimeout(this._blinkTimeout),this._markAsDirty(),this.onBlurObservable.notifyObservers(this),this._host.unRegisterClipboardEvents(),this._onClipboardObserver&&this._host.onClipboardObservable.remove(this._onClipboardObserver);var e=this._host.getScene();this._onPointerDblTapObserver&&e&&e.onPointerObservable.remove(this._onPointerDblTapObserver)},t.prototype.onFocus=function(){var e=this;if(this._isEnabled){if(this._scrollLeft=null,this._isFocused=!0,this._blinkIsEven=!1,this._cursorOffset=0,this._markAsDirty(),this.onFocusObservable.notifyObservers(this),-1!==navigator.userAgent.indexOf("Mobile")&&!this.disableMobilePrompt){var t=prompt(this.promptMessage);return null!==t&&(this.text=t),void(this._host.focusedControl=null)}this._host.registerClipboardEvents(),this._onClipboardObserver=this._host.onClipboardObservable.add((function(t){switch(t.type){case l.ClipboardEventTypes.COPY:e._onCopyText(t.event),e.onTextCopyObservable.notifyObservers(e);break;case l.ClipboardEventTypes.CUT:e._onCutText(t.event),e.onTextCutObservable.notifyObservers(e);break;case l.ClipboardEventTypes.PASTE:e._onPasteText(t.event),e.onTextPasteObservable.notifyObservers(e);break;default:return}}));var i=this._host.getScene();i&&(this._onPointerDblTapObserver=i.onPointerObservable.add((function(t){e._isFocused&&t.type===l.PointerEventTypes.POINTERDOUBLETAP&&e._processDblClick(t)}))),this._onFocusSelectAll&&this._selectAllText()}},t.prototype.focus=function(){this._host.moveFocusToControl(this)},t.prototype.blur=function(){this._host.focusedControl=null},t.prototype._getTypeName=function(){return"InputText"},t.prototype.keepsFocusWith=function(){return this._connectedVirtualKeyboard?[this._connectedVirtualKeyboard]:null},t.prototype.processKey=function(e,t,i){if(!this.isReadOnly&&(!i||!i.ctrlKey&&!i.metaKey||67!==e&&86!==e&&88!==e)){if(i&&(i.ctrlKey||i.metaKey)&&65===e)return this._selectAllText(),void i.preventDefault();switch(e){case 32:t=" ";break;case 191:i&&i.preventDefault();break;case 8:if(this._textWrapper.text&&this._textWrapper.length>0){if(this._isTextHighlightOn)return this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this._blinkIsEven=!1,void(i&&i.preventDefault());0===this._cursorOffset?this.text=this._textWrapper.substr(0,this._textWrapper.length-1):(n=this._textWrapper.length-this._cursorOffset)>0&&(this._textWrapper.removePart(n-1,n),this._textHasChanged())}return void(i&&i.preventDefault());case 46:if(this._isTextHighlightOn)return this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,void(i&&i.preventDefault());if(this._textWrapper.text&&this._textWrapper.length>0&&this._cursorOffset>0){var n=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(n,n+1),this._textHasChanged(),this._cursorOffset--}return void(i&&i.preventDefault());case 13:return this._host.focusedControl=null,void(this._isTextHighlightOn=!1);case 35:return this._cursorOffset=0,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 36:return this._cursorOffset=this._textWrapper.length,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 37:if(this._cursorOffset++,this._cursorOffset>this._textWrapper.length&&(this._cursorOffset=this._textWrapper.length),i&&i.shiftKey){if(this._blinkIsEven=!1,i.ctrlKey||i.metaKey){if(!this._isTextHighlightOn){if(this._textWrapper.length===this._cursorOffset)return;this._endHighlightIndex=this._textWrapper.length-this._cursorOffset+1}return this._startHighlightIndex=0,this._cursorIndex=this._textWrapper.length-this._endHighlightIndex,this._cursorOffset=this._textWrapper.length,this._isTextHighlightOn=!0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._textWrapper.length-this._endHighlightIndex,this._cursorOffset=0===this._startHighlightIndex?this._textWrapper.length:this._textWrapper.length-this._startHighlightIndex+1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset>=this._textWrapper.length?this._textWrapper.length:this._cursorOffset-1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this._isTextHighlightOn=!1),i&&(i.ctrlKey||i.metaKey)&&(this._cursorOffset=this._textWrapper.length,i.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 39:if(this._cursorOffset--,this._cursorOffset<0&&(this._cursorOffset=0),i&&i.shiftKey){if(this._blinkIsEven=!1,i.ctrlKey||i.metaKey){if(!this._isTextHighlightOn){if(0===this._cursorOffset)return;this._startHighlightIndex=this._textWrapper.length-this._cursorOffset-1}return this._endHighlightIndex=this._textWrapper.length,this._isTextHighlightOn=!0,this._cursorIndex=this._textWrapper.length-this._startHighlightIndex,this._cursorOffset=0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._textWrapper.length-this._startHighlightIndex,this._cursorOffset=this._textWrapper.length===this._endHighlightIndex?0:this._textWrapper.length-this._endHighlightIndex-1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset<=0?0:this._cursorOffset+1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._textWrapper.length-this._endHighlightIndex,this._isTextHighlightOn=!1),i&&(i.ctrlKey||i.metaKey)&&(this._cursorOffset=0,i.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 222:i?"Quote"==i.code?i.shiftKey?(e=34,t='"'):(e=39,t="'"):(i.preventDefault(),this._cursorIndex=-1,this.deadKey=!0):(this._cursorIndex=-1,this.deadKey=!0)}if(t&&(-1===e||32===e||34===e||39===e||e>47&&e<64||e>64&&e<91||e>159&&e<193||e>218&&e<223||e>95&&e<112)&&(this._currentKey=t,this.onBeforeKeyAddObservable.notifyObservers(this),t=this._currentKey,this._addKey))if(this._isTextHighlightOn)this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex,t),this._textHasChanged(),this._cursorOffset=this._textWrapper.length-(this._startHighlightIndex+1),this._isTextHighlightOn=!1,this._blinkIsEven=!1,this._markAsDirty();else if(0===this._cursorOffset)this.text+=t;else{var o=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(o,o,t),this._textHasChanged()}}},t.prototype._updateValueFromCursorIndex=function(e){if(this._blinkIsEven=!1,-1===this._cursorIndex)this._cursorIndex=e;else if(this._cursorIndex<this._cursorOffset)this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset;else{if(!(this._cursorIndex>this._cursorOffset))return this._isTextHighlightOn=!1,void this._markAsDirty();this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex}this._isTextHighlightOn=!0,this._markAsDirty()},t.prototype._processDblClick=function(e){var t,i;this._startHighlightIndex=this._textWrapper.length-this._cursorOffset,this._endHighlightIndex=this._startHighlightIndex;do{i=this._endHighlightIndex<this._textWrapper.length&&this._textWrapper.isWord(this._endHighlightIndex)?++this._endHighlightIndex:0,t=this._startHighlightIndex>0&&this._textWrapper.isWord(this._startHighlightIndex-1)?--this._startHighlightIndex:0}while(t||i);this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this.onTextHighlightObservable.notifyObservers(this),this._isTextHighlightOn=!0,this._clickedCoordinate=null,this._blinkIsEven=!0,this._cursorIndex=-1,this._markAsDirty()},t.prototype._selectAllText=function(){this._blinkIsEven=!0,this._isTextHighlightOn=!0,this._startHighlightIndex=0,this._endHighlightIndex=this._textWrapper.length,this._cursorOffset=this._textWrapper.length,this._cursorIndex=-1,this._markAsDirty()},t.prototype.processKeyboard=function(e){this.processKey(e.keyCode,e.key,e),this.onKeyboardEventProcessedObservable.notifyObservers(e)},t.prototype._onCopyText=function(e){this._isTextHighlightOn=!1;try{e.clipboardData&&e.clipboardData.setData("text/plain",this._highlightedText)}catch(e){}this._host.clipboardData=this._highlightedText},t.prototype._onCutText=function(e){if(this._highlightedText){this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex;try{e.clipboardData&&e.clipboardData.setData("text/plain",this._highlightedText)}catch(e){}this._host.clipboardData=this._highlightedText,this._highlightedText=""}},t.prototype._onPasteText=function(e){var t="";t=e.clipboardData&&-1!==e.clipboardData.types.indexOf("text/plain")?e.clipboardData.getData("text/plain"):this._host.clipboardData;var i=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(i,i,t),this._textHasChanged()},t.prototype._draw=function(e,t){var i=this;e.save(),this._applyStates(e),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._isFocused?this._focusedBackground&&(e.fillStyle=this._isEnabled?this._focusedBackground:this._disabledColor,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)):this._background&&(e.fillStyle=this._isEnabled?this._background:this._disabledColor,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._fontOffset&&!this._wasDirty||(this._fontOffset=g._GetFontOffset(e.font));var n=this._currentMeasure.left+this._margin.getValueInPixel(this._host,this._tempParentMeasure.width);this.color&&(e.fillStyle=this.color);var o=this._beforeRenderText(this._textWrapper);this._isFocused||this._textWrapper.text||!this._placeholderText||((o=new T).text=this._placeholderText,this._placeholderColor&&(e.fillStyle=this._placeholderColor)),this._textWidth=e.measureText(o.text).width;var r=2*this._margin.getValueInPixel(this._host,this._tempParentMeasure.width);this._autoStretchWidth&&(this.width=Math.min(this._maxWidth.getValueInPixel(this._host,this._tempParentMeasure.width),this._textWidth+r)+"px",this._autoStretchWidth=!0);var a=this._fontOffset.ascent+(this._currentMeasure.height-this._fontOffset.height)/2,s=this._width.getValueInPixel(this._host,this._tempParentMeasure.width)-r;if(e.save(),e.beginPath(),e.rect(n,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,s+2,this._currentMeasure.height),e.clip(),this._isFocused&&this._textWidth>s){var l=n-this._textWidth+s;this._scrollLeft||(this._scrollLeft=l)}else this._scrollLeft=n;if(e.fillText(o.text,this._scrollLeft,this._currentMeasure.top+a),this._isFocused){if(this._clickedCoordinate){var _=this._scrollLeft+this._textWidth-this._clickedCoordinate,h=0;this._cursorOffset=0;var c=0;do{this._cursorOffset&&(c=Math.abs(_-h)),this._cursorOffset++,h=e.measureText(o.substr(o.length-this._cursorOffset,this._cursorOffset)).width}while(h<_&&o.length>=this._cursorOffset);Math.abs(_-h)>c&&this._cursorOffset--,this._blinkIsEven=!1,this._clickedCoordinate=null}if(!this._blinkIsEven){var u=o.substr(o.length-this._cursorOffset),d=e.measureText(u).width,f=this._scrollLeft+this._textWidth-d;f<n?(this._scrollLeft+=n-f,f=n,this._markAsDirty()):f>n+s&&(this._scrollLeft+=n+s-f,f=n+s,this._markAsDirty()),this._isTextHighlightOn||e.fillRect(f,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,2,this._fontOffset.height)}if(clearTimeout(this._blinkTimeout),this._blinkTimeout=setTimeout((function(){i._blinkIsEven=!i._blinkIsEven,i._markAsDirty()}),500),this._isTextHighlightOn){clearTimeout(this._blinkTimeout);var p=e.measureText(o.substring(this._startHighlightIndex)).width,b=this._scrollLeft+this._textWidth-p;this._highlightedText=o.substring(this._startHighlightIndex,this._endHighlightIndex);var m=e.measureText(o.substring(this._startHighlightIndex,this._endHighlightIndex)).width;b<n&&((m-=n-b)||(m=e.measureText(o.charAt(o.length-this._cursorOffset)).width),b=n),e.globalAlpha=this._highligherOpacity,e.fillStyle=this._textHighlightColor,e.fillRect(b,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,m,this._fontOffset.height),e.globalAlpha=1}}e.restore(),this._thickness&&(this._isFocused?this.focusedColor&&(e.strokeStyle=this.focusedColor):this.color&&(e.strokeStyle=this.color),e.lineWidth=this._thickness,e.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness)),e.restore()},t.prototype._onPointerDown=function(t,i,n,o,r){return!(!e.prototype._onPointerDown.call(this,t,i,n,o,r)||!this.isReadOnly&&(this._clickedCoordinate=i.x,this._isTextHighlightOn=!1,this._highlightedText="",this._cursorIndex=-1,this._isPointerDown=!0,this._host._capturingControl[n]=this,this._host.focusedControl===this?(clearTimeout(this._blinkTimeout),this._markAsDirty(),0):!this._isEnabled||(this._host.focusedControl=this,0)))},t.prototype._onPointerMove=function(t,i,n,o){this._host.focusedControl===this&&this._isPointerDown&&!this.isReadOnly&&(this._clickedCoordinate=i.x,this._markAsDirty(),this._updateValueFromCursorIndex(this._cursorOffset)),e.prototype._onPointerMove.call(this,t,i,n,o)},t.prototype._onPointerUp=function(t,i,n,o,r){this._isPointerDown=!1,delete this._host._capturingControl[n],e.prototype._onPointerUp.call(this,t,i,n,o,r)},t.prototype._beforeRenderText=function(e){return e},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onBlurObservable.clear(),this.onFocusObservable.clear(),this.onTextChangedObservable.clear(),this.onTextCopyObservable.clear(),this.onTextCutObservable.clear(),this.onTextPasteObservable.clear(),this.onTextHighlightObservable.clear(),this.onKeyboardEventProcessedObservable.clear()},r([Object(l.serialize)()],t.prototype,"promptMessage",void 0),r([Object(l.serialize)()],t.prototype,"disableMobilePrompt",void 0),r([Object(l.serialize)()],t.prototype,"maxWidth",null),r([Object(l.serialize)()],t.prototype,"highligherOpacity",null),r([Object(l.serialize)()],t.prototype,"onFocusSelectAll",null),r([Object(l.serialize)()],t.prototype,"textHighlightColor",null),r([Object(l.serialize)()],t.prototype,"margin",null),r([Object(l.serialize)()],t.prototype,"autoStretchWidth",null),r([Object(l.serialize)()],t.prototype,"thickness",null),r([Object(l.serialize)()],t.prototype,"focusedBackground",null),r([Object(l.serialize)()],t.prototype,"focusedColor",null),r([Object(l.serialize)()],t.prototype,"background",null),r([Object(l.serialize)()],t.prototype,"placeholderColor",null),r([Object(l.serialize)()],t.prototype,"placeholderText",null),r([Object(l.serialize)()],t.prototype,"deadKey",null),r([Object(l.serialize)()],t.prototype,"text",null),r([Object(l.serialize)()],t.prototype,"width",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.InputText",I);var S=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._rowDefinitions=new Array,i._rowDefinitionObservers=[],i._columnDefinitions=new Array,i._columnDefinitionObservers=[],i._cells={},i._childControls=new Array,i}return o(t,e),Object.defineProperty(t.prototype,"columnCount",{get:function(){return this._columnDefinitions.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowCount",{get:function(){return this._rowDefinitions.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._childControls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cells",{get:function(){return this._cells},enumerable:!1,configurable:!0}),t.prototype.getRowDefinition=function(e){return e<0||e>=this._rowDefinitions.length?null:this._rowDefinitions[e]},t.prototype.getColumnDefinition=function(e){return e<0||e>=this._columnDefinitions.length?null:this._columnDefinitions[e]},t.prototype.addRowDefinition=function(e,t){var i=this;return void 0===t&&(t=!1),this._rowDefinitions.push(new _(e,t?_.UNITMODE_PIXEL:_.UNITMODE_PERCENTAGE)),this._rowDefinitionObservers.push(this._rowDefinitions[this.rowCount-1].onChangedObservable.add((function(){return i._markAsDirty()}))),this._markAsDirty(),this},t.prototype.addColumnDefinition=function(e,t){var i=this;return void 0===t&&(t=!1),this._columnDefinitions.push(new _(e,t?_.UNITMODE_PIXEL:_.UNITMODE_PERCENTAGE)),this._columnDefinitionObservers.push(this._columnDefinitions[this.columnCount-1].onChangedObservable.add((function(){return i._markAsDirty()}))),this._markAsDirty(),this},t.prototype.setRowDefinition=function(e,t,i){var n=this;if(void 0===i&&(i=!1),e<0||e>=this._rowDefinitions.length)return this;var o=this._rowDefinitions[e];return o&&o.isPixel===i&&o.value===t||(this._rowDefinitions[e].onChangedObservable.remove(this._rowDefinitionObservers[e]),this._rowDefinitions[e]=new _(t,i?_.UNITMODE_PIXEL:_.UNITMODE_PERCENTAGE),this._rowDefinitionObservers[e]=this._rowDefinitions[e].onChangedObservable.add((function(){return n._markAsDirty()})),this._markAsDirty()),this},t.prototype.setColumnDefinition=function(e,t,i){var n=this;if(void 0===i&&(i=!1),e<0||e>=this._columnDefinitions.length)return this;var o=this._columnDefinitions[e];return o&&o.isPixel===i&&o.value===t||(this._columnDefinitions[e].onChangedObservable.remove(this._columnDefinitionObservers[e]),this._columnDefinitions[e]=new _(t,i?_.UNITMODE_PIXEL:_.UNITMODE_PERCENTAGE),this._columnDefinitionObservers[e]=this._columnDefinitions[e].onChangedObservable.add((function(){return n._markAsDirty()})),this._markAsDirty()),this},t.prototype.getChildrenAt=function(e,t){var i=this._cells[e+":"+t];return i?i.children:null},t.prototype.getChildCellInfo=function(e){return e._tag},t.prototype._removeCell=function(t,i){if(t){e.prototype.removeControl.call(this,t);for(var n=0,o=t.children;n<o.length;n++){var r=o[n],a=this._childControls.indexOf(r);-1!==a&&this._childControls.splice(a,1)}delete this._cells[i]}},t.prototype._offsetCell=function(e,t){if(this._cells[t]){this._cells[e]=this._cells[t];for(var i=0,n=this._cells[e].children;i<n.length;i++)n[i]._tag=e;delete this._cells[t]}},t.prototype.removeColumnDefinition=function(e){if(e<0||e>=this._columnDefinitions.length)return this;for(var t=0;t<this._rowDefinitions.length;t++){var i=t+":"+e,n=this._cells[i];this._removeCell(n,i)}for(t=0;t<this._rowDefinitions.length;t++)for(var o=e+1;o<this._columnDefinitions.length;o++){var r=t+":"+(o-1);i=t+":"+o,this._offsetCell(r,i)}return this._columnDefinitions[e].onChangedObservable.remove(this._columnDefinitionObservers[e]),this._columnDefinitions.splice(e,1),this._columnDefinitionObservers.splice(e,1),this._markAsDirty(),this},t.prototype.removeRowDefinition=function(e){if(e<0||e>=this._rowDefinitions.length)return this;for(var t=0;t<this._columnDefinitions.length;t++){var i=e+":"+t,n=this._cells[i];this._removeCell(n,i)}for(t=0;t<this._columnDefinitions.length;t++)for(var o=e+1;o<this._rowDefinitions.length;o++){var r=o-1+":"+t;i=o+":"+t,this._offsetCell(r,i)}return this._rowDefinitions[e].onChangedObservable.remove(this._rowDefinitionObservers[e]),this._rowDefinitions.splice(e,1),this._rowDefinitionObservers.splice(e,1),this._markAsDirty(),this},t.prototype.addControl=function(t,i,n){if(void 0===i&&(i=0),void 0===n&&(n=0),0===this._rowDefinitions.length&&this.addRowDefinition(1,!1),0===this._columnDefinitions.length&&this.addColumnDefinition(1,!1),-1!==this._childControls.indexOf(t))return l.Tools.Warn("Control (Name:"+t.name+", UniqueId:"+t.uniqueId+") is already associated with this grid. You must remove it before reattaching it"),this;var o=Math.min(i,this._rowDefinitions.length-1)+":"+Math.min(n,this._columnDefinitions.length-1),r=this._cells[o];return r||(r=new m(o),this._cells[o]=r,r.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,r.verticalAlignment=g.VERTICAL_ALIGNMENT_TOP,e.prototype.addControl.call(this,r)),r.addControl(t),this._childControls.push(t),t._tag=o,t.parent=this,this._markAsDirty(),this},t.prototype.removeControl=function(e){var t=this._childControls.indexOf(e);-1!==t&&this._childControls.splice(t,1);var i=this._cells[e._tag];return i&&(i.removeControl(e),e._tag=null),this._markAsDirty(),this},t.prototype._getTypeName=function(){return"Grid"},t.prototype._getGridDefinitions=function(e){for(var t=[],i=[],n=[],o=[],r=this._currentMeasure.width,a=0,s=this._currentMeasure.height,l=0,_=0,h=0,c=this._rowDefinitions;h<c.length;h++)(b=c[h]).isPixel?(s-=p=b.getValue(this._host),i[_]=p):l+=b.value,_++;var u=0;_=0;for(var d=0,f=this._rowDefinitions;d<f.length;d++){var p,b=f[d];o.push(u),b.isPixel?u+=b.getValue(this._host):(u+=p=b.value/l*s,i[_]=p),_++}_=0;for(var g=0,m=this._columnDefinitions;g<m.length;g++)(O=m[g]).isPixel?(r-=P=O.getValue(this._host),t[_]=P):a+=O.value,_++;var v=0;_=0;for(var y=0,x=this._columnDefinitions;y<x.length;y++){var P,O=x[y];n.push(v),O.isPixel?v+=O.getValue(this._host):(v+=P=O.value/a*r,t[_]=P),_++}e(n,o,t,i)},t.prototype._additionalProcessing=function(t,i){var n=this;this._getGridDefinitions((function(e,t,i,o){for(var r in n._cells)if(n._cells.hasOwnProperty(r)){var a=r.split(":"),s=parseInt(a[0]),l=parseInt(a[1]),_=n._cells[r];_.left=e[l]+"px",_.top=t[s]+"px",_.width=i[l]+"px",_.height=o[s]+"px",_._left.ignoreAdaptiveScaling=!0,_._top.ignoreAdaptiveScaling=!0,_._width.ignoreAdaptiveScaling=!0,_._height.ignoreAdaptiveScaling=!0}})),e.prototype._additionalProcessing.call(this,t,i)},t.prototype._flagDescendantsAsMatrixDirty=function(){for(var e in this._cells)this._cells.hasOwnProperty(e)&&this._cells[e]._markMatrixAsDirty()},t.prototype._renderHighlightSpecific=function(t){var i=this;e.prototype._renderHighlightSpecific.call(this,t),this._getGridDefinitions((function(e,n,o,r){for(var a=0;a<e.length;a++){var s=i._currentMeasure.left+e[a]+o[a];t.beginPath(),t.moveTo(s,i._currentMeasure.top),t.lineTo(s,i._currentMeasure.top+i._currentMeasure.height),t.stroke()}for(a=0;a<n.length;a++){var l=i._currentMeasure.top+n[a]+r[a];t.beginPath(),t.moveTo(i._currentMeasure.left,l),t.lineTo(i._currentMeasure.left+i._currentMeasure.width,l),t.stroke()}})),t.restore()},t.prototype.dispose=function(){e.prototype.dispose.call(this);for(var t=0,i=this._childControls;t<i.length;t++)i[t].dispose();for(var n=0;n<this._rowDefinitions.length;n++)this._rowDefinitions[n].onChangedObservable.remove(this._rowDefinitionObservers[n]);for(n=0;n<this._columnDefinitions.length;n++)this._columnDefinitions[n].onChangedObservable.remove(this._columnDefinitionObservers[n]);this._rowDefinitionObservers=[],this._rowDefinitions=[],this._columnDefinitionObservers=[],this._columnDefinitions=[],this._cells={},this._childControls=[]},t.prototype.serialize=function(t){e.prototype.serialize.call(this,t),t.columnCount=this.columnCount,t.rowCount=this.rowCount,t.columns=[],t.rows=[],t.tags=[];for(var i=0;i<this.columnCount;++i){var n=this.getColumnDefinition(i),o={value:null==n?void 0:n.getValue(this.host),unit:null==n?void 0:n.unit};t.columns.push(o)}for(i=0;i<this.rowCount;++i){var r=this.getRowDefinition(i);o={value:null==r?void 0:r.getValue(this.host),unit:null==r?void 0:r.unit},t.rows.push(o)}this.children.forEach((function(e){t.tags.push(e._tag)}))},t.prototype._parseFromContent=function(t,i){e.prototype._parseFromContent.call(this,t,i);var n=[];this.children.forEach((function(e){n.push(e)})),this.removeRowDefinition(0),this.removeColumnDefinition(0);for(var o=0;o<t.columnCount;++o){var r=t.columns[o].value,a=t.columns[o].unit;this.addColumnDefinition(r,1===a)}for(o=0;o<t.rowCount;++o){var s=t.rows[o].value;a=t.rows[o].unit,this.addRowDefinition(s,1===a)}for(o=0;o<n.length;++o){var l=t.tags[o],_=parseInt(l.substring(0,l.search(":")));isNaN(_)&&(_=0);var h=parseInt(l.substring(l.search(":")+1));isNaN(h)&&(h=0),this.addControl(n[o],_,h)}},t}(m);Object(l.RegisterClass)("BABYLON.GUI.Grid",S);var R=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._value=l.Color3.Red(),i._tmpColor=new l.Color3,i._pointerStartedOnSquare=!1,i._pointerStartedOnWheel=!1,i._squareLeft=0,i._squareTop=0,i._squareSize=0,i._h=360,i._s=1,i._v=1,i._lastPointerDownId=-1,i.onValueChangedObservable=new l.Observable,i._pointerIsDown=!1,i.value=new l.Color3(.88,.1,.1),i.size="200px",i.isPointerBlocker=!0,i}return o(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value.equals(e)||(this._value.copyFrom(e),this._value.toHSVToRef(this._tmpColor),this._h=this._tmpColor.r,this._s=Math.max(this._tmpColor.g,1e-5),this._v=Math.max(this._tmpColor.b,1e-5),this._markAsDirty(),this._value.r<=t._Epsilon&&(this._value.r=0),this._value.g<=t._Epsilon&&(this._value.g=0),this._value.b<=t._Epsilon&&(this._value.b=0),this._value.r>=1-t._Epsilon&&(this._value.r=1),this._value.g>=1-t._Epsilon&&(this._value.g=1),this._value.b>=1-t._Epsilon&&(this._value.b=1),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._width.toString(this._host)!==e&&this._width.fromString(e)&&(0===this._width.getValue(this._host)&&(e="1px",this._width.fromString(e)),this._height.fromString(e),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(e){this._height.toString(this._host)!==e&&this._height.fromString(e)&&(0===this._height.getValue(this._host)&&(e="1px",this._height.fromString(e)),this._width.fromString(e),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.width},set:function(e){this.width=e},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ColorPicker"},t.prototype._preMeasure=function(e,t){e.width<e.height?this._currentMeasure.height=e.width:this._currentMeasure.width=e.height},t.prototype._updateSquareProps=function(){var e=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),t=2*(e-.2*e)/Math.sqrt(2),i=e-.5*t;this._squareLeft=this._currentMeasure.left+i,this._squareTop=this._currentMeasure.top+i,this._squareSize=t},t.prototype._drawGradientSquare=function(e,t,i,n,o,r){var a=r.createLinearGradient(t,i,n+t,i);a.addColorStop(0,"#fff"),a.addColorStop(1,"hsl("+e+", 100%, 50%)"),r.fillStyle=a,r.fillRect(t,i,n,o);var s=r.createLinearGradient(t,i,t,o+i);s.addColorStop(0,"rgba(0,0,0,0)"),s.addColorStop(1,"#000"),r.fillStyle=s,r.fillRect(t,i,n,o)},t.prototype._drawCircle=function(e,t,i,n){n.beginPath(),n.arc(e,t,i+1,0,2*Math.PI,!1),n.lineWidth=3,n.strokeStyle="#333333",n.stroke(),n.beginPath(),n.arc(e,t,i,0,2*Math.PI,!1),n.lineWidth=3,n.strokeStyle="#ffffff",n.stroke()},t.prototype._createColorWheelCanvas=function(e,t){var i=l.Engine.LastCreatedEngine;if(!i)throw new Error("Invalid engine. Unable to create a canvas.");for(var n=i.createCanvas(2*e,2*e),o=n.getContext("2d"),r=o.getImageData(0,0,2*e,2*e),a=r.data,s=this._tmpColor,_=e*e,h=e-t,c=h*h,u=-e;u<e;u++)for(var d=-e;d<e;d++){var f=u*u+d*d;if(!(f>_||f<c)){var p=Math.sqrt(f),b=Math.atan2(d,u);l.Color3.HSVtoRGBToRef(180*b/Math.PI+180,p/e,1,s);var g=4*(u+e+2*(d+e)*e);a[g]=255*s.r,a[g+1]=255*s.g,a[g+2]=255*s.b;var m=.2;m=e<50?.2:e>150?.04:-.16*(e-50)/100+.2;var v=(p-h)/(e-h);a[g+3]=v<m?v/m*255:v>1-m?255*(1-(v-(1-m))/m):255}}return o.putImageData(r,0,0),n},t.prototype._draw=function(e){e.save(),this._applyStates(e);var t=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),i=.2*t,n=this._currentMeasure.left,o=this._currentMeasure.top;this._colorWheelCanvas&&this._colorWheelCanvas.width==2*t||(this._colorWheelCanvas=this._createColorWheelCanvas(t,i)),this._updateSquareProps(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY,e.fillRect(this._squareLeft,this._squareTop,this._squareSize,this._squareSize)),e.drawImage(this._colorWheelCanvas,n,o),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._drawGradientSquare(this._h,this._squareLeft,this._squareTop,this._squareSize,this._squareSize,e);var r=this._squareLeft+this._squareSize*this._s,a=this._squareTop+this._squareSize*(1-this._v);this._drawCircle(r,a,.04*t,e);var s=t-.5*i;r=n+t+Math.cos((this._h-180)*Math.PI/180)*s,a=o+t+Math.sin((this._h-180)*Math.PI/180)*s,this._drawCircle(r,a,.35*i,e),e.restore()},t.prototype._updateValueFromPointer=function(e,i){if(this._pointerStartedOnWheel){var n=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),o=n+this._currentMeasure.left,r=n+this._currentMeasure.top;this._h=180*Math.atan2(i-r,e-o)/Math.PI+180}else this._pointerStartedOnSquare&&(this._updateSquareProps(),this._s=(e-this._squareLeft)/this._squareSize,this._v=1-(i-this._squareTop)/this._squareSize,this._s=Math.min(this._s,1),this._s=Math.max(this._s,t._Epsilon),this._v=Math.min(this._v,1),this._v=Math.max(this._v,t._Epsilon));l.Color3.HSVtoRGBToRef(this._h,this._s,this._v,this._tmpColor),this.value=this._tmpColor},t.prototype._isPointOnSquare=function(e,t){this._updateSquareProps();var i=this._squareLeft,n=this._squareTop,o=this._squareSize;return e>=i&&e<=i+o&&t>=n&&t<=n+o},t.prototype._isPointOnWheel=function(e,t){var i=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),n=i-.2*i,o=e-(i+this._currentMeasure.left),r=t-(i+this._currentMeasure.top),a=o*o+r*r;return a<=i*i&&a>=n*n},t.prototype._onPointerDown=function(t,i,n,o,r){if(!e.prototype._onPointerDown.call(this,t,i,n,o,r))return!1;if(this.isReadOnly)return!0;this._pointerIsDown=!0,this._pointerStartedOnSquare=!1,this._pointerStartedOnWheel=!1,this._invertTransformMatrix.transformCoordinates(i.x,i.y,this._transformedPosition);var a=this._transformedPosition.x,s=this._transformedPosition.y;return this._isPointOnSquare(a,s)?this._pointerStartedOnSquare=!0:this._isPointOnWheel(a,s)&&(this._pointerStartedOnWheel=!0),this._updateValueFromPointer(a,s),this._host._capturingControl[n]=this,this._lastPointerDownId=n,!0},t.prototype._onPointerMove=function(t,i,n,o){if(n==this._lastPointerDownId){if(!this.isReadOnly){this._invertTransformMatrix.transformCoordinates(i.x,i.y,this._transformedPosition);var r=this._transformedPosition.x,a=this._transformedPosition.y;this._pointerIsDown&&this._updateValueFromPointer(r,a)}e.prototype._onPointerMove.call(this,t,i,n,o)}},t.prototype._onPointerUp=function(t,i,n,o,r,a){this._pointerIsDown=!1,delete this._host._capturingControl[n],e.prototype._onPointerUp.call(this,t,i,n,o,r,a)},t.prototype._onCanvasBlur=function(){this._forcePointerUp(),e.prototype._onCanvasBlur.call(this)},t.ShowPickerDialogAsync=function(e,i){return new Promise((function(n,o){i.pickerWidth=i.pickerWidth||"640px",i.pickerHeight=i.pickerHeight||"400px",i.headerHeight=i.headerHeight||"35px",i.lastColor=i.lastColor||"#000000",i.swatchLimit=i.swatchLimit||20,i.numSwatchesPerLine=i.numSwatchesPerLine||10;var r,a,s,_,h,c,u,d,f,p,b,m,v,P,B,C,T,R,w,M=i.swatchLimit/i.numSwatchesPerLine,E=parseFloat(i.pickerWidth)/i.numSwatchesPerLine,D=Math.floor(.25*E),L=D*(i.numSwatchesPerLine+1),F=Math.floor((parseFloat(i.pickerWidth)-L)/i.numSwatchesPerLine),N=F*M+D*(M+1),k=(parseInt(i.pickerHeight)+N+Math.floor(.25*F)).toString()+"px",A=l.Color3.FromHexString("#dddddd"),z=A.r+A.g+A.b,Q=["R","G","B"],V=!1;function j(e,t){w=t;var i=e.toHexString();if(T.background=i,p.name!=w&&(p.text=Math.floor(255*e.r).toString()),b.name!=w&&(b.text=Math.floor(255*e.g).toString()),m.name!=w&&(m.text=Math.floor(255*e.b).toString()),v.name!=w&&(v.text=e.r.toString()),P.name!=w&&(P.text=e.g.toString()),B.name!=w&&(B.text=e.b.toString()),C.name!=w){var n=i.split("#");C.text=n[1]}f.name!=w&&(f.value=e)}function H(e,t){var i=e.text;if(/[^0-9]/g.test(i))e.text=R;else if(""!=i&&(Math.floor(parseInt(i))<0?i="0":Math.floor(parseInt(i))>255?i="255":isNaN(parseInt(i))&&(i="0")),w==e.name&&(R=i),""!=i){i=parseInt(i).toString(),e.text=i;var n=l.Color3.FromHexString(T.background);w==e.name&&j("r"==t?new l.Color3(parseInt(i)/255,n.g,n.b):"g"==t?new l.Color3(n.r,parseInt(i)/255,n.b):new l.Color3(n.r,n.g,parseInt(i)/255),e.name)}}function W(e,t){var i=e.text;if(/[^0-9\.]/g.test(i))e.text=R;else{""!=i&&"."!=i&&0!=parseFloat(i)&&(parseFloat(i)<0?i="0.0":parseFloat(i)>1?i="1.0":isNaN(parseFloat(i))&&(i="0.0")),w==e.name&&(R=i),""!=i&&"."!=i&&0!=parseFloat(i)?(i=parseFloat(i).toString(),e.text=i):i="0.0";var n=l.Color3.FromHexString(T.background);w==e.name&&j("r"==t?new l.Color3(parseFloat(i),n.g,n.b):"g"==t?new l.Color3(n.r,parseFloat(i),n.b):new l.Color3(n.r,n.g,parseFloat(i)),e.name)}}function G(){if(i.savedColors&&i.savedColors[u]){if(V)var e="b";else e="";var t=O.CreateSimpleButton("Swatch_"+u,e);t.fontFamily="BabylonJSglyphs";var n=l.Color3.FromHexString(i.savedColors[u]),o=n.r+n.g+n.b;t.color=o>z?"#aaaaaa":"#ffffff",t.fontSize=Math.floor(.7*F),t.textBlock.verticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,t.height=t.width=F.toString()+"px",t.background=i.savedColors[u],t.thickness=2;var r=u;return t.pointerDownAnimation=function(){t.thickness=4},t.pointerUpAnimation=function(){t.thickness=3},t.pointerEnterAnimation=function(){t.thickness=3},t.pointerOutAnimation=function(){t.thickness=2},t.onPointerClickObservable.add((function(){var e;V?(e=r,i.savedColors&&i.savedColors.splice(e,1),i.savedColors&&0==i.savedColors.length&&(X(!1),V=!1),Y("",Te)):i.savedColors&&j(l.Color3.FromHexString(i.savedColors[r]),t.name)})),t}return null}function U(e){if(void 0!==e&&(V=e),V){for(var t=0;t<d.children.length;t++)d.children[t].textBlock.text="b";void 0!==s&&(s.textBlock.text="Done")}else{for(t=0;t<d.children.length;t++)d.children[t].textBlock.text="";void 0!==s&&(s.textBlock.text="Edit")}}function Y(e,t){if(i.savedColors){""!=e&&i.savedColors.push(e),u=0,d.clearControls();var n=Math.ceil(i.savedColors.length/i.numSwatchesPerLine);if(0==n)var o=0;else o=n+1;if(d.rowCount!=n+o){for(var r=d.rowCount,a=0;a<r;a++)d.removeRowDefinition(0);for(a=0;a<n+o;a++)a%2?d.addRowDefinition(F,!0):d.addRowDefinition(D,!0)}d.height=(F*n+o*D).toString()+"px";for(var s=1,l=1;s<n+o;s+=2,l++){if(i.savedColors.length>l*i.numSwatchesPerLine)var _=i.numSwatchesPerLine;else _=i.savedColors.length-(l-1)*i.numSwatchesPerLine;for(var h=Math.min(Math.max(_,0),i.numSwatchesPerLine),c=0,f=1;c<h;c++)if(!(c>i.numSwatchesPerLine)){var p=G();null!=p&&(d.addControl(p,s,f),f+=2,u++)}}i.savedColors.length>=i.swatchLimit?K(t,!0):K(t,!1)}}function X(e){e?((s=O.CreateSimpleButton("butEdit","Edit")).width=_,s.height=h,s.left=Math.floor(.1*parseInt(_)).toString()+"px",s.top=(-1*parseFloat(s.left)).toString()+"px",s.verticalAlignment=g.VERTICAL_ALIGNMENT_BOTTOM,s.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,s.thickness=2,s.color="#c0c0c0",s.fontSize=a,s.background="#535353",s.onPointerEnterObservable.add((function(){s.background="#414141"})),s.onPointerOutObservable.add((function(){s.background="#535353"})),s.pointerDownAnimation=function(){s.background="515151"},s.pointerUpAnimation=function(){s.background="#414141"},s.onPointerClickObservable.add((function(){V=!V,U()})),_e.addControl(s,1,0)):_e.removeControl(s)}function K(e,t){t?(e.color="#555555",e.background="#454545"):(e.color="#c0c0c0",e.background="#535353")}function Z(t){i.savedColors&&i.savedColors.length>0?n({savedColors:i.savedColors,pickedColor:t}):n({pickedColor:t}),e.removeControl(q)}var q=new S;if(q.name="Dialog Container",q.width=i.pickerWidth,i.savedColors){q.height=k;var $=parseInt(i.pickerHeight)/parseInt(k);q.addRowDefinition($,!1),q.addRowDefinition(1-$,!1)}else q.height=i.pickerHeight,q.addRowDefinition(1,!1);if(e.addControl(q),i.savedColors){(d=new S).name="Swatch Drawer",d.verticalAlignment=g.VERTICAL_ALIGNMENT_TOP,d.background="#535353",d.width=i.pickerWidth;var J=i.savedColors.length/i.numSwatchesPerLine;if(0==J)var ee=0;else ee=J+1;d.height=(F*J+ee*D).toString()+"px",d.top=Math.floor(.25*F).toString()+"px";for(var te=0;te<2*Math.ceil(i.savedColors.length/i.numSwatchesPerLine)+1;te++)te%2!=0?d.addRowDefinition(F,!0):d.addRowDefinition(D,!0);for(te=0;te<2*i.numSwatchesPerLine+1;te++)te%2!=0?d.addColumnDefinition(F,!0):d.addColumnDefinition(D,!0);q.addControl(d,1,0)}var ie=new S;ie.name="Picker Panel",ie.height=i.pickerHeight;var ne=parseInt(i.headerHeight)/parseInt(i.pickerHeight),oe=[ne,1-ne];ie.addRowDefinition(oe[0],!1),ie.addRowDefinition(oe[1],!1),q.addControl(ie,0,0);var rt=new y;rt.name="Dialogue Header Bar",rt.background="#cccccc",rt.thickness=0,ie.addControl(rt,0,0);var re=O.CreateSimpleButton("closeButton","a");re.fontFamily="BabylonJSglyphs";var ae=l.Color3.FromHexString(rt.background);r=new l.Color3(1-ae.r,1-ae.g,1-ae.b),re.color=r.toHexString(),re.fontSize=Math.floor(.6*parseInt(i.headerHeight)),re.textBlock.textVerticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,re.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_RIGHT,re.height=re.width=i.headerHeight,re.background=rt.background,re.thickness=0,re.pointerDownAnimation=function(){},re.pointerUpAnimation=function(){re.background=rt.background},re.pointerEnterAnimation=function(){re.color=rt.background,re.background="red"},re.pointerOutAnimation=function(){re.color=r.toHexString(),re.background=rt.background},re.onPointerClickObservable.add((function(){Z(ye.background)})),ie.addControl(re,0,0);var se=new S;se.name="Dialogue Body",se.background="#535353";var le=[.4375,.5625];se.addRowDefinition(1,!1),se.addColumnDefinition(le[0],!1),se.addColumnDefinition(le[1],!1),ie.addControl(se,1,0);var _e=new S;_e.name="Picker Grid",_e.addRowDefinition(.85,!1),_e.addRowDefinition(.15,!1),se.addControl(_e,0,0),(f=new t).name="GUI Color Picker",i.pickerHeight<i.pickerWidth?f.width=.89:f.height=.89,f.value=l.Color3.FromHexString(i.lastColor),f.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_CENTER,f.verticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,f.onPointerDownObservable.add((function(){w=f.name,R="",U(!1)})),f.onValueChangedObservable.add((function(e){w==f.name&&j(e,f.name)})),_e.addControl(f,0,0);var he=new S;he.name="Dialogue Right Half",he.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT;var ce=[.514,.486];he.addRowDefinition(ce[0],!1),he.addRowDefinition(ce[1],!1),se.addControl(he,1,1);var dt=new S;dt.name="Swatches and Buttons";var ue=[.417,.583];dt.addRowDefinition(1,!1),dt.addColumnDefinition(ue[0],!1),dt.addColumnDefinition(ue[1],!1),he.addControl(dt,0,0);var de=new S;de.name="New and Current Swatches";var fe=[.04,.16,.64,.16];de.addRowDefinition(fe[0],!1),de.addRowDefinition(fe[1],!1),de.addRowDefinition(fe[2],!1),de.addRowDefinition(fe[3],!1),dt.addControl(de,0,0);var pe=new S;pe.name="Active Swatches",pe.width=.67,pe.addRowDefinition(.5,!1),pe.addRowDefinition(.5,!1),de.addControl(pe,2,0);var be=Math.floor(parseInt(i.pickerWidth)*le[1]*ue[0]*.11),ge=Math.floor(parseInt(i.pickerHeight)*oe[1]*ce[0]*fe[1]*.5);if(i.pickerWidth>i.pickerHeight)var me=ge;else me=be;var ve=new x;ve.text="new",ve.name="New Color Label",ve.color="#c0c0c0",ve.fontSize=me,de.addControl(ve,1,0),(T=new y).name="New Color Swatch",T.background=i.lastColor,T.thickness=0,pe.addControl(T,0,0);var ye=O.CreateSimpleButton("currentSwatch","");ye.background=i.lastColor,ye.thickness=0,ye.onPointerClickObservable.add((function(){j(l.Color3.FromHexString(ye.background),ye.name),U(!1)})),ye.pointerDownAnimation=function(){},ye.pointerUpAnimation=function(){},ye.pointerEnterAnimation=function(){},ye.pointerOutAnimation=function(){},pe.addControl(ye,1,0);var xe=new y;xe.name="Swatch Outline",xe.width=.67,xe.thickness=2,xe.color="#404040",xe.isHitTestVisible=!1,de.addControl(xe,2,0);var Pe=new x;Pe.name="Current Color Label",Pe.text="current",Pe.color="#c0c0c0",Pe.fontSize=me,de.addControl(Pe,3,0);var Oe=new S;Oe.name="Button Grid",Oe.height=.8,Oe.addRowDefinition(1/3,!1),Oe.addRowDefinition(1/3,!1),Oe.addRowDefinition(1/3,!1),dt.addControl(Oe,0,1),_=Math.floor(parseInt(i.pickerWidth)*le[1]*ue[1]*.67).toString()+"px",h=Math.floor(parseInt(i.pickerHeight)*oe[1]*ce[0]*(parseFloat(Oe.height.toString())/100)*(1/3)*.7).toString()+"px",a=parseFloat(_)>parseFloat(h)?Math.floor(.45*parseFloat(h)):Math.floor(.11*parseFloat(_));var Be=O.CreateSimpleButton("butOK","OK");Be.width=_,Be.height=h,Be.verticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,Be.thickness=2,Be.color="#c0c0c0",Be.fontSize=a,Be.background="#535353",Be.onPointerEnterObservable.add((function(){Be.background="#414141"})),Be.onPointerOutObservable.add((function(){Be.background="#535353"})),Be.pointerDownAnimation=function(){Be.background="515151"},Be.pointerUpAnimation=function(){Be.background="#414141"},Be.onPointerClickObservable.add((function(){U(!1),Z(T.background)})),Oe.addControl(Be,0,0);var Ce=O.CreateSimpleButton("butCancel","Cancel");if(Ce.width=_,Ce.height=h,Ce.verticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,Ce.thickness=2,Ce.color="#c0c0c0",Ce.fontSize=a,Ce.background="#535353",Ce.onPointerEnterObservable.add((function(){Ce.background="#414141"})),Ce.onPointerOutObservable.add((function(){Ce.background="#535353"})),Ce.pointerDownAnimation=function(){Ce.background="515151"},Ce.pointerUpAnimation=function(){Ce.background="#414141"},Ce.onPointerClickObservable.add((function(){U(!1),Z(ye.background)})),Oe.addControl(Ce,1,0),i.savedColors){var Te=O.CreateSimpleButton("butSave","Save");Te.width=_,Te.height=h,Te.verticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,Te.thickness=2,Te.fontSize=a,i.savedColors.length<i.swatchLimit?(Te.color="#c0c0c0",Te.background="#535353"):K(Te,!0),Te.onPointerEnterObservable.add((function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(Te.background="#414141")})),Te.onPointerOutObservable.add((function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(Te.background="#535353")})),Te.pointerDownAnimation=function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(Te.background="515151")},Te.pointerUpAnimation=function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(Te.background="#414141")},Te.onPointerClickObservable.add((function(){i.savedColors&&(0==i.savedColors.length&&X(!0),i.savedColors.length<i.swatchLimit&&Y(T.background,Te),U(!1))})),i.savedColors.length>0&&X(!0),Oe.addControl(Te,2,0)}var Ie=new S;Ie.name="Dialog Lower Right",Ie.addRowDefinition(.02,!1),Ie.addRowDefinition(.63,!1),Ie.addRowDefinition(.21,!1),Ie.addRowDefinition(.14,!1),he.addControl(Ie,1,0),c=l.Color3.FromHexString(i.lastColor);var Se=new S;for(Se.name="RGB Values",Se.width=.82,Se.verticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,Se.addRowDefinition(1/3,!1),Se.addRowDefinition(1/3,!1),Se.addRowDefinition(1/3,!1),Se.addColumnDefinition(.1,!1),Se.addColumnDefinition(.2,!1),Se.addColumnDefinition(.7,!1),Ie.addControl(Se,1,0),te=0;te<Q.length;te++)(Re=new x).text=Q[te],Re.color="#c0c0c0",Re.fontSize=a,Se.addControl(Re,te,0);(p=new I).width=.83,p.height=.72,p.name="rIntField",p.fontSize=a,p.text=(255*c.r).toString(),p.color="#f0f0f0",p.background="#454545",p.onFocusObservable.add((function(){w=p.name,R=p.text,U(!1)})),p.onBlurObservable.add((function(){""==p.text&&(p.text="0"),H(p,"r"),w==p.name&&(w="")})),p.onTextChangedObservable.add((function(){w==p.name&&H(p,"r")})),Se.addControl(p,0,1),(b=new I).width=.83,b.height=.72,b.name="gIntField",b.fontSize=a,b.text=(255*c.g).toString(),b.color="#f0f0f0",b.background="#454545",b.onFocusObservable.add((function(){w=b.name,R=b.text,U(!1)})),b.onBlurObservable.add((function(){""==b.text&&(b.text="0"),H(b,"g"),w==b.name&&(w="")})),b.onTextChangedObservable.add((function(){w==b.name&&H(b,"g")})),Se.addControl(b,1,1),(m=new I).width=.83,m.height=.72,m.name="bIntField",m.fontSize=a,m.text=(255*c.b).toString(),m.color="#f0f0f0",m.background="#454545",m.onFocusObservable.add((function(){w=m.name,R=m.text,U(!1)})),m.onBlurObservable.add((function(){""==m.text&&(m.text="0"),H(m,"b"),w==m.name&&(w="")})),m.onTextChangedObservable.add((function(){w==m.name&&H(m,"b")})),Se.addControl(m,2,1),(v=new I).width=.95,v.height=.72,v.name="rDecField",v.fontSize=a,v.text=c.r.toString(),v.color="#f0f0f0",v.background="#454545",v.onFocusObservable.add((function(){w=v.name,R=v.text,U(!1)})),v.onBlurObservable.add((function(){0!=parseFloat(v.text)&&""!=v.text||(v.text="0",W(v,"r")),w==v.name&&(w="")})),v.onTextChangedObservable.add((function(){w==v.name&&W(v,"r")})),Se.addControl(v,0,2),(P=new I).width=.95,P.height=.72,P.name="gDecField",P.fontSize=a,P.text=c.g.toString(),P.color="#f0f0f0",P.background="#454545",P.onFocusObservable.add((function(){w=P.name,R=P.text,U(!1)})),P.onBlurObservable.add((function(){0!=parseFloat(P.text)&&""!=P.text||(P.text="0",W(P,"g")),w==P.name&&(w="")})),P.onTextChangedObservable.add((function(){w==P.name&&W(P,"g")})),Se.addControl(P,1,2),(B=new I).width=.95,B.height=.72,B.name="bDecField",B.fontSize=a,B.text=c.b.toString(),B.color="#f0f0f0",B.background="#454545",B.onFocusObservable.add((function(){w=B.name,R=B.text,U(!1)})),B.onBlurObservable.add((function(){0!=parseFloat(B.text)&&""!=B.text||(B.text="0",W(B,"b")),w==B.name&&(w="")})),B.onTextChangedObservable.add((function(){w==B.name&&W(B,"b")})),Se.addControl(B,2,2);var Re,we=new S;we.name="Hex Value",we.width=.82,we.addRowDefinition(1,!1),we.addColumnDefinition(.1,!1),we.addColumnDefinition(.9,!1),Ie.addControl(we,2,0),(Re=new x).text="#",Re.color="#c0c0c0",Re.fontSize=a,we.addControl(Re,0,0),(C=new I).width=.96,C.height=.72,C.name="hexField",C.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_CENTER,C.fontSize=a;var Me=i.lastColor.split("#");C.text=Me[1],C.color="#f0f0f0",C.background="#454545",C.onFocusObservable.add((function(){w=C.name,R=C.text,U(!1)})),C.onBlurObservable.add((function(){if(3==C.text.length){var e=C.text.split("");C.text=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]}""==C.text&&(C.text="000000",j(l.Color3.FromHexString(C.text),"b")),w==C.name&&(w="")})),C.onTextChangedObservable.add((function(){var e=C.text,t=/[^0-9A-F]/i.test(e);if((C.text.length>6||t)&&w==C.name)C.text=R;else{if(C.text.length<6)for(var i=6-C.text.length,n=0;n<i;n++)e="0"+e;if(3==C.text.length){var o=C.text.split("");e=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]}e="#"+e,w==C.name&&(R=C.text,j(l.Color3.FromHexString(e),C.name))}})),we.addControl(C,0,1),i.savedColors&&i.savedColors.length>0&&Y("",Te)}))},t._Epsilon=1e-6,r([Object(l.serialize)()],t.prototype,"value",null),r([Object(l.serialize)()],t.prototype,"width",null),r([Object(l.serialize)()],t.prototype,"height",null),r([Object(l.serialize)()],t.prototype,"size",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.ColorPicker",R);var w=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._thickness=1,i}return o(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Ellipse"},t.prototype._localDraw=function(e){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),g.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,e),this._background&&(e.fillStyle=this._background,e.fill()),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._thickness&&(this.color&&(e.strokeStyle=this.color),e.lineWidth=this._thickness,e.stroke()),e.restore()},t.prototype._additionalProcessing=function(t,i){e.prototype._additionalProcessing.call(this,t,i),this._measureForChildren.width-=2*this._thickness,this._measureForChildren.height-=2*this._thickness,this._measureForChildren.left+=this._thickness,this._measureForChildren.top+=this._thickness},t.prototype._clipForChildren=function(e){g.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2,this._currentMeasure.height/2,e),e.clip()},t.prototype._renderHighlightSpecific=function(e){g.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._highlightLineWidth/2,this._currentMeasure.height/2-this._highlightLineWidth/2,e),e.stroke()},r([Object(l.serialize)()],t.prototype,"thickness",null),t}(m);Object(l.RegisterClass)("BABYLON.GUI.Ellipse",w);var M=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i.focusedColor=null,i._isFocused=!1,i._unfocusedColor=null,i.onFocusObservable=new l.Observable,i.onBlurObservable=new l.Observable,i.onKeyboardEventProcessedObservable=new l.Observable,i._unfocusedColor=i.color,i}return o(t,e),t.prototype.onBlur=function(){this._isFocused&&(this._isFocused=!1,this.focusedColor&&null!=this._unfocusedColor&&(this.color=this._unfocusedColor),this.onBlurObservable.notifyObservers(this))},t.prototype.onFocus=function(){this._isFocused=!0,this.focusedColor&&(this._unfocusedColor=this.color,this.color=this.focusedColor),this.onFocusObservable.notifyObservers(this)},t.prototype.keepsFocusWith=function(){return null},t.prototype.focus=function(){this._host.moveFocusToControl(this)},t.prototype.blur=function(){this._host.focusedControl=null},t.prototype.processKeyboard=function(e){this.onKeyboardEventProcessedObservable.notifyObservers(e,-1,this)},t.prototype._onPointerDown=function(t,i,n,o,r){return this.isReadOnly||this.focus(),e.prototype._onPointerDown.call(this,t,i,n,o,r)},t.prototype.displose=function(){e.prototype.dispose.call(this),this.onBlurObservable.clear(),this.onFocusObservable.clear(),this.onKeyboardEventProcessedObservable.clear()},t}(O);Object(l.RegisterClass)("BABYLON.GUI.FocusableButton",M);var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype._beforeRenderText=function(e){for(var t=new T,i="",n=0;n<e.length;n++)i+="";return t.text=i,t},t}(I);Object(l.RegisterClass)("BABYLON.GUI.InputPassword",E);var D=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._lineWidth=1,i._x1=new _(0),i._y1=new _(0),i._x2=new _(0),i._y2=new _(0),i._dash=new Array,i._automaticSize=!0,i.isHitTestVisible=!1,i._horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,i._verticalAlignment=g.VERTICAL_ALIGNMENT_TOP,i}return o(t,e),Object.defineProperty(t.prototype,"dash",{get:function(){return this._dash},set:function(e){this._dash!==e&&(this._dash=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectedControl",{get:function(){return this._connectedControl},set:function(e){var t=this;this._connectedControl!==e&&(this._connectedControlDirtyObserver&&this._connectedControl&&(this._connectedControl.onDirtyObservable.remove(this._connectedControlDirtyObserver),this._connectedControlDirtyObserver=null),e&&(this._connectedControlDirtyObserver=e.onDirtyObservable.add((function(){return t._markAsDirty()}))),this._connectedControl=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x1",{get:function(){return this._x1.toString(this._host)},set:function(e){this._x1.toString(this._host)!==e&&this._x1.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y1",{get:function(){return this._y1.toString(this._host)},set:function(e){this._y1.toString(this._host)!==e&&this._y1.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x2",{get:function(){return this._x2.toString(this._host)},set:function(e){this._x2.toString(this._host)!==e&&this._x2.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y2",{get:function(){return this._y2.toString(this._host)},set:function(e){this._y2.toString(this._host)!==e&&this._y2.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(e){this._lineWidth!==e&&(this._lineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_effectiveX2",{get:function(){return(this._connectedControl?this._connectedControl.centerX:0)+this._x2.getValue(this._host)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_effectiveY2",{get:function(){return(this._connectedControl?this._connectedControl.centerY:0)+this._y2.getValue(this._host)},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Line"},t.prototype._draw=function(e){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._applyStates(e),e.strokeStyle=this.color,e.lineWidth=this._lineWidth,e.setLineDash(this._dash),e.beginPath(),e.moveTo(this._cachedParentMeasure.left+this._x1.getValue(this._host),this._cachedParentMeasure.top+this._y1.getValue(this._host)),e.lineTo(this._cachedParentMeasure.left+this._effectiveX2,this._cachedParentMeasure.top+this._effectiveY2),e.stroke(),e.restore()},t.prototype._measure=function(){this._currentMeasure.width=Math.abs(this._x1.getValue(this._host)-this._effectiveX2)+this._lineWidth,this._currentMeasure.height=Math.abs(this._y1.getValue(this._host)-this._effectiveY2)+this._lineWidth},t.prototype._computeAlignment=function(e,t){this._currentMeasure.left=e.left+Math.min(this._x1.getValue(this._host),this._effectiveX2)-this._lineWidth/2,this._currentMeasure.top=e.top+Math.min(this._y1.getValue(this._host),this._effectiveY2)-this._lineWidth/2},t.prototype.moveToVector3=function(e,t,i){if(void 0===i&&(i=!1),this._host&&this.parent===this._host._rootContainer){var n=this._host._getGlobalViewport(),o=l.Vector3.Project(e,l.Matrix.Identity(),t.getTransformMatrix(),n);this._moveToProjectedPosition(o,i),o.z<0||o.z>1?this.notRenderable=!0:this.notRenderable=!1}else l.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},t.prototype._moveToProjectedPosition=function(e,t){void 0===t&&(t=!1);var i=e.x+this._linkOffsetX.getValue(this._host)+"px",n=e.y+this._linkOffsetY.getValue(this._host)+"px";t?(this.x2=i,this.y2=n,this._x2.ignoreAdaptiveScaling=!0,this._y2.ignoreAdaptiveScaling=!0):(this.x1=i,this.y1=n,this._x1.ignoreAdaptiveScaling=!0,this._y1.ignoreAdaptiveScaling=!0)},r([Object(l.serialize)()],t.prototype,"dash",null),r([Object(l.serialize)()],t.prototype,"x1",null),r([Object(l.serialize)()],t.prototype,"y1",null),r([Object(l.serialize)()],t.prototype,"x2",null),r([Object(l.serialize)()],t.prototype,"y2",null),r([Object(l.serialize)()],t.prototype,"lineWidth",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.Line",D);var L=function(){function e(e){this._multiLine=e,this._x=new _(0),this._y=new _(0),this._point=new l.Vector3(0,0,0)}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x.toString(this._multiLine._host)},set:function(e){this._x.toString(this._multiLine._host)!==e&&this._x.fromString(e)&&this._multiLine._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y.toString(this._multiLine._host)},set:function(e){this._y.toString(this._multiLine._host)!==e&&this._y.fromString(e)&&this._multiLine._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"control",{get:function(){return this._control},set:function(e){this._control!==e&&(this._control&&this._controlObserver&&(this._control.onDirtyObservable.remove(this._controlObserver),this._controlObserver=null),this._control=e,this._control&&(this._controlObserver=this._control.onDirtyObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mesh",{get:function(){return this._mesh},set:function(e){this._mesh!==e&&(this._mesh&&this._meshObserver&&this._mesh.getScene().onAfterCameraRenderObservable.remove(this._meshObserver),this._mesh=e,this._mesh&&(this._meshObserver=this._mesh.getScene().onAfterCameraRenderObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype.resetLinks=function(){this.control=null,this.mesh=null},e.prototype.translate=function(){return this._point=this._translatePoint(),this._point},e.prototype._translatePoint=function(){if(null!=this._mesh)return this._multiLine._host.getProjectedPositionWithZ(this._mesh.getBoundingInfo().boundingSphere.center,this._mesh.getWorldMatrix());if(null!=this._control)return new l.Vector3(this._control.centerX,this._control.centerY,1-l.Epsilon);var e=this._multiLine._host,t=this._x.getValueInPixel(e,Number(e._canvas.width)),i=this._y.getValueInPixel(e,Number(e._canvas.height));return new l.Vector3(t,i,1-l.Epsilon)},e.prototype.dispose=function(){this.resetLinks()},e}(),F=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._lineWidth=1,i.onPointUpdate=function(){i._markAsDirty()},i._automaticSize=!0,i.isHitTestVisible=!1,i._horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,i._verticalAlignment=g.VERTICAL_ALIGNMENT_TOP,i._dash=[],i._points=[],i}return o(t,e),Object.defineProperty(t.prototype,"dash",{get:function(){return this._dash},set:function(e){this._dash!==e&&(this._dash=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype.getAt=function(e){return this._points[e]||(this._points[e]=new L(this)),this._points[e]},t.prototype.add=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.map((function(t){return e.push(t)}))},t.prototype.push=function(e){var t=this.getAt(this._points.length);return null==e||(e instanceof l.AbstractMesh?t.mesh=e:e instanceof g?t.control=e:null!=e.x&&null!=e.y&&(t.x=e.x,t.y=e.y)),t},t.prototype.remove=function(e){var t;if(e instanceof L){if(-1===(t=this._points.indexOf(e)))return}else t=e;var i=this._points[t];i&&(i.dispose(),this._points.splice(t,1))},t.prototype.reset=function(){for(;this._points.length>0;)this.remove(this._points.length-1)},t.prototype.resetLinks=function(){this._points.forEach((function(e){null!=e&&e.resetLinks()}))},Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(e){this._lineWidth!==e&&(this._lineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"MultiLine"},t.prototype._draw=function(e,t){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._applyStates(e),e.strokeStyle=this.color,e.lineWidth=this._lineWidth,e.setLineDash(this._dash),e.beginPath();var i,n=!0;this._points.forEach((function(t){t&&(n?(e.moveTo(t._point.x,t._point.y),n=!1):t._point.z<1&&i.z<1?e.lineTo(t._point.x,t._point.y):e.moveTo(t._point.x,t._point.y),i=t._point)})),e.stroke(),e.restore()},t.prototype._additionalProcessing=function(e,t){var i=this;this._minX=null,this._minY=null,this._maxX=null,this._maxY=null,this._points.forEach((function(e,t){e&&(e.translate(),(null==i._minX||e._point.x<i._minX)&&(i._minX=e._point.x),(null==i._minY||e._point.y<i._minY)&&(i._minY=e._point.y),(null==i._maxX||e._point.x>i._maxX)&&(i._maxX=e._point.x),(null==i._maxY||e._point.y>i._maxY)&&(i._maxY=e._point.y))})),null==this._minX&&(this._minX=0),null==this._minY&&(this._minY=0),null==this._maxX&&(this._maxX=0),null==this._maxY&&(this._maxY=0)},t.prototype._measure=function(){null!=this._minX&&null!=this._maxX&&null!=this._minY&&null!=this._maxY&&(this._currentMeasure.width=Math.abs(this._maxX-this._minX)+this._lineWidth,this._currentMeasure.height=Math.abs(this._maxY-this._minY)+this._lineWidth)},t.prototype._computeAlignment=function(e,t){null!=this._minX&&null!=this._minY&&(this._currentMeasure.left=this._minX-this._lineWidth/2,this._currentMeasure.top=this._minY-this._lineWidth/2)},t.prototype.dispose=function(){this.reset(),e.prototype.dispose.call(this)},r([Object(l.serialize)()],t.prototype,"dash",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.MultiLine",F);var N=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._isChecked=!1,i._background="black",i._checkSizeRatio=.8,i._thickness=1,i.group="",i.onIsCheckedChangedObservable=new l.Observable,i.isPointerBlocker=!0,i}return o(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(e){e=Math.max(Math.min(1,e),0),this._checkSizeRatio!==e&&(this._checkSizeRatio=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(e){var t=this;this._isChecked!==e&&(this._isChecked=e,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(e),this._isChecked&&this._host&&this._host.executeOnAllControls((function(e){if(e!==t&&void 0!==e.group){var i=e;i.group===t.group&&(i.isChecked=!1)}})))},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"RadioButton"},t.prototype._draw=function(e){e.save(),this._applyStates(e);var t=this._currentMeasure.width-this._thickness,i=this._currentMeasure.height-this._thickness;if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),g.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,e),e.fillStyle=this._isEnabled?this._background:this._disabledColor,e.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.strokeStyle=this.color,e.lineWidth=this._thickness,e.stroke(),this._isChecked){e.fillStyle=this._isEnabled?this.color:this._disabledColor;var n=t*this._checkSizeRatio,o=i*this._checkSizeRatio;g.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,n/2-this._thickness/2,o/2-this._thickness/2,e),e.fill()}e.restore()},t.prototype._onPointerDown=function(t,i,n,o,r){return!!e.prototype._onPointerDown.call(this,t,i,n,o,r)&&(this.isReadOnly||this.isChecked||(this.isChecked=!0),!0)},t.AddRadioButtonWithHeader=function(e,i,n,o){var r=new B;r.isVertical=!1,r.height="30px";var a=new t;a.width="20px",a.height="20px",a.isChecked=n,a.color="green",a.group=i,a.onIsCheckedChangedObservable.add((function(e){return o(a,e)})),r.addControl(a);var s=new x;return s.text=e,s.width="180px",s.paddingLeft="5px",s.textHorizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,s.color="white",r.addControl(s),r},r([Object(l.serialize)()],t.prototype,"thickness",null),r([Object(l.serialize)()],t.prototype,"group",void 0),r([Object(l.serialize)()],t.prototype,"checkSizeRatio",null),r([Object(l.serialize)()],t.prototype,"background",null),r([Object(l.serialize)()],t.prototype,"isChecked",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.RadioButton",N);var k=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._thumbWidth=new _(20,_.UNITMODE_PIXEL,!1),i._minimum=0,i._maximum=100,i._value=50,i._isVertical=!1,i._barOffset=new _(5,_.UNITMODE_PIXEL,!1),i._isThumbClamped=!1,i._displayThumb=!0,i._step=0,i._lastPointerDownId=-1,i._effectiveBarOffset=0,i.onValueChangedObservable=new l.Observable,i._pointerIsDown=!1,i.isPointerBlocker=!0,i}return o(t,e),Object.defineProperty(t.prototype,"displayThumb",{get:function(){return this._displayThumb},set:function(e){this._displayThumb!==e&&(this._displayThumb=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(e){this._step!==e&&(this._step=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barOffset",{get:function(){return this._barOffset.toString(this._host)},set:function(e){this._barOffset.toString(this._host)!==e&&this._barOffset.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barOffsetInPixels",{get:function(){return this._barOffset.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbWidth",{get:function(){return this._thumbWidth.toString(this._host)},set:function(e){this._thumbWidth.toString(this._host)!==e&&this._thumbWidth.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbWidthInPixels",{get:function(){return this._thumbWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minimum",{get:function(){return this._minimum},set:function(e){this._minimum!==e&&(this._minimum=e,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this._maximum},set:function(e){this._maximum!==e&&(this._maximum=e,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){e=Math.max(Math.min(e,this._maximum),this._minimum),this._value!==e&&(this._value=e,this._markAsDirty(),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){this._isVertical!==e&&(this._isVertical=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isThumbClamped",{get:function(){return this._isThumbClamped},set:function(e){this._isThumbClamped!==e&&(this._isThumbClamped=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"BaseSlider"},t.prototype._getThumbPosition=function(){return this.isVertical?(this.maximum-this.value)/(this.maximum-this.minimum)*this._backgroundBoxLength:(this.value-this.minimum)/(this.maximum-this.minimum)*this._backgroundBoxLength},t.prototype._getThumbThickness=function(e){var t=0;switch(e){case"circle":t=this._thumbWidth.isPixel?Math.max(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host);break;case"rectangle":t=this._thumbWidth.isPixel?Math.min(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)}return t},t.prototype._prepareRenderingData=function(e){this._effectiveBarOffset=0,this._renderLeft=this._currentMeasure.left,this._renderTop=this._currentMeasure.top,this._renderWidth=this._currentMeasure.width,this._renderHeight=this._currentMeasure.height,this._backgroundBoxLength=Math.max(this._currentMeasure.width,this._currentMeasure.height),this._backgroundBoxThickness=Math.min(this._currentMeasure.width,this._currentMeasure.height),this._effectiveThumbThickness=this._getThumbThickness(e),this.displayThumb&&(this._backgroundBoxLength-=this._effectiveThumbThickness),this.isVertical&&this._currentMeasure.height<this._currentMeasure.width?console.error("Height should be greater than width"):(this._barOffset.isPixel?this._effectiveBarOffset=Math.min(this._barOffset.getValue(this._host),this._backgroundBoxThickness):this._effectiveBarOffset=this._backgroundBoxThickness*this._barOffset.getValue(this._host),this._backgroundBoxThickness-=2*this._effectiveBarOffset,this.isVertical?(this._renderLeft+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderTop+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxLength,this._renderWidth=this._backgroundBoxThickness):(this._renderTop+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderLeft+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxThickness,this._renderWidth=this._backgroundBoxLength))},t.prototype._updateValueFromPointer=function(e,t){var i;0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y),i=this._isVertical?this._minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this._maximum-this._minimum):this._minimum+(e-this._currentMeasure.left)/this._currentMeasure.width*(this._maximum-this._minimum),this.value=this._step?(i/this._step|0)*this._step:i},t.prototype._onPointerDown=function(t,i,n,o,r){return!!e.prototype._onPointerDown.call(this,t,i,n,o,r)&&(this.isReadOnly||(this._pointerIsDown=!0,this._updateValueFromPointer(i.x,i.y),this._host._capturingControl[n]=this,this._lastPointerDownId=n),!0)},t.prototype._onPointerMove=function(t,i,n,o){n==this._lastPointerDownId&&(this._pointerIsDown&&!this.isReadOnly&&this._updateValueFromPointer(i.x,i.y),e.prototype._onPointerMove.call(this,t,i,n,o))},t.prototype._onPointerUp=function(t,i,n,o,r){this._pointerIsDown=!1,delete this._host._capturingControl[n],e.prototype._onPointerUp.call(this,t,i,n,o,r)},t.prototype._onCanvasBlur=function(){this._forcePointerUp(),e.prototype._onCanvasBlur.call(this)},r([Object(l.serialize)()],t.prototype,"displayThumb",null),r([Object(l.serialize)()],t.prototype,"step",null),r([Object(l.serialize)()],t.prototype,"barOffset",null),r([Object(l.serialize)()],t.prototype,"thumbWidth",null),r([Object(l.serialize)()],t.prototype,"minimum",null),r([Object(l.serialize)()],t.prototype,"maximum",null),r([Object(l.serialize)()],t.prototype,"value",null),r([Object(l.serialize)()],t.prototype,"isVertical",null),r([Object(l.serialize)()],t.prototype,"isThumbClamped",null),t}(g),A=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._background="black",i._borderColor="white",i._thumbColor="",i._isThumbCircle=!1,i._displayValueBar=!0,i}return o(t,e),Object.defineProperty(t.prototype,"displayValueBar",{get:function(){return this._displayValueBar},set:function(e){this._displayValueBar!==e&&(this._displayValueBar=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderColor",{get:function(){return this._borderColor},set:function(e){this._borderColor!==e&&(this._borderColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbColor",{get:function(){return this._thumbColor},set:function(e){this._thumbColor!==e&&(this._thumbColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isThumbCircle",{get:function(){return this._isThumbCircle},set:function(e){this._isThumbCircle!==e&&(this._isThumbCircle=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Slider"},t.prototype._draw=function(e,t){e.save(),this._applyStates(e),this._prepareRenderingData(this.isThumbCircle?"circle":"rectangle");var i=this._renderLeft,n=this._renderTop,o=this._renderWidth,r=this._renderHeight,a=0;this.isThumbClamped&&this.isThumbCircle?(this.isVertical?n+=this._effectiveThumbThickness/2:i+=this._effectiveThumbThickness/2,a=this._backgroundBoxThickness/2):a=(this._effectiveThumbThickness-this._effectiveBarOffset)/2,(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY);var s=this._getThumbPosition();e.fillStyle=this._background,this.isVertical?this.isThumbClamped?this.isThumbCircle?(e.beginPath(),e.arc(i+this._backgroundBoxThickness/2,n,a,Math.PI,2*Math.PI),e.fill(),e.fillRect(i,n,o,r)):e.fillRect(i,n,o,r+this._effectiveThumbThickness):e.fillRect(i,n,o,r):this.isThumbClamped?this.isThumbCircle?(e.beginPath(),e.arc(i+this._backgroundBoxLength,n+this._backgroundBoxThickness/2,a,0,2*Math.PI),e.fill(),e.fillRect(i,n,o,r)):e.fillRect(i,n,o+this._effectiveThumbThickness,r):e.fillRect(i,n,o,r),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillStyle=this.color,this._displayValueBar&&(this.isVertical?this.isThumbClamped?this.isThumbCircle?(e.beginPath(),e.arc(i+this._backgroundBoxThickness/2,n+this._backgroundBoxLength,a,0,2*Math.PI),e.fill(),e.fillRect(i,n+s,o,r-s)):e.fillRect(i,n+s,o,r-s+this._effectiveThumbThickness):e.fillRect(i,n+s,o,r-s):this.isThumbClamped&&this.isThumbCircle?(e.beginPath(),e.arc(i,n+this._backgroundBoxThickness/2,a,0,2*Math.PI),e.fill(),e.fillRect(i,n,s,r)):e.fillRect(i,n,s,r)),e.fillStyle=this._thumbColor||this.color,this.displayThumb&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._isThumbCircle?(e.beginPath(),this.isVertical?e.arc(i+this._backgroundBoxThickness/2,n+s,a,0,2*Math.PI):e.arc(i+s,n+this._backgroundBoxThickness/2,a,0,2*Math.PI),e.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.strokeStyle=this._borderColor,e.stroke()):(this.isVertical?e.fillRect(i-this._effectiveBarOffset,this._currentMeasure.top+s,this._currentMeasure.width,this._effectiveThumbThickness):e.fillRect(this._currentMeasure.left+s,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.strokeStyle=this._borderColor,this.isVertical?e.strokeRect(i-this._effectiveBarOffset,this._currentMeasure.top+s,this._currentMeasure.width,this._effectiveThumbThickness):e.strokeRect(this._currentMeasure.left+s,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height))),e.restore()},r([Object(l.serialize)()],t.prototype,"displayValueBar",null),r([Object(l.serialize)()],t.prototype,"borderColor",null),r([Object(l.serialize)()],t.prototype,"background",null),r([Object(l.serialize)()],t.prototype,"thumbColor",null),r([Object(l.serialize)()],t.prototype,"isThumbCircle",null),t}(k);Object(l.RegisterClass)("BABYLON.GUI.Slider",A);var z=function(){function e(e){this.name=e,this._groupPanel=new B,this._selectors=new Array,this._groupPanel.verticalAlignment=g.VERTICAL_ALIGNMENT_TOP,this._groupPanel.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,this._groupHeader=this._addGroupHeader(e)}return Object.defineProperty(e.prototype,"groupPanel",{get:function(){return this._groupPanel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectors",{get:function(){return this._selectors},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"header",{get:function(){return this._groupHeader.text},set:function(e){"label"!==this._groupHeader.text&&(this._groupHeader.text=e)},enumerable:!1,configurable:!0}),e.prototype._addGroupHeader=function(e){var t=new x("groupHead",e);return t.width=.9,t.height="30px",t.textWrapping=!0,t.color="black",t.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,t.textHorizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,t.left="2px",this._groupPanel.addControl(t),t},e.prototype._getSelector=function(e){if(!(e<0||e>=this._selectors.length))return this._selectors[e]},e.prototype.removeSelector=function(e){e<0||e>=this._selectors.length||(this._groupPanel.removeControl(this._selectors[e]),this._selectors.splice(e,1))},e}(),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.addCheckbox=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=!1),i=i||!1;var n=new C;n.width="20px",n.height="20px",n.color="#364249",n.background="#CCCCCC",n.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,n.onIsCheckedChangedObservable.add((function(e){t(e)}));var o=g.AddHeader(n,e,"200px",{isHorizontal:!0,controlFirst:!0});o.height="30px",o.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,o.left="4px",this.groupPanel.addControl(o),this.selectors.push(o),n.isChecked=i,this.groupPanel.parent&&this.groupPanel.parent.parent&&(n.color=this.groupPanel.parent.parent.buttonColor,n.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(e,t){this.selectors[e].children[1].text=t},t.prototype._setSelectorLabelColor=function(e,t){this.selectors[e].children[1].color=t},t.prototype._setSelectorButtonColor=function(e,t){this.selectors[e].children[0].color=t},t.prototype._setSelectorButtonBackground=function(e,t){this.selectors[e].children[0].background=t},t}(z),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._selectNb=0,t}return o(t,e),t.prototype.addRadio=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=!1);var n=this._selectNb++,o=new N;o.name=e,o.width="20px",o.height="20px",o.color="#364249",o.background="#CCCCCC",o.group=this.name,o.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,o.onIsCheckedChangedObservable.add((function(e){e&&t(n)}));var r=g.AddHeader(o,e,"200px",{isHorizontal:!0,controlFirst:!0});r.height="30px",r.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,r.left="4px",this.groupPanel.addControl(r),this.selectors.push(r),o.isChecked=i,this.groupPanel.parent&&this.groupPanel.parent.parent&&(o.color=this.groupPanel.parent.parent.buttonColor,o.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(e,t){this.selectors[e].children[1].text=t},t.prototype._setSelectorLabelColor=function(e,t){this.selectors[e].children[1].color=t},t.prototype._setSelectorButtonColor=function(e,t){this.selectors[e].children[0].color=t},t.prototype._setSelectorButtonBackground=function(e,t){this.selectors[e].children[0].background=t},t}(z),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.addSlider=function(e,t,i,n,o,r,a){void 0===t&&(t=function(e){}),void 0===i&&(i="Units"),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=function(e){return 0|e});var s=new A;s.name=i,s.value=r,s.minimum=n,s.maximum=o,s.width=.9,s.height="20px",s.color="#364249",s.background="#CCCCCC",s.borderColor="black",s.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,s.left="4px",s.paddingBottom="4px",s.onValueChangedObservable.add((function(e){s.parent.children[0].text=s.parent.children[0].name+": "+a(e)+" "+s.name,t(e)}));var l=g.AddHeader(s,e+": "+a(r)+" "+i,"30px",{isHorizontal:!1,controlFirst:!1});l.height="60px",l.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,l.left="4px",l.children[0].name=e,this.groupPanel.addControl(l),this.selectors.push(l),this.groupPanel.parent&&this.groupPanel.parent.parent&&(s.color=this.groupPanel.parent.parent.buttonColor,s.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(e,t){this.selectors[e].children[0].name=t,this.selectors[e].children[0].text=t+": "+this.selectors[e].children[1].value+" "+this.selectors[e].children[1].name},t.prototype._setSelectorLabelColor=function(e,t){this.selectors[e].children[0].color=t},t.prototype._setSelectorButtonColor=function(e,t){this.selectors[e].children[1].color=t},t.prototype._setSelectorButtonBackground=function(e,t){this.selectors[e].children[1].background=t},t}(z),H=function(e){function t(t,i){void 0===i&&(i=[]);var n=e.call(this,t)||this;if(n.name=t,n.groups=i,n._buttonColor="#364249",n._buttonBackground="#CCCCCC",n._headerColor="black",n._barColor="white",n._barHeight="2px",n._spacerHeight="20px",n._bars=new Array,n._groups=i,n.thickness=2,n._panel=new B,n._panel.verticalAlignment=g.VERTICAL_ALIGNMENT_TOP,n._panel.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,n._panel.top=5,n._panel.left=5,n._panel.width=.95,i.length>0){for(var o=0;o<i.length-1;o++)n._panel.addControl(i[o].groupPanel),n._addSpacer();n._panel.addControl(i[i.length-1].groupPanel)}return n.addControl(n._panel),n}return o(t,e),t.prototype._getTypeName=function(){return"SelectionPanel"},Object.defineProperty(t.prototype,"panel",{get:function(){return this._panel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerColor",{get:function(){return this._headerColor},set:function(e){this._headerColor!==e&&(this._headerColor=e,this._setHeaderColor())},enumerable:!1,configurable:!0}),t.prototype._setHeaderColor=function(){for(var e=0;e<this._groups.length;e++)this._groups[e].groupPanel.children[0].color=this._headerColor},Object.defineProperty(t.prototype,"buttonColor",{get:function(){return this._buttonColor},set:function(e){this._buttonColor!==e&&(this._buttonColor=e,this._setbuttonColor())},enumerable:!1,configurable:!0}),t.prototype._setbuttonColor=function(){for(var e=0;e<this._groups.length;e++)for(var t=0;t<this._groups[e].selectors.length;t++)this._groups[e]._setSelectorButtonColor(t,this._buttonColor)},Object.defineProperty(t.prototype,"labelColor",{get:function(){return this._labelColor},set:function(e){this._labelColor!==e&&(this._labelColor=e,this._setLabelColor())},enumerable:!1,configurable:!0}),t.prototype._setLabelColor=function(){for(var e=0;e<this._groups.length;e++)for(var t=0;t<this._groups[e].selectors.length;t++)this._groups[e]._setSelectorLabelColor(t,this._labelColor)},Object.defineProperty(t.prototype,"buttonBackground",{get:function(){return this._buttonBackground},set:function(e){this._buttonBackground!==e&&(this._buttonBackground=e,this._setButtonBackground())},enumerable:!1,configurable:!0}),t.prototype._setButtonBackground=function(){for(var e=0;e<this._groups.length;e++)for(var t=0;t<this._groups[e].selectors.length;t++)this._groups[e]._setSelectorButtonBackground(t,this._buttonBackground)},Object.defineProperty(t.prototype,"barColor",{get:function(){return this._barColor},set:function(e){this._barColor!==e&&(this._barColor=e,this._setBarColor())},enumerable:!1,configurable:!0}),t.prototype._setBarColor=function(){for(var e=0;e<this._bars.length;e++)this._bars[e].children[0].background=this._barColor},Object.defineProperty(t.prototype,"barHeight",{get:function(){return this._barHeight},set:function(e){this._barHeight!==e&&(this._barHeight=e,this._setBarHeight())},enumerable:!1,configurable:!0}),t.prototype._setBarHeight=function(){for(var e=0;e<this._bars.length;e++)this._bars[e].children[0].height=this._barHeight},Object.defineProperty(t.prototype,"spacerHeight",{get:function(){return this._spacerHeight},set:function(e){this._spacerHeight!==e&&(this._spacerHeight=e,this._setSpacerHeight())},enumerable:!1,configurable:!0}),t.prototype._setSpacerHeight=function(){for(var e=0;e<this._bars.length;e++)this._bars[e].height=this._spacerHeight},t.prototype._addSpacer=function(){var e=new m;e.width=1,e.height=this._spacerHeight,e.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT;var t=new y;t.width=1,t.height=this._barHeight,t.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,t.verticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,t.background=this._barColor,t.color="transparent",e.addControl(t),this._panel.addControl(e),this._bars.push(e)},t.prototype.addGroup=function(e){this._groups.length>0&&this._addSpacer(),this._panel.addControl(e.groupPanel),this._groups.push(e),e.groupPanel.children[0].color=this._headerColor;for(var t=0;t<e.selectors.length;t++)e._setSelectorButtonColor(t,this._buttonColor),e._setSelectorButtonBackground(t,this._buttonBackground)},t.prototype.removeGroup=function(e){if(!(e<0||e>=this._groups.length)){var t=this._groups[e];this._panel.removeControl(t.groupPanel),this._groups.splice(e,1),e<this._bars.length&&(this._panel.removeControl(this._bars[e]),this._bars.splice(e,1))}},t.prototype.setHeaderName=function(e,t){t<0||t>=this._groups.length||(this._groups[t].groupPanel.children[0].text=e)},t.prototype.relabel=function(e,t,i){if(!(t<0||t>=this._groups.length)){var n=this._groups[t];i<0||i>=n.selectors.length||n._setSelectorLabel(i,e)}},t.prototype.removeFromGroupSelector=function(e,t){if(!(e<0||e>=this._groups.length)){var i=this._groups[e];t<0||t>=i.selectors.length||i.removeSelector(t)}},t.prototype.addToGroupCheckbox=function(e,t,i,n){void 0===i&&(i=function(){}),void 0===n&&(n=!1),e<0||e>=this._groups.length||this._groups[e].addCheckbox(t,i,n)},t.prototype.addToGroupRadio=function(e,t,i,n){void 0===i&&(i=function(){}),void 0===n&&(n=!1),e<0||e>=this._groups.length||this._groups[e].addRadio(t,i,n)},t.prototype.addToGroupSlider=function(e,t,i,n,o,r,a,s){void 0===i&&(i=function(){}),void 0===n&&(n="Units"),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===s&&(s=function(e){return 0|e}),e<0||e>=this._groups.length||this._groups[e].addSlider(t,i,n,o,r,a,s)},t}(y),W=function(e){function t(t){var i=e.call(this,t)||this;return i._freezeControls=!1,i._bucketWidth=0,i._bucketHeight=0,i._buckets={},i}return o(t,e),Object.defineProperty(t.prototype,"freezeControls",{get:function(){return this._freezeControls},set:function(e){if(this._freezeControls!==e){e||this._restoreMeasures(),this._freezeControls=!1;var t=this.host.getSize(),i=t.width,n=t.height,o=this.host.getContext(),r=new f(0,0,i,n);this.host._numLayoutCalls=0,this.host._rootContainer._layout(r,o),e&&(this._updateMeasures(),this._useBuckets()&&this._makeBuckets()),this._freezeControls=e,this.host.markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketWidth",{get:function(){return this._bucketWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketHeight",{get:function(){return this._bucketHeight},enumerable:!1,configurable:!0}),t.prototype.setBucketSizes=function(e,t){this._bucketWidth=e,this._bucketHeight=t,this._useBuckets()?this._freezeControls&&this._makeBuckets():this._buckets={}},t.prototype._useBuckets=function(){return this._bucketWidth>0&&this._bucketHeight>0},t.prototype._makeBuckets=function(){this._buckets={},this._bucketLen=Math.ceil(this.widthInPixels/this._bucketWidth),this._dispatchInBuckets(this._children),this._oldLeft=null,this._oldTop=null},t.prototype._dispatchInBuckets=function(e){for(var t=0;t<e.length;++t){for(var i=e[t],n=Math.max(0,Math.floor((i._customData._origLeft-this._customData.origLeft)/this._bucketWidth)),o=Math.floor((i._customData._origLeft-this._customData.origLeft+i._currentMeasure.width-1)/this._bucketWidth),r=Math.max(0,Math.floor((i._customData._origTop-this._customData.origTop)/this._bucketHeight)),a=Math.floor((i._customData._origTop-this._customData.origTop+i._currentMeasure.height-1)/this._bucketHeight);r<=a;){for(var s=n;s<=o;++s){var l=r*this._bucketLen+s,_=this._buckets[l];_||(_=[],this._buckets[l]=_),_.push(i)}r++}i instanceof m&&i._children.length>0&&this._dispatchInBuckets(i._children)}},t.prototype._updateMeasures=function(){var e=0|this.leftInPixels,t=0|this.topInPixels;this._measureForChildren.left-=e,this._measureForChildren.top-=t,this._currentMeasure.left-=e,this._currentMeasure.top-=t,this._customData.origLeftForChildren=this._measureForChildren.left,this._customData.origTopForChildren=this._measureForChildren.top,this._customData.origLeft=this._currentMeasure.left,this._customData.origTop=this._currentMeasure.top,this._updateChildrenMeasures(this._children,e,t)},t.prototype._updateChildrenMeasures=function(e,t,i){for(var n=0;n<e.length;++n){var o=e[n];o._currentMeasure.left-=t,o._currentMeasure.top-=i,o._customData._origLeft=o._currentMeasure.left,o._customData._origTop=o._currentMeasure.top,o instanceof m&&o._children.length>0&&this._updateChildrenMeasures(o._children,t,i)}},t.prototype._restoreMeasures=function(){var e=0|this.leftInPixels,t=0|this.topInPixels;this._measureForChildren.left=this._customData.origLeftForChildren+e,this._measureForChildren.top=this._customData.origTopForChildren+t,this._currentMeasure.left=this._customData.origLeft+e,this._currentMeasure.top=this._customData.origTop+t},t.prototype._getTypeName=function(){return"ScrollViewerWindow"},t.prototype._additionalProcessing=function(t,i){e.prototype._additionalProcessing.call(this,t,i),this._parentMeasure=t,this._measureForChildren.left=this._currentMeasure.left,this._measureForChildren.top=this._currentMeasure.top,this._measureForChildren.width=t.width,this._measureForChildren.height=t.height},t.prototype._layout=function(t,i){return this._freezeControls?(this.invalidateRect(),!1):e.prototype._layout.call(this,t,i)},t.prototype._scrollChildren=function(e,t,i){for(var n=0;n<e.length;++n){var o=e[n];o._currentMeasure.left=o._customData._origLeft+t,o._currentMeasure.top=o._customData._origTop+i,o._isClipped=!1,o instanceof m&&o._children.length>0&&this._scrollChildren(o._children,t,i)}},t.prototype._scrollChildrenWithBuckets=function(e,t,i,n){for(var o=Math.max(0,Math.floor(-e/this._bucketWidth)),r=Math.floor((-e+this._parentMeasure.width-1)/this._bucketWidth),a=Math.max(0,Math.floor(-t/this._bucketHeight)),s=Math.floor((-t+this._parentMeasure.height-1)/this._bucketHeight);a<=s;){for(var l=o;l<=r;++l){var _=a*this._bucketLen+l,h=this._buckets[_];if(h)for(var c=0;c<h.length;++c){var u=h[c];u._currentMeasure.left=u._customData._origLeft+i,u._currentMeasure.top=u._customData._origTop+n,u._isClipped=!1}}a++}},t.prototype._draw=function(t,i){if(this._freezeControls){this._localDraw(t),this.clipChildren&&this._clipForChildren(t);var n=0|this.leftInPixels,o=0|this.topInPixels;this._useBuckets()&&null!==this._oldLeft&&null!==this._oldTop?(this._scrollChildrenWithBuckets(this._oldLeft,this._oldTop,n,o),this._scrollChildrenWithBuckets(n,o,n,o)):this._scrollChildren(this._children,n,o),this._oldLeft=n,this._oldTop=o;for(var r=0,a=this._children;r<a.length;r++){var s=a[r];s._intersectsRect(this._parentMeasure)&&s._render(t,this._parentMeasure)}}else e.prototype._draw.call(this,t,i)},t.prototype._postMeasure=function(){if(this._freezeControls)e.prototype._postMeasure.call(this);else{for(var t=this.parentClientWidth,i=this.parentClientHeight,n=0,o=this.children;n<o.length;n++){var r=o[n];r.isVisible&&!r.notRenderable&&(r.horizontalAlignment===g.HORIZONTAL_ALIGNMENT_CENTER&&r._offsetLeft(this._currentMeasure.left-r._currentMeasure.left),r.verticalAlignment===g.VERTICAL_ALIGNMENT_CENTER&&r._offsetTop(this._currentMeasure.top-r._currentMeasure.top),t=Math.max(t,r._currentMeasure.left-this._currentMeasure.left+r._currentMeasure.width+r.paddingRightInPixels),i=Math.max(i,r._currentMeasure.top-this._currentMeasure.top+r._currentMeasure.height+r.paddingBottomInPixels))}this._currentMeasure.width!==t&&(this._width.updateInPlace(t,_.UNITMODE_PIXEL),this._currentMeasure.width=t,this._rebuildLayout=!0,this._isDirty=!0),this._currentMeasure.height!==i&&(this._height.updateInPlace(i,_.UNITMODE_PIXEL),this._currentMeasure.height=i,this._rebuildLayout=!0,this._isDirty=!0),e.prototype._postMeasure.call(this)}},t}(m),G=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._background="black",i._borderColor="white",i._tempMeasure=new f(0,0,0,0),i}return o(t,e),Object.defineProperty(t.prototype,"borderColor",{get:function(){return this._borderColor},set:function(e){this._borderColor!==e&&(this._borderColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Scrollbar"},t.prototype._getThumbThickness=function(){return this._thumbWidth.isPixel?this._thumbWidth.getValue(this._host):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)},t.prototype._draw=function(e){e.save(),this._applyStates(e),this._prepareRenderingData("rectangle");var t=this._renderLeft,i=this._getThumbPosition();e.fillStyle=this._background,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),e.fillStyle=this.color,this.isVertical?(this._tempMeasure.left=t-this._effectiveBarOffset,this._tempMeasure.top=this._currentMeasure.top+i,this._tempMeasure.width=this._currentMeasure.width,this._tempMeasure.height=this._effectiveThumbThickness):(this._tempMeasure.left=this._currentMeasure.left+i,this._tempMeasure.top=this._currentMeasure.top,this._tempMeasure.width=this._effectiveThumbThickness,this._tempMeasure.height=this._currentMeasure.height),e.fillRect(this._tempMeasure.left,this._tempMeasure.top,this._tempMeasure.width,this._tempMeasure.height),e.restore()},t.prototype._updateValueFromPointer=function(e,t){0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y),this._first&&(this._first=!1,this._originX=e,this._originY=t,(e<this._tempMeasure.left||e>this._tempMeasure.left+this._tempMeasure.width||t<this._tempMeasure.top||t>this._tempMeasure.top+this._tempMeasure.height)&&(this.isVertical?this.value=this.minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this.maximum-this.minimum):this.value=this.minimum+(e-this._currentMeasure.left)/this._currentMeasure.width*(this.maximum-this.minimum)));var i=0;i=this.isVertical?-(t-this._originY)/(this._currentMeasure.height-this._effectiveThumbThickness):(e-this._originX)/(this._currentMeasure.width-this._effectiveThumbThickness),this.value+=i*(this.maximum-this.minimum),this._originX=e,this._originY=t},t.prototype._onPointerDown=function(t,i,n,o,r){return this._first=!0,e.prototype._onPointerDown.call(this,t,i,n,o,r)},r([Object(l.serialize)()],t.prototype,"borderColor",null),r([Object(l.serialize)()],t.prototype,"background",null),t}(k),U=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._thumbLength=.5,i._thumbHeight=1,i._barImageHeight=1,i._tempMeasure=new f(0,0,0,0),i.num90RotationInVerticalMode=1,i}return o(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this._backgroundBaseImage},set:function(e){var t=this;this._backgroundBaseImage!==e&&(this._backgroundBaseImage=e,this.isVertical&&0!==this.num90RotationInVerticalMode?e.isLoaded?(this._backgroundImage=e._rotate90(this.num90RotationInVerticalMode,!0),this._markAsDirty()):e.onImageLoadedObservable.addOnce((function(){var i=e._rotate90(t.num90RotationInVerticalMode,!0);t._backgroundImage=i,i.isLoaded||i.onImageLoadedObservable.addOnce((function(){t._markAsDirty()})),t._markAsDirty()})):(this._backgroundImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){t._markAsDirty()})),this._markAsDirty()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._thumbBaseImage},set:function(e){var t=this;this._thumbBaseImage!==e&&(this._thumbBaseImage=e,this.isVertical&&0!==this.num90RotationInVerticalMode?e.isLoaded?(this._thumbImage=e._rotate90(-this.num90RotationInVerticalMode,!0),this._markAsDirty()):e.onImageLoadedObservable.addOnce((function(){var i=e._rotate90(-t.num90RotationInVerticalMode,!0);t._thumbImage=i,i.isLoaded||i.onImageLoadedObservable.addOnce((function(){t._markAsDirty()})),t._markAsDirty()})):(this._thumbImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){t._markAsDirty()})),this._markAsDirty()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbLength",{get:function(){return this._thumbLength},set:function(e){this._thumbLength!==e&&(this._thumbLength=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbHeight",{get:function(){return this._thumbHeight},set:function(e){this._thumbLength!==e&&(this._thumbHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barImageHeight",{get:function(){return this._barImageHeight},set:function(e){this._barImageHeight!==e&&(this._barImageHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ImageScrollBar"},t.prototype._getThumbThickness=function(){return this._thumbWidth.isPixel?this._thumbWidth.getValue(this._host):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)},t.prototype._draw=function(e){e.save(),this._applyStates(e),this._prepareRenderingData("rectangle");var t=this._getThumbPosition(),i=this._renderLeft,n=this._renderTop,o=this._renderWidth,r=this._renderHeight;this._backgroundImage&&(this._tempMeasure.copyFromFloats(i,n,o,r),this.isVertical?(this._tempMeasure.copyFromFloats(i+o*(1-this._barImageHeight)*.5,this._currentMeasure.top,o*this._barImageHeight,r),this._tempMeasure.height+=this._effectiveThumbThickness,this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure)):(this._tempMeasure.copyFromFloats(this._currentMeasure.left,n+r*(1-this._barImageHeight)*.5,o,r*this._barImageHeight),this._tempMeasure.width+=this._effectiveThumbThickness,this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure)),this._backgroundImage._draw(e)),this.isVertical?this._tempMeasure.copyFromFloats(i-this._effectiveBarOffset+this._currentMeasure.width*(1-this._thumbHeight)*.5,this._currentMeasure.top+t,this._currentMeasure.width*this._thumbHeight,this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(this._currentMeasure.left+t,this._currentMeasure.top+this._currentMeasure.height*(1-this._thumbHeight)*.5,this._effectiveThumbThickness,this._currentMeasure.height*this._thumbHeight),this._thumbImage&&(this._thumbImage._currentMeasure.copyFrom(this._tempMeasure),this._thumbImage._draw(e)),e.restore()},t.prototype._updateValueFromPointer=function(e,t){0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y),this._first&&(this._first=!1,this._originX=e,this._originY=t,(e<this._tempMeasure.left||e>this._tempMeasure.left+this._tempMeasure.width||t<this._tempMeasure.top||t>this._tempMeasure.top+this._tempMeasure.height)&&(this.isVertical?this.value=this.minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this.maximum-this.minimum):this.value=this.minimum+(e-this._currentMeasure.left)/this._currentMeasure.width*(this.maximum-this.minimum)));var i=0;i=this.isVertical?-(t-this._originY)/(this._currentMeasure.height-this._effectiveThumbThickness):(e-this._originX)/(this._currentMeasure.width-this._effectiveThumbThickness),this.value+=i*(this.maximum-this.minimum),this._originX=e,this._originY=t},t.prototype._onPointerDown=function(t,i,n,o,r){return this._first=!0,e.prototype._onPointerDown.call(this,t,i,n,o,r)},r([Object(l.serialize)()],t.prototype,"num90RotationInVerticalMode",void 0),t}(k),Y=function(e){function t(t,i){var n=e.call(this,t)||this;return n._barSize=20,n._pointerIsOver=!1,n._wheelPrecision=.05,n._thumbLength=.5,n._thumbHeight=1,n._barImageHeight=1,n._horizontalBarImageHeight=1,n._verticalBarImageHeight=1,n._oldWindowContentsWidth=0,n._oldWindowContentsHeight=0,n._forceHorizontalBar=!1,n._forceVerticalBar=!1,n._useImageBar=i||!1,n.onDirtyObservable.add((function(){n._horizontalBarSpace.color=n.color,n._verticalBarSpace.color=n.color,n._dragSpace.color=n.color})),n.onPointerEnterObservable.add((function(){n._pointerIsOver=!0})),n.onPointerOutObservable.add((function(){n._pointerIsOver=!1})),n._grid=new S,n._useImageBar?(n._horizontalBar=new U,n._verticalBar=new U):(n._horizontalBar=new G,n._verticalBar=new G),n._window=new W("scrollViewer_window"),n._window.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,n._window.verticalAlignment=g.VERTICAL_ALIGNMENT_TOP,n._grid.addColumnDefinition(1),n._grid.addColumnDefinition(0,!0),n._grid.addRowDefinition(1),n._grid.addRowDefinition(0,!0),e.prototype.addControl.call(n,n._grid),n._grid.addControl(n._window,0,0),n._verticalBarSpace=new y,n._verticalBarSpace.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,n._verticalBarSpace.verticalAlignment=g.VERTICAL_ALIGNMENT_TOP,n._verticalBarSpace.thickness=1,n._grid.addControl(n._verticalBarSpace,0,1),n._addBar(n._verticalBar,n._verticalBarSpace,!0,Math.PI),n._horizontalBarSpace=new y,n._horizontalBarSpace.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,n._horizontalBarSpace.verticalAlignment=g.VERTICAL_ALIGNMENT_TOP,n._horizontalBarSpace.thickness=1,n._grid.addControl(n._horizontalBarSpace,1,0),n._addBar(n._horizontalBar,n._horizontalBarSpace,!1,0),n._dragSpace=new y,n._dragSpace.thickness=1,n._grid.addControl(n._dragSpace,1,1),n._useImageBar||(n.barColor="grey",n.barBackground="transparent"),n}return o(t,e),Object.defineProperty(t.prototype,"horizontalBar",{get:function(){return this._horizontalBar},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalBar",{get:function(){return this._verticalBar},enumerable:!1,configurable:!0}),t.prototype.addControl=function(e){return e?(this._window.addControl(e),this):this},t.prototype.removeControl=function(e){return this._window.removeControl(e),this},Object.defineProperty(t.prototype,"children",{get:function(){return this._window.children},enumerable:!1,configurable:!0}),t.prototype._flagDescendantsAsMatrixDirty=function(){for(var e=0,t=this._children;e<t.length;e++)t[e]._markMatrixAsDirty()},Object.defineProperty(t.prototype,"freezeControls",{get:function(){return this._window.freezeControls},set:function(e){this._window.freezeControls=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketWidth",{get:function(){return this._window.bucketWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketHeight",{get:function(){return this._window.bucketHeight},enumerable:!1,configurable:!0}),t.prototype.setBucketSizes=function(e,t){this._window.setBucketSizes(e,t)},Object.defineProperty(t.prototype,"forceHorizontalBar",{get:function(){return this._forceHorizontalBar},set:function(e){this._grid.setRowDefinition(1,e?this._barSize:0,!0),this._horizontalBar.isVisible=e,this._forceHorizontalBar=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"forceVerticalBar",{get:function(){return this._forceVerticalBar},set:function(e){this._grid.setColumnDefinition(1,e?this._barSize:0,!0),this._verticalBar.isVisible=e,this._forceVerticalBar=e},enumerable:!1,configurable:!0}),t.prototype.resetWindow=function(){this._window.width="100%",this._window.height="100%"},t.prototype._getTypeName=function(){return"ScrollViewer"},t.prototype._buildClientSizes=function(){var e=this.host.idealRatio;this._window.parentClientWidth=this._currentMeasure.width-(this._verticalBar.isVisible||this.forceVerticalBar?this._barSize*e:0)-2*this.thickness,this._window.parentClientHeight=this._currentMeasure.height-(this._horizontalBar.isVisible||this.forceHorizontalBar?this._barSize*e:0)-2*this.thickness,this._clientWidth=this._window.parentClientWidth,this._clientHeight=this._window.parentClientHeight},t.prototype._additionalProcessing=function(t,i){e.prototype._additionalProcessing.call(this,t,i),this._buildClientSizes()},t.prototype._postMeasure=function(){e.prototype._postMeasure.call(this),this._updateScroller(),this._setWindowPosition(!1)},Object.defineProperty(t.prototype,"wheelPrecision",{get:function(){return this._wheelPrecision},set:function(e){this._wheelPrecision!==e&&(e<0&&(e=0),e>1&&(e=1),this._wheelPrecision=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollBackground",{get:function(){return this._horizontalBarSpace.background},set:function(e){this._horizontalBarSpace.background!==e&&(this._horizontalBarSpace.background=e,this._verticalBarSpace.background=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barColor",{get:function(){return this._barColor},set:function(e){this._barColor!==e&&(this._barColor=e,this._horizontalBar.color=e,this._verticalBar.color=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._barImage},set:function(e){if(this._barImage!==e){this._barImage=e;var t=this._horizontalBar,i=this._verticalBar;t.thumbImage=e,i.thumbImage=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalThumbImage",{get:function(){return this._horizontalBarImage},set:function(e){this._horizontalBarImage!==e&&(this._horizontalBarImage=e,this._horizontalBar.thumbImage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalThumbImage",{get:function(){return this._verticalBarImage},set:function(e){this._verticalBarImage!==e&&(this._verticalBarImage=e,this._verticalBar.thumbImage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barSize",{get:function(){return this._barSize},set:function(e){this._barSize!==e&&(this._barSize=e,this._markAsDirty(),this._horizontalBar.isVisible&&this._grid.setRowDefinition(1,this._barSize,!0),this._verticalBar.isVisible&&this._grid.setColumnDefinition(1,this._barSize,!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbLength",{get:function(){return this._thumbLength},set:function(e){if(this._thumbLength!==e){e<=0&&(e=.1),e>1&&(e=1),this._thumbLength=e;var t=this._horizontalBar,i=this._verticalBar;t.thumbLength=e,i.thumbLength=e,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbHeight",{get:function(){return this._thumbHeight},set:function(e){if(this._thumbHeight!==e){e<=0&&(e=.1),e>1&&(e=1),this._thumbHeight=e;var t=this._horizontalBar,i=this._verticalBar;t.thumbHeight=e,i.thumbHeight=e,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barImageHeight",{get:function(){return this._barImageHeight},set:function(e){if(this._barImageHeight!==e){e<=0&&(e=.1),e>1&&(e=1),this._barImageHeight=e;var t=this._horizontalBar,i=this._verticalBar;t.barImageHeight=e,i.barImageHeight=e,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalBarImageHeight",{get:function(){return this._horizontalBarImageHeight},set:function(e){this._horizontalBarImageHeight!==e&&(e<=0&&(e=.1),e>1&&(e=1),this._horizontalBarImageHeight=e,this._horizontalBar.barImageHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalBarImageHeight",{get:function(){return this._verticalBarImageHeight},set:function(e){this._verticalBarImageHeight!==e&&(e<=0&&(e=.1),e>1&&(e=1),this._verticalBarImageHeight=e,this._verticalBar.barImageHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barBackground",{get:function(){return this._barBackground},set:function(e){if(this._barBackground!==e){this._barBackground=e;var t=this._horizontalBar,i=this._verticalBar;t.background=e,i.background=e,this._dragSpace.background=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barImage",{get:function(){return this._barBackgroundImage},set:function(e){this._barBackgroundImage,this._barBackgroundImage=e;var t=this._horizontalBar,i=this._verticalBar;t.backgroundImage=e,i.backgroundImage=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalBarImage",{get:function(){return this._horizontalBarBackgroundImage},set:function(e){this._horizontalBarBackgroundImage,this._horizontalBarBackgroundImage=e,this._horizontalBar.backgroundImage=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalBarImage",{get:function(){return this._verticalBarBackgroundImage},set:function(e){this._verticalBarBackgroundImage,this._verticalBarBackgroundImage=e,this._verticalBar.backgroundImage=e},enumerable:!1,configurable:!0}),t.prototype._setWindowPosition=function(e){void 0===e&&(e=!0);var t=this.host.idealRatio,i=this._window._currentMeasure.width,n=this._window._currentMeasure.height;if(e||this._oldWindowContentsWidth!==i||this._oldWindowContentsHeight!==n){this._oldWindowContentsWidth=i,this._oldWindowContentsHeight=n;var o=this._clientWidth-i,r=this._clientHeight-n,a=this._horizontalBar.value/t*o+"px",s=this._verticalBar.value/t*r+"px";a!==this._window.left&&(this._window.left=a,this.freezeControls||(this._rebuildLayout=!0)),s!==this._window.top&&(this._window.top=s,this.freezeControls||(this._rebuildLayout=!0))}},t.prototype._updateScroller=function(){var e=this._window._currentMeasure.width,t=this._window._currentMeasure.height;this._horizontalBar.isVisible&&e<=this._clientWidth&&!this.forceHorizontalBar?(this._grid.setRowDefinition(1,0,!0),this._horizontalBar.isVisible=!1,this._horizontalBar.value=0,this._rebuildLayout=!0):!this._horizontalBar.isVisible&&(e>this._clientWidth||this.forceHorizontalBar)&&(this._grid.setRowDefinition(1,this._barSize,!0),this._horizontalBar.isVisible=!0,this._rebuildLayout=!0),this._verticalBar.isVisible&&t<=this._clientHeight&&!this.forceVerticalBar?(this._grid.setColumnDefinition(1,0,!0),this._verticalBar.isVisible=!1,this._verticalBar.value=0,this._rebuildLayout=!0):!this._verticalBar.isVisible&&(t>this._clientHeight||this.forceVerticalBar)&&(this._grid.setColumnDefinition(1,this._barSize,!0),this._verticalBar.isVisible=!0,this._rebuildLayout=!0),this._buildClientSizes();var i=this.host.idealRatio;this._horizontalBar.thumbWidth=.9*this._thumbLength*(this._clientWidth/i)+"px",this._verticalBar.thumbWidth=.9*this._thumbLength*(this._clientHeight/i)+"px"},t.prototype._link=function(t){e.prototype._link.call(this,t),this._attachWheel()},t.prototype._addBar=function(e,t,i,n){var o=this;e.paddingLeft=0,e.width="100%",e.height="100%",e.barOffset=0,e.value=0,e.maximum=1,e.horizontalAlignment=g.HORIZONTAL_ALIGNMENT_CENTER,e.verticalAlignment=g.VERTICAL_ALIGNMENT_CENTER,e.isVertical=i,e.rotation=n,e.isVisible=!1,t.addControl(e),e.onValueChangedObservable.add((function(e){o._setWindowPosition()}))},t.prototype._attachWheel=function(){var e=this;this._host&&!this._onWheelObserver&&(this._onWheelObserver=this.onWheelObservable.add((function(t){e._pointerIsOver&&!e.isReadOnly&&(1==e._verticalBar.isVisible&&(t.y<0&&e._verticalBar.value>0?e._verticalBar.value-=e._wheelPrecision:t.y>0&&e._verticalBar.value<e._verticalBar.maximum&&(e._verticalBar.value+=e._wheelPrecision)),1==e._horizontalBar.isVisible&&(t.x<0&&e._horizontalBar.value<e._horizontalBar.maximum?e._horizontalBar.value+=e._wheelPrecision:t.x>0&&e._horizontalBar.value>0&&(e._horizontalBar.value-=e._wheelPrecision)))})))},t.prototype._renderHighlightSpecific=function(t){this.isHighlighted&&(e.prototype._renderHighlightSpecific.call(this,t),this._grid._renderHighlightSpecific(t),t.restore())},t.prototype.dispose=function(){this.onWheelObservable.remove(this._onWheelObserver),this._onWheelObserver=null,e.prototype.dispose.call(this)},t}(y);Object(l.RegisterClass)("BABYLON.GUI.ScrollViewer",Y);var X=function(e){function t(t,i){var n=e.call(this,t)||this;n.name=t,n.onIsActiveChangedObservable=new l.Observable,n.delegatePickingToChildren=!1,n._isActive=!1,n.group=null!=i?i:"",n.thickness=0,n.isPointerBlocker=!0;var o=null;return n.toActiveAnimation=function(){n.thickness=1},n.toInactiveAnimation=function(){n.thickness=0},n.pointerEnterActiveAnimation=function(){o=n.alpha,n.alpha-=.1},n.pointerOutActiveAnimation=function(){null!==o&&(n.alpha=o)},n.pointerDownActiveAnimation=function(){n.scaleX-=.05,n.scaleY-=.05},n.pointerUpActiveAnimation=function(){n.scaleX+=.05,n.scaleY+=.05},n.pointerEnterInactiveAnimation=function(){o=n.alpha,n.alpha-=.1},n.pointerOutInactiveAnimation=function(){null!==o&&(n.alpha=o)},n.pointerDownInactiveAnimation=function(){n.scaleX-=.05,n.scaleY-=.05},n.pointerUpInactiveAnimation=function(){n.scaleX+=.05,n.scaleY+=.05},n}return o(t,e),Object.defineProperty(t.prototype,"group",{get:function(){return this._group},set:function(e){this._group!==e&&(this._group=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},set:function(e){var t,i,n=this;this._isActive!==e&&(this._isActive=e,this._isActive?null===(t=this.toActiveAnimation)||void 0===t||t.call(this):null===(i=this.toInactiveAnimation)||void 0===i||i.call(this),this._markAsDirty(),this.onIsActiveChangedObservable.notifyObservers(e),this._isActive&&this._host&&this._group&&this._host.executeOnAllControls((function(e){if("ToggleButton"===e.typeName){if(e===n)return;var t=e;t.group===n.group&&(t.isActive=!1)}})))},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ToggleButton"},t.prototype._processPicking=function(t,i,n,o,r,a,s,l){if(!this._isEnabled||!this.isHitTestVisible||!this.isVisible||this.notRenderable)return!1;if(!e.prototype.contains.call(this,t,i))return!1;if(this.delegatePickingToChildren){for(var _=!1,h=this._children.length-1;h>=0;h--){var c=this._children[h];if(c.isEnabled&&c.isHitTestVisible&&c.isVisible&&!c.notRenderable&&c.contains(t,i)){_=!0;break}}if(!_)return!1}return this._processObservables(o,t,i,n,r,a,s,l),!0},t.prototype._onPointerEnter=function(t,i){return!!e.prototype._onPointerEnter.call(this,t,i)&&(this.isReadOnly||(this._isActive?this.pointerEnterActiveAnimation&&this.pointerEnterActiveAnimation():this.pointerEnterInactiveAnimation&&this.pointerEnterInactiveAnimation()),!0)},t.prototype._onPointerOut=function(t,i,n){void 0===n&&(n=!1),this.isReadOnly||(this._isActive?this.pointerOutActiveAnimation&&this.pointerOutActiveAnimation():this.pointerOutInactiveAnimation&&this.pointerOutInactiveAnimation()),e.prototype._onPointerOut.call(this,t,i,n)},t.prototype._onPointerDown=function(t,i,n,o,r){return!!e.prototype._onPointerDown.call(this,t,i,n,o,r)&&(this.isReadOnly||(this._isActive?this.pointerDownActiveAnimation&&this.pointerDownActiveAnimation():this.pointerDownInactiveAnimation&&this.pointerDownInactiveAnimation()),!0)},t.prototype._onPointerUp=function(t,i,n,o,r,a){this.isReadOnly||(this._isActive?this.pointerUpActiveAnimation&&this.pointerUpActiveAnimation():this.pointerUpInactiveAnimation&&this.pointerUpInactiveAnimation()),e.prototype._onPointerUp.call(this,t,i,n,o,r,a)},t}(y);Object(l.RegisterClass)("BABYLON.GUI.ToggleButton",X);var K=function(){},Z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onKeyPressObservable=new l.Observable,t.defaultButtonWidth="40px",t.defaultButtonHeight="40px",t.defaultButtonPaddingLeft="2px",t.defaultButtonPaddingRight="2px",t.defaultButtonPaddingTop="2px",t.defaultButtonPaddingBottom="2px",t.defaultButtonColor="#DDD",t.defaultButtonBackground="#070707",t.shiftButtonColor="#7799FF",t.selectedShiftThickness=1,t.shiftState=0,t._currentlyConnectedInputText=null,t._connectedInputTexts=[],t._onKeyPressObserver=null,t}return o(t,e),t.prototype._getTypeName=function(){return"VirtualKeyboard"},t.prototype._createKey=function(e,t){var i=this,n=O.CreateSimpleButton(e,e);return n.width=t&&t.width?t.width:this.defaultButtonWidth,n.height=t&&t.height?t.height:this.defaultButtonHeight,n.color=t&&t.color?t.color:this.defaultButtonColor,n.background=t&&t.background?t.background:this.defaultButtonBackground,n.paddingLeft=t&&t.paddingLeft?t.paddingLeft:this.defaultButtonPaddingLeft,n.paddingRight=t&&t.paddingRight?t.paddingRight:this.defaultButtonPaddingRight,n.paddingTop=t&&t.paddingTop?t.paddingTop:this.defaultButtonPaddingTop,n.paddingBottom=t&&t.paddingBottom?t.paddingBottom:this.defaultButtonPaddingBottom,n.thickness=0,n.isFocusInvisible=!0,n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY,n.onPointerUpObservable.add((function(){i.onKeyPressObservable.notifyObservers(e)})),n},t.prototype.addKeysRow=function(e,t){var i=new B;i.isVertical=!1,i.isFocusInvisible=!0;for(var n=null,o=0;o<e.length;o++){var r=null;t&&t.length===e.length&&(r=t[o]);var a=this._createKey(e[o],r);(!n||a.heightInPixels>n.heightInPixels)&&(n=a),i.addControl(a)}i.height=n?n.height:this.defaultButtonHeight,this.addControl(i)},t.prototype.applyShiftState=function(e){if(this.children)for(var t=0;t<this.children.length;t++){var i=this.children[t];if(i&&i.children)for(var n=i,o=0;o<n.children.length;o++){var r=n.children[o];if(r&&r.children[0]){var a=r.children[0];""===a.text&&(r.color=e?this.shiftButtonColor:this.defaultButtonColor,r.thickness=e>1?this.selectedShiftThickness:0),a.text=e>0?a.text.toUpperCase():a.text.toLowerCase()}}}},Object.defineProperty(t.prototype,"connectedInputText",{get:function(){return this._currentlyConnectedInputText},enumerable:!1,configurable:!0}),t.prototype.connect=function(e){var t=this;if(!this._connectedInputTexts.some((function(t){return t.input===e}))){null===this._onKeyPressObserver&&(this._onKeyPressObserver=this.onKeyPressObservable.add((function(e){if(t._currentlyConnectedInputText){switch(t._currentlyConnectedInputText._host.focusedControl=t._currentlyConnectedInputText,e){case"":return t.shiftState++,t.shiftState>2&&(t.shiftState=0),void t.applyShiftState(t.shiftState);case"":return void t._currentlyConnectedInputText.processKey(8);case"":return void t._currentlyConnectedInputText.processKey(13)}t._currentlyConnectedInputText.processKey(-1,t.shiftState?e.toUpperCase():e),1===t.shiftState&&(t.shiftState=0,t.applyShiftState(t.shiftState))}}))),this.isVisible=!1,this._currentlyConnectedInputText=e,e._connectedVirtualKeyboard=this;var i=e.onFocusObservable.add((function(){t._currentlyConnectedInputText=e,e._connectedVirtualKeyboard=t,t.isVisible=!0})),n=e.onBlurObservable.add((function(){e._connectedVirtualKeyboard=null,t._currentlyConnectedInputText=null,t.isVisible=!1}));this._connectedInputTexts.push({input:e,onBlurObserver:n,onFocusObserver:i})}},t.prototype.disconnect=function(e){var t=this;if(e){var i=this._connectedInputTexts.filter((function(t){return t.input===e}));1===i.length&&(this._removeConnectedInputObservables(i[0]),this._connectedInputTexts=this._connectedInputTexts.filter((function(t){return t.input!==e})),this._currentlyConnectedInputText===e&&(this._currentlyConnectedInputText=null))}else this._connectedInputTexts.forEach((function(e){t._removeConnectedInputObservables(e)})),this._connectedInputTexts=[];0===this._connectedInputTexts.length&&(this._currentlyConnectedInputText=null,this.onKeyPressObservable.remove(this._onKeyPressObserver),this._onKeyPressObserver=null)},t.prototype._removeConnectedInputObservables=function(e){e.input._connectedVirtualKeyboard=null,e.input.onFocusObservable.remove(e.onFocusObserver),e.input.onBlurObservable.remove(e.onBlurObserver)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.disconnect()},t.CreateDefaultLayout=function(e){var i=new t(e);return i.addKeysRow(["1","2","3","4","5","6","7","8","9","0",""]),i.addKeysRow(["q","w","e","r","t","y","u","i","o","p"]),i.addKeysRow(["a","s","d","f","g","h","j","k","l",";","'",""]),i.addKeysRow(["","z","x","c","v","b","n","m",",",".","/"]),i.addKeysRow([" "],[{width:"200px"}]),i},t}(B);Object(l.RegisterClass)("BABYLON.GUI.VirtualKeyboard",Z);var q=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._cellWidth=20,i._cellHeight=20,i._minorLineTickness=1,i._minorLineColor="DarkGray",i._majorLineTickness=2,i._majorLineColor="White",i._majorLineFrequency=5,i._background="Black",i._displayMajorLines=!0,i._displayMinorLines=!0,i}return o(t,e),Object.defineProperty(t.prototype,"displayMinorLines",{get:function(){return this._displayMinorLines},set:function(e){this._displayMinorLines!==e&&(this._displayMinorLines=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayMajorLines",{get:function(){return this._displayMajorLines},set:function(e){this._displayMajorLines!==e&&(this._displayMajorLines=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(e){this._cellWidth=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(e){this._cellHeight=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorLineTickness",{get:function(){return this._minorLineTickness},set:function(e){this._minorLineTickness=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorLineColor",{get:function(){return this._minorLineColor},set:function(e){this._minorLineColor=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLineTickness",{get:function(){return this._majorLineTickness},set:function(e){this._majorLineTickness=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLineColor",{get:function(){return this._majorLineColor},set:function(e){this._majorLineColor=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLineFrequency",{get:function(){return this._majorLineFrequency},set:function(e){this._majorLineFrequency=e,this._markAsDirty()},enumerable:!1,configurable:!0}),t.prototype._draw=function(e,t){if(e.save(),this._applyStates(e),this._isEnabled){this._background&&(e.fillStyle=this._background,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height));var i=this._currentMeasure.width/this._cellWidth,n=this._currentMeasure.height/this._cellHeight,o=this._currentMeasure.left+this._currentMeasure.width/2,r=this._currentMeasure.top+this._currentMeasure.height/2;if(this._displayMinorLines){e.strokeStyle=this._minorLineColor,e.lineWidth=this._minorLineTickness;for(var a=-i/2+1;a<i/2;a++){var s=o+a*this.cellWidth;e.beginPath(),e.moveTo(s,this._currentMeasure.top),e.lineTo(s,this._currentMeasure.top+this._currentMeasure.height),e.stroke()}for(var l=-n/2+1;l<n/2;l++){var _=r+l*this.cellHeight;e.beginPath(),e.moveTo(this._currentMeasure.left,_),e.lineTo(this._currentMeasure.left+this._currentMeasure.width,_),e.stroke()}}if(this._displayMajorLines){for(e.strokeStyle=this._majorLineColor,e.lineWidth=this._majorLineTickness,a=-i/2+this._majorLineFrequency;a<i/2;a+=this._majorLineFrequency)s=o+a*this.cellWidth,e.beginPath(),e.moveTo(s,this._currentMeasure.top),e.lineTo(s,this._currentMeasure.top+this._currentMeasure.height),e.stroke();for(l=-n/2+this._majorLineFrequency;l<n/2;l+=this._majorLineFrequency)_=r+l*this.cellHeight,e.moveTo(this._currentMeasure.left,_),e.lineTo(this._currentMeasure.left+this._currentMeasure.width,_),e.closePath(),e.stroke()}}e.restore()},t.prototype._getTypeName=function(){return"DisplayGrid"},r([Object(l.serialize)()],t.prototype,"displayMinorLines",null),r([Object(l.serialize)()],t.prototype,"displayMajorLines",null),r([Object(l.serialize)()],t.prototype,"background",null),r([Object(l.serialize)()],t.prototype,"cellWidth",null),r([Object(l.serialize)()],t.prototype,"cellHeight",null),r([Object(l.serialize)()],t.prototype,"minorLineTickness",null),r([Object(l.serialize)()],t.prototype,"minorLineColor",null),r([Object(l.serialize)()],t.prototype,"majorLineTickness",null),r([Object(l.serialize)()],t.prototype,"majorLineColor",null),r([Object(l.serialize)()],t.prototype,"majorLineFrequency",null),t}(g);Object(l.RegisterClass)("BABYLON.GUI.DisplayGrid",q);var $=function(e){function t(t){var i=e.call(this,t)||this;return i.name=t,i._tempMeasure=new f(0,0,0,0),i}return o(t,e),Object.defineProperty(t.prototype,"displayThumb",{get:function(){return this._displayThumb&&null!=this.thumbImage},set:function(e){this._displayThumb!==e&&(this._displayThumb=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this._backgroundImage},set:function(e){var t=this;this._backgroundImage!==e&&(this._backgroundImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){return t._markAsDirty()})),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueBarImage",{get:function(){return this._valueBarImage},set:function(e){var t=this;this._valueBarImage!==e&&(this._valueBarImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){return t._markAsDirty()})),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._thumbImage},set:function(e){var t=this;this._thumbImage!==e&&(this._thumbImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){return t._markAsDirty()})),this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ImageBasedSlider"},t.prototype._draw=function(e,t){e.save(),this._applyStates(e),this._prepareRenderingData("rectangle");var i=this._getThumbPosition(),n=this._renderLeft,o=this._renderTop,r=this._renderWidth,a=this._renderHeight;this._backgroundImage&&(this._tempMeasure.copyFromFloats(n,o,r,a),this.isThumbClamped&&this.displayThumb&&(this.isVertical?this._tempMeasure.height+=this._effectiveThumbThickness:this._tempMeasure.width+=this._effectiveThumbThickness),this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure),this._backgroundImage._draw(e)),this._valueBarImage&&(this.isVertical?this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(n,o+i,r,a-i+this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(n,o+i,r,a-i):this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(n,o,i+this._effectiveThumbThickness/2,a):this._tempMeasure.copyFromFloats(n,o,i,a),this._valueBarImage._currentMeasure.copyFrom(this._tempMeasure),this._valueBarImage._draw(e)),this.displayThumb&&(this.isVertical?this._tempMeasure.copyFromFloats(n-this._effectiveBarOffset,this._currentMeasure.top+i,this._currentMeasure.width,this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(this._currentMeasure.left+i,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),this._thumbImage._currentMeasure.copyFrom(this._tempMeasure),this._thumbImage._draw(e)),e.restore()},t.prototype.serialize=function(t){e.prototype.serialize.call(this,t);var i={},n={},o={};this.backgroundImage.serialize(i),this.thumbImage.serialize(n),this.valueBarImage.serialize(o),t.backgroundImage=i,t.thumbImage=n,t.valueBarImage=o},t.prototype._parseFromContent=function(t,i){e.prototype._parseFromContent.call(this,t,i),this.backgroundImage=P.Parse(t.backgroundImage,i),this.thumbImage=P.Parse(t.thumbImage,i),this.valueBarImage=P.Parse(t.valueBarImage,i)},r([Object(l.serialize)()],t.prototype,"displayThumb",null),t}(k);Object(l.RegisterClass)("BABYLON.GUI.ImageBasedSlider",$);var J="Statics";g.AddHeader=function(e,t,i,n){var o=new B("panel"),r=!n||n.isHorizontal,a=!n||n.controlFirst;o.isVertical=!r;var s=new x("header");return s.text=t,s.textHorizontalAlignment=g.HORIZONTAL_ALIGNMENT_LEFT,r?s.width=i:s.height=i,a?(o.addControl(e),o.addControl(s),s.paddingLeft="5px"):(o.addControl(s),o.addControl(e),s.paddingRight="5px"),s.shadowBlur=e.shadowBlur,s.shadowColor=e.shadowColor,s.shadowOffsetX=e.shadowOffsetX,s.shadowOffsetY=e.shadowOffsetY,o};var ee=function(){function e(e){this._fontFamily="Arial",this._fontStyle="",this._fontWeight="",this._fontSize=new _(18,_.UNITMODE_PIXEL,!1),this.onChangedObservable=new l.Observable,this._host=e}return Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(e){this._fontSize.toString(this._host)!==e&&this._fontSize.fromString(e)&&this.onChangedObservable.notifyObservers(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this._fontFamily!==e&&(this._fontFamily=e,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.onChangedObservable.clear()},e}(),te=function(e){function t(t,i,n,o,r,a,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=!1),void 0===a&&(a=l.Texture.NEAREST_SAMPLINGMODE),void 0===s&&(s=!0);var _=e.call(this,t,{width:i,height:n},o,r,a,l.Constants.TEXTUREFORMAT_RGBA,s)||this;return _._isDirty=!1,_._rootContainer=new m("root"),_._lastControlOver={},_._lastControlDown={},_._capturingControl={},_._linkedControls=new Array,_._isFullscreen=!1,_._fullscreenViewport=new l.Viewport(0,0,1,1),_._idealWidth=0,_._idealHeight=0,_._useSmallestIdeal=!1,_._renderAtIdealSize=!1,_._blockNextFocusCheck=!1,_._renderScale=1,_._cursorChanged=!1,_._defaultMousePointerId=0,_._numLayoutCalls=0,_._numRenderCalls=0,_._clipboardData="",_.onClipboardObservable=new l.Observable,_.onControlPickedObservable=new l.Observable,_.onBeginLayoutObservable=new l.Observable,_.onEndLayoutObservable=new l.Observable,_.onBeginRenderObservable=new l.Observable,_.onEndRenderObservable=new l.Observable,_.premulAlpha=!1,_.applyYInversionOnUpdate=!0,_._useInvalidateRectOptimization=!0,_._invalidatedRectangle=null,_._clearMeasure=new f(0,0,0,0),_.onClipboardCopy=function(e){var t=e,i=new l.ClipboardInfo(l.ClipboardEventTypes.COPY,t);_.onClipboardObservable.notifyObservers(i),t.preventDefault()},_.onClipboardCut=function(e){var t=e,i=new l.ClipboardInfo(l.ClipboardEventTypes.CUT,t);_.onClipboardObservable.notifyObservers(i),t.preventDefault()},_.onClipboardPaste=function(e){var t=e,i=new l.ClipboardInfo(l.ClipboardEventTypes.PASTE,t);_.onClipboardObservable.notifyObservers(i),t.preventDefault()},(o=_.getScene())&&_._texture?(_.applyYInversionOnUpdate=s,_._rootElement=o.getEngine().getInputElement(),_._renderObserver=o.onBeforeCameraRenderObservable.add((function(e){return _._checkUpdate(e)})),_._preKeyboardObserver=o.onPreKeyboardObservable.add((function(e){_._focusedControl&&(e.type===l.KeyboardEventTypes.KEYDOWN&&_._focusedControl.processKeyboard(e.event),e.skipOnPointerObservable=!0)})),_._rootContainer._link(_),_.hasAlpha=!0,i&&n||(_._resizeObserver=o.getEngine().onResizeObservable.add((function(){return _._onResize()})),_._onResize()),_._texture.isReady=!0,_):_}return o(t,e),Object.defineProperty(t.prototype,"numLayoutCalls",{get:function(){return this._numLayoutCalls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numRenderCalls",{get:function(){return this._numRenderCalls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderScale",{get:function(){return this._renderScale},set:function(e){e!==this._renderScale&&(this._renderScale=e,this._onResize())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this.markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idealWidth",{get:function(){return this._idealWidth},set:function(e){this._idealWidth!==e&&(this._idealWidth=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idealHeight",{get:function(){return this._idealHeight},set:function(e){this._idealHeight!==e&&(this._idealHeight=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useSmallestIdeal",{get:function(){return this._useSmallestIdeal},set:function(e){this._useSmallestIdeal!==e&&(this._useSmallestIdeal=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderAtIdealSize",{get:function(){return this._renderAtIdealSize},set:function(e){this._renderAtIdealSize!==e&&(this._renderAtIdealSize=e,this._onResize())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idealRatio",{get:function(){var e=0,t=0;return this._idealWidth&&(e=this.getSize().width/this._idealWidth),this._idealHeight&&(t=this.getSize().height/this._idealHeight),this._useSmallestIdeal&&this._idealWidth&&this._idealHeight?window.innerWidth<window.innerHeight?e:t:this._idealWidth?e:this._idealHeight?t:1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layer",{get:function(){return this._layerToDispose},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),t.prototype.getChildren=function(){return[this._rootContainer]},t.prototype.getDescendants=function(e,t){return this._rootContainer.getDescendants(e,t)},t.prototype.getControlsByType=function(e){return this._rootContainer.getDescendants(!1,(function(t){return t.typeName===e}))},t.prototype.getControlByName=function(e){return this._getControlByKey("name",e)},t.prototype._getControlByKey=function(e,t){return this._rootContainer.getDescendants().find((function(i){return i[e]===t}))||null},Object.defineProperty(t.prototype,"focusedControl",{get:function(){return this._focusedControl},set:function(e){this._focusedControl!=e&&(this._focusedControl&&this._focusedControl.onBlur(),e&&e.onFocus(),this._focusedControl=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isForeground",{get:function(){return!this.layer||!this.layer.isBackground},set:function(e){this.layer&&this.layer.isBackground!==!e&&(this.layer.isBackground=!e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clipboardData",{get:function(){return this._clipboardData},set:function(e){this._clipboardData=e},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return"AdvancedDynamicTexture"},t.prototype.executeOnAllControls=function(e,t){t||(t=this._rootContainer),e(t);for(var i=0,n=t.children;i<n.length;i++){var o=n[i];o.children?this.executeOnAllControls(e,o):e(o)}},Object.defineProperty(t.prototype,"useInvalidateRectOptimization",{get:function(){return this._useInvalidateRectOptimization},set:function(e){this._useInvalidateRectOptimization=e},enumerable:!1,configurable:!0}),t.prototype.invalidateRect=function(e,t,i,n){if(this._useInvalidateRectOptimization)if(this._invalidatedRectangle){var o=Math.ceil(Math.max(this._invalidatedRectangle.left+this._invalidatedRectangle.width-1,i)),r=Math.ceil(Math.max(this._invalidatedRectangle.top+this._invalidatedRectangle.height-1,n));this._invalidatedRectangle.left=Math.floor(Math.min(this._invalidatedRectangle.left,e)),this._invalidatedRectangle.top=Math.floor(Math.min(this._invalidatedRectangle.top,t)),this._invalidatedRectangle.width=o-this._invalidatedRectangle.left+1,this._invalidatedRectangle.height=r-this._invalidatedRectangle.top+1}else this._invalidatedRectangle=new f(e,t,i-e+1,n-t+1)},t.prototype.markAsDirty=function(){this._isDirty=!0},t.prototype.createStyle=function(){return new ee(this)},t.prototype.addControl=function(e){return this._rootContainer.addControl(e),this},t.prototype.removeControl=function(e){return this._rootContainer.removeControl(e),this},t.prototype.moveToNonOverlappedPosition=function(e,i,n){var o;if(void 0===i&&(i=1),void 0===n&&(n=1),Array.isArray(e))o=e;else{var r=this.getDescendants(!0);o=void 0===e?r.filter((function(e){return void 0!==e.overlapGroup})):r.filter((function(t){return t.overlapGroup===e}))}o.forEach((function(e){var r,a=l.Vector2.Zero(),s=new l.Vector2(e.centerX,e.centerY);o.forEach((function(i){if(e!==i&&t._Overlaps(e,i)){var o=s.subtract(new l.Vector2(i.centerX,i.centerY)),r=o.length();r>0&&(a=a.add(o.normalize().scale(n/r)))}})),a.length()>0&&(a=a.normalize().scale(i*(null!==(r=e.overlapDeltaMultiplier)&&void 0!==r?r:1)),e.linkOffsetXInPixels+=a.x,e.linkOffsetYInPixels+=a.y)}))},t.prototype.dispose=function(){var t=this.getScene();t&&(this._rootElement=null,t.onBeforeCameraRenderObservable.remove(this._renderObserver),this._resizeObserver&&t.getEngine().onResizeObservable.remove(this._resizeObserver),this._pointerMoveObserver&&t.onPrePointerObservable.remove(this._pointerMoveObserver),this._pointerObserver&&t.onPointerObservable.remove(this._pointerObserver),this._preKeyboardObserver&&t.onPreKeyboardObservable.remove(this._preKeyboardObserver),this._canvasPointerOutObserver&&t.getEngine().onCanvasPointerOutObservable.remove(this._canvasPointerOutObserver),this._canvasBlurObserver&&t.getEngine().onCanvasBlurObservable.remove(this._canvasBlurObserver),this._layerToDispose&&(this._layerToDispose.texture=null,this._layerToDispose.dispose(),this._layerToDispose=null),this._rootContainer.dispose(),this.onClipboardObservable.clear(),this.onControlPickedObservable.clear(),this.onBeginRenderObservable.clear(),this.onEndRenderObservable.clear(),this.onBeginLayoutObservable.clear(),this.onEndLayoutObservable.clear(),e.prototype.dispose.call(this))},t.prototype._onResize=function(){var e=this.getScene();if(e){var t=e.getEngine(),i=this.getSize(),n=t.getRenderWidth()*this._renderScale,o=t.getRenderHeight()*this._renderScale;this._renderAtIdealSize&&(this._idealWidth?(o=o*this._idealWidth/n,n=this._idealWidth):this._idealHeight&&(n=n*this._idealHeight/o,o=this._idealHeight)),i.width===n&&i.height===o||(this.scaleTo(n,o),this.markAsDirty(),(this._idealWidth||this._idealHeight)&&this._rootContainer._markAllAsDirty()),this.invalidateRect(0,0,i.width-1,i.height-1)}},t.prototype._getGlobalViewport=function(){var e=this.getSize(),t=this._fullscreenViewport.toGlobal(e.width,e.height),i=Math.round(t.width*(1/this.rootContainer.scaleX)),n=Math.round(t.height*(1/this.rootContainer.scaleY));return t.x+=(t.width-i)/2,t.y+=(t.height-n)/2,t.width=i,t.height=n,t},t.prototype.getProjectedPosition=function(e,t){var i=this.getProjectedPositionWithZ(e,t);return new l.Vector2(i.x,i.y)},t.prototype.getProjectedPositionWithZ=function(e,t){var i=this.getScene();if(!i)return l.Vector3.Zero();var n=this._getGlobalViewport(),o=l.Vector3.Project(e,t,i.getTransformMatrix(),n);return new l.Vector3(o.x,o.y,o.z)},t.prototype._checkUpdate=function(e){if(!this._layerToDispose||0!=(e.layerMask&this._layerToDispose.layerMask)){if(this._isFullscreen&&this._linkedControls.length){var i=this.getScene();if(!i)return;for(var n=this._getGlobalViewport(),o=function(e){if(!e.isVisible)return"continue";var t=e._linkedMesh;if(!t||t.isDisposed())return l.Tools.SetImmediate((function(){e.linkWithMesh(null)})),"continue";var o=t.getBoundingInfo?t.getBoundingInfo().boundingSphere.center:l.Vector3.ZeroReadOnly,r=l.Vector3.Project(o,t.getWorldMatrix(),i.getTransformMatrix(),n);if(r.z<0||r.z>1)return e.notRenderable=!0,"continue";e.notRenderable=!1,e._moveToProjectedPosition(r)},r=0,a=this._linkedControls;r<a.length;r++)o(a[r])}(this._isDirty||this._rootContainer.isDirty)&&(this._isDirty=!1,this._render(),this.update(this.applyYInversionOnUpdate,this.premulAlpha,t.AllowGPUOptimizations))}},t.prototype._render=function(){var e=this.getSize(),t=e.width,i=e.height,n=this.getContext();n.font="18px Arial",n.strokeStyle="white",this.onBeginLayoutObservable.notifyObservers(this);var o=new f(0,0,t,i);this._numLayoutCalls=0,this._rootContainer._layout(o,n),this.onEndLayoutObservable.notifyObservers(this),this._isDirty=!1,this._invalidatedRectangle?this._clearMeasure.copyFrom(this._invalidatedRectangle):this._clearMeasure.copyFromFloats(0,0,t,i),n.clearRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),this._background&&(n.save(),n.fillStyle=this._background,n.fillRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),n.restore()),this.onBeginRenderObservable.notifyObservers(this),this._numRenderCalls=0,this._rootContainer._render(n,this._invalidatedRectangle),this.onEndRenderObservable.notifyObservers(this),this._invalidatedRectangle=null},t.prototype._changeCursor=function(e){this._rootElement&&(this._rootElement.style.cursor=e,this._cursorChanged=!0)},t.prototype._registerLastControlDown=function(e,t){this._lastControlDown[t]=e,this.onControlPickedObservable.notifyObservers(e)},t.prototype._doPicking=function(e,t,i,n,o,r,a,s){var _=this.getScene();if(_){var h=_.getEngine(),c=this.getSize();if(this._isFullscreen){var u=_.cameraToUseForPointers||_.activeCamera;if(!u)return;var d=u.viewport;e*=c.width/(h.getRenderWidth()*d.width),t*=c.height/(h.getRenderHeight()*d.height)}this._capturingControl[o]?this._capturingControl[o]._processObservables(n,e,t,i,o,r):(this._cursorChanged=!1,this._rootContainer._processPicking(e,t,i,n,o,r,a,s)||(_.doNotHandleCursors||this._changeCursor(""),n===l.PointerEventTypes.POINTERMOVE&&this._lastControlOver[o]&&(this._lastControlOver[o]._onPointerOut(this._lastControlOver[o],i),delete this._lastControlOver[o])),this._cursorChanged||_.doNotHandleCursors||this._changeCursor(""),this._manageFocus())}},t.prototype._cleanControlAfterRemovalFromList=function(e,t){for(var i in e)e.hasOwnProperty(i)&&e[i]===t&&delete e[i]},t.prototype._cleanControlAfterRemoval=function(e){this._cleanControlAfterRemovalFromList(this._lastControlDown,e),this._cleanControlAfterRemovalFromList(this._lastControlOver,e)},t.prototype.attach=function(){var e=this,t=this.getScene();if(t){var i=new l.Viewport(0,0,0,0);this._pointerMoveObserver=t.onPrePointerObservable.add((function(n,o){if(!t.isPointerCaptured(n.event.pointerId)&&(n.type===l.PointerEventTypes.POINTERMOVE||n.type===l.PointerEventTypes.POINTERUP||n.type===l.PointerEventTypes.POINTERDOWN||n.type===l.PointerEventTypes.POINTERWHEEL)){n.type===l.PointerEventTypes.POINTERMOVE&&n.event.pointerId&&(e._defaultMousePointerId=n.event.pointerId);var r=t.cameraToUseForPointers||t.activeCamera,a=t.getEngine(),s=t.cameraToUseForPointers;if(r)if(r.rigCameras.length){var _=new l.Viewport(0,0,1,1);r.rigCameras.forEach((function(e){e.viewport.toGlobalToRef(a.getRenderWidth(),a.getRenderHeight(),_);var n=t.pointerX/a.getHardwareScalingLevel()-_.x,o=t.pointerY/a.getHardwareScalingLevel()-(a.getRenderHeight()-_.y-_.height);n<0||o<0||n>_.width||o>_.height||(t.cameraToUseForPointers=e,i.x=_.x,i.y=_.y,i.width=_.width,i.height=_.height)}))}else r.viewport.toGlobalToRef(a.getRenderWidth(),a.getRenderHeight(),i);else i.x=0,i.y=0,i.width=a.getRenderWidth(),i.height=a.getRenderHeight();var h=t.pointerX/a.getHardwareScalingLevel()-i.x,c=t.pointerY/a.getHardwareScalingLevel()-(a.getRenderHeight()-i.y-i.height);e._shouldBlockPointer=!1;var u=n.event.pointerId||e._defaultMousePointerId;e._doPicking(h,c,n,n.type,u,n.event.button,n.event.deltaX,n.event.deltaY),e._shouldBlockPointer&&(n.skipOnPointerObservable=e._shouldBlockPointer),t.cameraToUseForPointers=s}})),this._attachToOnPointerOut(t),this._attachToOnBlur(t)}},t.prototype.registerClipboardEvents=function(){self.addEventListener("copy",this.onClipboardCopy,!1),self.addEventListener("cut",this.onClipboardCut,!1),self.addEventListener("paste",this.onClipboardPaste,!1)},t.prototype.unRegisterClipboardEvents=function(){self.removeEventListener("copy",this.onClipboardCopy),self.removeEventListener("cut",this.onClipboardCut),self.removeEventListener("paste",this.onClipboardPaste)},t.prototype.attachToMesh=function(e,t){var i=this;void 0===t&&(t=!0);var n=this.getScene();n&&(this._pointerObserver=n.onPointerObservable.add((function(t,n){if(t.type===l.PointerEventTypes.POINTERMOVE||t.type===l.PointerEventTypes.POINTERUP||t.type===l.PointerEventTypes.POINTERDOWN||t.type===l.PointerEventTypes.POINTERWHEEL){t.type===l.PointerEventTypes.POINTERMOVE&&t.event.pointerId&&(i._defaultMousePointerId=t.event.pointerId);var o=t.event.pointerId||i._defaultMousePointerId;if(t.pickInfo&&t.pickInfo.hit&&t.pickInfo.pickedMesh===e){var r=t.pickInfo.getTextureCoordinates();if(r){var a=i.getSize();i._doPicking(r.x*a.width,(i.applyYInversionOnUpdate?1-r.y:r.y)*a.height,t,t.type,o,t.event.button,t.event.deltaX,t.event.deltaY)}}else if(t.type===l.PointerEventTypes.POINTERUP){if(i._lastControlDown[o]&&i._lastControlDown[o]._forcePointerUp(o),delete i._lastControlDown[o],i.focusedControl){var s=i.focusedControl.keepsFocusWith(),_=!0;if(s)for(var h=0,c=s;h<c.length;h++){var u=c[h];if(i!==u._host){var d=u._host;if(d._lastControlOver[o]&&d._lastControlOver[o].isAscendant(u)){_=!1;break}}}_&&(i.focusedControl=null)}}else t.type===l.PointerEventTypes.POINTERMOVE&&(i._lastControlOver[o]&&i._lastControlOver[o]._onPointerOut(i._lastControlOver[o],t,!0),delete i._lastControlOver[o])}})),e.enablePointerMoveEvents=t,this._attachToOnPointerOut(n),this._attachToOnBlur(n))},t.prototype.moveFocusToControl=function(e){this.focusedControl=e,this._lastPickedControl=e,this._blockNextFocusCheck=!0},t.prototype._manageFocus=function(){if(this._blockNextFocusCheck)return this._blockNextFocusCheck=!1,void(this._lastPickedControl=this._focusedControl);if(this._focusedControl&&this._focusedControl!==this._lastPickedControl){if(this._lastPickedControl.isFocusInvisible)return;this.focusedControl=null}},t.prototype._attachToOnPointerOut=function(e){var t=this;this._canvasPointerOutObserver=e.getEngine().onCanvasPointerOutObservable.add((function(e){t._lastControlOver[e.pointerId]&&t._lastControlOver[e.pointerId]._onPointerOut(t._lastControlOver[e.pointerId],null),delete t._lastControlOver[e.pointerId],t._lastControlDown[e.pointerId]&&t._lastControlDown[e.pointerId]!==t._capturingControl[e.pointerId]&&(t._lastControlDown[e.pointerId]._forcePointerUp(),delete t._lastControlDown[e.pointerId])}))},t.prototype._attachToOnBlur=function(e){var t=this;this._canvasBlurObserver=e.getEngine().onCanvasBlurObservable.add((function(e){Object.entries(t._lastControlDown).forEach((function(e){e[0],e[1]._onCanvasBlur()})),t.focusedControl=null,t._lastControlDown={}}))},t.prototype.serializeContent=function(){var e=this.getSize(),t={root:{},width:e.width,height:e.height};return this._rootContainer.serialize(t.root),t},t.prototype.parseContent=function(e,t){if(this._rootContainer=g.Parse(e.root,this),t){var i=e.width,n=e.height;"number"==typeof i&&"number"==typeof n&&i>=0&&n>=0&&this.scaleTo(i,n)}},t.prototype.parseFromSnippetAsync=function(e,i){var n=this;return"_BLANK"===e?Promise.resolve():new Promise((function(o,r){var a=new l.WebRequest;a.addEventListener("readystatechange",(function(){if(4==a.readyState)if(200==a.status){var t=JSON.parse(JSON.parse(a.responseText).jsonPayload),s=JSON.parse(t.gui);n.parseContent(s,i),n.snippetId=e,o()}else r("Unable to load the snippet "+e)})),a.open("GET",t.SnippetUrl+"/"+e.replace(/#/g,"/")),a.send()}))},t.prototype.parseFromURLAsync=function(e,t){var i=this;return""===e?Promise.resolve():new Promise((function(n,o){var r=new l.WebRequest;r.addEventListener("readystatechange",(function(){if(4==r.readyState)if(200==r.status){var e=r.responseText,a=JSON.parse(e);i.parseContent(a,t),n()}else o("Unable to load")})),r.open("GET",e),r.send()}))},t._Overlaps=function(e,t){return!(e.centerX>t.centerX+t.widthInPixels||e.centerX+e.widthInPixels<t.centerX||e.centerY+e.heightInPixels<t.centerY||e.centerY>t.centerY+t.heightInPixels)},t.CreateForMesh=function(e,i,n,o,r,a){void 0===i&&(i=1024),void 0===n&&(n=1024),void 0===o&&(o=!0),void 0===r&&(r=!1);var s=new t(e.name+" AdvancedDynamicTexture",i,n,e.getScene(),!0,l.Texture.TRILINEAR_SAMPLINGMODE,a),_=new l.StandardMaterial("AdvancedDynamicTextureMaterial",e.getScene());return _.backFaceCulling=!1,_.diffuseColor=l.Color3.Black(),_.specularColor=l.Color3.Black(),r?(_.diffuseTexture=s,_.emissiveTexture=s,s.hasAlpha=!0):(_.emissiveTexture=s,_.opacityTexture=s),e.material=_,s.attachToMesh(e,o),s},t.CreateForMeshTexture=function(e,i,n,o,r){void 0===i&&(i=1024),void 0===n&&(n=1024),void 0===o&&(o=!0);var a=new t(e.name+" AdvancedDynamicTexture",i,n,e.getScene(),!0,l.Texture.TRILINEAR_SAMPLINGMODE,r);return a.attachToMesh(e,o),a},t.CreateFullscreenUI=function(e,i,n,o,r){void 0===i&&(i=!0),void 0===n&&(n=null),void 0===o&&(o=l.Texture.BILINEAR_SAMPLINGMODE),void 0===r&&(r=!1);var a=new t(e,0,0,n,!1,o),s=a.getScene(),_=new l.Layer(e+"_layer",null,s,!i);if(_.texture=a,a._layerToDispose=_,a._isFullscreen=!0,r&&s){var h=1/s.getEngine().getHardwareScalingLevel();a._rootContainer.scaleX=h,a._rootContainer.scaleY=h}return a.attach(),a},t.SnippetUrl="https://snippet.babylonjs.com",t.AllowGPUOptimizations=!0,t}(l.DynamicTexture),ie=function(){function e(e){this.texture=e,this._captureRenderTime=!1,this._renderTime=new l.PerfCounter,this._captureLayoutTime=!1,this._layoutTime=new l.PerfCounter,this._onBeginRenderObserver=null,this._onEndRenderObserver=null,this._onBeginLayoutObserver=null,this._onEndLayoutObserver=null}return Object.defineProperty(e.prototype,"renderTimeCounter",{get:function(){return this._renderTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layoutTimeCounter",{get:function(){return this._layoutTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"captureRenderTime",{get:function(){return this._captureRenderTime},set:function(e){var t=this;e!==this._captureRenderTime&&(this._captureRenderTime=e,e?(this._onBeginRenderObserver=this.texture.onBeginRenderObservable.add((function(){t._renderTime.beginMonitoring()})),this._onEndRenderObserver=this.texture.onEndRenderObservable.add((function(){t._renderTime.endMonitoring(!0)}))):(this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver),this._onBeginRenderObserver=null,this.texture.onEndRenderObservable.remove(this._onEndRenderObserver),this._onEndRenderObserver=null))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"captureLayoutTime",{get:function(){return this._captureLayoutTime},set:function(e){var t=this;e!==this._captureLayoutTime&&(this._captureLayoutTime=e,e?(this._onBeginLayoutObserver=this.texture.onBeginLayoutObservable.add((function(){t._layoutTime.beginMonitoring()})),this._onEndLayoutObserver=this.texture.onEndLayoutObservable.add((function(){t._layoutTime.endMonitoring(!0)}))):(this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver),this._onBeginLayoutObserver=null,this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver),this._onEndLayoutObserver=null))},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver),this._onBeginRenderObserver=null,this.texture.onEndRenderObservable.remove(this._onEndRenderObserver),this._onEndRenderObserver=null,this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver),this._onBeginLayoutObserver=null,this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver),this._onEndLayoutObserver=null,this.texture=null},e}(),ne=function(){function e(e){void 0===e&&(e=null),this._nodes={},this._nodeTypes={element:1,attribute:2,text:3},this._isLoaded=!1,this._objectAttributes={textHorizontalAlignment:1,textVerticalAlignment:2,horizontalAlignment:3,verticalAlignment:4,stretch:5},e&&(this._parentClass=e)}return e.prototype._getChainElement=function(e){var t=window;this._parentClass&&(t=this._parentClass);var i=e;i=i.split(".");for(var n=0;n<i.length;n++)t=t[i[n]];return t},e.prototype._getClassAttribute=function(e){var t=e.split(".");return Object(l.GetClass)("BABYLON.GUI."+t[0])[t[1]]},e.prototype._createGuiElement=function(e,t,i){void 0===i&&(i=!0);try{var n=new(Object(l.GetClass)("BABYLON.GUI."+e.nodeName));t&&i&&t.addControl(n);for(var o=0;o<e.attributes.length;o++)if(!e.attributes[o].name.toLowerCase().includes("datasource"))if(e.attributes[o].name.toLowerCase().includes("observable")){var r=this._getChainElement(e.attributes[o].value);n[e.attributes[o].name].add(r)}else"linkWithMesh"==e.attributes[o].name?this._parentClass?n.linkWithMesh(this._parentClass[e.attributes[o].value]):n.linkWithMesh(window[e.attributes[o].value]):e.attributes[o].value.startsWith("{{")&&e.attributes[o].value.endsWith("}}")?(r=this._getChainElement(e.attributes[o].value.substring(2,e.attributes[o].value.length-2)),n[e.attributes[o].name]=r):this._objectAttributes[e.attributes[o].name]?n[e.attributes[o].name]=this._getClassAttribute(e.attributes[o].value):"true"==e.attributes[o].value||"false"==e.attributes[o].value?n[e.attributes[o].name]="true"==e.attributes[o].value:n[e.attributes[o].name]=isNaN(Number(e.attributes[o].value))?e.attributes[o].value:Number(e.attributes[o].value);if(!e.attributes.getNamedItem("id"))return this._nodes[e.nodeName+Object.keys(this._nodes).length+"_gen"]=n,n;var a=e.attributes.getNamedItem("id").value;if(a.startsWith("{{")&&a.endsWith("}}")&&(a=this._getChainElement(a.substring(2,a.length-2))),this._nodes[a])throw"XmlLoader Exception : Duplicate ID, every element should have an unique ID attribute";return this._nodes[a]=n,n}catch(t){throw"XmlLoader Exception : Error parsing Control "+e.nodeName+","+t+"."}},e.prototype._parseGrid=function(e,t,i){for(var n,o,r,a,s,l=e.children,_=!1,h=-1,c=-1,u=0,d=0;d<l.length;d++)if(l[d].nodeType==this._nodeTypes.element){if("Row"!=l[d].nodeName)throw"XmlLoader Exception : Expecting Row node, received "+l[d].nodeName;if(h+=1,r=l[d].children,!l[d].attributes.getNamedItem("height"))throw"XmlLoader Exception : Height must be defined for grid rows";o=Number(l[d].attributes.getNamedItem("height").nodeValue),_=!!l[d].attributes.getNamedItem("isPixel")&&JSON.parse(l[d].attributes.getNamedItem("isPixel").nodeValue),t.addRowDefinition(o,_);for(var f=0;f<r.length;f++)if(r[f].nodeType==this._nodeTypes.element){if("Column"!=r[f].nodeName)throw"XmlLoader Exception : Expecting Column node, received "+r[f].nodeName;if(c+=1,h>0&&c>u)throw"XmlLoader Exception : In the Grid element, the number of columns is defined in the first row, do not add more columns in the subsequent rows.";if(0==h){if(!r[f].attributes.getNamedItem("width"))throw"XmlLoader Exception : Width must be defined for all the grid columns in the first row";n=Number(r[f].attributes.getNamedItem("width").nodeValue),_=!!r[f].attributes.getNamedItem("isPixel")&&JSON.parse(r[f].attributes.getNamedItem("isPixel").nodeValue),t.addColumnDefinition(n,_)}a=r[f].children;for(var p=0;p<a.length;p++)a[p].nodeType==this._nodeTypes.element&&(s=this._createGuiElement(a[p],t,!1),t.addControl(s,h,c),a[p].firstChild&&this._parseXml(a[p].firstChild,s))}0==h&&(u=c),c=-1}e.nextSibling&&this._parseXml(e.nextSibling,i)},e.prototype._parseElement=function(e,t,i){e.firstChild&&this._parseXml(e.firstChild,t),e.nextSibling&&this._parseXml(e.nextSibling,i)},e.prototype._prepareSourceElement=function(e,t,i,n,o){this._parentClass?this._parentClass[i]=n[o]:window[i]=n[o],e.firstChild&&this._parseXml(e.firstChild,t,!0)},e.prototype._parseElementsFromSource=function(e,t,i){var n=e.attributes.getNamedItem("dataSource").value;if(!n.includes(" in "))throw"XmlLoader Exception : Malformed XML, Data Source must include an in";var o=!0,r=n.split(" in ");if(r.length<2)throw"XmlLoader Exception : Malformed XML, Data Source must have an iterator and a source";var a=r[1];if(a.startsWith("{")&&a.endsWith("}")&&(o=!1),(!o||a.startsWith("[")&&a.endsWith("]"))&&(a=a.substring(1,a.length-1)),a=this._parentClass?this._parentClass[a]:window[a],o)for(var s=0;s<a.length;s++)this._prepareSourceElement(e,t,r[0],a,s);else for(var s in a)this._prepareSourceElement(e,t,r[0],a,s);e.nextSibling&&this._parseXml(e.nextSibling,i)},e.prototype._parseXml=function(e,t,i){if(void 0===i&&(i=!1),e.nodeType==this._nodeTypes.element){i&&e.setAttribute("id",t.id+(t._children.length+1));var n=this._createGuiElement(e,t);this._rootNode||(this._rootNode=n),"Grid"==e.nodeName?this._parseGrid(e,n,t):e.attributes.getNamedItem("dataSource")?this._parseElementsFromSource(e,n,t):this._parseElement(e,n,t)}else e.nextSibling&&this._parseXml(e.nextSibling,t,i)},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.getNodeById=function(e){return this._nodes[e]},e.prototype.getNodes=function(){return this._nodes},e.prototype.dispose=function(){this._rootNode&&(this._rootNode.dispose(),this._rootNode=null,this._nodes={})},e.prototype.loadLayout=function(e,t,i,n){var o=this;void 0===i&&(i=null),void 0===n&&(n=null);var r=new XMLHttpRequest;r.onload=function(){if(4===r.readyState&&200===r.status){if(!r.responseXML)throw"XmlLoader Exception : XML file is malformed or corrupted.";var e=r.responseXML.documentElement;o._parseXml(e.firstChild,t),o._isLoaded=!0,i&&i()}},r.onerror=function(){n&&n("an error occurred during loading the layout")},r.open("GET",e,!0),r.send()},e.prototype.loadLayoutAsync=function(e,t){return a(this,void 0,void 0,(function(){var i=this;return s(this,(function(n){return[2,new Promise((function(n,o){i.loadLayout(e,t,n,o)}))]}))}))},e}(),oe=function(e){function t(t,i){void 0===i&&(i=0);var n=e.call(this,t.x,t.y,t.z)||this;return n.buttonIndex=i,n}return o(t,e),t}(l.Vector3),rt=function(){function e(e){this.name=e,this._downCount=0,this._enterCount=-1,this._downPointerIds={},this._isVisible=!0,this._isScaledByManager=!1,this.onPointerMoveObservable=new l.Observable,this.onPointerOutObservable=new l.Observable,this.onPointerDownObservable=new l.Observable,this.onPointerUpObservable=new l.Observable,this.onPointerClickObservable=new l.Observable,this.onPointerEnterObservable=new l.Observable,this._behaviors=new Array}return Object.defineProperty(e.prototype,"position",{get:function(){return this._node?this._node.position:l.Vector3.Zero()},set:function(e){this._node&&(this._node.position=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaling",{get:function(){return this._node?this._node.scaling:new l.Vector3(1,1,1)},set:function(e){this._node&&(this._isScaledByManager=!1,this._node.scaling=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"behaviors",{get:function(){return this._behaviors},enumerable:!1,configurable:!0}),e.prototype.addBehavior=function(e){var t=this;if(-1!==this._behaviors.indexOf(e))return this;e.init();var i=this._host.scene;return i.isLoading?i.onDataLoadedObservable.addOnce((function(){e.attach(t)})):e.attach(this),this._behaviors.push(e),this},e.prototype.removeBehavior=function(e){var t=this._behaviors.indexOf(e);return-1===t||(this._behaviors[t].detach(),this._behaviors.splice(t,1)),this},e.prototype.getBehaviorByName=function(e){for(var t=0,i=this._behaviors;t<i.length;t++){var n=i[t];if(n.name===e)return n}return null},Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){if(this._isVisible!==e){this._isVisible=e;var t=this.mesh;t&&t.setEnabled(e)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return this._getTypeName()},e.prototype._getTypeName=function(){return"Control3D"},Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mesh",{get:function(){return this._node instanceof l.AbstractMesh?this._node:null},enumerable:!1,configurable:!0}),e.prototype.linkToTransformNode=function(e){return this._node&&(this._node.parent=e),this},e.prototype._prepareNode=function(e){if(!this._node){if(this._node=this._createNode(e),!this.node)return;this._injectGUI3DReservedDataStore(this.node).control=this;var t=this.mesh;t&&(t.isPickable=!0,this._affectMaterial(t))}},e.prototype._injectGUI3DReservedDataStore=function(e){var t,i;return e.reservedDataStore=null!==(t=e.reservedDataStore)&&void 0!==t?t:{},e.reservedDataStore.GUI3D=null!==(i=e.reservedDataStore.GUI3D)&&void 0!==i?i:{},e.reservedDataStore.GUI3D},e.prototype._createNode=function(e){return null},e.prototype._affectMaterial=function(e){e.material=null},e.prototype._IsTouchButton3D=function(e){return void 0!==e._generatePointerEventType},e.prototype._onPointerMove=function(e,t){this.onPointerMoveObservable.notifyObservers(t,-1,e,this)},e.prototype._onPointerEnter=function(e){return-1===this._enterCount&&(this._enterCount=0),this._enterCount++,!(this._enterCount>1||(this.onPointerEnterObservable.notifyObservers(this,-1,e,this),this.pointerEnterAnimation&&this.pointerEnterAnimation(),0))},e.prototype._onPointerOut=function(e){this._enterCount--,this._enterCount>0||(this._enterCount=0,this.onPointerOutObservable.notifyObservers(this,-1,e,this),this.pointerOutAnimation&&this.pointerOutAnimation())},e.prototype._onPointerDown=function(e,t,i,n){return this._downCount++,this._downPointerIds[i]=this._downPointerIds[i]+1||1,1===this._downCount&&(this.onPointerDownObservable.notifyObservers(new oe(t,n),-1,e,this),this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},e.prototype._onPointerUp=function(e,t,i,n,o){this._downCount--,this._downPointerIds[i]--,this._downPointerIds[i]<=0&&delete this._downPointerIds[i],this._downCount<0?this._downCount=0:0==this._downCount&&(o&&(this._enterCount>0||-1===this._enterCount)&&this.onPointerClickObservable.notifyObservers(new oe(t,n),-1,e,this),this.onPointerUpObservable.notifyObservers(new oe(t,n),-1,e,this),this.pointerUpAnimation&&this.pointerUpAnimation())},e.prototype.forcePointerUp=function(e){if(void 0===e&&(e=null),null!==e)this._onPointerUp(this,l.Vector3.Zero(),e,0,!0);else{for(var t in this._downPointerIds)this._onPointerUp(this,l.Vector3.Zero(),+t,0,!0);this._downCount>0&&(this._downCount=1,this._onPointerUp(this,l.Vector3.Zero(),0,0,!0))}},e.prototype._processObservables=function(e,t,i,n,o){if(this._IsTouchButton3D(this)&&i&&(e=this._generatePointerEventType(e,i,this._downCount)),e===l.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,t);var r=this._host._lastControlOver[n];return r&&r!==this&&r._onPointerOut(this),r!==this&&this._onPointerEnter(this),this._host._lastControlOver[n]=this,!0}return e===l.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,t,n,o),this._host._lastControlDown[n]=this,this._host._lastPickedControl=this,!0):(e===l.PointerEventTypes.POINTERUP||e===l.PointerEventTypes.POINTERDOUBLETAP)&&(this._host._lastControlDown[n]&&this._host._lastControlDown[n]._onPointerUp(this,t,n,o,!0),delete this._host._lastControlDown[n],!0)},e.prototype._disposeNode=function(){this._node&&(this._node.dispose(),this._node=null)},e.prototype.dispose=function(){this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this._disposeNode();for(var e=0,t=this._behaviors;e<t.length;e++)t[e].detach()},e}(),re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._contentResolution=512,t._contentScaleRatio=2,t}return o(t,e),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){this._content=e,this._host&&this._host.utilityLayer&&(this._facadeTexture?this._facadeTexture.rootContainer.clearControls():(this._facadeTexture=new te("Facade",this._contentResolution,this._contentResolution,this._host.utilityLayer.utilityLayerScene,!0,l.Texture.TRILINEAR_SAMPLINGMODE),this._facadeTexture.rootContainer.scaleX=this._contentScaleRatio,this._facadeTexture.rootContainer.scaleY=this._contentScaleRatio,this._facadeTexture.premulAlpha=!0),this._facadeTexture.addControl(e),this._applyFacade(this._facadeTexture))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentResolution",{get:function(){return this._contentResolution},set:function(e){this._contentResolution!==e&&(this._contentResolution=e,this._resetContent())},enumerable:!1,configurable:!0}),t.prototype._disposeFacadeTexture=function(){this._facadeTexture&&(this._facadeTexture.dispose(),this._facadeTexture=null)},t.prototype._resetContent=function(){this._disposeFacadeTexture(),this.content=this._content},t.prototype._applyFacade=function(e){},t}(rt),ae=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype._getTypeName=function(){return"AbstractButton3D"},t.prototype._createNode=function(e){return new l.TransformNode("button"+this.name)},t}(re),se=function(e){function t(t){var i=e.call(this,t)||this;return i.pointerEnterAnimation=function(){i.mesh&&(i._currentMaterial.emissiveColor=l.Color3.Red())},i.pointerOutAnimation=function(){i._currentMaterial.emissiveColor=l.Color3.Black()},i.pointerDownAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(.95)},i.pointerUpAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(1/.95)},i}return o(t,e),t.prototype._applyFacade=function(e){this._currentMaterial.emissiveTexture=e},t.prototype._getTypeName=function(){return"Button3D"},t.prototype._createNode=function(e){for(var t=new Array(6),i=0;i<6;i++)t[i]=new l.Vector4(0,0,0,0);return e.useRightHandedSystem?t[0].copyFromFloats(1,0,0,1):t[1].copyFromFloats(0,0,1,1),Object(l.CreateBox)(this.name+"_rootMesh",{width:1,height:1,depth:.08,faceUV:t,wrap:!0},e)},t.prototype._affectMaterial=function(e){var t=new l.StandardMaterial(this.name+"Material",e.getScene());t.specularColor=l.Color3.Black(),e.material=t,this._currentMaterial=t,this._resetContent()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeFacadeTexture(),this._currentMaterial&&this._currentMaterial.dispose()},t}(ae),le=function(e){function t(t){var i=e.call(this,t)||this;return i._blockLayout=!1,i._children=new Array,i}return o(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blockLayout",{get:function(){return this._blockLayout},set:function(e){this._blockLayout!==e&&(this._blockLayout=e,this._blockLayout||this._arrangeChildren())},enumerable:!1,configurable:!0}),t.prototype.updateLayout=function(){return this._arrangeChildren(),this},t.prototype.containsControl=function(e){return-1!==this._children.indexOf(e)},t.prototype.addControl=function(e){return-1!==this._children.indexOf(e)||(e.parent=this,e._host=this._host,this._children.push(e),this._host.utilityLayer&&(e._prepareNode(this._host.utilityLayer.utilityLayerScene),e.node&&(e.node.parent=this.node),this.blockLayout||this._arrangeChildren())),this},t.prototype._arrangeChildren=function(){},t.prototype._createNode=function(e){return new l.TransformNode("ContainerNode",e)},t.prototype.removeControl=function(e){var t=this._children.indexOf(e);return-1!==t&&(this._children.splice(t,1),e.parent=null,e._disposeNode()),this},t.prototype._getTypeName=function(){return"Container3D"},t.prototype.dispose=function(){for(var t=0,i=this._children;t<i.length;t++)i[t].dispose();this._children=[],e.prototype.dispose.call(this)},t.UNSET_ORIENTATION=0,t.FACEORIGIN_ORIENTATION=1,t.FACEORIGINREVERSED_ORIENTATION=2,t.FACEFORWARD_ORIENTATION=3,t.FACEFORWARDREVERSED_ORIENTATION=4,t}(rt),_e=function(e){function t(t){var i=e.call(this,t)||this;return i._columns=10,i._rows=0,i._rowThenColum=!0,i._orientation=le.FACEORIGIN_ORIENTATION,i.margin=0,i}return o(t,e),Object.defineProperty(t.prototype,"orientation",{get:function(){return this._orientation},set:function(e){var t=this;this._orientation!==e&&(this._orientation=e,l.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this._columns},set:function(e){var t=this;this._columns!==e&&(this._columns=e,this._rowThenColum=!0,l.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._rows},set:function(e){var t=this;this._rows!==e&&(this._rows=e,this._rowThenColum=!1,l.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._arrangeChildren=function(){this._cellWidth=0,this._cellHeight=0;for(var e=0,t=0,i=0,n=l.Matrix.Invert(this.node.computeWorldMatrix(!0)),o=0,r=this._children;o<r.length;o++)if((m=r[o]).mesh){i++,m.mesh.computeWorldMatrix(!0);var a=m.mesh.getHierarchyBoundingVectors(),s=l.TmpVectors.Vector3[0],_=l.TmpVectors.Vector3[1];a.max.subtractToRef(a.min,_),_.scaleInPlace(.5),l.Vector3.TransformNormalToRef(_,n,s),this._cellWidth=Math.max(this._cellWidth,2*s.x),this._cellHeight=Math.max(this._cellHeight,2*s.y)}this._cellWidth+=2*this.margin,this._cellHeight+=2*this.margin,this._rowThenColum?(t=this._columns,e=Math.ceil(i/this._columns)):(e=this._rows,t=Math.ceil(i/this._rows));var h=.5*t*this._cellWidth,c=.5*e*this._cellHeight,u=[],d=0;if(this._rowThenColum)for(var f=0;f<e;f++)for(var p=0;p<t&&(u.push(new l.Vector3(p*this._cellWidth-h+this._cellWidth/2,f*this._cellHeight-c+this._cellHeight/2,0)),!(++d>i));p++);else for(p=0;p<t;p++)for(f=0;f<e&&(u.push(new l.Vector3(p*this._cellWidth-h+this._cellWidth/2,f*this._cellHeight-c+this._cellHeight/2,0)),!(++d>i));f++);d=0;for(var b=0,g=this._children;b<g.length;b++){var m;(m=g[b]).mesh&&(this._mapGridNode(m,u[d]),d++)}this._finalProcessing()},t.prototype._finalProcessing=function(){},t}(le),he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._radius=5,t}return o(t,e),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){var t=this;this._radius!==e&&(this._radius=e,l.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._mapGridNode=function(e,t){var i=e.mesh;if(i){var n=this._cylindricalMapping(t);switch(e.position=n,this.orientation){case le.FACEORIGIN_ORIENTATION:i.lookAt(new l.Vector3(2*n.x,n.y,2*n.z));break;case le.FACEORIGINREVERSED_ORIENTATION:i.lookAt(new l.Vector3(-n.x,n.y,-n.z));break;case le.FACEFORWARD_ORIENTATION:break;case le.FACEFORWARDREVERSED_ORIENTATION:i.rotate(l.Axis.Y,Math.PI,l.Space.LOCAL)}}},t.prototype._cylindricalMapping=function(e){var t=new l.Vector3(0,e.y,this._radius),i=e.x/this._radius;return l.Matrix.RotationYawPitchRollToRef(i,0,0,l.TmpVectors.Matrix[0]),l.Vector3.TransformNormal(t,l.TmpVectors.Matrix[0])},t}(_e),ce="precision highp float;\n\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\nuniform mat4 world;\nuniform mat4 viewProjection;\nvarying vec2 vUV;\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float borderWidth;\nuniform vec3 scaleFactor;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\n#endif\nvoid main(void) {\nvUV=uv;\n#ifdef BORDER\nvec3 scale=scaleFactor;\nfloat minScale=min(min(scale.x,scale.y),scale.z);\nfloat maxScale=max(max(scale.x,scale.y),scale.z);\nfloat minOverMiddleScale=minScale/(scale.x+scale.y+scale.z-minScale-maxScale);\nfloat areaYZ=scale.y*scale.z;\nfloat areaXZ=scale.x*scale.z;\nfloat areaXY=scale.x*scale.y;\nfloat scaledBorderWidth=borderWidth;\nif (abs(normal.x) == 1.0)\n{\nscale.x=scale.y;\nscale.y=scale.z;\nif (areaYZ>areaXZ && areaYZ>areaXY)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse if (abs(normal.y) == 1.0)\n{\nscale.x=scale.z;\nif (areaXZ>areaXY && areaXZ>areaYZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse\n{\nif (areaXY>areaYZ && areaXY>areaXZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nfloat scaleRatio=min(scale.x,scale.y)/max(scale.x,scale.y);\nif (scale.x>scale.y)\n{\nscaleInfo.x=1.0-(scaledBorderWidth*scaleRatio);\nscaleInfo.y=1.0-scaledBorderWidth;\n}\nelse\n{\nscaleInfo.x=1.0-scaledBorderWidth;\nscaleInfo.y=1.0-(scaledBorderWidth*scaleRatio);\n}\n#endif\nvec4 worldPos=world*vec4(position,1.0);\n#ifdef HOVERLIGHT\nworldPosition=worldPos.xyz;\n#endif\ngl_Position=viewProjection*worldPos;\n}\n";l.ShaderStore.ShadersStore.fluentVertexShader=ce;var dt="precision highp float;\nvarying vec2 vUV;\nuniform vec4 albedoColor;\n#ifdef INNERGLOW\nuniform vec4 innerGlowColor;\n#endif\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float edgeSmoothingValue;\nuniform float borderMinValue;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\nuniform vec3 hoverPosition;\nuniform vec4 hoverColor;\nuniform float hoverRadius;\n#endif\n#ifdef TEXTURE\nuniform sampler2D albedoSampler;\nuniform mat4 textureMatrix;\nvec2 finalUV;\n#endif\nvoid main(void) {\nvec3 albedo=albedoColor.rgb;\nfloat alpha=albedoColor.a;\n#ifdef TEXTURE\nfinalUV=vec2(textureMatrix*vec4(vUV,1.0,0.0));\nalbedo=texture2D(albedoSampler,finalUV).rgb;\n#endif\n#ifdef HOVERLIGHT\nfloat pointToHover=(1.0-clamp(length(hoverPosition-worldPosition)/hoverRadius,0.,1.))*hoverColor.a;\nalbedo=clamp(albedo+hoverColor.rgb*pointToHover,0.,1.);\n#else\nfloat pointToHover=1.0;\n#endif\n#ifdef BORDER\nfloat borderPower=10.0;\nfloat inverseBorderPower=1.0/borderPower;\nvec3 borderColor=albedo*borderPower;\nvec2 distanceToEdge;\ndistanceToEdge.x=abs(vUV.x-0.5)*2.0;\ndistanceToEdge.y=abs(vUV.y-0.5)*2.0;\nfloat borderValue=max(smoothstep(scaleInfo.x-edgeSmoothingValue,scaleInfo.x+edgeSmoothingValue,distanceToEdge.x),\nsmoothstep(scaleInfo.y-edgeSmoothingValue,scaleInfo.y+edgeSmoothingValue,distanceToEdge.y));\nborderColor=borderColor*borderValue*max(borderMinValue*inverseBorderPower,pointToHover);\nalbedo+=borderColor;\nalpha=max(alpha,borderValue);\n#endif\n#ifdef INNERGLOW\n\nvec2 uvGlow=(vUV-vec2(0.5,0.5))*(innerGlowColor.a*2.0);\nuvGlow=uvGlow*uvGlow;\nuvGlow=uvGlow*uvGlow;\nalbedo+=mix(vec3(0.0,0.0,0.0),innerGlowColor.rgb,uvGlow.x+uvGlow.y);\n#endif\ngl_FragColor=vec4(albedo,alpha);\n}";l.ShaderStore.ShadersStore.fluentPixelShader=dt;var ue=function(e){function t(){var t=e.call(this)||this;return t.INNERGLOW=!1,t.BORDER=!1,t.HOVERLIGHT=!1,t.TEXTURE=!1,t.rebuild(),t}return o(t,e),t}(l.MaterialDefines),de=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.innerGlowColorIntensity=.5,n.innerGlowColor=new l.Color3(1,1,1),n.albedoColor=new l.Color3(.3,.35,.4),n.renderBorders=!1,n.borderWidth=.5,n.edgeSmoothingValue=.02,n.borderMinValue=.1,n.renderHoverLight=!1,n.hoverRadius=1,n.hoverColor=new l.Color4(.3,.3,.3,1),n.hoverPosition=l.Vector3.Zero(),n}return o(t,e),t.prototype.needAlphaBlending=function(){return 1!==this.alpha},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,i){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t.materialDefines||(t.materialDefines=new ue);var n=this.getScene(),o=t.materialDefines;if(!this.checkReadyOnEveryCall&&t.effect&&o._renderId===n.getRenderId())return!0;if(o._areTexturesDirty)if(o.INNERGLOW=this.innerGlowColorIntensity>0,o.BORDER=this.renderBorders,o.HOVERLIGHT=this.renderHoverLight,this._albedoTexture){if(!this._albedoTexture.isReadyOrNotBlocking())return!1;o.TEXTURE=!0}else o.TEXTURE=!1;var r=n.getEngine();if(o.isDirty){o.markAsProcessed(),n.resetCachedMaterial();var a=[l.VertexBuffer.PositionKind];a.push(l.VertexBuffer.NormalKind),a.push(l.VertexBuffer.UVKind);var s=["world","viewProjection","innerGlowColor","albedoColor","borderWidth","edgeSmoothingValue","scaleFactor","borderMinValue","hoverColor","hoverPosition","hoverRadius","textureMatrix"],_=["albedoSampler"],h=new Array;l.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:s,uniformBuffersNames:h,samplers:_,defines:o,maxSimultaneousLights:4});var c=o.toString();t.setEffect(n.getEngine().createEffect("fluent",{attributes:a,uniformsNames:s,uniformBuffersNames:h,samplers:_,defines:c,fallbacks:null,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},r),o,this._materialContext)}return!(!t.effect||!t.effect.isReady()||(o._renderId=n.getRenderId(),t.effect._wasPreviouslyReady=!0,0))},t.prototype.bindForSubMesh=function(e,t,i){var n=this.getScene(),o=i.materialDefines;if(o){var r=i.effect;if(r){if(this._activeEffect=r,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",n.getTransformMatrix()),this._mustRebind(n,r)&&(this._activeEffect.setColor4("albedoColor",this.albedoColor,this.alpha),o.INNERGLOW&&this._activeEffect.setColor4("innerGlowColor",this.innerGlowColor,this.innerGlowColorIntensity),o.BORDER&&(this._activeEffect.setFloat("borderWidth",this.borderWidth),this._activeEffect.setFloat("edgeSmoothingValue",this.edgeSmoothingValue),this._activeEffect.setFloat("borderMinValue",this.borderMinValue),t.getBoundingInfo().boundingBox.extendSize.multiplyToRef(t.scaling,l.TmpVectors.Vector3[0]),this._activeEffect.setVector3("scaleFactor",l.TmpVectors.Vector3[0])),o.HOVERLIGHT&&(this._activeEffect.setDirectColor4("hoverColor",this.hoverColor),this._activeEffect.setFloat("hoverRadius",this.hoverRadius),this._activeEffect.setVector3("hoverPosition",this.hoverPosition)),o.TEXTURE&&this._albedoTexture)){this._activeEffect.setTexture("albedoSampler",this._albedoTexture);var a=this._albedoTexture.getTextureMatrix();this._activeEffect.setMatrix("textureMatrix",a)}this._afterBind(t,this._activeEffect)}}},t.prototype.getActiveTextures=function(){return e.prototype.getActiveTextures.call(this)},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var i=this;return l.SerializationHelper.Clone((function(){return new t(e,i.getScene())}),this)},t.prototype.serialize=function(){var e=l.SerializationHelper.Serialize(this);return e.customType="BABYLON.GUI.FluentMaterial",e},t.prototype.getClassName=function(){return"FluentMaterial"},t.Parse=function(e,i,n){return l.SerializationHelper.Parse((function(){return new t(e.name,i)}),e,i,n)},r([Object(l.serialize)(),Object(l.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"innerGlowColorIntensity",void 0),r([Object(l.serializeAsColor3)()],t.prototype,"innerGlowColor",void 0),r([Object(l.serializeAsColor3)()],t.prototype,"albedoColor",void 0),r([Object(l.serialize)(),Object(l.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"renderBorders",void 0),r([Object(l.serialize)()],t.prototype,"borderWidth",void 0),r([Object(l.serialize)()],t.prototype,"edgeSmoothingValue",void 0),r([Object(l.serialize)()],t.prototype,"borderMinValue",void 0),r([Object(l.serialize)(),Object(l.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"renderHoverLight",void 0),r([Object(l.serialize)()],t.prototype,"hoverRadius",void 0),r([Object(l.serializeAsColor4)()],t.prototype,"hoverColor",void 0),r([Object(l.serializeAsVector3)()],t.prototype,"hoverPosition",void 0),r([Object(l.serializeAsTexture)("albedoTexture")],t.prototype,"_albedoTexture",void 0),r([Object(l.expandToProperty)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"albedoTexture",void 0),t}(l.PushMaterial);Object(l.RegisterClass)("BABYLON.GUI.FluentMaterial",de);var fe=function(e){function t(t,i){void 0===i&&(i=!0);var n=e.call(this,t)||this;return n._shareMaterials=!0,n._shareMaterials=i,n.pointerEnterAnimation=function(){n.mesh&&n._frontPlate.setEnabled(!0)},n.pointerOutAnimation=function(){n.mesh&&n._frontPlate.setEnabled(!1)},n}return o(t,e),t.prototype._disposeTooltip=function(){this._tooltipFade=null,this._tooltipTextBlock&&this._tooltipTextBlock.dispose(),this._tooltipTexture&&this._tooltipTexture.dispose(),this._tooltipMesh&&this._tooltipMesh.dispose(),this.onPointerEnterObservable.remove(this._tooltipHoverObserver),this.onPointerOutObservable.remove(this._tooltipOutObserver)},Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._backPlate.renderingGroupId},set:function(e){this._backPlate.renderingGroupId=e,this._textPlate.renderingGroupId=e,this._frontPlate.renderingGroupId=e,this._tooltipMesh&&(this._tooltipMesh.renderingGroupId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltipText",{get:function(){return this._tooltipTextBlock?this._tooltipTextBlock.text:null},set:function(e){var t=this;if(e){if(!this._tooltipFade){var i=this._backPlate._scene.useRightHandedSystem;this._tooltipMesh=Object(l.CreatePlane)("",{size:1},this._backPlate._scene);var n=Object(l.CreatePlane)("",{size:1,sideOrientation:l.Mesh.DOUBLESIDE},this._backPlate._scene),o=new l.StandardMaterial("",this._backPlate._scene);o.diffuseColor=l.Color3.FromHexString("#212121"),n.material=o,n.isPickable=!1,this._tooltipMesh.addChild(n),n.position=l.Vector3.Forward(i).scale(.05),this._tooltipMesh.scaling.y=1/3,this._tooltipMesh.position=l.Vector3.Up().scale(.7).add(l.Vector3.Forward(i).scale(-.15)),this._tooltipMesh.isPickable=!1,this._tooltipMesh.parent=this._backPlate,this._tooltipTexture=te.CreateForMesh(this._tooltipMesh),this._tooltipTextBlock=new x,this._tooltipTextBlock.scaleY=3,this._tooltipTextBlock.color="white",this._tooltipTextBlock.fontSize=130,this._tooltipTexture.addControl(this._tooltipTextBlock),this._tooltipFade=new l.FadeInOutBehavior,this._tooltipFade.delay=500,this._tooltipMesh.addBehavior(this._tooltipFade),this._tooltipHoverObserver=this.onPointerEnterObservable.add((function(){t._tooltipFade&&t._tooltipFade.fadeIn(!0)})),this._tooltipOutObserver=this.onPointerOutObservable.add((function(){t._tooltipFade&&t._tooltipFade.fadeIn(!1)}))}this._tooltipTextBlock&&(this._tooltipTextBlock.text=e)}else this._disposeTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl!==e&&(this._imageUrl=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backMaterial",{get:function(){return this._backMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frontMaterial",{get:function(){return this._frontMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plateMaterial",{get:function(){return this._plateMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shareMaterials",{get:function(){return this._shareMaterials},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"HolographicButton"},t.prototype._rebuildContent=function(){this._disposeFacadeTexture();var e=new B;if(e.isVertical=!0,l.DomManagement.IsDocumentAvailable()&&document.createElement&&this._imageUrl){var t=new P;t.source=this._imageUrl,t.paddingTop="40px",t.height="180px",t.width="100px",t.paddingBottom="40px",e.addControl(t)}if(this._text){var i=new x;i.text=this._text,i.color="white",i.height="30px",i.fontSize=24,e.addControl(i)}this._frontPlate&&(this.content=e)},t.prototype._createNode=function(t){return this._backPlate=Object(l.CreateBox)(this.name+"BackMesh",{width:1,height:1,depth:.08},t),this._frontPlate=Object(l.CreateBox)(this.name+"FrontMesh",{width:1,height:1,depth:.08},t),this._frontPlate.parent=this._backPlate,this._frontPlate.position=l.Vector3.Forward(t.useRightHandedSystem).scale(-.08),this._frontPlate.isPickable=!1,this._frontPlate.setEnabled(!1),this._textPlate=e.prototype._createNode.call(this,t),this._textPlate.parent=this._backPlate,this._textPlate.position=l.Vector3.Forward(t.useRightHandedSystem).scale(-.08),this._textPlate.isPickable=!1,this._backPlate},t.prototype._applyFacade=function(e){this._plateMaterial.emissiveTexture=e,this._plateMaterial.opacityTexture=e},t.prototype._createBackMaterial=function(e){var t=this;this._backMaterial=new de(this.name+"Back Material",e.getScene()),this._backMaterial.renderHoverLight=!0,this._pickedPointObserver=this._host.onPickedPointChangedObservable.add((function(e){e?(t._backMaterial.hoverPosition=e,t._backMaterial.hoverColor.a=1):t._backMaterial.hoverColor.a=0}))},t.prototype._createFrontMaterial=function(e){this._frontMaterial=new de(this.name+"Front Material",e.getScene()),this._frontMaterial.innerGlowColorIntensity=0,this._frontMaterial.alpha=.5,this._frontMaterial.renderBorders=!0},t.prototype._createPlateMaterial=function(e){this._plateMaterial=new l.StandardMaterial(this.name+"Plate Material",e.getScene()),this._plateMaterial.specularColor=l.Color3.Black()},t.prototype._affectMaterial=function(e){this._shareMaterials?(this._host._sharedMaterials.backFluentMaterial?this._backMaterial=this._host._sharedMaterials.backFluentMaterial:(this._createBackMaterial(e),this._host._sharedMaterials.backFluentMaterial=this._backMaterial),this._host._sharedMaterials.frontFluentMaterial?this._frontMaterial=this._host._sharedMaterials.frontFluentMaterial:(this._createFrontMaterial(e),this._host._sharedMaterials.frontFluentMaterial=this._frontMaterial)):(this._createBackMaterial(e),this._createFrontMaterial(e)),this._createPlateMaterial(e),this._backPlate.material=this._backMaterial,this._frontPlate.material=this._frontMaterial,this._textPlate.material=this._plateMaterial,this._rebuildContent()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeTooltip(),this.shareMaterials||(this._backMaterial.dispose(),this._frontMaterial.dispose(),this._plateMaterial.dispose(),this._pickedPointObserver&&(this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver),this._pickedPointObserver=null))},t}(se),pe="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nuniform float _Edge_Width_;\nuniform vec4 _Edge_Color_;\nuniform bool _Relative_Width_;\nuniform float _Proximity_Max_Intensity_;\nuniform float _Proximity_Far_Distance_;\nuniform float _Proximity_Near_Radius_;\nuniform float _Proximity_Anisotropy_;\nuniform float _Selection_Fuzz_;\nuniform float _Selected_;\nuniform float _Selection_Fade_;\nuniform float _Selection_Fade_Size_;\nuniform float _Selected_Distance_;\nuniform float _Selected_Fade_Length_;\nuniform bool _Blob_Enable_;\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Inner_Fade_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\nuniform bool _Blob_Enable_2_;\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Inner_Fade_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Active_Face_Dir_;\nuniform vec3 _Active_Face_Up_;\nuniform bool Enable_Fade;\nuniform float _Fade_Width_;\nuniform bool _Smooth_Active_Face_;\nuniform bool _Show_Frame_;\nuniform bool _Use_Blob_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\n\nvoid Holo_Edge_Fragment_B35(\nvec4 Edges,\nfloat Edge_Width,\nout float NotEdge)\n{\nvec2 c=vec2(min(Edges.r,Edges.g),min(Edges.b,Edges.a));\nvec2 df=fwidth(c)*Edge_Width;\nvec2 g=clamp(c/df,0.0,1.0);\nNotEdge=g.x*g.y;\n}\n\n\nvoid Blob_Fragment_B39(\nvec2 UV,\nvec3 Blob_Info,\nsampler2D Blob_Texture,\nout vec4 Blob_Color)\n{\nfloat k=dot(UV,UV);\nBlob_Color=Blob_Info.y*texture(Blob_Texture,vec2(vec2(sqrt(k),Blob_Info.x).x,1.0-vec2(sqrt(k),Blob_Info.x).y))*(1.0-clamp(k,0.0,1.0));\n}\n\n\nvec2 FilterStep(vec2 Edge,vec2 X)\n{\n\nvec2 dX=max(fwidth(X),vec2(0.00001,0.00001));\nreturn clamp( (X+dX-max(Edge,X-dX))/(dX*2.0),0.0,1.0);\n}\nvoid Wireframe_Fragment_B59(\nvec3 Widths,\nvec2 UV,\nfloat Proximity,\nvec4 Edge_Color,\nout vec4 Wireframe)\n{\nvec2 c=min(UV,vec2(1.0,1.0)-UV);\nvec2 g=FilterStep(Widths.xy*0.5,c);\nWireframe=(1.0-min(g.x,g.y))*Proximity*Edge_Color;\n}\n\n\nvoid Proximity_B53(\nvec3 Proximity_Center,\nvec3 Proximity_Center_2,\nfloat Proximity_Max_Intensity,\nfloat Proximity_Near_Radius,\nvec3 Position,\nvec3 Show_Selection,\nvec4 Extra1,\nfloat Dist_To_Face,\nfloat Intensity,\nout float Proximity)\n{\nvec2 delta1=Extra1.xy;\nvec2 delta2=Extra1.zw;\nfloat d2=sqrt(min(dot(delta1,delta1),dot(delta2,delta2))+Dist_To_Face*Dist_To_Face);\n\nProximity=Intensity*Proximity_Max_Intensity*(1.0-clamp(d2/Proximity_Near_Radius,0.0,1.0))*(1.0-Show_Selection.x)+Show_Selection.x;\n}\n\n\nvoid To_XYZ_B46(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\nvoid main()\n{\nfloat NotEdge_Q35;\n#if ENABLE_FADE\nHolo_Edge_Fragment_B35(vColor,_Fade_Width_,NotEdge_Q35);\n#else\nNotEdge_Q35=1.0;\n#endif\n\n\nvec4 Blob_Color_Q39;\nfloat k=dot(vUV,vUV);\nvec2 blobTextureCoord=vec2(vec2(sqrt(k),vTangent.x).x,1.0-vec2(sqrt(k),vTangent.x).y);\nvec4 blobColor=mix(vec4(1.0,1.0,1.0,1.0)*step(1.0-vTangent.x,clamp(sqrt(k)+0.1,0.0,1.0)),texture(_Blob_Texture_,blobTextureCoord),float(_Use_Blob_Texture_));\nBlob_Color_Q39=vTangent.y*blobColor*(1.0-clamp(k,0.0,1.0));\n\nfloat Is_Quad_Q24;\nIs_Quad_Q24=vNormal.z;\n\nvec3 Blob_Position_Q41=mix(_Blob_Position_,Global_Left_Index_Tip_Position.xyz,float(Use_Global_Left_Index));\n\nvec3 Blob_Position_Q42=mix(_Blob_Position_2_,Global_Right_Index_Tip_Position.xyz,float(Use_Global_Right_Index));\nfloat X_Q46;\nfloat Y_Q46;\nfloat Z_Q46;\nTo_XYZ_B46(vBinormal,X_Q46,Y_Q46,Z_Q46);\nfloat Proximity_Q53;\nProximity_B53(Blob_Position_Q41,Blob_Position_Q42,_Proximity_Max_Intensity_,_Proximity_Near_Radius_,vPosition,vBinormal,vExtra1,Y_Q46,Z_Q46,Proximity_Q53);\nvec4 Wireframe_Q59;\nWireframe_Fragment_B59(vNormal,vUV,Proximity_Q53,_Edge_Color_,Wireframe_Q59);\n\nvec4 Wire_Or_Blob_Q23=mix(Wireframe_Q59,Blob_Color_Q39,Is_Quad_Q24);\n\nvec4 Result_Q22;\nResult_Q22=mix(Wire_Or_Blob_Q23,vec4(0.3,0.3,0.3,0.3),float(_Show_Frame_));\n\nvec4 Final_Color_Q37=NotEdge_Q35*Result_Q22;\nvec4 Out_Color=Final_Color_Q37;\nfloat Clip_Threshold=0.0;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";l.ShaderStore.ShadersStore.fluentButtonPixelShader=pe;var be="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec3 tangent;\nattribute vec4 color;\nuniform float _Edge_Width_;\nuniform vec4 _Edge_Color_;\nuniform float _Proximity_Max_Intensity_;\nuniform float _Proximity_Far_Distance_;\nuniform float _Proximity_Near_Radius_;\nuniform float _Proximity_Anisotropy_;\nuniform float _Selection_Fuzz_;\nuniform float _Selected_;\nuniform float _Selection_Fade_;\nuniform float _Selection_Fade_Size_;\nuniform float _Selected_Distance_;\nuniform float _Selected_Fade_Length_;\nuniform bool _Blob_Enable_;\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Inner_Fade_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\nuniform bool _Blob_Enable_2_;\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Inner_Fade_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Active_Face_Dir_;\nuniform vec3 _Active_Face_Up_;\nuniform bool _Enable_Fade_;\nuniform float _Fade_Width_;\nuniform bool _Smooth_Active_Face_;\nuniform bool _Show_Frame_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\n\nvoid Blob_Vertex_B47(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nvec4 Vx_Color,\nvec2 UV,\nvec3 Face_Center,\nvec2 Face_Size,\nvec2 In_UV,\nfloat Blob_Fade_Length,\nfloat Selection_Fade,\nfloat Selection_Fade_Size,\nfloat Inner_Fade,\nvec3 Active_Face_Center,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nfloat Blob_Enabled,\nout vec3 Out_Position,\nout vec2 Out_UV,\nout vec3 Blob_Info)\n{\nfloat blobSize,fadeIn;\nvec3 Hit_Position;\nBlob_Info=vec3(0.0,0.0,0.0);\nfloat Hit_Distance=dot(Blob_Position-Face_Center,Normal);\nHit_Position=Blob_Position-Hit_Distance*Normal;\nfloat absD=abs(Hit_Distance);\nfloat lerpVal=clamp((absD-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfadeIn=1.0-clamp((absD-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat innerFade=1.0-clamp(-Hit_Distance/Inner_Fade,0.0,1.0);\n\nfloat farClip=clamp(1.0-step(Blob_Far_Distance+Blob_Fade_Length,absD),0.0,1.0);\nfloat size=mix(Blob_Near_Size,Blob_Far_Size,lerpVal)*farClip;\nblobSize=mix(size,Selection_Fade_Size,Selection_Fade)*innerFade*Blob_Enabled;\nBlob_Info.x=lerpVal*0.5+0.5;\nBlob_Info.y=fadeIn*Intensity*(1.0-Selection_Fade)*Blob_Fade;\nBlob_Info.x*=(1.0-Blob_Pulse);\n\nvec3 delta=Hit_Position-Face_Center;\nvec2 blobCenterXY=vec2(dot(delta,Tangent),dot(delta,Bitangent));\nvec2 quadUVin=2.0*UV-1.0;\nvec2 blobXY=blobCenterXY+quadUVin*blobSize;\n\nvec2 blobClipped=clamp(blobXY,-Face_Size*0.5,Face_Size*0.5);\nvec2 blobUV=(blobClipped-blobCenterXY)/max(blobSize,0.0001)*2.0;\nvec3 blobCorner=Face_Center+blobClipped.x*Tangent+blobClipped.y*Bitangent;\n\nOut_Position=mix(Position,blobCorner,Vx_Color.rrr);\nOut_UV=mix(In_UV,blobUV,Vx_Color.rr);\n}\n\n\nvec2 ProjectProximity(\nvec3 blobPosition,\nvec3 position,\nvec3 center,\nvec3 dir,\nvec3 xdir,\nvec3 ydir,\nout float vdistance\n)\n{\nvec3 delta=blobPosition-position;\nvec2 xy=vec2(dot(delta,xdir),dot(delta,ydir));\nvdistance=abs(dot(delta,dir));\nreturn xy;\n}\nvoid Proximity_Vertex_B66(\nvec3 Blob_Position,\nvec3 Blob_Position_2,\nvec3 Active_Face_Center,\nvec3 Active_Face_Dir,\nvec3 Position,\nfloat Proximity_Far_Distance,\nfloat Relative_Scale,\nfloat Proximity_Anisotropy,\nvec3 Up,\nout vec4 Extra1,\nout float Distance_To_Face,\nout float Intensity)\n{\nvec3 Active_Face_Dir_X=normalize(cross(Active_Face_Dir,Up));\n\nvec3 Active_Face_Dir_Y=cross(Active_Face_Dir,Active_Face_Dir_X);\nfloat distz1,distz2;\nExtra1.xy=ProjectProximity(Blob_Position,Position,Active_Face_Center,Active_Face_Dir,Active_Face_Dir_X*Proximity_Anisotropy,Active_Face_Dir_Y,distz1)/Relative_Scale;\nExtra1.zw=ProjectProximity(Blob_Position_2,Position,Active_Face_Center,Active_Face_Dir,Active_Face_Dir_X*Proximity_Anisotropy,Active_Face_Dir_Y,distz2)/Relative_Scale;\nDistance_To_Face=dot(Active_Face_Dir,Position-Active_Face_Center);\nIntensity=1.0-clamp(min(distz1,distz2)/Proximity_Far_Distance,0.0,1.0);\n}\n\n\nvoid Holo_Edge_Vertex_B44(\nvec3 Incident,\nvec3 Normal,\nvec2 UV,\nvec3 Tangent,\nvec3 Bitangent,\nbool Smooth_Active_Face,\nfloat Active,\nout vec4 Holo_Edges)\n{\nfloat NdotI=dot(Incident,Normal);\nvec2 flip=(UV-vec2(0.5,0.5));\nfloat udot=dot(Incident,Tangent)*flip.x*NdotI;\nfloat uval=1.0-float(udot>0.0);\nfloat vdot=-dot(Incident,Bitangent)*flip.y*NdotI;\nfloat vval=1.0-float(vdot>0.0);\nfloat Smooth_And_Active=step(1.0,float(Smooth_Active_Face && Active>0.0));\nuval=mix(uval,max(1.0,uval),Smooth_And_Active);\nvval=mix(vval,max(1.0,vval),Smooth_And_Active);\nHolo_Edges=vec4(1.0,1.0,1.0,1.0)-vec4(uval*UV.x,uval*(1.0-UV.x),vval*UV.y,vval*(1.0-UV.y));\n}\n\n\nvoid Object_To_World_Pos_B13(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid Choose_Blob_B38(\nvec4 Vx_Color,\nvec3 Position1,\nvec3 Position2,\nbool Blob_Enable_1,\nbool Blob_Enable_2,\nfloat Near_Size_1,\nfloat Near_Size_2,\nfloat Blob_Inner_Fade_1,\nfloat Blob_Inner_Fade_2,\nfloat Blob_Pulse_1,\nfloat Blob_Pulse_2,\nfloat Blob_Fade_1,\nfloat Blob_Fade_2,\nout vec3 Position,\nout float Near_Size,\nout float Inner_Fade,\nout float Blob_Enable,\nout float Fade,\nout float Pulse)\n{\nPosition=Position1*(1.0-Vx_Color.g)+Vx_Color.g*Position2;\nfloat b1=float(Blob_Enable_1);\nfloat b2=float(Blob_Enable_2);\nBlob_Enable=b1+(b2-b1)*Vx_Color.g;\nPulse=Blob_Pulse_1*(1.0-Vx_Color.g)+Vx_Color.g*Blob_Pulse_2;\nFade=Blob_Fade_1*(1.0-Vx_Color.g)+Vx_Color.g*Blob_Fade_2;\nNear_Size=Near_Size_1*(1.0-Vx_Color.g)+Vx_Color.g*Near_Size_2;\nInner_Fade=Blob_Inner_Fade_1*(1.0-Vx_Color.g)+Vx_Color.g*Blob_Inner_Fade_2;\n}\n\n\nvoid Wireframe_Vertex_B51(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nfloat Edge_Width,\nvec2 Face_Size,\nout vec3 Wire_Vx_Pos,\nout vec2 UV,\nout vec2 Widths)\n{\nWidths.xy=Edge_Width/Face_Size;\nfloat x=dot(Position,Tangent);\nfloat y=dot(Position,Bitangent);\nfloat dx=0.5-abs(x);\nfloat newx=(0.5-dx*Widths.x*2.0)*sign(x);\nfloat dy=0.5-abs(y);\nfloat newy=(0.5-dy*Widths.y*2.0)*sign(y);\nWire_Vx_Pos=Normal*0.5+newx*Tangent+newy*Bitangent;\nUV.x=dot(Wire_Vx_Pos,Tangent)+0.5;\nUV.y=dot(Wire_Vx_Pos,Bitangent)+0.5;\n}\n\n\nvec2 ramp2(vec2 start,vec2 end,vec2 x)\n{\nreturn clamp((x-start)/(end-start),vec2(0.0,0.0),vec2(1.0,1.0));\n}\nfloat computeSelection(\nvec3 blobPosition,\nvec3 normal,\nvec3 tangent,\nvec3 bitangent,\nvec3 faceCenter,\nvec2 faceSize,\nfloat selectionFuzz,\nfloat farDistance,\nfloat fadeLength\n)\n{\nvec3 delta=blobPosition-faceCenter;\nfloat absD=abs(dot(delta,normal));\nfloat fadeIn=1.0-clamp((absD-farDistance)/fadeLength,0.0,1.0);\nvec2 blobCenterXY=vec2(dot(delta,tangent),dot(delta,bitangent));\nvec2 innerFace=faceSize*(1.0-selectionFuzz)*0.5;\nvec2 selectPulse=ramp2(-faceSize*0.5,-innerFace,blobCenterXY)-ramp2(innerFace,faceSize*0.5,blobCenterXY);\nreturn selectPulse.x*selectPulse.y*fadeIn;\n}\nvoid Selection_Vertex_B48(\nvec3 Blob_Position,\nvec3 Blob_Position_2,\nvec3 Face_Center,\nvec2 Face_Size,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nfloat Selection_Fuzz,\nfloat Selected,\nfloat Far_Distance,\nfloat Fade_Length,\nvec3 Active_Face_Dir,\nout float Show_Selection)\n{\nfloat select1=computeSelection(Blob_Position,Normal,Tangent,Bitangent,Face_Center,Face_Size,Selection_Fuzz,Far_Distance,Fade_Length);\nfloat select2=computeSelection(Blob_Position_2,Normal,Tangent,Bitangent,Face_Center,Face_Size,Selection_Fuzz,Far_Distance,Fade_Length);\nfloat Active=max(0.0,dot(Active_Face_Dir,Normal));\nShow_Selection=mix(max(select1,select2),1.0,Selected)*Active;\n}\n\n\nvoid Proximity_Visibility_B54(\nfloat Selection,\nvec3 Proximity_Center,\nvec3 Proximity_Center_2,\nfloat Input_Width,\nfloat Proximity_Far_Distance,\nfloat Proximity_Radius,\nvec3 Active_Face_Center,\nvec3 Active_Face_Dir,\nout float Width)\n{\n\nvec3 boxEdges=(world*vec4(vec3(0.5,0.5,0.5),0.0)).xyz;\nfloat boxMaxSize=length(boxEdges);\nfloat d1=dot(Proximity_Center-Active_Face_Center,Active_Face_Dir);\nvec3 blob1=Proximity_Center-d1*Active_Face_Dir;\nfloat d2=dot(Proximity_Center_2-Active_Face_Center,Active_Face_Dir);\nvec3 blob2=Proximity_Center_2-d2*Active_Face_Dir;\n\nvec3 delta1=blob1-Active_Face_Center;\nvec3 delta2=blob2-Active_Face_Center;\nfloat dist1=dot(delta1,delta1);\nfloat dist2=dot(delta2,delta2);\nfloat nearestProxDist=sqrt(min(dist1,dist2));\n\nWidth=Input_Width*(1.0-step(boxMaxSize+Proximity_Radius,nearestProxDist))*(1.0-step(Proximity_Far_Distance,min(d1,d2))*(1.0-step(0.0001,Selection)));\n}\n\n\nvoid Object_To_World_Dir_B67(\nvec3 Dir_Object,\nout vec3 Dir_World)\n{\nDir_World=(world*vec4(Dir_Object,0.0)).xyz;\n}\n\nvoid main()\n{\n\nvec3 Active_Face_Center_Q49;\nActive_Face_Center_Q49=(world*vec4(_Active_Face_Dir_*0.5,1.0)).xyz;\n\nvec3 Blob_Position_Q41=mix(_Blob_Position_,Global_Left_Index_Tip_Position.xyz,float(Use_Global_Left_Index));\n\nvec3 Blob_Position_Q42=mix(_Blob_Position_2_,Global_Right_Index_Tip_Position.xyz,float(Use_Global_Right_Index));\n\nvec3 Active_Face_Dir_Q64=normalize((world*vec4(_Active_Face_Dir_,0.0)).xyz);\n\nfloat Relative_Scale_Q57;\n#if RELATIVE_WIDTH\nRelative_Scale_Q57=length((world*vec4(vec3(0,1,0),0.0)).xyz);\n#else\nRelative_Scale_Q57=1.0;\n#endif\n\nvec3 Tangent_World_Q30;\nTangent_World_Q30=(world*vec4(tangent,0.0)).xyz;\n\nvec3 Binormal_World_Q31;\nBinormal_World_Q31=(world*vec4((cross(normal,tangent)),0.0)).xyz;\n\nvec3 Normal_World_Q60;\nNormal_World_Q60=(world*vec4(normal,0.0)).xyz;\n\nvec3 Result_Q18=0.5*normal;\nvec3 Dir_World_Q67;\nObject_To_World_Dir_B67(_Active_Face_Up_,Dir_World_Q67);\n\nfloat Product_Q56=_Edge_Width_*Relative_Scale_Q57;\n\nvec3 Normal_World_N_Q29=normalize(Normal_World_Q60);\n\nvec3 Tangent_World_N_Q28=normalize(Tangent_World_Q30);\n\nvec3 Binormal_World_N_Q32=normalize(Binormal_World_Q31);\nvec3 Position_Q38;\nfloat Near_Size_Q38;\nfloat Inner_Fade_Q38;\nfloat Blob_Enable_Q38;\nfloat Fade_Q38;\nfloat Pulse_Q38;\nChoose_Blob_B38(color,Blob_Position_Q41,Blob_Position_Q42,_Blob_Enable_,_Blob_Enable_2_,_Blob_Near_Size_,_Blob_Near_Size_2_,_Blob_Inner_Fade_,_Blob_Inner_Fade_2_,_Blob_Pulse_,_Blob_Pulse_2_,_Blob_Fade_,_Blob_Fade_2_,Position_Q38,Near_Size_Q38,Inner_Fade_Q38,Blob_Enable_Q38,Fade_Q38,Pulse_Q38);\n\nvec3 Face_Center_Q33;\nFace_Center_Q33=(world*vec4(Result_Q18,1.0)).xyz;\n\nvec2 Face_Size_Q50=vec2(length(Tangent_World_Q30),length(Binormal_World_Q31));\nfloat Show_Selection_Q48;\nSelection_Vertex_B48(Blob_Position_Q41,Blob_Position_Q42,Face_Center_Q33,Face_Size_Q50,Normal_World_N_Q29,Tangent_World_N_Q28,Binormal_World_N_Q32,_Selection_Fuzz_,_Selected_,_Selected_Distance_,_Selected_Fade_Length_,Active_Face_Dir_Q64,Show_Selection_Q48);\n\nvec3 Normalized_Q72=normalize(Dir_World_Q67);\n\nfloat Active_Q34=max(0.0,dot(Active_Face_Dir_Q64,Normal_World_N_Q29));\nfloat Width_Q54;\nProximity_Visibility_B54(Show_Selection_Q48,Blob_Position_Q41,Blob_Position_Q42,Product_Q56,_Proximity_Far_Distance_,_Proximity_Near_Radius_,Active_Face_Center_Q49,Active_Face_Dir_Q64,Width_Q54);\nvec3 Wire_Vx_Pos_Q51;\nvec2 UV_Q51;\nvec2 Widths_Q51;\nWireframe_Vertex_B51(position,normal,tangent,(cross(normal,tangent)),Width_Q54,Face_Size_Q50,Wire_Vx_Pos_Q51,UV_Q51,Widths_Q51);\n\nvec3 Vec3_Q27=vec3(Widths_Q51.x,Widths_Q51.y,color.r);\nvec3 Pos_World_Q13;\nObject_To_World_Pos_B13(Wire_Vx_Pos_Q51,Pos_World_Q13);\n\nvec3 Incident_Q36=normalize(Pos_World_Q13-cameraPosition);\nvec3 Out_Position_Q47;\nvec2 Out_UV_Q47;\nvec3 Blob_Info_Q47;\nBlob_Vertex_B47(Pos_World_Q13,Normal_World_N_Q29,Tangent_World_N_Q28,Binormal_World_N_Q32,Position_Q38,_Blob_Intensity_,Near_Size_Q38,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,color,uv,Face_Center_Q33,Face_Size_Q50,UV_Q51,_Blob_Fade_Length_,_Selection_Fade_,_Selection_Fade_Size_,Inner_Fade_Q38,Active_Face_Center_Q49,Pulse_Q38,Fade_Q38,Blob_Enable_Q38,Out_Position_Q47,Out_UV_Q47,Blob_Info_Q47);\nvec4 Extra1_Q66;\nfloat Distance_To_Face_Q66;\nfloat Intensity_Q66;\nProximity_Vertex_B66(Blob_Position_Q41,Blob_Position_Q42,Active_Face_Center_Q49,Active_Face_Dir_Q64,Pos_World_Q13,_Proximity_Far_Distance_,Relative_Scale_Q57,_Proximity_Anisotropy_,Normalized_Q72,Extra1_Q66,Distance_To_Face_Q66,Intensity_Q66);\nvec4 Holo_Edges_Q44;\nHolo_Edge_Vertex_B44(Incident_Q36,Normal_World_N_Q29,uv,Tangent_World_Q30,Binormal_World_Q31,_Smooth_Active_Face_,Active_Q34,Holo_Edges_Q44);\n\nvec3 Vec3_Q19=vec3(Show_Selection_Q48,Distance_To_Face_Q66,Intensity_Q66);\nvec3 Position=Out_Position_Q47;\nvec2 UV=Out_UV_Q47;\nvec3 Tangent=Blob_Info_Q47;\nvec3 Binormal=Vec3_Q19;\nvec3 Normal=Vec3_Q27;\nvec4 Extra1=Extra1_Q66;\nvec4 Color=Holo_Edges_Q44;\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvColor=Color;\nvExtra1=Extra1;\n}";l.ShaderStore.ShadersStore.fluentButtonVertexShader=be;var ge=function(e){function t(){var t=e.call(this)||this;return t.RELATIVE_WIDTH=!0,t.ENABLE_FADE=!0,t._needNormals=!0,t._needUVs=!0,t.rebuild(),t}return o(t,e),t}(l.MaterialDefines),me=function(e){function t(i,n){var o=e.call(this,i,n)||this;return o.edgeWidth=.04,o.edgeColor=new l.Color4(.592157,.592157,.592157,1),o.proximityMaxIntensity=.45,o.proximityFarDistance=.16,o.proximityNearRadius=1.5,o.proximityAnisotropy=1,o.selectionFuzz=.5,o.selected=0,o.selectionFade=0,o.selectionFadeSize=.3,o.selectedDistance=.08,o.selectedFadeLength=.08,o.blobIntensity=.5,o.blobFarSize=.05,o.blobNearDistance=0,o.blobFarDistance=.08,o.blobFadeLength=.08,o.leftBlobEnable=!0,o.leftBlobNearSize=.025,o.leftBlobPulse=0,o.leftBlobFade=1,o.leftBlobInnerFade=.01,o.rightBlobEnable=!0,o.rightBlobNearSize=.025,o.rightBlobPulse=0,o.rightBlobFade=1,o.rightBlobInnerFade=.01,o.activeFaceDir=new l.Vector3(0,0,-1),o.activeFaceUp=new l.Vector3(0,1,0),o.enableFade=!0,o.fadeWidth=1.5,o.smoothActiveFace=!0,o.showFrame=!1,o.useBlobTexture=!0,o.globalLeftIndexTipPosition=l.Vector3.Zero(),o.globalRightIndexTipPosition=l.Vector3.Zero(),o.alphaMode=l.Constants.ALPHA_ADD,o.disableDepthWrite=!0,o.backFaceCulling=!1,o._blobTexture=new l.Texture(t.BLOB_TEXTURE_URL,n,!0,!1,l.Texture.NEAREST_SAMPLINGMODE),o}return o(t,e),t.prototype.needAlphaBlending=function(){return!0},t.prototype.needAlphaTesting=function(){return!0},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,i){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t.materialDefines||(t.materialDefines=new ge);var n=t.materialDefines,o=this.getScene();if(this._isReadyForSubMesh(t))return!0;var r=o.getEngine();if(l.MaterialHelper.PrepareDefinesForAttributes(e,n,!0,!1),n.isDirty){n.markAsProcessed(),o.resetCachedMaterial();var a=new l.EffectFallbacks;n.FOG&&a.addFallback(1,"FOG"),l.MaterialHelper.HandleFallbacksForShadows(n,a),n.IMAGEPROCESSINGPOSTPROCESS=o.imageProcessingConfiguration.applyByPostProcess;var s=[l.VertexBuffer.PositionKind];n.NORMAL&&s.push(l.VertexBuffer.NormalKind),n.UV1&&s.push(l.VertexBuffer.UVKind),n.UV2&&s.push(l.VertexBuffer.UV2Kind),n.VERTEXCOLOR&&s.push(l.VertexBuffer.ColorKind),n.TANGENT&&s.push(l.VertexBuffer.TangentKind),l.MaterialHelper.PrepareAttributesForInstances(s,n);var _=n.toString(),h=["world","viewProjection","cameraPosition","_Edge_Width_","_Edge_Color_","_Relative_Width_","_Proximity_Max_Intensity_","_Proximity_Far_Distance_","_Proximity_Near_Radius_","_Proximity_Anisotropy_","_Selection_Fuzz_","_Selected_","_Selection_Fade_","_Selection_Fade_Size_","_Selected_Distance_","_Selected_Fade_Length_","_Blob_Enable_","_Blob_Position_","_Blob_Intensity_","_Blob_Near_Size_","_Blob_Far_Size_","_Blob_Near_Distance_","_Blob_Far_Distance_","_Blob_Fade_Length_","_Blob_Inner_Fade_","_Blob_Pulse_","_Blob_Fade_","_Blob_Texture_","_Blob_Enable_2_","_Blob_Position_2_","_Blob_Near_Size_2_","_Blob_Inner_Fade_2_","_Blob_Pulse_2_","_Blob_Fade_2_","_Active_Face_Dir_","_Active_Face_Up_","_Enable_Fade_","_Fade_Width_","_Smooth_Active_Face_","_Show_Frame_","_Use_Blob_Texture_","Use_Global_Left_Index","Use_Global_Right_Index","Global_Left_Index_Tip_Position","Global_Right_Index_Tip_Position","Global_Left_Thumb_Tip_Position","Global_Right_Thumb_Tip_Position","Global_Left_Index_Tip_Proximity","Global_Right_Index_Tip_Proximity"],c=["_Blob_Texture_"],u=new Array;l.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:n,maxSimultaneousLights:4}),t.setEffect(o.getEngine().createEffect("fluentButton",{attributes:s,uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:_,fallbacks:a,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},r),n,this._materialContext)}return!(!t.effect||!t.effect.isReady()||(n._renderId=o.getRenderId(),t.effect._wasPreviouslyReady=!0,0))},t.prototype.bindForSubMesh=function(e,t,i){var n=this.getScene();if(i.materialDefines){var o=i.effect;o&&(this._activeEffect=o,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",n.getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",n.activeCamera.position),this._activeEffect.setTexture("_Blob_Texture_",this._blobTexture),this._activeEffect.setFloat("_Edge_Width_",this.edgeWidth),this._activeEffect.setColor4("_Edge_Color_",new l.Color3(this.edgeColor.r,this.edgeColor.g,this.edgeColor.b),this.edgeColor.a),this._activeEffect.setFloat("_Proximity_Max_Intensity_",this.proximityMaxIntensity),this._activeEffect.setFloat("_Proximity_Far_Distance_",this.proximityFarDistance),this._activeEffect.setFloat("_Proximity_Near_Radius_",this.proximityNearRadius),this._activeEffect.setFloat("_Proximity_Anisotropy_",this.proximityAnisotropy),this._activeEffect.setFloat("_Selection_Fuzz_",this.selectionFuzz),this._activeEffect.setFloat("_Selected_",this.selected),this._activeEffect.setFloat("_Selection_Fade_",this.selectionFade),this._activeEffect.setFloat("_Selection_Fade_Size_",this.selectionFadeSize),this._activeEffect.setFloat("_Selected_Distance_",this.selectedDistance),this._activeEffect.setFloat("_Selected_Fade_Length_",this.selectedFadeLength),this._activeEffect.setFloat("_Blob_Enable_",this.leftBlobEnable?1:0),this._activeEffect.setFloat("_Blob_Intensity_",this.blobIntensity),this._activeEffect.setFloat("_Blob_Near_Size_",this.leftBlobNearSize),this._activeEffect.setFloat("_Blob_Far_Size_",this.blobFarSize),this._activeEffect.setFloat("_Blob_Near_Distance_",this.blobNearDistance),this._activeEffect.setFloat("_Blob_Far_Distance_",this.blobFarDistance),this._activeEffect.setFloat("_Blob_Fade_Length_",this.blobFadeLength),this._activeEffect.setFloat("_Blob_Inner_Fade_",this.leftBlobInnerFade),this._activeEffect.setFloat("_Blob_Pulse_",this.leftBlobPulse),this._activeEffect.setFloat("_Blob_Fade_",this.leftBlobFade),this._activeEffect.setFloat("_Blob_Enable_2_",this.rightBlobEnable?1:0),this._activeEffect.setFloat("_Blob_Near_Size_2_",this.rightBlobNearSize),this._activeEffect.setFloat("_Blob_Inner_Fade_2_",this.rightBlobInnerFade),this._activeEffect.setFloat("_Blob_Pulse_2_",this.rightBlobPulse),this._activeEffect.setFloat("_Blob_Fade_2_",this.rightBlobFade),this._activeEffect.setVector3("_Active_Face_Dir_",this.activeFaceDir),this._activeEffect.setVector3("_Active_Face_Up_",this.activeFaceUp),this._activeEffect.setFloat("_Fade_Width_",this.fadeWidth),this._activeEffect.setFloat("_Smooth_Active_Face_",this.smoothActiveFace?1:0),this._activeEffect.setFloat("_Show_Frame_",this.showFrame?1:0),this._activeEffect.setFloat("_Use_Blob_Texture_",this.useBlobTexture?1:0),this._activeEffect.setFloat("Use_Global_Left_Index",1),this._activeEffect.setFloat("Use_Global_Right_Index",1),this._activeEffect.setVector4("Global_Left_Index_Tip_Position",new l.Vector4(this.globalLeftIndexTipPosition.x,this.globalLeftIndexTipPosition.y,this.globalLeftIndexTipPosition.z,1)),this._activeEffect.setVector4("Global_Right_Index_Tip_Position",new l.Vector4(this.globalRightIndexTipPosition.x,this.globalRightIndexTipPosition.y,this.globalRightIndexTipPosition.z,1)),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var i=this;return l.SerializationHelper.Clone((function(){return new t(e,i.getScene())}),this)},t.prototype.serialize=function(){var e=l.SerializationHelper.Serialize(this);return e.customType="BABYLON.FluentButtonMaterial",e},t.prototype.getClassName=function(){return"FluentButtonMaterial"},t.Parse=function(e,i,n){return l.SerializationHelper.Parse((function(){return new t(e.name,i)}),e,i,n)},t.BLOB_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/mrtk-fluent-button-blob.png",r([Object(l.serialize)()],t.prototype,"edgeWidth",void 0),r([Object(l.serializeAsColor4)()],t.prototype,"edgeColor",void 0),r([Object(l.serialize)()],t.prototype,"proximityMaxIntensity",void 0),r([Object(l.serialize)()],t.prototype,"proximityFarDistance",void 0),r([Object(l.serialize)()],t.prototype,"proximityNearRadius",void 0),r([Object(l.serialize)()],t.prototype,"proximityAnisotropy",void 0),r([Object(l.serialize)()],t.prototype,"selectionFuzz",void 0),r([Object(l.serialize)()],t.prototype,"selected",void 0),r([Object(l.serialize)()],t.prototype,"selectionFade",void 0),r([Object(l.serialize)()],t.prototype,"selectionFadeSize",void 0),r([Object(l.serialize)()],t.prototype,"selectedDistance",void 0),r([Object(l.serialize)()],t.prototype,"selectedFadeLength",void 0),r([Object(l.serialize)()],t.prototype,"blobIntensity",void 0),r([Object(l.serialize)()],t.prototype,"blobFarSize",void 0),r([Object(l.serialize)()],t.prototype,"blobNearDistance",void 0),r([Object(l.serialize)()],t.prototype,"blobFarDistance",void 0),r([Object(l.serialize)()],t.prototype,"blobFadeLength",void 0),r([Object(l.serialize)()],t.prototype,"leftBlobEnable",void 0),r([Object(l.serialize)()],t.prototype,"leftBlobNearSize",void 0),r([Object(l.serialize)()],t.prototype,"leftBlobPulse",void 0),r([Object(l.serialize)()],t.prototype,"leftBlobFade",void 0),r([Object(l.serialize)()],t.prototype,"leftBlobInnerFade",void 0),r([Object(l.serialize)()],t.prototype,"rightBlobEnable",void 0),r([Object(l.serialize)()],t.prototype,"rightBlobNearSize",void 0),r([Object(l.serialize)()],t.prototype,"rightBlobPulse",void 0),r([Object(l.serialize)()],t.prototype,"rightBlobFade",void 0),r([Object(l.serialize)()],t.prototype,"rightBlobInnerFade",void 0),r([Object(l.serializeAsVector3)()],t.prototype,"activeFaceDir",void 0),r([Object(l.serializeAsVector3)()],t.prototype,"activeFaceUp",void 0),r([Object(l.serialize)()],t.prototype,"enableFade",void 0),r([Object(l.serialize)()],t.prototype,"fadeWidth",void 0),r([Object(l.serialize)()],t.prototype,"smoothActiveFace",void 0),r([Object(l.serialize)()],t.prototype,"showFrame",void 0),r([Object(l.serialize)()],t.prototype,"useBlobTexture",void 0),r([Object(l.serializeAsVector3)()],t.prototype,"globalLeftIndexTipPosition",void 0),r([Object(l.serializeAsVector3)()],t.prototype,"globalRightIndexTipPosition",void 0),t}(l.PushMaterial);Object(l.RegisterClass)("BABYLON.GUI.FluentButtonMaterial",me);var ve=function(e){function t(t,i){var n=e.call(this,t)||this;return n._isNearPressed=!1,n.collidableFrontDirection=l.Vector3.Zero(),i&&(n.collisionMesh=i),n}return o(t,e),Object.defineProperty(t.prototype,"collidableFrontDirection",{get:function(){if(this._collisionMesh){var e=l.TmpVectors.Vector3[0];return l.Vector3.TransformNormalToRef(this._collidableFrontDirection,this._collisionMesh.getWorldMatrix(),e),e.normalize()}return this._collidableFrontDirection},set:function(e){if(this._collidableFrontDirection=e.normalize(),this._collisionMesh){var t=l.TmpVectors.Matrix[0];t.copyFrom(this._collisionMesh.getWorldMatrix()),t.invert(),l.Vector3.TransformNormalToRef(this._collidableFrontDirection,t,this._collidableFrontDirection),this._collidableFrontDirection.normalize()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"collisionMesh",{set:function(e){this._collisionMesh&&this._collisionMesh.dispose(),!e.parent&&this.mesh&&e.setParent(this.mesh),this._collisionMesh=e,this._injectGUI3DReservedDataStore(this._collisionMesh).control=this,this._collisionMesh.isNearPickable=!0,this.collidableFrontDirection=e.forward},enumerable:!1,configurable:!0}),t.prototype._isInteractionInFrontOfButton=function(e){return this._getInteractionHeight(e,this._collisionMesh.getAbsolutePosition())>0},t.prototype._getInteractionHeight=function(e,t){var i=this.collidableFrontDirection;if(0===i.length())return l.Vector3.Distance(e,t);var n=l.Vector3.Dot(t,i);return l.Vector3.Dot(e,i)-n},t.prototype._generatePointerEventType=function(e,t,i){if(e===l.PointerEventTypes.POINTERDOWN){if(!this._isInteractionInFrontOfButton(t))return l.PointerEventTypes.POINTERMOVE;this._isNearPressed=!0}if(e===l.PointerEventTypes.POINTERUP){if(0==i)return l.PointerEventTypes.POINTERMOVE;this._isNearPressed=!1}return e},t.prototype._getTypeName=function(){return"TouchButton3D"},t.prototype._createNode=function(t){return e.prototype._createNode.call(this,t)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._collisionMesh&&this._collisionMesh.dispose()},t}(se),ye=function(e){function t(t,i){void 0===i&&(i=!0);var n=e.call(this,t)||this;return n._shareMaterials=!0,n._isBackplateVisible=!0,n._frontPlateDepth=.5,n._backPlateDepth=.04,n._shareMaterials=i,n.pointerEnterAnimation=function(){n._frontMaterial.leftBlobEnable=!0,n._frontMaterial.rightBlobEnable=!0},n.pointerOutAnimation=function(){n._frontMaterial.leftBlobEnable=!1,n._frontMaterial.rightBlobEnable=!1},n.pointerDownAnimation=function(){n._frontPlate&&!n._isNearPressed&&(n._frontPlate.scaling.z=.2*n._frontPlateDepth,n._frontPlate.position=l.Vector3.Forward(n._frontPlate._scene.useRightHandedSystem).scale((n._frontPlateDepth-.2*n._frontPlateDepth)/2),n._textPlate.position=l.Vector3.Forward(n._textPlate._scene.useRightHandedSystem).scale(-(n._backPlateDepth+.2*n._frontPlateDepth)/2))},n.pointerUpAnimation=function(){n._frontPlate&&(n._frontPlate.scaling.z=n._frontPlateDepth,n._frontPlate.position=l.Vector3.Forward(n._frontPlate._scene.useRightHandedSystem).scale((n._frontPlateDepth-n._frontPlateDepth)/2),n._textPlate.position=l.Vector3.Forward(n._textPlate._scene.useRightHandedSystem).scale(-(n._backPlateDepth+n._frontPlateDepth)/2))},n.onPointerMoveObservable.add((function(e){if(n._frontPlate&&n._isNearPressed){var t=l.Vector3.Zero();if(n._backPlate.getWorldMatrix().decompose(t,void 0,void 0)){var i=n._getInteractionHeight(e,n._backPlate.position)/t.z;i=l.Scalar.Clamp(i-n._backPlateDepth/2,.2*n._frontPlateDepth,n._frontPlateDepth),n._frontPlate.scaling.z=i,n._frontPlate.position=l.Vector3.Forward(n._frontPlate._scene.useRightHandedSystem).scale((n._frontPlateDepth-i)/2),n._textPlate.position=l.Vector3.Forward(n._textPlate._scene.useRightHandedSystem).scale(-(n._backPlateDepth+i)/2)}}})),n._pointerHoverObserver=n.onPointerMoveObservable.add((function(e){n._frontMaterial.globalLeftIndexTipPosition=e})),n}return o(t,e),t.prototype._disposeTooltip=function(){this._tooltipFade=null,this._tooltipTextBlock&&this._tooltipTextBlock.dispose(),this._tooltipTexture&&this._tooltipTexture.dispose(),this._tooltipMesh&&this._tooltipMesh.dispose(),this.onPointerEnterObservable.remove(this._tooltipHoverObserver),this.onPointerOutObservable.remove(this._tooltipOutObserver)},Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._backPlate.renderingGroupId},set:function(e){this._backPlate.renderingGroupId=e,this._textPlate.renderingGroupId=e,this._frontPlate.renderingGroupId=e,this._tooltipMesh&&(this._tooltipMesh.renderingGroupId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltipText",{get:function(){return this._tooltipTextBlock?this._tooltipTextBlock.text:null},set:function(e){var t=this;if(e){if(!this._tooltipFade){var i=this._backPlate._scene.useRightHandedSystem;this._tooltipMesh=Object(l.CreatePlane)("",{size:1},this._backPlate._scene);var n=Object(l.CreatePlane)("",{size:1,sideOrientation:l.Mesh.DOUBLESIDE},this._backPlate._scene),o=new l.StandardMaterial("",this._backPlate._scene);o.diffuseColor=l.Color3.FromHexString("#212121"),n.material=o,n.isPickable=!1,this._tooltipMesh.addChild(n),n.position=l.Vector3.Forward(i).scale(.05),this._tooltipMesh.scaling.y=1/3,this._tooltipMesh.position=l.Vector3.Up().scale(.7).add(l.Vector3.Forward(i).scale(-.15)),this._tooltipMesh.isPickable=!1,this._tooltipMesh.parent=this._backPlate,this._tooltipTexture=te.CreateForMesh(this._tooltipMesh),this._tooltipTextBlock=new x,this._tooltipTextBlock.scaleY=3,this._tooltipTextBlock.color="white",this._tooltipTextBlock.fontSize=130,this._tooltipTexture.addControl(this._tooltipTextBlock),this._tooltipFade=new l.FadeInOutBehavior,this._tooltipFade.delay=500,this._tooltipMesh.addBehavior(this._tooltipFade),this._tooltipHoverObserver=this.onPointerEnterObservable.add((function(){t._tooltipFade&&t._tooltipFade.fadeIn(!0)})),this._tooltipOutObserver=this.onPointerOutObservable.add((function(){t._tooltipFade&&t._tooltipFade.fadeIn(!1)}))}this._tooltipTextBlock&&(this._tooltipTextBlock.text=e)}else this._disposeTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl!==e&&(this._imageUrl=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backMaterial",{get:function(){return this._backMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frontMaterial",{get:function(){return this._frontMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plateMaterial",{get:function(){return this._plateMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shareMaterials",{get:function(){return this._shareMaterials},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBackplateVisible",{set:function(e){this.mesh&&this._backMaterial&&(e&&!this._isBackplateVisible?this._backPlate.visibility=1:!e&&this._isBackplateVisible&&(this._backPlate.visibility=0)),this._isBackplateVisible=e},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"TouchHolographicButton"},t.prototype._rebuildContent=function(){this._disposeFacadeTexture();var e=new B;if(e.isVertical=!0,l.DomManagement.IsDocumentAvailable()&&document.createElement&&this._imageUrl){var t=new P;t.source=this._imageUrl,t.paddingTop="40px",t.height="180px",t.width="100px",t.paddingBottom="40px",e.addControl(t)}if(this._text){var i=new x;i.text=this._text,i.color="white",i.height="30px",i.fontSize=24,e.addControl(i)}this.content=e},t.prototype._createNode=function(i){var n,o=this;this.name=null!==(n=this.name)&&void 0!==n?n:"TouchHolographicButton";var r=Object(l.CreateBox)(this.name+"_collisionMesh",{width:1,height:1,depth:this._frontPlateDepth},i);return r.isPickable=!0,r.isNearPickable=!0,r.visibility=0,r.position=l.Vector3.Forward(i.useRightHandedSystem).scale(-this._frontPlateDepth/2),l.SceneLoader.ImportMeshAsync(void 0,t.MODEL_BASE_URL,t.MODEL_FILENAME,i).then((function(e){var t=e.meshes[1];t.name=o.name+"_frontPlate",t.isPickable=!1,t.scaling.z=o._frontPlateDepth,t.parent=r,o._frontMaterial&&(t.material=o._frontMaterial),o._frontPlate=t})),this._backPlate=Object(l.CreateBox)(this.name+"_backPlate",{width:1,height:1,depth:this._backPlateDepth},i),this._backPlate.position=l.Vector3.Forward(i.useRightHandedSystem).scale(-this._backPlateDepth/2),this._backPlate.isPickable=!1,this._textPlate=e.prototype._createNode.call(this,i),this._textPlate.name=this.name+"_textPlate",this._textPlate.isPickable=!1,this._textPlate.position=l.Vector3.Forward(i.useRightHandedSystem).scale(-this._frontPlateDepth/2),this._backPlate.addChild(r),this._backPlate.addChild(this._textPlate),this.collisionMesh=r,this.collidableFrontDirection=this._backPlate.forward.negate(),this._backPlate},t.prototype._applyFacade=function(e){this._plateMaterial.emissiveTexture=e,this._plateMaterial.opacityTexture=e,this._plateMaterial.diffuseColor=new l.Color3(.4,.4,.4)},t.prototype._createBackMaterial=function(e){this._backMaterial=new l.StandardMaterial(this.name+"Back Material",e.getScene()),this._backMaterial.diffuseColor=new l.Color3(.5,.5,.5)},t.prototype._createFrontMaterial=function(e){this._frontMaterial=new me(this.name+"Front Material",e.getScene())},t.prototype._createPlateMaterial=function(e){this._plateMaterial=new l.StandardMaterial(this.name+"Plate Material",e.getScene()),this._plateMaterial.specularColor=l.Color3.Black()},t.prototype._affectMaterial=function(e){this._shareMaterials?(this._host._touchSharedMaterials.backFluentMaterial?this._backMaterial=this._host._touchSharedMaterials.backFluentMaterial:(this._createBackMaterial(e),this._host._touchSharedMaterials.backFluentMaterial=this._backMaterial),this._host._touchSharedMaterials.frontFluentMaterial?this._frontMaterial=this._host._touchSharedMaterials.frontFluentMaterial:(this._createFrontMaterial(e),this._host._touchSharedMaterials.frontFluentMaterial=this._frontMaterial)):(this._createBackMaterial(e),this._createFrontMaterial(e)),this._createPlateMaterial(e),this._backPlate.material=this._backMaterial,this._textPlate.material=this._plateMaterial,this._isBackplateVisible||(this._backPlate.visibility=0),this._frontPlate&&(this._frontPlate.material=this._frontMaterial),this._rebuildContent()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeTooltip(),this.onPointerMoveObservable.remove(this._pointerHoverObserver),this.shareMaterials||(this._backMaterial.dispose(),this._frontMaterial.dispose(),this._plateMaterial.dispose(),this._pickedPointObserver&&(this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver),this._pickedPointObserver=null))},t.MODEL_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.MODEL_FILENAME="mrtk-fluent-button.glb",t}(ve),xe="precision highp float;\n\nattribute vec3 position;\n\nuniform vec3 positionOffset;\nuniform mat4 worldViewProjection;\nuniform float scale;\nvoid main(void) {\nvec4 vPos=vec4((vec3(position)+positionOffset)*scale,1.0);\ngl_Position=worldViewProjection*vPos;\n}";l.ShaderStore.ShadersStore.handleVertexShader=xe;var Pe="uniform vec3 color;\nvoid main(void) {\ngl_FragColor=vec4(color,1.0);\n}";l.ShaderStore.ShadersStore.handlePixelShader=Pe;var Oe,Be=function(e){function t(t,i){var n=e.call(this,t,i,"handle",{attributes:["position"],uniforms:["worldViewProjection","color","scale","positionOffset"],needAlphaBlending:!1,needAlphaTesting:!1})||this;return n._hover=!1,n._drag=!1,n._color=new l.Color3,n._scale=1,n._lastTick=-1,n.animationLength=100,n.hoverColor=new l.Color3(0,.467,.84),n.baseColor=new l.Color3(1,1,1),n.hoverScale=.75,n.baseScale=.35,n.dragScale=.55,n._positionOffset=l.Vector3.Zero(),n._updateInterpolationTarget(),n._lastTick=Date.now(),n._onBeforeRender=n.getScene().onBeforeRenderObservable.add((function(){var e=Date.now(),t=e-n._lastTick,i=n._targetScale-n._scale,o=l.TmpColors.Color3[0].copyFrom(n._targetColor).subtractToRef(n._color,l.TmpColors.Color3[0]);n._scale=n._scale+i*t/n.animationLength,o.scaleToRef(t/n.animationLength,o),n._color.addToRef(o,n._color),n.setColor3("color",n._color),n.setFloat("scale",n._scale),n.setVector3("positionOffset",n._positionOffset),n._lastTick=e})),n}return o(t,e),Object.defineProperty(t.prototype,"hover",{get:function(){return this._hover},set:function(e){this._hover=e,this._updateInterpolationTarget()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"drag",{get:function(){return this._drag},set:function(e){this._drag=e,this._updateInterpolationTarget()},enumerable:!1,configurable:!0}),t.prototype._updateInterpolationTarget=function(){this.drag?(this._targetColor=this.hoverColor,this._targetScale=this.dragScale):this.hover?(this._targetColor=this.hoverColor,this._targetScale=this.hoverScale):(this._targetColor=this.baseColor,this._targetScale=this.baseScale)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.getScene().onBeforeRenderObservable.remove(this._onBeforeRender)},t}(l.ShaderMaterial);!function(e){e[e.IDLE=0]="IDLE",e[e.HOVER=1]="HOVER",e[e.DRAG=2]="DRAG"}(Oe||(Oe={}));var Ce=function(){function e(e,t){this._state=Oe.IDLE,this._materials=[],this._scene=t,this._gizmo=e,this.node=this.createNode(),this.node.reservedDataStore={handle:this}}return Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gizmo",{get:function(){return this._gizmo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hover",{set:function(e){e?this._state|=Oe.HOVER:this._state&=~Oe.HOVER,this._updateMaterial()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drag",{set:function(e){e?this._state|=Oe.DRAG:this._state&=~Oe.DRAG,this._updateMaterial()},enumerable:!1,configurable:!0}),e.prototype._createMaterial=function(e){var t=new Be("handle",this._scene);return e&&(t._positionOffset=e),t},e.prototype._updateMaterial=function(){for(var e=this._state,t=0,i=this._materials;t<i.length;t++)(s=i[t]).hover=!1,s.drag=!1;if(e&Oe.DRAG)for(var n=0,o=this._materials;n<o.length;n++)(s=o[n]).drag=!0;else if(e&Oe.HOVER)for(var r=0,a=this._materials;r<a.length;r++){var s;(s=a[r]).hover=!0}},e.prototype.setDragBehavior=function(e,t,i){var n=new l.BaseSixDofDragBehavior;this._dragBehavior=n,this._dragStartObserver=n.onDragStartObservable.add(e),this._draggingObserver=n.onDragObservable.add(t),this._dragEndObserver=n.onDragEndObservable.add(i),this._dragBehavior.attach(this.node)},e.prototype.dispose=function(){this._dragBehavior.onDragStartObservable.remove(this._dragStartObserver),this._dragBehavior.onDragObservable.remove(this._draggingObserver),this._dragBehavior.onDragEndObservable.remove(this._dragEndObserver),this._dragBehavior.detach();for(var e=0,t=this._materials;e<t.length;e++)t[e].dispose();this.node.dispose()},e}(),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.createNode=function(){var e=Object(l.CreateBox)("sideVert",{width:1,height:10,depth:.1},this._scene),t=new l.TransformNode("side",this._scene);e.parent=t;var i=this._createMaterial();return e.material=i,e.isNearGrabbable=!0,this._materials.push(i),t},t}(Ce),Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.createNode=function(){var e=Object(l.CreateBox)("angleHor",{width:3,height:1,depth:.1},this._scene),t=Object(l.CreateBox)("angleVert",{width:1,height:3,depth:.1},this._scene),i=new l.TransformNode("angle",this._scene);return e.parent=i,t.parent=i,e.material=this._createMaterial(new l.Vector3(1,0,0)),t.material=this._createMaterial(new l.Vector3(0,1,0)),t.isNearGrabbable=!0,e.isNearGrabbable=!0,this._materials.push(e.material),this._materials.push(t.material),i},t}(Ce),Se=function(e){function t(t){var i=e.call(this,t)||this;return i._boundingDimensions=new l.Vector3(0,0,0),i._renderObserver=null,i._tmpQuaternion=new l.Quaternion,i._tmpVector=new l.Vector3(0,0,0),i._corners=[],i._sides=[],i._boundingBoxGizmo={min:new l.Vector3,max:new l.Vector3},i._margin=.35,i._attachedSlate=null,i._existingSlateScale=new l.Vector3,i.fixedScreenSize=!1,i.fixedScreenSizeDistanceFactor=10,i.handleSize=.01,i._createNode(),i.updateScale=!1,i._renderObserver=i.gizmoLayer.originalScene.onBeforeRenderObservable.add((function(){i.attachedMesh&&!i._existingSlateScale.equals(i.attachedMesh.scaling)&&i.updateBoundingBox()})),i}return o(t,e),Object.defineProperty(t.prototype,"attachedSlate",{get:function(){return this._attachedSlate},set:function(e){var t=this;e?(this.attachedMesh=e.mesh,this.updateBoundingBox(),this._pickedPointObserver=e._host.onPickingObservable.add((function(e){if(!t._handleHovered||e&&e.parent===t._handleHovered.node||(t._handleHovered.hover=!1,t._handleHovered=null),e&&e.parent&&e.parent.reservedDataStore&&e.parent.reservedDataStore.handle){var i=e.parent.reservedDataStore.handle;i.gizmo===t&&(t._handleHovered=i,t._handleHovered.hover=!0)}}))):this._attachedSlate&&this._attachedSlate._host.onPickingObservable.remove(this._pickedPointObserver),this._attachedSlate=e},enumerable:!1,configurable:!0}),t.prototype._createNode=function(){var e=this;this._handlesParent=new l.TransformNode("handlesParent",this.gizmoLayer.utilityLayerScene),this._handlesParent.rotationQuaternion=l.Quaternion.Identity();for(var t=[{dimensions:new l.Vector3(-1,-1,0),origin:new l.Vector3(1,0,0)},{dimensions:new l.Vector3(1,-1,0),origin:new l.Vector3(0,0,0)},{dimensions:new l.Vector3(1,1,0),origin:new l.Vector3(0,1,0)},{dimensions:new l.Vector3(-1,1,0),origin:new l.Vector3(1,1,0)}],i=0;i<4;i++){var n=new Ie(this,this.gizmoLayer.utilityLayerScene);this._corners.push(n),n.node.rotation.z=Math.PI/2*i,n.node.scaling.setAll(this.handleSize),n.node.parent=this._handlesParent,this._assignDragBehaviorCorners(n,(function(t,i,n,o){return e._moveHandle(t,i,n,o,!0)}),t[i])}for(i=0;i<4;i++){var o=new Te(this,this.gizmoLayer.utilityLayerScene);this._sides.push(o),o.node.rotation.z=Math.PI/2*i,o.node.scaling.copyFromFloats(this.handleSize,this.handleSize,this.handleSize),o.node.parent=this._handlesParent,this._assignDragBehaviorSides(o,i%2==0?new l.Vector3(0,1,0):new l.Vector3(1,0,0))}this._handlesParent.parent=this._rootMesh},t.prototype._keepAspectRatio=function(e,t,i){void 0===i&&(i=!1);var n=l.TmpVectors.Vector3[0];n.copyFromFloats(t,1,0).normalize(),i&&(n.y*=-1);var o=l.Vector3.Dot(e,n);e.copyFrom(n).scaleInPlace(o)},t.prototype._clampDimensions=function(e,t,i,n){void 0===n&&(n=!1);var o=l.TmpVectors.Vector3[0];o.copyFrom(e).multiplyInPlace(i);var r=l.TmpVectors.Vector3[1];if(r.copyFromFloats(Math.max(this._attachedSlate.minDimensions.x,o.x+t.x),Math.max(this._attachedSlate.minDimensions.y,o.y+t.y),0),n){var a=t.x/t.y;r.x=Math.max(r.x,r.y*a),r.y=Math.max(r.y,r.x/a)}o.copyFrom(r).subtractInPlace(t),e.x=Math.sign(e.x)*Math.abs(o.x),e.y=Math.sign(e.y)*Math.abs(o.y)},t.prototype._moveHandle=function(e,t,i,n,o){if(this._attachedSlate){if(o){var r=t.x/t.y;this._keepAspectRatio(i,r,n.dimensions.x*n.dimensions.y<0)}this._clampDimensions(i,t,n.dimensions,o);var a=l.TmpVectors.Vector3[0],s=l.TmpVectors.Vector3[1];a.copyFrom(i).multiplyInPlace(n.origin),s.copyFrom(i).multiplyInPlace(n.dimensions),this._attachedSlate.origin.copyFrom(e).addInPlace(a),this._attachedSlate.dimensions.copyFrom(t).addInPlace(s),this._attachedSlate.backplateDimensions.x=this._attachedSlate.dimensions.x}},t.prototype._assignDragBehaviorCorners=function(e,t,i){var n=this,o=new l.Vector3,r=new l.Vector3,a=new l.Vector3,s=new l.Matrix,_=new l.Vector3,h=!1;e.setDragBehavior((function(e){n.attachedSlate&&n.attachedMesh&&(o.copyFrom(n.attachedSlate.dimensions),r.copyFrom(n.attachedSlate.origin),a.copyFrom(e.position),s.copyFrom(n.attachedMesh.computeWorldMatrix(!0)),s.invert(),h=n.attachedSlate.defaultBehavior.followBehaviorEnabled,n.attachedSlate.defaultBehavior.followBehaviorEnabled=!1,l.Vector3.TransformNormalToRef(l.Vector3.Forward(),n.attachedMesh.getWorldMatrix(),_),_.normalize(),n._handleHovered&&(n._handleDragged=n._handleHovered,n._handleDragged.drag=!0))}),(function(e){n.attachedSlate&&n.attachedMesh&&(function(e,t,i,n){e.subtractToRef(i,l.TmpVectors.Vector3[0]);var o=l.Vector3.Dot(l.TmpVectors.Vector3[0],t);l.TmpVectors.Vector3[1].copyFrom(t).scaleInPlace(o),l.TmpVectors.Vector3[0].subtractInPlace(l.TmpVectors.Vector3[1]),l.TmpVectors.Vector3[0].addToRef(i,n)}(e.position,_,a,n._tmpVector),n._tmpVector.subtractInPlace(a),l.Vector3.TransformNormalToRef(n._tmpVector,s,n._tmpVector),t(r,o,n._tmpVector,i),n.attachedSlate._positionElements(),n.updateBoundingBox())}),(function(){n.attachedSlate&&n.attachedNode&&(n.attachedSlate._updatePivot(),n.attachedSlate.defaultBehavior.followBehaviorEnabled=h,n._handleDragged&&(n._handleDragged.drag=!1,n._handleDragged=null))}))},t.prototype._assignDragBehaviorSides=function(e,t){var i,n=this,o=new l.Quaternion,r=new l.Vector3,a=new l.Vector3,s=new l.Vector3,_=new l.Vector3;e.setDragBehavior((function(e){n.attachedSlate&&n.attachedMesh&&(o.copyFrom(n.attachedMesh.rotationQuaternion),r.copyFrom(e.position),i=n.attachedSlate.defaultBehavior.followBehaviorEnabled,n.attachedSlate.defaultBehavior.followBehaviorEnabled=!1,s.copyFrom(n.attachedMesh.getAbsolutePivotPoint()),a.copyFrom(r).subtractInPlace(s).normalize(),l.Vector3.TransformNormalToRef(t,n.attachedMesh.getWorldMatrix(),_),_.normalize(),n._handleHovered&&(n._handleDragged=n._handleHovered,n._handleDragged.drag=!0))}),(function(e){if(n.attachedSlate&&n.attachedMesh){n._tmpVector.copyFrom(e.position),n._tmpVector.subtractInPlace(s),n._tmpVector.normalize();var i=-l.Vector3.GetAngleBetweenVectorsOnPlane(n._tmpVector,a,_);l.Quaternion.RotationAxisToRef(t,i,n._tmpQuaternion),o.multiplyToRef(n._tmpQuaternion,n.attachedMesh.rotationQuaternion)}}),(function(){n.attachedSlate&&n.attachedNode&&(n.attachedSlate._updatePivot(),n.attachedSlate.defaultBehavior.followBehaviorEnabled=i,n._handleDragged&&(n._handleDragged.drag=!1,n._handleDragged=null))}))},t.prototype._attachedNodeChanged=function(e){e&&this.updateBoundingBox()},t.prototype.updateBoundingBox=function(){if(this.attachedMesh){l.PivotTools._RemoveAndStorePivotPoint(this.attachedMesh);var e=this.attachedMesh.parent;this.attachedMesh.setParent(null),this._update(),this.attachedMesh.rotationQuaternion||(this.attachedMesh.rotationQuaternion=l.Quaternion.RotationYawPitchRoll(this.attachedMesh.rotation.y,this.attachedMesh.rotation.x,this.attachedMesh.rotation.z)),this._tmpQuaternion.copyFrom(this.attachedMesh.rotationQuaternion),this._tmpVector.copyFrom(this.attachedMesh.position),this.attachedMesh.rotationQuaternion.set(0,0,0,1),this.attachedMesh.position.set(0,0,0);var t=this.attachedMesh.getHierarchyBoundingVectors();t.max.subtractToRef(t.min,this._boundingDimensions),this._boundingBoxGizmo.min=t.min,this._boundingBoxGizmo.max=t.max,this._updateHandlesPosition(),this.attachedMesh.rotationQuaternion.copyFrom(this._tmpQuaternion),this.attachedMesh.position.copyFrom(this._tmpVector),l.PivotTools._RestorePivotPoint(this.attachedMesh),this.attachedMesh.setParent(e),this.attachedMesh.computeWorldMatrix(!0),this._existingSlateScale.copyFrom(this.attachedMesh.scaling)}},t.prototype._updateHandlesPosition=function(){var e=this._boundingBoxGizmo.min.clone(),t=this._boundingBoxGizmo.max.clone(),i=this._corners[0].node.scaling.length();e.x-=this._margin*i,e.y-=this._margin*i,t.x+=this._margin*i,t.y+=this._margin*i;var n=e.add(t).scaleInPlace(.5);this._corners[0].node.position.copyFromFloats(e.x,e.y,0),this._corners[1].node.position.copyFromFloats(t.x,e.y,0),this._corners[2].node.position.copyFromFloats(t.x,t.y,0),this._corners[3].node.position.copyFromFloats(e.x,t.y,0),this._sides[0].node.position.copyFromFloats(e.x,n.y,0),this._sides[1].node.position.copyFromFloats(n.x,e.y,0),this._sides[2].node.position.copyFromFloats(t.x,n.y,0),this._sides[3].node.position.copyFromFloats(n.x,t.y,0)},t.prototype._update=function(){if(e.prototype._update.call(this),this.gizmoLayer.utilityLayerScene.activeCamera&&this._attachedSlate&&this._attachedSlate.mesh){if(this.fixedScreenSize){this._attachedSlate.mesh.absolutePosition.subtractToRef(this.gizmoLayer.utilityLayerScene.activeCamera.position,this._tmpVector);for(var t=this.handleSize*this._tmpVector.length()/this.fixedScreenSizeDistanceFactor,i=0;i<this._corners.length;i++)this._corners[i].node.scaling.set(t,t,t)}this._updateHandlesPosition()}},t.prototype.dispose=function(){this.gizmoLayer.originalScene.onBeforeRenderObservable.remove(this._renderObserver),e.prototype.dispose.call(this);for(var t=0,i=this._corners;t<i.length;t++)i[t].dispose();for(var n=0,o=this._sides;n<o.length;n++)o[n].dispose()},t}(l.Gizmo),Re=function(){function e(){this.followBehaviorEnabled=!1,this.sixDofDragBehaviorEnabled=!0,this.surfaceMagnetismBehaviorEnabled=!0,this._followBehavior=new l.FollowBehavior,this._sixDofDragBehavior=new l.SixDofDragBehavior,this._surfaceMagnetismBehavior=new l.SurfaceMagnetismBehavior}return Object.defineProperty(e.prototype,"name",{get:function(){return"Default"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followBehavior",{get:function(){return this._followBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sixDofDragBehavior",{get:function(){return this._sixDofDragBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"surfaceMagnetismBehavior",{get:function(){return this._surfaceMagnetismBehavior},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.attach=function(e,t,i){this._scene=e.getScene(),this.attachedNode=e,this._addObservables(),this._followBehavior.attach(e),this._sixDofDragBehavior.attach(e),this._sixDofDragBehavior.draggableMeshes=t||null,this._sixDofDragBehavior.faceCameraOnDragStart=!0,this._surfaceMagnetismBehavior.attach(e,this._scene),i&&(this._surfaceMagnetismBehavior.meshes=i),this._surfaceMagnetismBehavior.enabled=!1},e.prototype.detach=function(){this.attachedNode=null,this._removeObservables(),this._followBehavior.detach(),this._sixDofDragBehavior.detach(),this._surfaceMagnetismBehavior.detach()},e.prototype._addObservables=function(){var e=this;this._onBeforeRenderObserver=this._scene.onBeforeRenderObservable.add((function(){e._followBehavior._enabled=!e._sixDofDragBehavior.isMoving&&e.followBehaviorEnabled})),this._onDragObserver=this._sixDofDragBehavior.onDragObservable.add((function(t){e._sixDofDragBehavior.disableMovement=e._surfaceMagnetismBehavior.findAndUpdateTarget(t.pickInfo)}))},e.prototype._removeObservables=function(){this._scene.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._sixDofDragBehavior.onDragObservable.remove(this._onDragObserver)},e}(),we="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\nuniform float _Radius_;\nuniform float _Line_Width_;\nuniform bool _Absolute_Sizes_;\nuniform float _Filter_Width_;\nuniform vec4 _Base_Color_;\nuniform vec4 _Line_Color_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform float _Rate_;\nuniform vec4 _Highlight_Color_;\nuniform float _Highlight_Width_;\nuniform vec4 _Highlight_Transform_;\nuniform float _Highlight_;\nuniform float _Iridescence_Intensity_;\nuniform float _Iridescence_Edge_Intensity_;\nuniform float _Angle_;\nuniform float _Fade_Out_;\n\nuniform bool _Reflected_;\nuniform float _Frequency_;\nuniform float _Vertical_Offset_;\n\nuniform sampler2D _Iridescent_Map_;\nuniform bool _Use_Global_Left_Index_;\nuniform bool _Use_Global_Right_Index_;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\n\nvoid Round_Rect_Fragment_B31(\nfloat Radius,\nfloat Line_Width,\nvec4 Line_Color,\nfloat Filter_Width,\nvec2 UV,\nfloat Line_Visibility,\nvec4 Rect_Parms,\nvec4 Fill_Color,\nout vec4 Color)\n{\nfloat d=length(max(abs(UV)-Rect_Parms.xy,0.0));\nfloat dx=max(fwidth(d)*Filter_Width,0.00001);\n\nfloat g=min(Rect_Parms.z,Rect_Parms.w);\nfloat dgrad=max(fwidth(g)*Filter_Width,0.00001);\nfloat Inside_Rect=clamp(g/dgrad,0.0,1.0);\n\n\nfloat inner=clamp((d+dx*0.5-max(Radius-Line_Width,d-dx*0.5))/dx,0.0,1.0);\nColor=clamp(mix(Fill_Color,Line_Color,inner),0.0,1.0)*Inside_Rect;\n\n\n\n}\n\n\nvoid Blob_Fragment_B71(\nsampler2D Blob_Texture,\nvec4 Blob_Info1,\nvec4 Blob_Info2,\nout vec4 Blob_Color)\n{\nfloat k1=dot(Blob_Info1.xy,Blob_Info1.xy);\nfloat k2=dot(Blob_Info2.xy,Blob_Info2.xy);\nvec3 closer=k1<k2 ? vec3(k1,Blob_Info1.z,Blob_Info1.w) : vec3(k2,Blob_Info2.z,Blob_Info2.w);\nBlob_Color=closer.z*texture(Blob_Texture,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\n}\n\n\nvoid Line_Fragment_B48(\nvec4 Base_Color,\nvec4 Highlight_Color,\nfloat Highlight_Width,\nvec3 Line_Vertex,\nfloat Highlight,\nout vec4 Line_Color)\n{\nfloat k2=1.0-clamp(abs(Line_Vertex.y/Highlight_Width),0.0,1.0);\nLine_Color=mix(Base_Color,Highlight_Color,Highlight*k2);\n}\n\n\nvoid Scale_RGB_B54(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Conditional_Float_B38(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\nvoid main()\n{\n\nfloat R_Q72;\nfloat G_Q72;\nfloat B_Q72;\nfloat A_Q72;\nR_Q72=vColor.r; G_Q72=vColor.g; B_Q72=vColor.b; A_Q72=vColor.a;\nvec4 Blob_Color_Q71;\n#if BLOB_ENABLE\n\nfloat k1=dot(vExtra2.xy,vExtra2.xy);\nfloat k2=dot(vExtra3.xy,vExtra3.xy);\nvec3 closer=k1<k2 ? vec3(k1,vExtra2.z,vExtra2.w) : vec3(k2,vExtra3.z,vExtra3.w);\nBlob_Color_Q71=closer.z*texture(_Blob_Texture_,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\n#else\nBlob_Color_Q71=vec4(0,0,0,0);\n#endif\nvec4 Line_Color_Q48;\nLine_Fragment_B48(_Line_Color_,_Highlight_Color_,_Highlight_Width_,vTangent,_Highlight_,Line_Color_Q48);\n\nfloat X_Q67;\nfloat Y_Q67;\nX_Q67=vUV.x;\nY_Q67=vUV.y;\n\nvec3 Incident_Q66=normalize(vPosition-cameraPosition);\n\nvec3 Reflected_Q60=reflect(Incident_Q66,vBinormal);\n\nfloat Product_Q63=Y_Q67*_Vertical_Offset_;\n\nfloat Dot_Q68=dot(Incident_Q66,Reflected_Q60);\n\nfloat Dot_Q57=dot(vNormal,Incident_Q66);\nfloat Result_Q38;\nConditional_Float_B38(_Reflected_,Dot_Q68,Dot_Q57,Result_Q38);\n\nfloat Product_Q64=Result_Q38*_Frequency_;\n\nfloat Sum_Q69=Product_Q64+1.0;\n\nfloat Product_Q70=Sum_Q69*0.5;\n\nfloat Sum_Q62=Product_Q63+Product_Q70;\n\nfloat FractF_Q59=fract(Sum_Q62);\n\nvec2 Vec2_Q65=vec2(FractF_Q59,0.5);\n\nvec4 Color_Q58;\n#if IRIDESCENT_MAP_ENABLE\nColor_Q58=texture(_Iridescent_Map_,Vec2_Q65);\n#else\nColor_Q58=vec4(0,0,0,0);\n#endif\nvec4 Result_Q54;\nScale_RGB_B54(Color_Q58,_Iridescence_Edge_Intensity_,Result_Q54);\nvec4 Result_Q55;\nScale_RGB_B54(Color_Q58,_Iridescence_Intensity_,Result_Q55);\n\nvec4 Base_And_Iridescent_Q53;\nBase_And_Iridescent_Q53=Line_Color_Q48+vec4(Result_Q54.rgb,0.0);\n\nvec4 Base_And_Iridescent_Q56;\nBase_And_Iridescent_Q56=_Base_Color_+vec4(Result_Q55.rgb,0.0);\n\nvec4 Result_Q52=Base_And_Iridescent_Q53; Result_Q52.a=1.0;\n\nvec4 Result_Q35=Blob_Color_Q71+(1.0-Blob_Color_Q71.a)*Base_And_Iridescent_Q56;\nvec4 Color_Q31;\nRound_Rect_Fragment_B31(R_Q72,G_Q72,Result_Q52,_Filter_Width_,vUV,1.0,vExtra1,Result_Q35,Color_Q31);\n\nvec4 Result_Q47=_Fade_Out_*Color_Q31;\nvec4 Out_Color=Result_Q47;\nfloat Clip_Threshold=0.001;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";l.ShaderStore.ShadersStore.fluentBackplatePixelShader=we;var Me="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\n#ifdef TANGENT\nattribute vec3 tangent;\n#else\nconst vec3 tangent=vec3(0.);\n#endif\nuniform float _Radius_;\nuniform float _Line_Width_;\nuniform bool _Absolute_Sizes_;\nuniform float _Filter_Width_;\nuniform vec4 _Base_Color_;\nuniform vec4 _Line_Color_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform float _Rate_;\nuniform vec4 _Highlight_Color_;\nuniform float _Highlight_Width_;\nuniform vec4 _Highlight_Transform_;\nuniform float _Highlight_;\nuniform float _Iridescence_Intensity_;\nuniform float _Iridescence_Edge_Intensity_;\nuniform float _Angle_;\nuniform float _Fade_Out_;\n\nuniform bool _Reflected_;\nuniform float _Frequency_;\nuniform float _Vertical_Offset_;\n\nuniform sampler2D _Iridescent_Map_;\nuniform bool _Use_Global_Left_Index_;\nuniform bool _Use_Global_Right_Index_;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\n\nvoid Object_To_World_Pos_B115(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid PickDir_B140(\nfloat Degrees,\nvec3 DirX,\nvec3 DirY,\nout vec3 Dir)\n{\n\nfloat a=Degrees*3.14159/180.0;\nDir=cos(a)*DirX+sin(a)*DirY;\n}\n\n\nvoid Round_Rect_Vertex_B139(\nvec2 UV,\nfloat Radius,\nfloat Margin,\nfloat Anisotropy,\nfloat Gradient1,\nfloat Gradient2,\nout vec2 Rect_UV,\nout vec4 Rect_Parms,\nout vec2 Scale_XY,\nout vec2 Line_UV)\n{\nScale_XY=vec2(Anisotropy,1.0);\nLine_UV=(UV-vec2(0.5,0.5));\nRect_UV=Line_UV*Scale_XY;\nRect_Parms.xy=Scale_XY*0.5-vec2(Radius,Radius)-vec2(Margin,Margin);\nRect_Parms.z=Gradient1;\nRect_Parms.w=Gradient2;\n}\n\n\nvoid Line_Vertex_B135(\nvec2 Scale_XY,\nvec2 UV,\nfloat Time,\nfloat Rate,\nvec4 Highlight_Transform,\nout vec3 Line_Vertex)\n{\nfloat angle2=(Rate*Time)*2.0*3.1416;\nfloat sinAngle2=sin(angle2);\nfloat cosAngle2=cos(angle2);\nvec2 xformUV=UV*Highlight_Transform.xy+Highlight_Transform.zw;\nLine_Vertex.x=0.0;\nLine_Vertex.y=cosAngle2*xformUV.x-sinAngle2*xformUV.y;\nLine_Vertex.z=0.0;\n}\n\n\nvoid Blob_Vertex_B180(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=Blob_Position;\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Move_Verts_B129(\nfloat Anisotropy,\nvec3 P,\nfloat Radius,\nout vec3 New_P,\nout vec2 New_UV,\nout float Radial_Gradient,\nout vec3 Radial_Dir)\n{\nvec2 UV=P.xy*2.0+0.5;\nvec2 center=clamp(UV,0.0,1.0);\nvec2 delta=UV-center;\nvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\nNew_UV=center+r2*(UV-2.0*center+0.5);\nNew_P=vec3(New_UV-0.5,P.z);\nRadial_Gradient=1.0-length(delta)*2.0;\nRadial_Dir=vec3(delta*r2,0.0);\n}\n\n\nvoid Object_To_World_Dir_B132(\nvec3 Dir_Object,\nout vec3 Binormal_World,\nout vec3 Binormal_World_N,\nout float Binormal_Length)\n{\nBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nBinormal_Length=length(Binormal_World);\nBinormal_World_N=Binormal_World/Binormal_Length;\n}\n\n\nvoid RelativeOrAbsoluteDetail_B147(\nfloat Nominal_Radius,\nfloat Nominal_LineWidth,\nbool Absolute_Measurements,\nfloat Height,\nout float Radius,\nout float Line_Width)\n{\nfloat scale=Absolute_Measurements ? 1.0/Height : 1.0;\nRadius=Nominal_Radius*scale;\nLine_Width=Nominal_LineWidth*scale;\n}\n\n\nvoid Edge_AA_Vertex_B130(\nvec3 Position_World,\nvec3 Position_Object,\nvec3 Normal_Object,\nvec3 Eye,\nfloat Radial_Gradient,\nvec3 Radial_Dir,\nvec3 Tangent,\nout float Gradient1,\nout float Gradient2)\n{\n\nvec3 I=(Eye-Position_World);\nvec3 T=(world* vec4(Tangent,0.0)).xyz;\nfloat g=(dot(T,I)<0.0) ? 0.0 : 1.0;\nif (Normal_Object.z==0.0) {\n\nGradient1=Position_Object.z>0.0 ? g : 1.0;\nGradient2=Position_Object.z>0.0 ? 1.0 : g;\n} else {\n\n\n\n\nGradient1=g+(1.0-g)*(Radial_Gradient);\nGradient2=1.0;\n}\n}\n\n\nvoid Pick_Radius_B144(\nfloat Radius,\nfloat Radius_Top_Left,\nfloat Radius_Top_Right,\nfloat Radius_Bottom_Left,\nfloat Radius_Bottom_Right,\nvec3 Position,\nout float Result)\n{\nbool whichY=Position.y>0.0;\nResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\nResult*=Radius;\n}\n\nvoid main()\n{\n\nvec3 Nrm_World_Q128;\nNrm_World_Q128=normalize((world*vec4(normal,0.0)).xyz);\n\nvec3 Tangent_World_Q131;\nvec3 Tangent_World_N_Q131;\nfloat Tangent_Length_Q131;\nTangent_World_Q131=(world*vec4(vec3(1,0,0),0.0)).xyz;\nTangent_Length_Q131=length(Tangent_World_Q131);\nTangent_World_N_Q131=Tangent_World_Q131/Tangent_Length_Q131;\nvec3 Binormal_World_Q132;\nvec3 Binormal_World_N_Q132;\nfloat Binormal_Length_Q132;\nObject_To_World_Dir_B132(vec3(0,1,0),Binormal_World_Q132,Binormal_World_N_Q132,Binormal_Length_Q132);\n\nfloat Anisotropy_Q133=Tangent_Length_Q131/Binormal_Length_Q132;\n\nvec3 Result_Q177;\nResult_Q177=mix(_Blob_Position_,Global_Left_Index_Tip_Position.xyz,float(_Use_Global_Left_Index_));\n\nvec3 Result_Q178;\nResult_Q178=mix(_Blob_Position_2_,Global_Right_Index_Tip_Position.xyz,float(_Use_Global_Right_Index_));\nfloat Result_Q144;\nPick_Radius_B144(_Radius_,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q144);\nvec3 Dir_Q140;\nPickDir_B140(_Angle_,Tangent_World_N_Q131,Binormal_World_N_Q132,Dir_Q140);\nfloat Radius_Q147;\nfloat Line_Width_Q147;\nRelativeOrAbsoluteDetail_B147(Result_Q144,_Line_Width_,_Absolute_Sizes_,Binormal_Length_Q132,Radius_Q147,Line_Width_Q147);\n\nvec4 Out_Color_Q145=vec4(Radius_Q147,Line_Width_Q147,0,1);\nvec3 New_P_Q129;\nvec2 New_UV_Q129;\nfloat Radial_Gradient_Q129;\nvec3 Radial_Dir_Q129;\nMove_Verts_B129(Anisotropy_Q133,position,Radius_Q147,New_P_Q129,New_UV_Q129,Radial_Gradient_Q129,Radial_Dir_Q129);\nvec3 Pos_World_Q115;\nObject_To_World_Pos_B115(New_P_Q129,Pos_World_Q115);\nvec4 Blob_Info_Q180;\n#if BLOB_ENABLE\nBlob_Vertex_B180(Pos_World_Q115,Nrm_World_Q128,Tangent_World_N_Q131,Binormal_World_N_Q132,Result_Q177,_Blob_Intensity_,_Blob_Near_Size_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_,_Blob_Fade_,Blob_Info_Q180);\n#else\nBlob_Info_Q180=vec4(0,0,0,0);\n#endif\nvec4 Blob_Info_Q181;\n#if BLOB_ENABLE_2\nBlob_Vertex_B180(Pos_World_Q115,Nrm_World_Q128,Tangent_World_N_Q131,Binormal_World_N_Q132,Result_Q178,_Blob_Intensity_,_Blob_Near_Size_2_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_2_,_Blob_Fade_2_,Blob_Info_Q181);\n#else\nBlob_Info_Q181=vec4(0,0,0,0);\n#endif\nfloat Gradient1_Q130;\nfloat Gradient2_Q130;\n#if SMOOTH_EDGES\nEdge_AA_Vertex_B130(Pos_World_Q115,position,normal,cameraPosition,Radial_Gradient_Q129,Radial_Dir_Q129,tangent,Gradient1_Q130,Gradient2_Q130);\n#else\nGradient1_Q130=1.0;\nGradient2_Q130=1.0;\n#endif\nvec2 Rect_UV_Q139;\nvec4 Rect_Parms_Q139;\nvec2 Scale_XY_Q139;\nvec2 Line_UV_Q139;\nRound_Rect_Vertex_B139(New_UV_Q129,Radius_Q147,0.0,Anisotropy_Q133,Gradient1_Q130,Gradient2_Q130,Rect_UV_Q139,Rect_Parms_Q139,Scale_XY_Q139,Line_UV_Q139);\nvec3 Line_Vertex_Q135;\nLine_Vertex_B135(Scale_XY_Q139,Line_UV_Q139,0.0,_Rate_,_Highlight_Transform_,Line_Vertex_Q135);\nvec3 Position=Pos_World_Q115;\nvec3 Normal=Dir_Q140;\nvec2 UV=Rect_UV_Q139;\nvec3 Tangent=Line_Vertex_Q135;\nvec3 Binormal=Nrm_World_Q128;\nvec4 Color=Out_Color_Q145;\nvec4 Extra1=Rect_Parms_Q139;\nvec4 Extra2=Blob_Info_Q180;\nvec4 Extra3=Blob_Info_Q181;\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvColor=Color;\nvExtra1=Extra1;\nvExtra2=Extra2;\nvExtra3=Extra3;\n}";l.ShaderStore.ShadersStore.fluentBackplateVertexShader=Me;var Ee=function(e){function t(){var t=e.call(this)||this;return t.BLOB_ENABLE=!0,t.BLOB_ENABLE_2=!0,t.SMOOTH_EDGES=!0,t.IRIDESCENT_MAP_ENABLE=!0,t._needNormals=!0,t.rebuild(),t}return o(t,e),t}(l.MaterialDefines),De=function(e){function t(i,n){var o=e.call(this,i,n)||this;return o.radius=.03,o.lineWidth=.01,o.absoluteSizes=!1,o._filterWidth=1,o.baseColor=new l.Color4(.0392157,.0666667,.207843,1),o.lineColor=new l.Color4(.14902,.133333,.384314,1),o.blobIntensity=.98,o.blobFarSize=.04,o.blobNearDistance=0,o.blobFarDistance=.08,o.blobFadeLength=.08,o.blobNearSize=.22,o.blobPulse=0,o.blobFade=0,o.blobNearSize2=.22,o.blobPulse2=0,o.blobFade2=0,o._rate=.135,o.highlightColor=new l.Color4(.98,.98,.98,1),o.highlightWidth=.25,o._highlightTransform=new l.Vector4(1,1,0,0),o._highlight=1,o.iridescenceIntensity=0,o.iridescenceEdgeIntensity=1,o._angle=-45,o.fadeOut=1,o._reflected=!0,o._frequency=1,o._verticalOffset=0,o.globalLeftIndexTipPosition=l.Vector3.Zero(),o._globalLeftIndexTipPosition4=l.Vector4.Zero(),o.globalRightIndexTipPosition=l.Vector3.Zero(),o._globalRightIndexTipPosition4=l.Vector4.Zero(),o.alphaMode=l.Constants.ALPHA_DISABLE,o.backFaceCulling=!1,o._blobTexture=new l.Texture(t.BLOB_TEXTURE_URL,n,!0,!1,l.Texture.NEAREST_SAMPLINGMODE),o._iridescentMap=new l.Texture(t.IM_TEXTURE_URL,n,!0,!1,l.Texture.NEAREST_SAMPLINGMODE),o}return o(t,e),t.prototype.needAlphaBlending=function(){return!1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,i){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t.materialDefines||(t.materialDefines=new Ee);var n=t.materialDefines,o=this.getScene();if(this._isReadyForSubMesh(t))return!0;var r=o.getEngine();if(l.MaterialHelper.PrepareDefinesForAttributes(e,n,!1,!1),n.isDirty){n.markAsProcessed(),o.resetCachedMaterial();var a=new l.EffectFallbacks;n.FOG&&a.addFallback(1,"FOG"),l.MaterialHelper.HandleFallbacksForShadows(n,a),n.IMAGEPROCESSINGPOSTPROCESS=o.imageProcessingConfiguration.applyByPostProcess;var s=[l.VertexBuffer.PositionKind];n.NORMAL&&s.push(l.VertexBuffer.NormalKind),n.UV1&&s.push(l.VertexBuffer.UVKind),n.UV2&&s.push(l.VertexBuffer.UV2Kind),n.VERTEXCOLOR&&s.push(l.VertexBuffer.ColorKind),n.TANGENT&&s.push(l.VertexBuffer.TangentKind),l.MaterialHelper.PrepareAttributesForInstances(s,n);var _=n.toString(),h=["world","viewProjection","cameraPosition","_Radius_","_Line_Width_","_Absolute_Sizes_","_Filter_Width_","_Base_Color_","_Line_Color_","_Radius_Top_Left_","_Radius_Top_Right_","_Radius_Bottom_Left_","_Radius_Bottom_Right_","_Blob_Position_","_Blob_Intensity_","_Blob_Near_Size_","_Blob_Far_Size_","_Blob_Near_Distance_","_Blob_Far_Distance_","_Blob_Fade_Length_","_Blob_Pulse_","_Blob_Fade_","_Blob_Texture_","_Blob_Position_2_","_Blob_Near_Size_2_","_Blob_Pulse_2_","_Blob_Fade_2_","_Rate_","_Highlight_Color_","_Highlight_Width_","_Highlight_Transform_","_Highlight_","_Iridescence_Intensity_","_Iridescence_Edge_Intensity_","_Angle_","_Fade_Out_","_Reflected_","_Frequency_","_Vertical_Offset_","_Iridescent_Map_","_Use_Global_Left_Index_","_Use_Global_Right_Index_","Global_Left_Index_Tip_Position","Global_Right_Index_Tip_Position"],c=["_Blob_Texture_","_Iridescent_Map_"],u=new Array;l.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:n,maxSimultaneousLights:4}),t.setEffect(o.getEngine().createEffect("fluentBackplate",{attributes:s,uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:_,fallbacks:a,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},r),n,this._materialContext)}return!(!t.effect||!t.effect.isReady()||(n._renderId=o.getRenderId(),t.effect._wasPreviouslyReady=!0,0))},t.prototype.bindForSubMesh=function(e,t,i){var n,o;if(i.materialDefines){var r=i.effect;r&&(this._activeEffect=r,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",null!==(o=null===(n=this.getScene().activeCamera)||void 0===n?void 0:n.position)&&void 0!==o?o:l.Vector3.ZeroReadOnly),this._activeEffect.setFloat("_Radius_",this.radius),this._activeEffect.setFloat("_Line_Width_",this.lineWidth),this._activeEffect.setFloat("_Absolute_Sizes_",this.absoluteSizes?1:0),this._activeEffect.setFloat("_Filter_Width_",this._filterWidth),this._activeEffect.setDirectColor4("_Base_Color_",this.baseColor),this._activeEffect.setDirectColor4("_Line_Color_",this.lineColor),this._activeEffect.setFloat("_Radius_Top_Left_",1),this._activeEffect.setFloat("_Radius_Top_Right_",1),this._activeEffect.setFloat("_Radius_Bottom_Left_",1),this._activeEffect.setFloat("_Radius_Bottom_Right_",1),this._activeEffect.setFloat("_Blob_Intensity_",this.blobIntensity),this._activeEffect.setFloat("_Blob_Near_Size_",this.blobNearSize),this._activeEffect.setFloat("_Blob_Far_Size_",this.blobFarSize),this._activeEffect.setFloat("_Blob_Near_Distance_",this.blobNearDistance),this._activeEffect.setFloat("_Blob_Far_Distance_",this.blobFarDistance),this._activeEffect.setFloat("_Blob_Fade_Length_",this.blobFadeLength),this._activeEffect.setFloat("_Blob_Pulse_",this.blobPulse),this._activeEffect.setFloat("_Blob_Fade_",this.blobFade),this._activeEffect.setTexture("_Blob_Texture_",this._blobTexture),this._activeEffect.setFloat("_Blob_Near_Size_2_",this.blobNearSize2),this._activeEffect.setFloat("_Blob_Pulse_2_",this.blobPulse2),this._activeEffect.setFloat("_Blob_Fade_2_",this.blobFade2),this._activeEffect.setFloat("_Rate_",this._rate),this._activeEffect.setDirectColor4("_Highlight_Color_",this.highlightColor),this._activeEffect.setFloat("_Highlight_Width_",this.highlightWidth),this._activeEffect.setVector4("_Highlight_Transform_",this._highlightTransform),this._activeEffect.setFloat("_Highlight_",this._highlight),this._activeEffect.setFloat("_Iridescence_Intensity_",this.iridescenceIntensity),this._activeEffect.setFloat("_Iridescence_Edge_Intensity_",this.iridescenceEdgeIntensity),this._activeEffect.setFloat("_Angle_",this._angle),this._activeEffect.setFloat("_Fade_Out_",this.fadeOut),this._activeEffect.setFloat("_Reflected_",this._reflected?1:0),this._activeEffect.setFloat("_Frequency_",this._frequency),this._activeEffect.setFloat("_Vertical_Offset_",this._verticalOffset),this._activeEffect.setTexture("_Iridescent_Map_",this._iridescentMap),this._activeEffect.setFloat("_Use_Global_Left_Index_",1),this._activeEffect.setFloat("_Use_Global_Right_Index_",1),this._globalLeftIndexTipPosition4.set(this.globalLeftIndexTipPosition.x,this.globalLeftIndexTipPosition.y,this.globalLeftIndexTipPosition.z,1),this._activeEffect.setVector4("Global_Left_Index_Tip_Position",this._globalLeftIndexTipPosition4),this._globalRightIndexTipPosition4.set(this.globalRightIndexTipPosition.x,this.globalRightIndexTipPosition.y,this.globalRightIndexTipPosition.z,1),this._activeEffect.setVector4("Global_Right_Index_Tip_Position",this._globalRightIndexTipPosition4),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t),this._blobTexture.dispose(),this._iridescentMap.dispose()},t.prototype.clone=function(e){var i=this;return l.SerializationHelper.Clone((function(){return new t(e,i.getScene())}),this)},t.prototype.serialize=function(){var e=l.SerializationHelper.Serialize(this);return e.customType="BABYLON.FluentBackplateMaterial",e},t.prototype.getClassName=function(){return"FluentBackplateMaterial"},t.Parse=function(e,i,n){return l.SerializationHelper.Parse((function(){return new t(e.name,i)}),e,i,n)},t.BLOB_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/mrtk-fluent-backplate-blob.png",t.IM_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/mrtk-fluent-backplate-iridescence.png",r([Object(l.serialize)()],t.prototype,"radius",void 0),r([Object(l.serialize)()],t.prototype,"lineWidth",void 0),r([Object(l.serialize)()],t.prototype,"absoluteSizes",void 0),r([Object(l.serialize)()],t.prototype,"baseColor",void 0),r([Object(l.serialize)()],t.prototype,"lineColor",void 0),r([Object(l.serialize)()],t.prototype,"blobIntensity",void 0),r([Object(l.serialize)()],t.prototype,"blobFarSize",void 0),r([Object(l.serialize)()],t.prototype,"blobNearDistance",void 0),r([Object(l.serialize)()],t.prototype,"blobFarDistance",void 0),r([Object(l.serialize)()],t.prototype,"blobFadeLength",void 0),r([Object(l.serialize)()],t.prototype,"blobNearSize",void 0),r([Object(l.serialize)()],t.prototype,"blobPulse",void 0),r([Object(l.serialize)()],t.prototype,"blobFade",void 0),r([Object(l.serialize)()],t.prototype,"blobNearSize2",void 0),r([Object(l.serialize)()],t.prototype,"blobPulse2",void 0),r([Object(l.serialize)()],t.prototype,"blobFade2",void 0),r([Object(l.serialize)()],t.prototype,"highlightColor",void 0),r([Object(l.serialize)()],t.prototype,"highlightWidth",void 0),r([Object(l.serialize)()],t.prototype,"iridescenceIntensity",void 0),r([Object(l.serialize)()],t.prototype,"iridescenceEdgeIntensity",void 0),r([Object(l.serialize)()],t.prototype,"fadeOut",void 0),r([Object(l.serializeAsVector3)()],t.prototype,"globalLeftIndexTipPosition",void 0),r([Object(l.serializeAsVector3)()],t.prototype,"globalRightIndexTipPosition",void 0),t}(l.PushMaterial);Object(l.RegisterClass)("BABYLON.GUI.FluentBackplateMaterial",De);var Le=function(e){function t(t){var i=e.call(this,t)||this;return i.dimensions=new l.Vector3(21.875,12.5,.001),i.minDimensions=new l.Vector3(15.625,6.25,.001),i.defaultDimensions=i.dimensions.clone(),i.backplateDimensions=new l.Vector3(21.875,.625,.001),i.backPlateMargin=.005,i.origin=new l.Vector3(0,0,0),i._contentScaleRatio=1,i._followButton=new ye("followButton"+i.name),i._closeButton=new ye("closeButton"+i.name),i._contentViewport=new l.Viewport(0,0,1,1),i._contentDragBehavior=new l.PointerDragBehavior({dragPlaneNormal:new l.Vector3(0,0,-1)}),i}return o(t,e),Object.defineProperty(t.prototype,"defaultBehavior",{get:function(){return this._defaultBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._backPlate.renderingGroupId},set:function(e){this._backPlate.renderingGroupId=e,this._contentPlate.renderingGroupId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl!==e&&(this._imageUrl=e,this._rebuildContent(),this._resetContentPositionAndZoom(),this._applyContentViewport())},enumerable:!1,configurable:!0}),t.prototype._applyFacade=function(e){this._contentMaterial.albedoTexture=e},t.prototype._rebuildContent=function(){if(this._disposeFacadeTexture(),l.DomManagement.IsDocumentAvailable()&&document.createElement&&this._imageUrl){var e=new P;e.source=this._imageUrl,this._contentPlate&&(this.content=e)}},t.prototype._addControl=function(e){e._host=this._host,this._host.utilityLayer&&e._prepareNode(this._host.utilityLayer.utilityLayerScene)},t.prototype._getTypeName=function(){return"HolographicSlate"},t.prototype._positionElements=function(){var e=this._followButton.mesh,t=this._closeButton.mesh,i=this._backPlate,n=this._contentPlate;if(e&&t&&i){var o=this.backplateDimensions.y/1;t.scaling.setAll(o),e.scaling.setAll(o),t.position.copyFromFloats(this.backplateDimensions.x-o/2,-this.backplateDimensions.y/2,-this.backplateDimensions.z/2*(this._host.scene.useRightHandedSystem?-1:1)).addInPlace(this.origin),e.position.copyFromFloats(this.backplateDimensions.x-3*o/2,-this.backplateDimensions.y/2,-this.backplateDimensions.z/2*(this._host.scene.useRightHandedSystem?-1:1)).addInPlace(this.origin);var r=this.dimensions.y-this.backplateDimensions.y-this.backPlateMargin;i.scaling.copyFrom(this.backplateDimensions),n.scaling.copyFromFloats(this.dimensions.x,r,this.dimensions.z),i.position.copyFromFloats(this.backplateDimensions.x/2,-this.backplateDimensions.y/2,0).addInPlace(this.origin),n.position.copyFromFloats(this.dimensions.x/2,-(this.backplateDimensions.y+this.backPlateMargin+r/2),0).addInPlace(this.origin);var a=this.dimensions.x/r;this._contentViewport.width=this._contentScaleRatio,this._contentViewport.height=this._contentScaleRatio/a,this._applyContentViewport()}},t.prototype._applyContentViewport=function(){if(this._contentPlate.material&&this._contentPlate.material.albedoTexture){var e=this._contentPlate.material.albedoTexture;e.uScale=this._contentScaleRatio,e.vScale=this._contentScaleRatio/this._contentViewport.width*this._contentViewport.height,e.uOffset=this._contentViewport.x,e.vOffset=this._contentViewport.y}},t.prototype._resetContentPositionAndZoom=function(){this._contentViewport.x=0,this._contentViewport.y=1-this._contentViewport.height/this._contentViewport.width,this._contentScaleRatio=1},t.prototype._updatePivot=function(){if(this.mesh){var e=this.dimensions.scale(.5);e.y*=-1,e.addInPlace(this.origin),e.z=0;var t=new l.Vector3(0,0,0);l.Vector3.TransformCoordinatesToRef(t,this.mesh.computeWorldMatrix(!0),t),this.mesh.setPivotPoint(e);var i=new l.Vector3(0,0,0);l.Vector3.TransformCoordinatesToRef(i,this.mesh.computeWorldMatrix(!0),i),this.mesh.position.addInPlace(t).subtractInPlace(i)}},t.prototype._createNode=function(e){var i=this,n=new l.Mesh("slate"+this.name,e);this._backPlate=Object(l.CreateBox)("backPlate"+this.name,{size:1},e);var o=new Array(6).fill(new l.Vector4(0,0,1,1));e.useRightHandedSystem&&o[0].copyFromFloats(0,1,1,0),this._contentPlate=Object(l.CreateBox)("contentPlate"+this.name,{size:1,faceUV:o},e),this._backPlate.parent=n,this._backPlate.isNearGrabbable=!0,this._contentPlate.parent=n,this._attachContentPlateBehavior(),this._addControl(this._followButton),this._addControl(this._closeButton);var r=this._followButton.mesh,a=this._closeButton.mesh;return r.parent=n,a.parent=n,this._positionElements(),this._followButton.imageUrl=t.ASSETS_BASE_URL+t.FOLLOW_ICON_FILENAME,this._closeButton.imageUrl=t.ASSETS_BASE_URL+t.CLOSE_ICON_FILENAME,this._followButton.isBackplateVisible=!1,this._closeButton.isBackplateVisible=!1,this._followButton.onPointerClickObservable.add((function(){i._defaultBehavior.followBehaviorEnabled=!i._defaultBehavior.followBehaviorEnabled,i._defaultBehavior.followBehaviorEnabled&&i._defaultBehavior.followBehavior.recenter()})),this._closeButton.onPointerClickObservable.add((function(){i.dispose()})),n.rotationQuaternion=l.Quaternion.Identity(),n.isVisible=!1,n},t.prototype._attachContentPlateBehavior=function(){var e=this;this._contentDragBehavior.attach(this._contentPlate),this._contentDragBehavior.moveAttached=!1,this._contentDragBehavior.useObjectOrientationForDragging=!0,this._contentDragBehavior.updateDragPlane=!1;var t,i,n=new l.Vector3,o=new l.Vector3,r=new l.Vector3,a=new l.Vector3,s=new l.Vector2;this._contentDragBehavior.onDragStartObservable.add((function(s){e.node&&(t=e._contentViewport.clone(),i=e.node.computeWorldMatrix(!0),n.copyFrom(s.dragPlanePoint),o.copyFrom(e.dimensions),o.y-=e.backplateDimensions.y+e.backPlateMargin,l.Vector3.TransformNormalToRef(o,i,o),r.copyFromFloats(0,1,0),l.Vector3.TransformNormalToRef(r,i,r),a.copyFromFloats(1,0,0),l.Vector3.TransformNormalToRef(a,i,a),r.normalize(),r.scaleInPlace(1/l.Vector3.Dot(r,o)),a.normalize(),a.scaleInPlace(1/l.Vector3.Dot(a,o)))}));var _=new l.Vector3;this._contentDragBehavior.onDragObservable.add((function(i){_.copyFrom(i.dragPlanePoint),_.subtractInPlace(n),s.copyFromFloats(l.Vector3.Dot(_,a),l.Vector3.Dot(_,r)),e._contentViewport.x=l.Scalar.Clamp(t.x-_.x,0,1-e._contentViewport.width*e._contentScaleRatio),e._contentViewport.y=l.Scalar.Clamp(t.y-_.y,0,1-e._contentViewport.height*e._contentScaleRatio),e._applyContentViewport()}))},t.prototype._affectMaterial=function(e){this._backPlateMaterial=new De(this.name+" plateMaterial",e.getScene()),this._pickedPointObserver=this._host.onPickedPointChangedObservable.add((function(e){})),this._contentMaterial=new de(this.name+"contentMaterial",e.getScene()),this._contentMaterial.renderBorders=!0,this._backPlate.material=this._backPlateMaterial,this._contentPlate.material=this._contentMaterial,this._rebuildContent(),this._applyContentViewport()},t.prototype._prepareNode=function(t){var i=this;e.prototype._prepareNode.call(this,t),this._gizmo=new Se(this._host.utilityLayer),this._gizmo.attachedSlate=this,this._defaultBehavior=new Re,this._defaultBehavior.attach(this.node,[this._backPlate]),this._positionChangedObserver=this._defaultBehavior.sixDofDragBehavior.onPositionChangedObservable.add((function(){i._gizmo.updateBoundingBox()})),this._updatePivot(),this.resetDefaultAspectAndPose()},t.prototype.resetDefaultAspectAndPose=function(){if(this._host&&this._host.utilityLayer&&this.node){var e=this._host.utilityLayer.utilityLayerScene,t=e.activeCamera;if(t){var i=t.getWorldMatrix(),n=l.Vector3.TransformNormal(l.Vector3.Backward(e.useRightHandedSystem),i);this.dimensions.copyFrom(this.defaultDimensions),this.origin.setAll(0),this._gizmo.updateBoundingBox();var o=this.node.getAbsolutePivotPoint();this.node.position.copyFrom(t.position).subtractInPlace(n).subtractInPlace(o),this.node.rotationQuaternion=l.Quaternion.FromLookDirectionLH(n,new l.Vector3(0,1,0))}}},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._backPlateMaterial.dispose(),this._contentMaterial.dispose(),this._backPlate.dispose(),this._contentPlate.dispose(),this._followButton.dispose(),this._closeButton.dispose(),this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver),this._defaultBehavior.sixDofDragBehavior.onPositionChangedObservable.remove(this._positionChangedObserver),this._defaultBehavior.detach(),this._gizmo.dispose(),this._contentDragBehavior.detach()},t.ASSETS_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.CLOSE_ICON_FILENAME="IconClose.png",t.FOLLOW_ICON_FILENAME="IconFollowMe.png",t}(re),Fe=function(e){function t(t){var i=e.call(this,t)||this;return i._backPlateMargin=1.25,i}return o(t,e),Object.defineProperty(t.prototype,"backPlateMargin",{get:function(){return this._backPlateMargin},set:function(e){var t=this;this._backPlateMargin=e,this._children.length>=1&&(this.children.forEach((function(e){t._updateCurrentMinMax(e.position)})),this._updateMargins())},enumerable:!1,configurable:!0}),t.prototype._createNode=function(e){var t=new l.Mesh("menu_"+this.name,e);return this._backPlate=Object(l.CreateBox)("backPlate"+this.name,{size:1},e),this._backPlate.parent=t,t},t.prototype._affectMaterial=function(e){var t=this;this._backPlateMaterial=new de(this.name+"backPlateMaterial",e.getScene()),this._backPlateMaterial.albedoColor=new l.Color3(.08,.15,.55),this._backPlateMaterial.renderBorders=!0,this._backPlateMaterial.renderHoverLight=!0,this._pickedPointObserver=this._host.onPickedPointChangedObservable.add((function(e){e?(t._backPlateMaterial.hoverPosition=e,t._backPlateMaterial.hoverColor.a=1):t._backPlateMaterial.hoverColor.a=0})),this._backPlate.material=this._backPlateMaterial},t.prototype._mapGridNode=function(e,t){e.mesh&&(e.position=t.clone(),this._updateCurrentMinMax(t))},t.prototype._finalProcessing=function(){this._updateMargins()},t.prototype._updateCurrentMinMax=function(e){this._currentMin||(this._currentMin=e.clone(),this._currentMax=e.clone()),this._currentMin.minimizeInPlace(e),this._currentMax.maximizeInPlace(e)},t.prototype._updateMargins=function(){if(this._children.length>0){this._currentMin.addInPlaceFromFloats(-this._cellWidth/2,-this._cellHeight/2,0),this._currentMax.addInPlaceFromFloats(this._cellWidth/2,this._cellHeight/2,0);var e=this._currentMax.subtract(this._currentMin);this._backPlate.scaling.x=e.x+this._cellWidth*this.backPlateMargin,this._backPlate.scaling.y=e.y+this._cellHeight*this.backPlateMargin,this._backPlate.scaling.z=.001;for(var t=0;t<this._children.length;t++)this._children[t].position.subtractInPlace(this._currentMin).subtractInPlace(e.scale(.5)),this._children[t].position.z-=.01}this._currentMin=null,this._currentMax=null},t.prototype.addButton=function(i){var n=this.blockLayout;return n||(this.blockLayout=!0),e.prototype.addControl.call(this,i),i.isBackplateVisible=!1,i.scaling.scaleInPlace(t.MENU_BUTTON_SCALE),n||(this.blockLayout=!1),this},t.prototype.addControl=function(e){return l.Logger.Warn("TouchHolographicMenu can only contain buttons. Please use the method `addButton` instead."),this},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver)},t.MENU_BUTTON_SCALE=1,t}(_e),Ne=function(e){function t(t,i){var n=e.call(this,i)||this;return n._handConstraintBehavior=new l.HandConstraintBehavior,n._handConstraintBehavior.linkToXRExperience(t),n.backPlateMargin=.15,n.rows=3,n}return o(t,e),Object.defineProperty(t.prototype,"handConstraintBehavior",{get:function(){return this._handConstraintBehavior},enumerable:!1,configurable:!0}),t.prototype._createNode=function(t){var i=e.prototype._createNode.call(this,t);return this._handConstraintBehavior.attach(i),i},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._handConstraintBehavior.detach()},t}(Fe),ke=function(e){function t(t,i){var n=e.call(this,i)||this;return n._currentMesh=t,n.pointerEnterAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(1.1)},n.pointerOutAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(1/1.1)},n.pointerDownAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(.95)},n.pointerUpAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(1/.95)},n}return o(t,e),t.prototype._getTypeName=function(){return"MeshButton3D"},t.prototype._createNode=function(e){var t=this;return this._currentMesh.getChildMeshes().forEach((function(e){t._injectGUI3DReservedDataStore(e).control=t})),this._currentMesh},t.prototype._affectMaterial=function(e){},t}(se),Ae=function(e){function t(t){var i=e.call(this,t)||this;return i._isPinned=!1,i._defaultBehavior=new Re,i._dragObserver=i._defaultBehavior.sixDofDragBehavior.onDragObservable.add((function(){i.isPinned=!0})),i.backPlateMargin=1,i}return o(t,e),Object.defineProperty(t.prototype,"defaultBehavior",{get:function(){return this._defaultBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPinned",{get:function(){return this._isPinned},set:function(e){this._isPinned=e,this._isPinned?(this._pinMaterial.emissiveColor.copyFromFloats(.25,.4,.95),this._defaultBehavior.followBehaviorEnabled=!1):(this._pinMaterial.emissiveColor.copyFromFloats(.08,.15,.55),this._defaultBehavior.followBehaviorEnabled=!0)},enumerable:!1,configurable:!0}),t.prototype._createPinButton=function(e){var i=this,n=new ye("pin"+this.name,!1);return n.imageUrl=t.ASSETS_BASE_URL+t.PIN_ICON_FILENAME,n.parent=this,n._host=this._host,n.onPointerClickObservable.add((function(){return i.isPinned=!i.isPinned})),this._host.utilityLayer&&(n._prepareNode(this._host.utilityLayer.utilityLayerScene),n.scaling.scaleInPlace(Fe.MENU_BUTTON_SCALE),this._pinMaterial=n.backMaterial,this._pinMaterial.diffuseColor.copyFromFloats(0,0,0),n.node&&(n.node.parent=e)),n},t.prototype._createNode=function(t){var i=e.prototype._createNode.call(this,t);return this._pinButton=this._createPinButton(i),this.isPinned=!1,this._defaultBehavior.attach(i,[this._backPlate]),this._defaultBehavior.followBehavior.ignoreCameraPitchAndRoll=!0,this._defaultBehavior.followBehavior.pitchOffset=-15,this._defaultBehavior.followBehavior.minimumDistance=.3,this._defaultBehavior.followBehavior.defaultDistance=.4,this._defaultBehavior.followBehavior.maximumDistance=.6,this._backPlate.isNearGrabbable=!0,i.isVisible=!1,i},t.prototype._finalProcessing=function(){e.prototype._finalProcessing.call(this),this._pinButton.position.copyFromFloats((this._backPlate.scaling.x+Fe.MENU_BUTTON_SCALE)/2,this._backPlate.scaling.y/2,0)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._defaultBehavior.sixDofDragBehavior.onDragObservable.remove(this._dragObserver),this._defaultBehavior.detach()},t.ASSETS_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.PIN_ICON_FILENAME="IconPin.png",t}(Fe),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype._mapGridNode=function(e,t){var i=e.mesh;if(i){e.position=t.clone();var n=l.TmpVectors.Vector3[0];switch(n.copyFrom(t),this.orientation){case le.FACEORIGIN_ORIENTATION:case le.FACEFORWARD_ORIENTATION:n.addInPlace(new l.Vector3(0,0,1)),i.lookAt(n);break;case le.FACEFORWARDREVERSED_ORIENTATION:case le.FACEORIGINREVERSED_ORIENTATION:n.addInPlace(new l.Vector3(0,0,-1)),i.lookAt(n)}}},t}(_e),Qe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._iteration=100,t}return o(t,e),Object.defineProperty(t.prototype,"iteration",{get:function(){return this._iteration},set:function(e){var t=this;this._iteration!==e&&(this._iteration=e,l.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._mapGridNode=function(e,t){var i=e.mesh,n=this._scatterMapping(t);if(i){switch(this.orientation){case le.FACEORIGIN_ORIENTATION:case le.FACEFORWARD_ORIENTATION:i.lookAt(new l.Vector3(0,0,1));break;case le.FACEFORWARDREVERSED_ORIENTATION:case le.FACEORIGINREVERSED_ORIENTATION:i.lookAt(new l.Vector3(0,0,-1))}e.position=n}},t.prototype._scatterMapping=function(e){return e.x=(1-2*Math.random())*this._cellWidth,e.y=(1-2*Math.random())*this._cellHeight,e},t.prototype._finalProcessing=function(){for(var e=[],t=0,i=this._children;t<i.length;t++){var n=i[t];n.mesh&&e.push(n.mesh)}for(var o=0;o<this._iteration;o++){e.sort((function(e,t){var i=e.position.lengthSquared(),n=t.position.lengthSquared();return i<n?1:i>n?-1:0}));for(var r=Math.pow(this.margin,2),a=Math.max(this._cellWidth,this._cellHeight),s=l.TmpVectors.Vector2[0],_=l.TmpVectors.Vector3[0],h=0;h<e.length-1;h++)for(var c=h+1;c<e.length;c++)if(h!=c){e[c].position.subtractToRef(e[h].position,_),s.x=_.x,s.y=_.y;var u=a,d=s.lengthSquared()-r;(d-=Math.min(d,r))<Math.pow(u,2)&&(s.normalize(),_.scaleInPlace(.5*(u-Math.sqrt(d))),e[c].position.addInPlace(_),e[h].position.subtractInPlace(_))}}},t}(_e),Ve="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\nuniform float _Radius_;\nuniform float _Bevel_Front_;\nuniform float _Bevel_Front_Stretch_;\nuniform float _Bevel_Back_;\nuniform float _Bevel_Back_Stretch_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform bool _Bulge_Enabled_;\nuniform float _Bulge_Height_;\nuniform float _Bulge_Radius_;\nuniform float _Sun_Intensity_;\nuniform float _Sun_Theta_;\nuniform float _Sun_Phi_;\nuniform float _Indirect_Diffuse_;\nuniform vec4 _Albedo_;\nuniform float _Specular_;\nuniform float _Shininess_;\nuniform float _Sharpness_;\nuniform float _Subsurface_;\nuniform vec4 _Left_Color_;\nuniform vec4 _Right_Color_;\nuniform float _Reflection_;\nuniform float _Front_Reflect_;\nuniform float _Edge_Reflect_;\nuniform float _Power_;\n\nuniform vec4 _Sky_Color_;\nuniform vec4 _Horizon_Color_;\nuniform vec4 _Ground_Color_;\nuniform float _Horizon_Power_;\n\nuniform sampler2D _Reflection_Map_;\nuniform sampler2D _Indirect_Environment_;\n\nuniform float _Width_;\nuniform float _Fuzz_;\nuniform float _Min_Fuzz_;\nuniform float _Clip_Fade_;\nuniform float _Hue_Shift_;\nuniform float _Saturation_Shift_;\nuniform float _Value_Shift_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Left_Index_Pos_;\nuniform vec3 _Right_Index_Pos_;\nuniform vec3 _Left_Index_Middle_Pos_;\nuniform vec3 _Right_Index_Middle_Pos_;\n\nuniform sampler2D _Decal_;\nuniform vec2 _Decal_Scale_XY_;\nuniform bool _Decal_Front_Only_;\nuniform float _Rim_Intensity_;\nuniform sampler2D _Rim_Texture_;\nuniform float _Rim_Hue_Shift_;\nuniform float _Rim_Saturation_Shift_;\nuniform float _Rim_Value_Shift_;\n\nuniform float _Iridescence_Intensity_;\nuniform sampler2D _Iridescence_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform vec4 Global_Left_Index_Middle_Position;\nuniform vec4 Global_Right_Index_Middle_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\n\nvoid Blob_Fragment_B30(\nsampler2D Blob_Texture,\nvec4 Blob_Info1,\nvec4 Blob_Info2,\nout vec4 Blob_Color)\n{\nfloat k1=dot(Blob_Info1.xy,Blob_Info1.xy);\nfloat k2=dot(Blob_Info2.xy,Blob_Info2.xy);\nvec3 closer=k1<k2 ? vec3(k1,Blob_Info1.z,Blob_Info1.w) : vec3(k2,Blob_Info2.z,Blob_Info2.w);\nBlob_Color=closer.z*texture(Blob_Texture,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\n}\n\n\nvoid FastLinearTosRGB_B42(\nvec4 Linear,\nout vec4 sRGB)\n{\nsRGB.rgb=sqrt(clamp(Linear.rgb,0.0,1.0));\nsRGB.a=Linear.a;\n}\n\n\nvoid Scale_RGB_B59(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Fragment_Main_B121(\nfloat Sun_Intensity,\nfloat Sun_Theta,\nfloat Sun_Phi,\nvec3 Normal,\nvec4 Albedo,\nfloat Fresnel_Reflect,\nfloat Shininess,\nvec3 Incident,\nvec4 Horizon_Color,\nvec4 Sky_Color,\nvec4 Ground_Color,\nfloat Indirect_Diffuse,\nfloat Specular,\nfloat Horizon_Power,\nfloat Reflection,\nvec4 Reflection_Sample,\nvec4 Indirect_Sample,\nfloat Sharpness,\nfloat SSS,\nfloat Subsurface,\nvec4 Translucence,\nvec4 Rim_Light,\nvec4 Iridescence,\nout vec4 Result)\n{\nfloat theta=Sun_Theta*2.0*3.14159;\nfloat phi=Sun_Phi*3.14159;\nvec3 lightDir=vec3(cos(phi)*cos(theta),sin(phi),cos(phi)*sin(theta));\nfloat NdotL=max(dot(lightDir,Normal),0.0);\n\nvec3 R=reflect(Incident,Normal);\nfloat RdotL=max(0.0,dot(R,lightDir));\nfloat specular=pow(RdotL,Shininess);\nspecular=mix(specular,smoothstep(0.495*Sharpness,1.0-0.495*Sharpness,specular),Sharpness);\nvec4 gi=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\n\nResult=((Sun_Intensity*NdotL+Indirect_Sample*Indirect_Diffuse+Translucence)*(1.0+SSS*Subsurface))*Albedo*(1.0-Fresnel_Reflect)+(Sun_Intensity*specular*Specular+Fresnel_Reflect*Reflection*Reflection_Sample)+Fresnel_Reflect*Rim_Light+Iridescence;\n}\n\n\nvoid Bulge_B79(\nbool Enabled,\nvec3 Normal,\nvec3 Tangent,\nfloat Bulge_Height,\nvec4 UV,\nfloat Bulge_Radius,\nvec3 ButtonN,\nout vec3 New_Normal)\n{\nvec2 xy=clamp(UV.xy*2.0,vec2(-1,-1),vec2(1,1));\nvec3 B=(cross(Normal,Tangent));\n\n\n\n\nfloat k=-clamp(1.0-length(xy)/Bulge_Radius,0.0,1.0)*Bulge_Height;\nk=sin(k*3.14159*0.5);\nk*=smoothstep(0.9998,0.9999,abs(dot(ButtonN,Normal)));\nNew_Normal=Normal*sqrt(1.0-k*k)+(xy.x*Tangent+xy.y*B)*k;\nNew_Normal=Enabled ? New_Normal : Normal;\n}\n\n\nvoid SSS_B77(\nvec3 ButtonN,\nvec3 Normal,\nvec3 Incident,\nout float Result)\n{\nfloat NdotI=abs(dot(Normal,Incident));\nfloat BdotI=abs(dot(ButtonN,Incident));\nResult=(abs(NdotI-BdotI));\n\n}\n\n\nvoid FingerOcclusion_B67(\nfloat Width,\nfloat DistToCenter,\nfloat Fuzz,\nfloat Min_Fuzz,\nvec3 Position,\nvec3 Forward,\nvec3 Nearest,\nfloat Fade_Out,\nout float NotInShadow)\n{\nfloat d=dot((Nearest-Position),Forward);\nfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\nNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\n}\n\n\nvoid FingerOcclusion_B68(\nfloat Width,\nfloat DistToCenter,\nfloat Fuzz,\nfloat Min_Fuzz,\nvec3 Position,\nvec3 Forward,\nvec3 Nearest,\nfloat Fade_Out,\nout float NotInShadow)\n{\nfloat d=dot((Nearest-Position),Forward);\nfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\nNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\n}\n\n\nvoid Scale_Color_B91(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=Scalar*Color;\n}\n\n\nvoid From_HSV_B73(\nfloat Hue,\nfloat Saturation,\nfloat Value,\nfloat Alpha,\nout vec4 Color)\n{\n\nvec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);\nvec3 p=abs(fract(vec3(Hue,Hue,Hue)+K.xyz)*6.0-K.www);\nColor.rgb=Value*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),Saturation);\nColor.a=Alpha;\n}\n\n\nvoid Fast_Fresnel_B122(\nfloat Front_Reflect,\nfloat Edge_Reflect,\nfloat Power,\nvec3 Normal,\nvec3 Incident,\nout float Transmit,\nout float Reflect)\n{\nfloat d=max(-dot(Incident,Normal),0.0);\nReflect=Front_Reflect+(Edge_Reflect-Front_Reflect)*pow(.01-d,Power);\nTransmit=1.0-Reflect;\n}\n\n\nvoid Mapped_Environment_B51(\nsampler2D Reflected_Environment,\nsampler2D Indirect_Environment,\nvec3 Dir,\nout vec4 Reflected_Color,\nout vec4 Indirect_Diffuse)\n{\n\nReflected_Color=texture(Reflected_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\nIndirect_Diffuse=texture(Indirect_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\n}\n\n\nvec4 SampleEnv_Bid50(vec3 D,vec4 S,vec4 H,vec4 G,float exponent)\n{\nfloat k=pow(abs(D.y),exponent);\nvec4 C;\nif (D.y>0.0) {\nC=mix(H,S,k);\n} else {\nC=mix(H,G,k);\n}\nreturn C;\n}\nvoid Sky_Environment_B50(\nvec3 Normal,\nvec3 Reflected,\nvec4 Sky_Color,\nvec4 Horizon_Color,\nvec4 Ground_Color,\nfloat Horizon_Power,\nout vec4 Reflected_Color,\nout vec4 Indirect_Color)\n{\n\nReflected_Color=SampleEnv_Bid50(Reflected,Sky_Color,Horizon_Color,Ground_Color,Horizon_Power);\nIndirect_Color=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\n}\n\n\nvoid Min_Segment_Distance_B65(\nvec3 P0,\nvec3 P1,\nvec3 Q0,\nvec3 Q1,\nout vec3 NearP,\nout vec3 NearQ,\nout float Distance)\n{\nvec3 u=P1-P0;\nvec3 v=Q1-Q0;\nvec3 w=P0-Q0;\nfloat a=dot(u,u);\nfloat b=dot(u,v);\nfloat c=dot(v,v);\nfloat d=dot(u,w);\nfloat e=dot(v,w);\nfloat D=a*c-b*b;\nfloat sD=D;\nfloat tD=D;\nfloat sc,sN,tc,tN;\nif (D<0.00001) {\nsN=0.0;\nsD=1.0;\ntN=e;\ntD=c;\n} else {\nsN=(b*e-c*d);\ntN=(a*e-b*d);\nif (sN<0.0) {\nsN=0.0;\ntN=e;\ntD=c;\n} else if (sN>sD) {\nsN=sD;\ntN=e+b;\ntD=c;\n}\n}\nif (tN<0.0) {\ntN=0.0;\nif (-d<0.0) {\nsN=0.0;\n} else if (-d>a) {\nsN=sD;\n} else {\nsN=-d;\nsD=a;\n}\n} else if (tN>tD) {\ntN=tD;\nif ((-d+b)<0.0) {\nsN=0.0;\n} else if ((-d+b)>a) {\nsN=sD;\n} else {\nsN=(-d+b);\nsD=a;\n}\n}\nsc=abs(sN)<0.000001 ? 0.0 : sN/sD;\ntc=abs(tN)<0.000001 ? 0.0 : tN/tD;\nNearP=P0+sc*u;\nNearQ=Q0+tc*v;\nDistance=distance(NearP,NearQ);\n}\n\n\nvoid To_XYZ_B74(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\n\nvoid Finger_Positions_B64(\nvec3 Left_Index_Pos,\nvec3 Right_Index_Pos,\nvec3 Left_Index_Middle_Pos,\nvec3 Right_Index_Middle_Pos,\nout vec3 Left_Index,\nout vec3 Right_Index,\nout vec3 Left_Index_Middle,\nout vec3 Right_Index_Middle)\n{\nLeft_Index=(Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Left_Index_Pos);\nRight_Index=(Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Right_Index_Pos);\nLeft_Index_Middle=(Use_Global_Left_Index ? Global_Left_Index_Middle_Position.xyz : Left_Index_Middle_Pos);\nRight_Index_Middle=(Use_Global_Right_Index ? Global_Right_Index_Middle_Position.xyz : Right_Index_Middle_Pos);\n}\n\n\nvoid VaryHSV_B108(\nvec3 HSV_In,\nfloat Hue_Shift,\nfloat Saturation_Shift,\nfloat Value_Shift,\nout vec3 HSV_Out)\n{\nHSV_Out=vec3(fract(HSV_In.x+Hue_Shift),clamp(HSV_In.y+Saturation_Shift,0.0,1.0),clamp(HSV_In.z+Value_Shift,0.0,1.0));\n}\n\n\nvoid Remap_Range_B114(\nfloat In_Min,\nfloat In_Max,\nfloat Out_Min,\nfloat Out_Max,\nfloat In,\nout float Out)\n{\nOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\n}\n\n\nvoid To_HSV_B75(\nvec4 Color,\nout float Hue,\nout float Saturation,\nout float Value,\nout float Alpha,\nout vec3 HSV)\n{\n\nvec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);\nvec4 p=Color.g<Color.b ? vec4(Color.bg,K.wz) : vec4(Color.gb,K.xy);\nvec4 q=Color.r<p.x ? vec4(p.xyw,Color.r) : vec4(Color.r,p.yzx);\nfloat d=q.x-min(q.w,q.y);\nfloat e=1.0e-10;\nHue=abs(q.z+(q.w-q.y)/(6.0*d+e));\nSaturation=d/(q.x+e);\nValue=q.x;\nAlpha=Color.a;\nHSV=vec3(Hue,Saturation,Value);\n}\n\n\nvoid Code_B110(\nfloat X,\nout float Result)\n{\nResult=(acos(X)/3.14159-0.5)*2.0;\n}\n\n\nvoid Rim_Light_B132(\nvec3 Front,\nvec3 Normal,\nvec3 Incident,\nfloat Rim_Intensity,\nsampler2D Texture,\nout vec4 Result)\n{\nvec3 R=reflect(Incident,Normal);\nfloat RdotF=dot(R,Front);\nfloat RdotL=sqrt(1.0-RdotF*RdotF);\nvec2 UV=vec2(R.y*0.5+0.5,0.5);\nvec4 Color=texture(Texture,UV);\nResult=Color;\n}\n\nvoid main()\n{\nvec4 Blob_Color_Q30;\n#if BLOB_ENABLE\nBlob_Fragment_B30(_Blob_Texture_,vExtra2,vExtra3,Blob_Color_Q30);\n#else\nBlob_Color_Q30=vec4(0,0,0,0);\n#endif\n\nvec3 Incident_Q39=normalize(vPosition-cameraPosition);\n\nvec3 Normalized_Q38=normalize(vNormal);\n\nvec3 Normalized_Q71=normalize(vTangent);\n\nvec4 Color_Q83;\n#if DECAL_ENABLE\nColor_Q83=texture(_Decal_,vUV);\n#else\nColor_Q83=vec4(0,0,0,0);\n#endif\n\nfloat X_Q90;\nfloat Y_Q90;\nfloat Z_Q90;\nfloat W_Q90;\nX_Q90=vExtra1.x;\nY_Q90=vExtra1.y;\nZ_Q90=vExtra1.z;\nW_Q90=vExtra1.w;\n\nvec4 Linear_Q43;\nLinear_Q43.rgb=clamp(_Sky_Color_.rgb*_Sky_Color_.rgb,0.0,1.0);\nLinear_Q43.a=_Sky_Color_.a;\n\nvec4 Linear_Q44;\nLinear_Q44.rgb=clamp(_Horizon_Color_.rgb*_Horizon_Color_.rgb,0.0,1.0);\nLinear_Q44.a=_Horizon_Color_.a;\n\nvec4 Linear_Q45;\nLinear_Q45.rgb=clamp(_Ground_Color_.rgb*_Ground_Color_.rgb,0.0,1.0);\nLinear_Q45.a=_Ground_Color_.a;\nvec3 Left_Index_Q64;\nvec3 Right_Index_Q64;\nvec3 Left_Index_Middle_Q64;\nvec3 Right_Index_Middle_Q64;\nFinger_Positions_B64(_Left_Index_Pos_,_Right_Index_Pos_,_Left_Index_Middle_Pos_,_Right_Index_Middle_Pos_,Left_Index_Q64,Right_Index_Q64,Left_Index_Middle_Q64,Right_Index_Middle_Q64);\n\nvec4 Linear_Q46;\nLinear_Q46.rgb=clamp(_Albedo_.rgb*_Albedo_.rgb,0.0,1.0);\nLinear_Q46.a=_Albedo_.a;\n\nvec3 Normalized_Q107=normalize(vBinormal);\n\nvec3 Incident_Q70=normalize(vPosition-cameraPosition);\nvec3 New_Normal_Q79;\nBulge_B79(_Bulge_Enabled_,Normalized_Q38,Normalized_Q71,_Bulge_Height_,vColor,_Bulge_Radius_,vBinormal,New_Normal_Q79);\nfloat Result_Q77;\nSSS_B77(vBinormal,New_Normal_Q79,Incident_Q39,Result_Q77);\nvec4 Result_Q91;\nScale_Color_B91(Color_Q83,X_Q90,Result_Q91);\nfloat Transmit_Q122;\nfloat Reflect_Q122;\nFast_Fresnel_B122(_Front_Reflect_,_Edge_Reflect_,_Power_,New_Normal_Q79,Incident_Q39,Transmit_Q122,Reflect_Q122);\n\nfloat Product_Q125=Y_Q90*Y_Q90;\nvec3 NearP_Q65;\nvec3 NearQ_Q65;\nfloat Distance_Q65;\nMin_Segment_Distance_B65(Left_Index_Q64,Left_Index_Middle_Q64,vPosition,cameraPosition,NearP_Q65,NearQ_Q65,Distance_Q65);\nvec3 NearP_Q63;\nvec3 NearQ_Q63;\nfloat Distance_Q63;\nMin_Segment_Distance_B65(Right_Index_Q64,Right_Index_Middle_Q64,vPosition,cameraPosition,NearP_Q63,NearQ_Q63,Distance_Q63);\n\nvec3 Reflected_Q47=reflect(Incident_Q39,New_Normal_Q79);\n\nvec4 Product_Q103=Linear_Q46*vec4(1,1,1,1);\nvec4 Result_Q132;\nRim_Light_B132(Normalized_Q107,Normalized_Q38,Incident_Q70,_Rim_Intensity_,_Rim_Texture_,Result_Q132);\n\nfloat Dot_Q72=dot(Incident_Q70,Normalized_Q71);\n\nfloat MaxAB_Q123=max(Reflect_Q122,Product_Q125);\nfloat NotInShadow_Q67;\n#if OCCLUSION_ENABLED\nFingerOcclusion_B67(_Width_,Distance_Q65,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q65,_Clip_Fade_,NotInShadow_Q67);\n#else\nNotInShadow_Q67=1.0;\n#endif\nfloat NotInShadow_Q68;\n#if OCCLUSION_ENABLED\nFingerOcclusion_B68(_Width_,Distance_Q63,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q63,_Clip_Fade_,NotInShadow_Q68);\n#else\nNotInShadow_Q68=1.0;\n#endif\nvec4 Reflected_Color_Q51;\nvec4 Indirect_Diffuse_Q51;\n#if ENV_ENABLE\nMapped_Environment_B51(_Reflection_Map_,_Indirect_Environment_,Reflected_Q47,Reflected_Color_Q51,Indirect_Diffuse_Q51);\n#else\nReflected_Color_Q51=vec4(0,0,0,1);\nIndirect_Diffuse_Q51=vec4(0,0,0,1);\n#endif\nvec4 Reflected_Color_Q50;\nvec4 Indirect_Color_Q50;\n#if SKY_ENABLED\nSky_Environment_B50(New_Normal_Q79,Reflected_Q47,Linear_Q43,Linear_Q44,Linear_Q45,_Horizon_Power_,Reflected_Color_Q50,Indirect_Color_Q50);\n#else\nReflected_Color_Q50=vec4(0,0,0,1);\nIndirect_Color_Q50=vec4(0,0,0,1);\n#endif\nfloat Hue_Q75;\nfloat Saturation_Q75;\nfloat Value_Q75;\nfloat Alpha_Q75;\nvec3 HSV_Q75;\nTo_HSV_B75(Product_Q103,Hue_Q75,Saturation_Q75,Value_Q75,Alpha_Q75,HSV_Q75);\nfloat Hue_Q127;\nfloat Saturation_Q127;\nfloat Value_Q127;\nfloat Alpha_Q127;\nvec3 HSV_Q127;\nTo_HSV_B75(Result_Q132,Hue_Q127,Saturation_Q127,Value_Q127,Alpha_Q127,HSV_Q127);\nfloat Result_Q110;\nCode_B110(Dot_Q72,Result_Q110);\n\nfloat AbsA_Q76=abs(Result_Q110);\n\nfloat MinAB_Q58=min(NotInShadow_Q67,NotInShadow_Q68);\n\nvec4 Sum_Q48=Reflected_Color_Q51+Reflected_Color_Q50;\n\nvec4 Sum_Q49=Indirect_Diffuse_Q51+Indirect_Color_Q50;\nvec3 HSV_Out_Q126;\nVaryHSV_B108(HSV_Q127,_Rim_Hue_Shift_,_Rim_Saturation_Shift_,_Rim_Value_Shift_,HSV_Out_Q126);\nfloat Out_Q114;\nRemap_Range_B114(-1.0,1.0,0.0,1.0,Result_Q110,Out_Q114);\n\nfloat Product_Q106;\nProduct_Q106=AbsA_Q76*_Hue_Shift_;\n\nfloat X_Q128;\nfloat Y_Q128;\nfloat Z_Q128;\nTo_XYZ_B74(HSV_Out_Q126,X_Q128,Y_Q128,Z_Q128);\n\nvec2 Vec2_Q112=vec2(Out_Q114,0.5);\nvec3 HSV_Out_Q108;\nVaryHSV_B108(HSV_Q75,Product_Q106,_Saturation_Shift_,_Value_Shift_,HSV_Out_Q108);\nvec4 Color_Q129;\nFrom_HSV_B73(X_Q128,Y_Q128,Z_Q128,0.0,Color_Q129);\n\nvec4 Color_Q111;\n#if IRIDESCENCE_ENABLED\nColor_Q111=texture(_Iridescence_Texture_,Vec2_Q112);\n#else\nColor_Q111=vec4(0,0,0,0);\n#endif\nfloat X_Q74;\nfloat Y_Q74;\nfloat Z_Q74;\nTo_XYZ_B74(HSV_Out_Q108,X_Q74,Y_Q74,Z_Q74);\n\nvec4 Result_Q131=_Rim_Intensity_*Color_Q129;\n\nvec4 Result_Q113=_Iridescence_Intensity_*Color_Q111;\nvec4 Color_Q73;\nFrom_HSV_B73(X_Q74,Y_Q74,Z_Q74,0.0,Color_Q73);\n\nvec4 Result_Q84=Result_Q91+(1.0-Result_Q91.a)*Color_Q73;\nvec4 Result_Q121;\nFragment_Main_B121(_Sun_Intensity_,_Sun_Theta_,_Sun_Phi_,New_Normal_Q79,Result_Q84,MaxAB_Q123,_Shininess_,Incident_Q39,_Horizon_Color_,_Sky_Color_,_Ground_Color_,_Indirect_Diffuse_,_Specular_,_Horizon_Power_,_Reflection_,Sum_Q48,Sum_Q49,_Sharpness_,Result_Q77,_Subsurface_,vec4(0,0,0,0),Result_Q131,Result_Q113,Result_Q121);\nvec4 Result_Q59;\nScale_RGB_B59(Result_Q121,MinAB_Q58,Result_Q59);\nvec4 sRGB_Q42;\nFastLinearTosRGB_B42(Result_Q59,sRGB_Q42);\n\nvec4 Result_Q31=Blob_Color_Q30+(1.0-Blob_Color_Q30.a)*sRGB_Q42;\n\nvec4 Result_Q40=Result_Q31; Result_Q40.a=1.0;\nvec4 Out_Color=Result_Q40;\nfloat Clip_Threshold=0.001;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";l.ShaderStore.ShadersStore.mrdlSliderBarPixelShader=Ve;var je="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n#ifdef TANGENT\nattribute vec3 tangent;\n#else\nconst vec3 tangent=vec3(0.);\n#endif\nuniform float _Radius_;\nuniform float _Bevel_Front_;\nuniform float _Bevel_Front_Stretch_;\nuniform float _Bevel_Back_;\nuniform float _Bevel_Back_Stretch_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform bool _Bulge_Enabled_;\nuniform float _Bulge_Height_;\nuniform float _Bulge_Radius_;\nuniform float _Sun_Intensity_;\nuniform float _Sun_Theta_;\nuniform float _Sun_Phi_;\nuniform float _Indirect_Diffuse_;\nuniform vec4 _Albedo_;\nuniform float _Specular_;\nuniform float _Shininess_;\nuniform float _Sharpness_;\nuniform float _Subsurface_;\nuniform vec4 _Left_Color_;\nuniform vec4 _Right_Color_;\nuniform float _Reflection_;\nuniform float _Front_Reflect_;\nuniform float _Edge_Reflect_;\nuniform float _Power_;\n\nuniform vec4 _Sky_Color_;\nuniform vec4 _Horizon_Color_;\nuniform vec4 _Ground_Color_;\nuniform float _Horizon_Power_;\n\nuniform sampler2D _Reflection_Map_;\nuniform sampler2D _Indirect_Environment_;\n\nuniform float _Width_;\nuniform float _Fuzz_;\nuniform float _Min_Fuzz_;\nuniform float _Clip_Fade_;\nuniform float _Hue_Shift_;\nuniform float _Saturation_Shift_;\nuniform float _Value_Shift_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Left_Index_Pos_;\nuniform vec3 _Right_Index_Pos_;\nuniform vec3 _Left_Index_Middle_Pos_;\nuniform vec3 _Right_Index_Middle_Pos_;\n\nuniform sampler2D _Decal_;\nuniform vec2 _Decal_Scale_XY_;\nuniform bool _Decal_Front_Only_;\nuniform float _Rim_Intensity_;\nuniform sampler2D _Rim_Texture_;\nuniform float _Rim_Hue_Shift_;\nuniform float _Rim_Saturation_Shift_;\nuniform float _Rim_Value_Shift_;\n\nuniform float _Iridescence_Intensity_;\nuniform sampler2D _Iridescence_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\n\nvoid Object_To_World_Pos_B12(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid Object_To_World_Normal_B32(\nvec3 Nrm_Object,\nout vec3 Nrm_World)\n{\nNrm_World=(vec4(Nrm_Object,0.0)).xyz;\n}\n\n\nvoid Blob_Vertex_B23(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=(Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Blob_Position);\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Blob_Vertex_B24(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=(Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Blob_Position);\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Move_Verts_B130(\nfloat Anisotropy,\nvec3 P,\nfloat Radius,\nfloat Bevel,\nvec3 Normal_Object,\nfloat ScaleZ,\nfloat Stretch,\nout vec3 New_P,\nout vec2 New_UV,\nout float Radial_Gradient,\nout vec3 Radial_Dir,\nout vec3 New_Normal)\n{\nvec2 UV=P.xy*2.0+0.5;\nvec2 center=clamp(UV,0.0,1.0);\nvec2 delta=UV-center;\nfloat deltad=(length(delta)*2.0);\nfloat f=(Bevel+(Radius-Bevel)*Stretch)/Radius;\n\nfloat innerd=clamp(deltad*2.0,0.0,1.0);\nfloat outerd=clamp(deltad*2.0-1.0,0.0,1.0);\nfloat bevelAngle=outerd*3.14159*0.5;\nfloat sinb=sin(bevelAngle);\nfloat cosb=cos(bevelAngle);\nfloat beveld=(1.0-f)*innerd+f*sinb;\nfloat br=outerd;\nvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\nfloat dir=P.z<0.0001 ? 1.0 : -1.0;\n\nNew_UV=center+r2*((0.5-center)+normalize(delta+vec2(0.0,0.000001))*beveld*0.5);\nNew_P=vec3(New_UV-0.5,P.z+dir*(1.0-cosb)*Bevel*ScaleZ);\nRadial_Gradient=clamp((deltad-0.5)*2.0,0.0,1.0);\nRadial_Dir=vec3(delta*r2,0.0);\nvec3 beveledNormal=cosb*Normal_Object+sinb*vec3(delta.x,delta.y,0.0);\nNew_Normal=Normal_Object.z==0.0 ? Normal_Object : beveledNormal;\n}\n\n\nvoid Object_To_World_Dir_B60(\nvec3 Dir_Object,\nout vec3 Normal_World,\nout vec3 Normal_World_N,\nout float Normal_Length)\n{\nNormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nNormal_Length=length(Normal_World);\nNormal_World_N=Normal_World/Normal_Length;\n}\n\n\nvoid To_XYZ_B78(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\n\nvoid Conditional_Float_B93(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\n\nvoid Object_To_World_Dir_B28(\nvec3 Dir_Object,\nout vec3 Binormal_World,\nout vec3 Binormal_World_N,\nout float Binormal_Length)\n{\nBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nBinormal_Length=length(Binormal_World);\nBinormal_World_N=Binormal_World/Binormal_Length;\n}\n\n\nvoid Pick_Radius_B69(\nfloat Radius,\nfloat Radius_Top_Left,\nfloat Radius_Top_Right,\nfloat Radius_Bottom_Left,\nfloat Radius_Bottom_Right,\nvec3 Position,\nout float Result)\n{\nbool whichY=Position.y>0.0;\nResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\nResult*=Radius;\n}\n\n\nvoid Conditional_Float_B36(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\n\nvoid Greater_Than_B37(\nfloat Left,\nfloat Right,\nout bool Not_Greater_Than,\nout bool Greater_Than)\n{\nGreater_Than=Left>Right;\nNot_Greater_Than=!Greater_Than;\n}\n\n\nvoid Remap_Range_B105(\nfloat In_Min,\nfloat In_Max,\nfloat Out_Min,\nfloat Out_Max,\nfloat In,\nout float Out)\n{\nOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\n}\n\nvoid main()\n{\n\nvec2 XY_Q85;\nXY_Q85=(uv-vec2(0.5,0.5))*_Decal_Scale_XY_+vec2(0.5,0.5);\n\nvec3 Tangent_World_Q27;\nvec3 Tangent_World_N_Q27;\nfloat Tangent_Length_Q27;\nTangent_World_Q27=(world*vec4(vec3(1,0,0),0.0)).xyz;\nTangent_Length_Q27=length(Tangent_World_Q27);\nTangent_World_N_Q27=Tangent_World_Q27/Tangent_Length_Q27;\nvec3 Normal_World_Q60;\nvec3 Normal_World_N_Q60;\nfloat Normal_Length_Q60;\nObject_To_World_Dir_B60(vec3(0,0,1),Normal_World_Q60,Normal_World_N_Q60,Normal_Length_Q60);\nfloat X_Q78;\nfloat Y_Q78;\nfloat Z_Q78;\nTo_XYZ_B78(position,X_Q78,Y_Q78,Z_Q78);\n\nvec3 Nrm_World_Q26;\nNrm_World_Q26=normalize((world*vec4(normal,0.0)).xyz);\nvec3 Binormal_World_Q28;\nvec3 Binormal_World_N_Q28;\nfloat Binormal_Length_Q28;\nObject_To_World_Dir_B28(vec3(0,1,0),Binormal_World_Q28,Binormal_World_N_Q28,Binormal_Length_Q28);\n\nfloat Anisotropy_Q29=Tangent_Length_Q27/Binormal_Length_Q28;\nfloat Result_Q69;\nPick_Radius_B69(_Radius_,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q69);\n\nfloat Anisotropy_Q53=Binormal_Length_Q28/Normal_Length_Q60;\nbool Not_Greater_Than_Q37;\nbool Greater_Than_Q37;\nGreater_Than_B37(Z_Q78,0.0,Not_Greater_Than_Q37,Greater_Than_Q37);\n\nvec4 Linear_Q101;\nLinear_Q101.rgb=clamp(_Left_Color_.rgb*_Left_Color_.rgb,0.0,1.0);\nLinear_Q101.a=_Left_Color_.a;\n\nvec4 Linear_Q102;\nLinear_Q102.rgb=clamp(_Right_Color_.rgb*_Right_Color_.rgb,0.0,1.0);\nLinear_Q102.a=_Right_Color_.a;\n\nvec3 Difference_Q61=vec3(0,0,0)-Normal_World_N_Q60;\n\nvec4 Out_Color_Q34=vec4(X_Q78,Y_Q78,Z_Q78,1);\nfloat Result_Q36;\nConditional_Float_B36(Greater_Than_Q37,_Bevel_Back_,_Bevel_Front_,Result_Q36);\nfloat Result_Q94;\nConditional_Float_B36(Greater_Than_Q37,_Bevel_Back_Stretch_,_Bevel_Front_Stretch_,Result_Q94);\nvec3 New_P_Q130;\nvec2 New_UV_Q130;\nfloat Radial_Gradient_Q130;\nvec3 Radial_Dir_Q130;\nvec3 New_Normal_Q130;\nMove_Verts_B130(Anisotropy_Q29,position,Result_Q69,Result_Q36,normal,Anisotropy_Q53,Result_Q94,New_P_Q130,New_UV_Q130,Radial_Gradient_Q130,Radial_Dir_Q130,New_Normal_Q130);\n\nfloat X_Q98;\nfloat Y_Q98;\nX_Q98=New_UV_Q130.x;\nY_Q98=New_UV_Q130.y;\nvec3 Pos_World_Q12;\nObject_To_World_Pos_B12(New_P_Q130,Pos_World_Q12);\nvec3 Nrm_World_Q32;\nObject_To_World_Normal_B32(New_Normal_Q130,Nrm_World_Q32);\nvec4 Blob_Info_Q23;\n#if BLOB_ENABLE\nBlob_Vertex_B23(Pos_World_Q12,Nrm_World_Q26,Tangent_World_N_Q27,Binormal_World_N_Q28,_Blob_Position_,_Blob_Intensity_,_Blob_Near_Size_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_,_Blob_Fade_,Blob_Info_Q23);\n#else\nBlob_Info_Q23=vec4(0,0,0,0);\n#endif\nvec4 Blob_Info_Q24;\n#if BLOB_ENABLE_2\nBlob_Vertex_B24(Pos_World_Q12,Nrm_World_Q26,Tangent_World_N_Q27,Binormal_World_N_Q28,_Blob_Position_2_,_Blob_Intensity_,_Blob_Near_Size_2_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_2_,_Blob_Fade_2_,Blob_Info_Q24);\n#else\nBlob_Info_Q24=vec4(0,0,0,0);\n#endif\nfloat Out_Q105;\nRemap_Range_B105(0.0,1.0,0.0,1.0,X_Q98,Out_Q105);\nfloat X_Q86;\nfloat Y_Q86;\nfloat Z_Q86;\nTo_XYZ_B78(Nrm_World_Q32,X_Q86,Y_Q86,Z_Q86);\n\nvec4 Color_At_T_Q97=mix(Linear_Q101,Linear_Q102,Out_Q105);\n\nfloat Minus_F_Q87=-Z_Q86;\n\nfloat R_Q99;\nfloat G_Q99;\nfloat B_Q99;\nfloat A_Q99;\nR_Q99=Color_At_T_Q97.r; G_Q99=Color_At_T_Q97.g; B_Q99=Color_At_T_Q97.b; A_Q99=Color_At_T_Q97.a;\n\nfloat ClampF_Q88=clamp(0.0,Minus_F_Q87,1.0);\nfloat Result_Q93;\nConditional_Float_B93(_Decal_Front_Only_,ClampF_Q88,1.0,Result_Q93);\n\nvec4 Vec4_Q89=vec4(Result_Q93,Radial_Gradient_Q130,G_Q99,B_Q99);\nvec3 Position=Pos_World_Q12;\nvec3 Normal=Nrm_World_Q32;\nvec2 UV=XY_Q85;\nvec3 Tangent=Tangent_World_N_Q27;\nvec3 Binormal=Difference_Q61;\nvec4 Color=Out_Color_Q34;\nvec4 Extra1=Vec4_Q89;\nvec4 Extra2=Blob_Info_Q23;\nvec4 Extra3=Blob_Info_Q24;\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvColor=Color;\nvExtra1=Extra1;\nvExtra2=Extra2;\nvExtra3=Extra3;\n}";l.ShaderStore.ShadersStore.mrdlSliderBarVertexShader=je;var He=function(e){function t(){var t=e.call(this)||this;return t.SKY_ENABLED=!0,t.BLOB_ENABLE_2=!0,t.IRIDESCENCE_ENABLED=!0,t._needNormals=!0,t._needUVs=!0,t.rebuild(),t}return o(t,e),t}(l.MaterialDefines),We=function(e){function t(i,n){var o=e.call(this,i,n)||this;return o.radius=.6,o.bevelFront=.6,o.bevelFrontStretch=.077,o.bevelBack=0,o.bevelBackStretch=0,o.radiusTopLeft=1,o.radiusTopRight=1,o.radiusBottomLeft=1,o.radiusBottomRight=1,o.bulgeEnabled=!1,o.bulgeHeight=-.323,o.bulgeRadius=.73,o.sunIntensity=1.102,o.sunTheta=.76,o.sunPhi=.526,o.indirectDiffuse=.658,o.albedo=new l.Color4(.0117647,.505882,.996078,1),o.specular=0,o.shininess=10,o.sharpness=0,o.subsurface=0,o.leftGradientColor=new l.Color4(.0117647,.505882,.996078,1),o.rightGradientColor=new l.Color4(.0117647,.505882,.996078,1),o.reflection=.749,o.frontReflect=0,o.edgeReflect=.09,o.power=8.13,o.skyColor=new l.Color4(.0117647,.964706,.996078,1),o.horizonColor=new l.Color4(.0117647,.333333,.996078,1),o.groundColor=new l.Color4(0,.254902,.996078,1),o.horizonPower=1,o.width=.02,o.fuzz=.5,o.minFuzz=.001,o.clipFade=.01,o.hueShift=0,o.saturationShift=0,o.valueShift=0,o.blobPosition=new l.Vector3(0,0,.1),o.blobIntensity=.5,o.blobNearSize=.01,o.blobFarSize=.03,o.blobNearDistance=0,o.blobFarDistance=.08,o.blobFadeLength=.576,o.blobPulse=0,o.blobFade=1,o.blobPosition2=new l.Vector3(.2,0,.1),o.blobNearSize2=.01,o.blobPulse2=0,o.blobFade2=1,o.blobTexture=new l.Texture("",o.getScene()),o.leftIndexPosition=new l.Vector3(0,0,1),o.rightIndexPosition=new l.Vector3(-1,-1,-1),o.leftIndexMiddlePosition=new l.Vector3(0,0,0),o.rightIndexMiddlePosition=new l.Vector3(0,0,0),o.decalScaleXY=new l.Vector2(1.5,1.5),o.decalFrontOnly=!0,o.rimIntensity=.287,o.rimHueShift=0,o.rimSaturationShift=0,o.rimValueShift=-1,o.iridescenceIntensity=0,o.useGlobalLeftIndex=1,o.useGlobalRightIndex=1,o.globalLeftIndexTipProximity=0,o.globalRightIndexTipProximity=0,o.globalLeftIndexTipPosition=new l.Vector4(.5,0,-.55,1),o.globaRightIndexTipPosition=new l.Vector4(0,0,0,1),o.globalLeftThumbTipPosition=new l.Vector4(.5,0,-.55,1),o.globalRightThumbTipPosition=new l.Vector4(0,0,0,1),o.globalLeftIndexMiddlePosition=new l.Vector4(.5,0,-.55,1),o.globalRightIndexMiddlePosition=new l.Vector4(0,0,0,1),o.alphaMode=l.Constants.ALPHA_DISABLE,o.backFaceCulling=!1,o._blueGradientTexture=new l.Texture(t.BLUE_GRADIENT_TEXTURE_URL,n,!0,!1,l.Texture.NEAREST_SAMPLINGMODE),o}return o(t,e),t.prototype.needAlphaBlending=function(){return!1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,i){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t.materialDefines||(t.materialDefines=new He);var n=t.materialDefines,o=this.getScene();if(this._isReadyForSubMesh(t))return!0;var r=o.getEngine();if(l.MaterialHelper.PrepareDefinesForAttributes(e,n,!1,!1),n.isDirty){n.markAsProcessed(),o.resetCachedMaterial();var a=new l.EffectFallbacks;n.FOG&&a.addFallback(1,"FOG"),l.MaterialHelper.HandleFallbacksForShadows(n,a),n.IMAGEPROCESSINGPOSTPROCESS=o.imageProcessingConfiguration.applyByPostProcess;var s=[l.VertexBuffer.PositionKind];n.NORMAL&&s.push(l.VertexBuffer.NormalKind),n.UV1&&s.push(l.VertexBuffer.UVKind),n.UV2&&s.push(l.VertexBuffer.UV2Kind),n.VERTEXCOLOR&&s.push(l.VertexBuffer.ColorKind),n.TANGENT&&s.push(l.VertexBuffer.TangentKind),l.MaterialHelper.PrepareAttributesForInstances(s,n);var _=n.toString(),h=["world","viewProjection","cameraPosition","_Radius_","_Bevel_Front_","_Bevel_Front_Stretch_","_Bevel_Back_","_Bevel_Back_Stretch_","_Radius_Top_Left_","_Radius_Top_Right_","_Radius_Bottom_Left_","_Radius_Bottom_Right_","_Bulge_Enabled_","_Bulge_Height_","_Bulge_Radius_","_Sun_Intensity_","_Sun_Theta_","_Sun_Phi_","_Indirect_Diffuse_","_Albedo_","_Specular_","_Shininess_","_Sharpness_","_Subsurface_","_Left_Color_","_Right_Color_","_Reflection_","_Front_Reflect_","_Edge_Reflect_","_Power_","_Sky_Color_","_Horizon_Color_","_Ground_Color_","_Horizon_Power_","_Reflection_Map_","_Indirect_Environment_","_Width_","_Fuzz_","_Min_Fuzz_","_Clip_Fade_","_Hue_Shift_","_Saturation_Shift_","_Value_Shift_","_Blob_Position_","_Blob_Intensity_","_Blob_Near_Size_","_Blob_Far_Size_","_Blob_Near_Distance_","_Blob_Far_Distance_","_Blob_Fade_Length_","_Blob_Pulse_","_Blob_Fade_","_Blob_Texture_","_Blob_Position_2_","_Blob_Near_Size_2_","_Blob_Pulse_2_","_Blob_Fade_2_","_Left_Index_Pos_","_Right_Index_Pos_","_Left_Index_Middle_Pos_","_Right_Index_Middle_Pos_","_Decal_","_Decal_Scale_XY_","_Decal_Front_Only_","_Rim_Intensity_","_Rim_Texture_","_Rim_Hue_Shift_","_Rim_Saturation_Shift_","_Rim_Value_Shift_","_Iridescence_Intensity_","_Iridescence_Texture_","Use_Global_Left_Index","Use_Global_Right_Index","Global_Left_Index_Tip_Position","Global_Right_Index_Tip_Position","Global_Left_Thumb_Tip_Position","Global_Right_Thumb_Tip_Position","Global_Left_Index_Middle_Position;","Global_Right_Index_Middle_Position","Global_Left_Index_Tip_Proximity","Global_Right_Index_Tip_Proximity"],c=["_Rim_Texture_","_Iridescence_Texture_"],u=new Array;l.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:n,maxSimultaneousLights:4}),t.setEffect(o.getEngine().createEffect("mrdlSliderBar",{attributes:s,uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:_,fallbacks:a,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},r),n,this._materialContext)}return!(!t.effect||!t.effect.isReady()||(n._renderId=o.getRenderId(),t.effect._wasPreviouslyReady=!0,0))},t.prototype.bindForSubMesh=function(e,t,i){if(i.materialDefines){var n=i.effect;n&&(this._activeEffect=n,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",this.getScene().activeCamera.position),this._activeEffect.setFloat("_Radius_",this.radius),this._activeEffect.setFloat("_Bevel_Front_",this.bevelFront),this._activeEffect.setFloat("_Bevel_Front_Stretch_",this.bevelFrontStretch),this._activeEffect.setFloat("_Bevel_Back_",this.bevelBack),this._activeEffect.setFloat("_Bevel_Back_Stretch_",this.bevelBackStretch),this._activeEffect.setFloat("_Radius_Top_Left_",this.radiusTopLeft),this._activeEffect.setFloat("_Radius_Top_Right_",this.radiusTopRight),this._activeEffect.setFloat("_Radius_Bottom_Left_",this.radiusBottomLeft),this._activeEffect.setFloat("_Radius_Bottom_Right_",this.radiusBottomRight),this._activeEffect.setFloat("_Bulge_Enabled_",this.bulgeEnabled?1:0),this._activeEffect.setFloat("_Bulge_Height_",this.bulgeHeight),this._activeEffect.setFloat("_Bulge_Radius_",this.bulgeRadius),this._activeEffect.setFloat("_Sun_Intensity_",this.sunIntensity),this._activeEffect.setFloat("_Sun_Theta_",this.sunTheta),this._activeEffect.setFloat("_Sun_Phi_",this.sunPhi),this._activeEffect.setFloat("_Indirect_Diffuse_",this.indirectDiffuse),this._activeEffect.setDirectColor4("_Albedo_",this.albedo),this._activeEffect.setFloat("_Specular_",this.specular),this._activeEffect.setFloat("_Shininess_",this.shininess),this._activeEffect.setFloat("_Sharpness_",this.sharpness),this._activeEffect.setFloat("_Subsurface_",this.subsurface),this._activeEffect.setDirectColor4("_Left_Color_",this.leftGradientColor),this._activeEffect.setDirectColor4("_Right_Color_",this.rightGradientColor),this._activeEffect.setFloat("_Reflection_",this.reflection),this._activeEffect.setFloat("_Front_Reflect_",this.frontReflect),this._activeEffect.setFloat("_Edge_Reflect_",this.edgeReflect),this._activeEffect.setFloat("_Power_",this.power),this._activeEffect.setDirectColor4("_Sky_Color_",this.skyColor),this._activeEffect.setDirectColor4("_Horizon_Color_",this.horizonColor),this._activeEffect.setDirectColor4("_Ground_Color_",this.groundColor),this._activeEffect.setFloat("_Horizon_Power_",this.horizonPower),this._activeEffect.setTexture("_Reflection_Map_",new l.Texture("",this.getScene())),this._activeEffect.setTexture("_Indirect_Environment_",new l.Texture("",this.getScene())),this._activeEffect.setFloat("_Width_",this.width),this._activeEffect.setFloat("_Fuzz_",this.fuzz),this._activeEffect.setFloat("_Min_Fuzz_",this.minFuzz),this._activeEffect.setFloat("_Clip_Fade_",this.clipFade),this._activeEffect.setFloat("_Hue_Shift_",this.hueShift),this._activeEffect.setFloat("_Saturation_Shift_",this.saturationShift),this._activeEffect.setFloat("_Value_Shift_",this.valueShift),this._activeEffect.setVector3("_Blob_Position_",this.blobPosition),this._activeEffect.setFloat("_Blob_Intensity_",this.blobIntensity),this._activeEffect.setFloat("_Blob_Near_Size_",this.blobNearSize),this._activeEffect.setFloat("_Blob_Far_Size_",this.blobFarSize),this._activeEffect.setFloat("_Blob_Near_Distance_",this.blobNearDistance),this._activeEffect.setFloat("_Blob_Far_Distance_",this.blobFarDistance),this._activeEffect.setFloat("_Blob_Fade_Length_",this.blobFadeLength),this._activeEffect.setFloat("_Blob_Pulse_",this.blobPulse),this._activeEffect.setFloat("_Blob_Fade_",this.blobFade),this._activeEffect.setTexture("_Blob_Texture_",this.blobTexture),this._activeEffect.setVector3("_Blob_Position_2_",this.blobPosition2),this._activeEffect.setFloat("_Blob_Near_Size_2_",this.blobNearSize2),this._activeEffect.setFloat("_Blob_Pulse_2_",this.blobPulse2),this._activeEffect.setFloat("_Blob_Fade_2_",this.blobFade2),this._activeEffect.setVector3("_Left_Index_Pos_",this.leftIndexPosition),this._activeEffect.setVector3("_Right_Index_Pos_",this.rightIndexPosition),this._activeEffect.setVector3("_Left_Index_Middle_Pos_",this.leftIndexMiddlePosition),this._activeEffect.setVector3("_Right_Index_Middle_Pos_",this.rightIndexMiddlePosition),this._activeEffect.setTexture("_Decal_",new l.Texture("",this.getScene())),this._activeEffect.setVector2("_Decal_Scale_XY_",this.decalScaleXY),this._activeEffect.setFloat("_Decal_Front_Only_",this.decalFrontOnly?1:0),this._activeEffect.setFloat("_Rim_Intensity_",this.rimIntensity),this._activeEffect.setTexture("_Rim_Texture_",this._blueGradientTexture),this._activeEffect.setFloat("_Rim_Hue_Shift_",this.rimHueShift),this._activeEffect.setFloat("_Rim_Saturation_Shift_",this.rimSaturationShift),this._activeEffect.setFloat("_Rim_Value_Shift_",this.rimValueShift),this._activeEffect.setFloat("_Iridescence_Intensity_",this.iridescenceIntensity),this._activeEffect.setTexture("_Iridescence_Texture_",this._blueGradientTexture),this._activeEffect.setFloat("Use_Global_Left_Index",this.useGlobalLeftIndex),this._activeEffect.setFloat("Use_Global_Right_Index",this.useGlobalRightIndex),this._activeEffect.setVector4("Global_Left_Index_Tip_Position",this.globalLeftIndexTipPosition),this._activeEffect.setVector4("Global_Right_Index_Tip_Position",this.globaRightIndexTipPosition),this._activeEffect.setVector4("Global_Left_Thumb_Tip_Position",this.globalLeftThumbTipPosition),this._activeEffect.setVector4("Global_Right_Thumb_Tip_Position",this.globalRightThumbTipPosition),this._activeEffect.setVector4("Global_Left_Index_Middle_Position",this.globalLeftIndexMiddlePosition),this._activeEffect.setVector4("Global_Right_Index_Middle_Position",this.globalRightIndexMiddlePosition),this._activeEffect.setFloat("Global_Left_Index_Tip_Proximity",this.globalLeftIndexTipProximity),this._activeEffect.setFloat("Global_Right_Index_Tip_Proximity",this.globalRightIndexTipProximity),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var i=this;return l.SerializationHelper.Clone((function(){return new t(e,i.getScene())}),this)},t.prototype.serialize=function(){var e=l.SerializationHelper.Serialize(this);return e.customType="BABYLON.MRDLSliderBarMaterial",e},t.prototype.getClassName=function(){return"MRDLSliderBarMaterial"},t.Parse=function(e,i,n){return l.SerializationHelper.Parse((function(){return new t(e.name,i)}),e,i,n)},t.BLUE_GRADIENT_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/MRDL/mrtk-mrdl-blue-gradient.png",r([Object(l.serialize)()],t.prototype,"radius",void 0),r([Object(l.serialize)()],t.prototype,"bevelFront",void 0),r([Object(l.serialize)()],t.prototype,"bevelFrontStretch",void 0),r([Object(l.serialize)()],t.prototype,"bevelBack",void 0),r([Object(l.serialize)()],t.prototype,"bevelBackStretch",void 0),r([Object(l.serialize)()],t.prototype,"radiusTopLeft",void 0),r([Object(l.serialize)()],t.prototype,"radiusTopRight",void 0),r([Object(l.serialize)()],t.prototype,"radiusBottomLeft",void 0),r([Object(l.serialize)()],t.prototype,"radiusBottomRight",void 0),r([Object(l.serialize)()],t.prototype,"bulgeEnabled",void 0),r([Object(l.serialize)()],t.prototype,"bulgeHeight",void 0),r([Object(l.serialize)()],t.prototype,"bulgeRadius",void 0),r([Object(l.serialize)()],t.prototype,"sunIntensity",void 0),r([Object(l.serialize)()],t.prototype,"sunTheta",void 0),r([Object(l.serialize)()],t.prototype,"sunPhi",void 0),r([Object(l.serialize)()],t.prototype,"indirectDiffuse",void 0),r([Object(l.serialize)()],t.prototype,"albedo",void 0),r([Object(l.serialize)()],t.prototype,"specular",void 0),r([Object(l.serialize)()],t.prototype,"shininess",void 0),r([Object(l.serialize)()],t.prototype,"sharpness",void 0),r([Object(l.serialize)()],t.prototype,"subsurface",void 0),r([Object(l.serialize)()],t.prototype,"leftGradientColor",void 0),r([Object(l.serialize)()],t.prototype,"rightGradientColor",void 0),r([Object(l.serialize)()],t.prototype,"reflection",void 0),r([Object(l.serialize)()],t.prototype,"frontReflect",void 0),r([Object(l.serialize)()],t.prototype,"edgeReflect",void 0),r([Object(l.serialize)()],t.prototype,"power",void 0),r([Object(l.serialize)()],t.prototype,"skyColor",void 0),r([Object(l.serialize)()],t.prototype,"horizonColor",void 0),r([Object(l.serialize)()],t.prototype,"groundColor",void 0),r([Object(l.serialize)()],t.prototype,"horizonPower",void 0),r([Object(l.serialize)()],t.prototype,"width",void 0),r([Object(l.serialize)()],t.prototype,"fuzz",void 0),r([Object(l.serialize)()],t.prototype,"minFuzz",void 0),r([Object(l.serialize)()],t.prototype,"clipFade",void 0),r([Object(l.serialize)()],t.prototype,"hueShift",void 0),r([Object(l.serialize)()],t.prototype,"saturationShift",void 0),r([Object(l.serialize)()],t.prototype,"valueShift",void 0),r([Object(l.serialize)()],t.prototype,"blobPosition",void 0),r([Object(l.serialize)()],t.prototype,"blobIntensity",void 0),r([Object(l.serialize)()],t.prototype,"blobNearSize",void 0),r([Object(l.serialize)()],t.prototype,"blobFarSize",void 0),r([Object(l.serialize)()],t.prototype,"blobNearDistance",void 0),r([Object(l.serialize)()],t.prototype,"blobFarDistance",void 0),r([Object(l.serialize)()],t.prototype,"blobFadeLength",void 0),r([Object(l.serialize)()],t.prototype,"blobPulse",void 0),r([Object(l.serialize)()],t.prototype,"blobFade",void 0),r([Object(l.serialize)()],t.prototype,"blobPosition2",void 0),r([Object(l.serialize)()],t.prototype,"blobNearSize2",void 0),r([Object(l.serialize)()],t.prototype,"blobPulse2",void 0),r([Object(l.serialize)()],t.prototype,"blobFade2",void 0),r([Object(l.serialize)()],t.prototype,"blobTexture",void 0),r([Object(l.serialize)()],t.prototype,"leftIndexPosition",void 0),r([Object(l.serialize)()],t.prototype,"rightIndexPosition",void 0),r([Object(l.serialize)()],t.prototype,"leftIndexMiddlePosition",void 0),r([Object(l.serialize)()],t.prototype,"rightIndexMiddlePosition",void 0),r([Object(l.serialize)()],t.prototype,"decalScaleXY",void 0),r([Object(l.serialize)()],t.prototype,"decalFrontOnly",void 0),r([Object(l.serialize)()],t.prototype,"rimIntensity",void 0),r([Object(l.serialize)()],t.prototype,"rimHueShift",void 0),r([Object(l.serialize)()],t.prototype,"rimSaturationShift",void 0),r([Object(l.serialize)()],t.prototype,"rimValueShift",void 0),r([Object(l.serialize)()],t.prototype,"iridescenceIntensity",void 0),t}(l.PushMaterial);Object(l.RegisterClass)("BABYLON.GUI.MRDLSliderBarMaterial",We);var Ge="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\nuniform float _Radius_;\nuniform float _Bevel_Front_;\nuniform float _Bevel_Front_Stretch_;\nuniform float _Bevel_Back_;\nuniform float _Bevel_Back_Stretch_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform bool _Bulge_Enabled_;\nuniform float _Bulge_Height_;\nuniform float _Bulge_Radius_;\nuniform float _Sun_Intensity_;\nuniform float _Sun_Theta_;\nuniform float _Sun_Phi_;\nuniform float _Indirect_Diffuse_;\nuniform vec4 _Albedo_;\nuniform float _Specular_;\nuniform float _Shininess_;\nuniform float _Sharpness_;\nuniform float _Subsurface_;\nuniform vec4 _Left_Color_;\nuniform vec4 _Right_Color_;\nuniform float _Reflection_;\nuniform float _Front_Reflect_;\nuniform float _Edge_Reflect_;\nuniform float _Power_;\n\nuniform vec4 _Sky_Color_;\nuniform vec4 _Horizon_Color_;\nuniform vec4 _Ground_Color_;\nuniform float _Horizon_Power_;\n\nuniform sampler2D _Reflection_Map_;\nuniform sampler2D _Indirect_Environment_;\n\nuniform float _Width_;\nuniform float _Fuzz_;\nuniform float _Min_Fuzz_;\nuniform float _Clip_Fade_;\nuniform float _Hue_Shift_;\nuniform float _Saturation_Shift_;\nuniform float _Value_Shift_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Left_Index_Pos_;\nuniform vec3 _Right_Index_Pos_;\nuniform vec3 _Left_Index_Middle_Pos_;\nuniform vec3 _Right_Index_Middle_Pos_;\n\nuniform sampler2D _Decal_;\nuniform vec2 _Decal_Scale_XY_;\nuniform bool _Decal_Front_Only_;\nuniform float _Rim_Intensity_;\nuniform sampler2D _Rim_Texture_;\nuniform float _Rim_Hue_Shift_;\nuniform float _Rim_Saturation_Shift_;\nuniform float _Rim_Value_Shift_;\n\nuniform float _Iridescence_Intensity_;\nuniform sampler2D _Iridescence_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform vec4 Global_Left_Index_Middle_Position;\nuniform vec4 Global_Right_Index_Middle_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\n\nvoid Blob_Fragment_B180(\nsampler2D Blob_Texture,\nvec4 Blob_Info1,\nvec4 Blob_Info2,\nout vec4 Blob_Color)\n{\nfloat k1=dot(Blob_Info1.xy,Blob_Info1.xy);\nfloat k2=dot(Blob_Info2.xy,Blob_Info2.xy);\nvec3 closer=k1<k2 ? vec3(k1,Blob_Info1.z,Blob_Info1.w) : vec3(k2,Blob_Info2.z,Blob_Info2.w);\nBlob_Color=closer.z*texture(Blob_Texture,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\n}\n\n\nvoid FastLinearTosRGB_B192(\nvec4 Linear,\nout vec4 sRGB)\n{\nsRGB.rgb=sqrt(clamp(Linear.rgb,0.0,1.0));\nsRGB.a=Linear.a;\n}\n\n\nvoid Scale_RGB_B209(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Fragment_Main_B271(\nfloat Sun_Intensity,\nfloat Sun_Theta,\nfloat Sun_Phi,\nvec3 Normal,\nvec4 Albedo,\nfloat Fresnel_Reflect,\nfloat Shininess,\nvec3 Incident,\nvec4 Horizon_Color,\nvec4 Sky_Color,\nvec4 Ground_Color,\nfloat Indirect_Diffuse,\nfloat Specular,\nfloat Horizon_Power,\nfloat Reflection,\nvec4 Reflection_Sample,\nvec4 Indirect_Sample,\nfloat Sharpness,\nfloat SSS,\nfloat Subsurface,\nvec4 Translucence,\nvec4 Rim_Light,\nvec4 Iridescence,\nout vec4 Result)\n{\nfloat theta=Sun_Theta*2.0*3.14159;\nfloat phi=Sun_Phi*3.14159;\nvec3 lightDir=vec3(cos(phi)*cos(theta),sin(phi),cos(phi)*sin(theta));\nfloat NdotL=max(dot(lightDir,Normal),0.0);\n\nvec3 R=reflect(Incident,Normal);\nfloat RdotL=max(0.0,dot(R,lightDir));\nfloat specular=pow(RdotL,Shininess);\nspecular=mix(specular,smoothstep(0.495*Sharpness,1.0-0.495*Sharpness,specular),Sharpness);\nvec4 gi=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\n\nResult=((Sun_Intensity*NdotL+Indirect_Sample*Indirect_Diffuse+Translucence)*(1.0+SSS*Subsurface))*Albedo*(1.0-Fresnel_Reflect)+(Sun_Intensity*specular*Specular+Fresnel_Reflect*Reflection*Reflection_Sample)+Fresnel_Reflect*Rim_Light+Iridescence;\n}\n\n\nvoid Bulge_B229(\nbool Enabled,\nvec3 Normal,\nvec3 Tangent,\nfloat Bulge_Height,\nvec4 UV,\nfloat Bulge_Radius,\nvec3 ButtonN,\nout vec3 New_Normal)\n{\nvec2 xy=clamp(UV.xy*2.0,vec2(-1,-1),vec2(1,1));\nvec3 B=(cross(Normal,Tangent));\n\n\n\n\nfloat k=-clamp(1.0-length(xy)/Bulge_Radius,0.0,1.0)*Bulge_Height;\nk=sin(k*3.14159*0.5);\nk*=smoothstep(0.9998,0.9999,abs(dot(ButtonN,Normal)));\nNew_Normal=Normal*sqrt(1.0-k*k)+(xy.x*Tangent+xy.y*B)*k;\nNew_Normal=Enabled ? New_Normal : Normal;\n}\n\n\nvoid SSS_B227(\nvec3 ButtonN,\nvec3 Normal,\nvec3 Incident,\nout float Result)\n{\nfloat NdotI=abs(dot(Normal,Incident));\nfloat BdotI=abs(dot(ButtonN,Incident));\nResult=(abs(NdotI-BdotI));\n\n}\n\n\nvoid FingerOcclusion_B217(\nfloat Width,\nfloat DistToCenter,\nfloat Fuzz,\nfloat Min_Fuzz,\nvec3 Position,\nvec3 Forward,\nvec3 Nearest,\nfloat Fade_Out,\nout float NotInShadow)\n{\nfloat d=dot((Nearest-Position),Forward);\nfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\nNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\n}\n\n\nvoid FingerOcclusion_B218(\nfloat Width,\nfloat DistToCenter,\nfloat Fuzz,\nfloat Min_Fuzz,\nvec3 Position,\nvec3 Forward,\nvec3 Nearest,\nfloat Fade_Out,\nout float NotInShadow)\n{\nfloat d=dot((Nearest-Position),Forward);\nfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\nNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\n}\n\n\nvoid Scale_Color_B241(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=Scalar*Color;\n}\n\n\nvoid From_HSV_B223(\nfloat Hue,\nfloat Saturation,\nfloat Value,\nfloat Alpha,\nout vec4 Color)\n{\n\nvec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);\nvec3 p=abs(fract(vec3(Hue,Hue,Hue)+K.xyz)*6.0-K.www);\nColor.rgb=Value*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),Saturation);\nColor.a=Alpha;\n}\n\n\nvoid Fast_Fresnel_B272(\nfloat Front_Reflect,\nfloat Edge_Reflect,\nfloat Power,\nvec3 Normal,\nvec3 Incident,\nout float Transmit,\nout float Reflect)\n{\nfloat d=max(-dot(Incident,Normal),0.0);\nReflect=Front_Reflect+(Edge_Reflect-Front_Reflect)*pow(1.0-d,Power);\nTransmit=1.0-Reflect;\n}\n\n\nvoid Mapped_Environment_B201(\nsampler2D Reflected_Environment,\nsampler2D Indirect_Environment,\nvec3 Dir,\nout vec4 Reflected_Color,\nout vec4 Indirect_Diffuse)\n{\n\nReflected_Color=texture(Reflected_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\nIndirect_Diffuse=texture(Indirect_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\n}\n\n\nvec4 SampleEnv_Bid200(vec3 D,vec4 S,vec4 H,vec4 G,float exponent)\n{\nfloat k=pow(abs(D.y),exponent);\nvec4 C;\nif (D.y>0.0) {\nC=mix(H,S,k);\n} else {\nC=mix(H,G,k);\n}\nreturn C;\n}\nvoid Sky_Environment_B200(\nvec3 Normal,\nvec3 Reflected,\nvec4 Sky_Color,\nvec4 Horizon_Color,\nvec4 Ground_Color,\nfloat Horizon_Power,\nout vec4 Reflected_Color,\nout vec4 Indirect_Color)\n{\n\nReflected_Color=SampleEnv_Bid200(Reflected,Sky_Color,Horizon_Color,Ground_Color,Horizon_Power);\nIndirect_Color=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\n}\n\n\nvoid Min_Segment_Distance_B215(\nvec3 P0,\nvec3 P1,\nvec3 Q0,\nvec3 Q1,\nout vec3 NearP,\nout vec3 NearQ,\nout float Distance)\n{\nvec3 u=P1-P0;\nvec3 v=Q1-Q0;\nvec3 w=P0-Q0;\nfloat a=dot(u,u);\nfloat b=dot(u,v);\nfloat c=dot(v,v);\nfloat d=dot(u,w);\nfloat e=dot(v,w);\nfloat D=a*c-b*b;\nfloat sD=D;\nfloat tD=D;\nfloat sc,sN,tc,tN;\nif (D<0.00001) {\nsN=0.0;\nsD=1.0;\ntN=e;\ntD=c;\n} else {\nsN=(b*e-c*d);\ntN=(a*e-b*d);\nif (sN<0.0) {\nsN=0.0;\ntN=e;\ntD=c;\n} else if (sN>sD) {\nsN=sD;\ntN=e+b;\ntD=c;\n}\n}\nif (tN<0.0) {\ntN=0.0;\nif (-d<0.0) {\nsN=0.0;\n} else if (-d>a) {\nsN=sD;\n} else {\nsN=-d;\nsD=a;\n}\n} else if (tN>tD) {\ntN=tD;\nif ((-d+b)<0.0) {\nsN=0.0;\n} else if ((-d+b)>a) {\nsN=sD;\n} else {\nsN=(-d+b);\nsD=a;\n}\n}\nsc=abs(sN)<0.000001 ? 0.0 : sN/sD;\ntc=abs(tN)<0.000001 ? 0.0 : tN/tD;\nNearP=P0+sc*u;\nNearQ=Q0+tc*v;\nDistance=distance(NearP,NearQ);\n}\n\n\nvoid To_XYZ_B224(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\n\nvoid Finger_Positions_B214(\nvec3 Left_Index_Pos,\nvec3 Right_Index_Pos,\nvec3 Left_Index_Middle_Pos,\nvec3 Right_Index_Middle_Pos,\nout vec3 Left_Index,\nout vec3 Right_Index,\nout vec3 Left_Index_Middle,\nout vec3 Right_Index_Middle)\n{\nLeft_Index=(Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Left_Index_Pos);\nRight_Index=(Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Right_Index_Pos);\nLeft_Index_Middle=(Use_Global_Left_Index ? Global_Left_Index_Middle_Position.xyz : Left_Index_Middle_Pos);\nRight_Index_Middle=(Use_Global_Right_Index ? Global_Right_Index_Middle_Position.xyz : Right_Index_Middle_Pos);\n}\n\n\nvoid VaryHSV_B258(\nvec3 HSV_In,\nfloat Hue_Shift,\nfloat Saturation_Shift,\nfloat Value_Shift,\nout vec3 HSV_Out)\n{\nHSV_Out=vec3(fract(HSV_In.x+Hue_Shift),clamp(HSV_In.y+Saturation_Shift,0.0,1.0),clamp(HSV_In.z+Value_Shift,0.0,1.0));\n}\n\n\nvoid Remap_Range_B264(\nfloat In_Min,\nfloat In_Max,\nfloat Out_Min,\nfloat Out_Max,\nfloat In,\nout float Out)\n{\nOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\n}\n\n\nvoid To_HSV_B225(\nvec4 Color,\nout float Hue,\nout float Saturation,\nout float Value,\nout float Alpha,\nout vec3 HSV)\n{\n\nvec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);\nvec4 p=Color.g<Color.b ? vec4(Color.bg,K.wz) : vec4(Color.gb,K.xy);\nvec4 q=Color.r<p.x ? vec4(p.xyw,Color.r) : vec4(Color.r,p.yzx);\nfloat d=q.x-min(q.w,q.y);\nfloat e=1.0e-10;\nHue=abs(q.z+(q.w-q.y)/(6.0*d+e));\nSaturation=d/(q.x+e);\nValue=q.x;\nAlpha=Color.a;\nHSV=vec3(Hue,Saturation,Value);\n}\n\n\nvoid Code_B260(\nfloat X,\nout float Result)\n{\nResult=(acos(X)/3.14159-0.5)*2.0;\n}\n\n\nvoid Rim_Light_B282(\nvec3 Front,\nvec3 Normal,\nvec3 Incident,\nfloat Rim_Intensity,\nsampler2D Texture,\nout vec4 Result)\n{\nvec3 R=reflect(Incident,Normal);\nfloat RdotF=dot(R,Front);\nfloat RdotL=sqrt(1.0-RdotF*RdotF);\nvec2 UV=vec2(R.y*0.5+0.5,0.5);\nvec4 Color=texture(Texture,UV);\nResult=Color;\n}\n\nvoid main()\n{\nvec4 Blob_Color_Q180;\n#if BLOB_ENABLE\nBlob_Fragment_B180(_Blob_Texture_,vExtra2,vExtra3,Blob_Color_Q180);\n#else\nBlob_Color_Q180=vec4(0,0,0,0);\n#endif\n\nvec3 Incident_Q189=normalize(vPosition-cameraPosition);\n\nvec3 Normalized_Q188=normalize(vNormal);\n\nvec3 Normalized_Q221=normalize(vTangent);\n\nvec4 Color_Q233;\n#if DECAL_ENABLE\nColor_Q233=texture(_Decal_,vUV);\n#else\nColor_Q233=vec4(0,0,0,0);\n#endif\n\nfloat X_Q240;\nfloat Y_Q240;\nfloat Z_Q240;\nfloat W_Q240;\nX_Q240=vExtra1.x;\nY_Q240=vExtra1.y;\nZ_Q240=vExtra1.z;\nW_Q240=vExtra1.w;\n\nvec4 Linear_Q193;\nLinear_Q193.rgb=clamp(_Sky_Color_.rgb*_Sky_Color_.rgb,0.0,1.0);\nLinear_Q193.a=_Sky_Color_.a;\n\nvec4 Linear_Q194;\nLinear_Q194.rgb=clamp(_Horizon_Color_.rgb*_Horizon_Color_.rgb,0.0,1.0);\nLinear_Q194.a=_Horizon_Color_.a;\n\nvec4 Linear_Q195;\nLinear_Q195.rgb=clamp(_Ground_Color_.rgb*_Ground_Color_.rgb,0.0,1.0);\nLinear_Q195.a=_Ground_Color_.a;\nvec3 Left_Index_Q214;\nvec3 Right_Index_Q214;\nvec3 Left_Index_Middle_Q214;\nvec3 Right_Index_Middle_Q214;\nFinger_Positions_B214(_Left_Index_Pos_,_Right_Index_Pos_,_Left_Index_Middle_Pos_,_Right_Index_Middle_Pos_,Left_Index_Q214,Right_Index_Q214,Left_Index_Middle_Q214,Right_Index_Middle_Q214);\n\nvec4 Linear_Q196;\nLinear_Q196.rgb=clamp(_Albedo_.rgb*_Albedo_.rgb,0.0,1.0);\nLinear_Q196.a=_Albedo_.a;\n\nvec3 Normalized_Q257=normalize(vBinormal);\n\nvec3 Incident_Q220=normalize(vPosition-cameraPosition);\nvec3 New_Normal_Q229;\nBulge_B229(_Bulge_Enabled_,Normalized_Q188,Normalized_Q221,_Bulge_Height_,vColor,_Bulge_Radius_,vBinormal,New_Normal_Q229);\nfloat Result_Q227;\nSSS_B227(vBinormal,New_Normal_Q229,Incident_Q189,Result_Q227);\nvec4 Result_Q241;\nScale_Color_B241(Color_Q233,X_Q240,Result_Q241);\nfloat Transmit_Q272;\nfloat Reflect_Q272;\nFast_Fresnel_B272(_Front_Reflect_,_Edge_Reflect_,_Power_,New_Normal_Q229,Incident_Q189,Transmit_Q272,Reflect_Q272);\n\nfloat Product_Q275=Y_Q240*Y_Q240;\nvec3 NearP_Q215;\nvec3 NearQ_Q215;\nfloat Distance_Q215;\nMin_Segment_Distance_B215(Left_Index_Q214,Left_Index_Middle_Q214,vPosition,cameraPosition,NearP_Q215,NearQ_Q215,Distance_Q215);\nvec3 NearP_Q213;\nvec3 NearQ_Q213;\nfloat Distance_Q213;\nMin_Segment_Distance_B215(Right_Index_Q214,Right_Index_Middle_Q214,vPosition,cameraPosition,NearP_Q213,NearQ_Q213,Distance_Q213);\n\nvec3 Reflected_Q197=reflect(Incident_Q189,New_Normal_Q229);\n\nvec4 Product_Q253=Linear_Q196*vec4(1,1,1,1);\nvec4 Result_Q282;\nRim_Light_B282(Normalized_Q257,Normalized_Q188,Incident_Q220,_Rim_Intensity_,_Rim_Texture_,Result_Q282);\n\nfloat Dot_Q222=dot(Incident_Q220,Normalized_Q221);\n\nfloat MaxAB_Q273=max(Reflect_Q272,Product_Q275);\nfloat NotInShadow_Q217;\n#if OCCLUSION_ENABLED\nFingerOcclusion_B217(_Width_,Distance_Q215,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q215,_Clip_Fade_,NotInShadow_Q217);\n#else\nNotInShadow_Q217=1.0;\n#endif\nfloat NotInShadow_Q218;\n#if OCCLUSION_ENABLED\nFingerOcclusion_B218(_Width_,Distance_Q213,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q213,_Clip_Fade_,NotInShadow_Q218);\n#else\nNotInShadow_Q218=1.0;\n#endif\nvec4 Reflected_Color_Q201;\nvec4 Indirect_Diffuse_Q201;\n#if ENV_ENABLE\nMapped_Environment_B201(_Reflection_Map_,_Indirect_Environment_,Reflected_Q197,Reflected_Color_Q201,Indirect_Diffuse_Q201);\n#else\nReflected_Color_Q201=vec4(0,0,0,1);\nIndirect_Diffuse_Q201=vec4(0,0,0,1);\n#endif\nvec4 Reflected_Color_Q200;\nvec4 Indirect_Color_Q200;\n#if SKY_ENABLED\nSky_Environment_B200(New_Normal_Q229,Reflected_Q197,Linear_Q193,Linear_Q194,Linear_Q195,_Horizon_Power_,Reflected_Color_Q200,Indirect_Color_Q200);\n#else\nReflected_Color_Q200=vec4(0,0,0,1);\nIndirect_Color_Q200=vec4(0,0,0,1);\n#endif\nfloat Hue_Q225;\nfloat Saturation_Q225;\nfloat Value_Q225;\nfloat Alpha_Q225;\nvec3 HSV_Q225;\nTo_HSV_B225(Product_Q253,Hue_Q225,Saturation_Q225,Value_Q225,Alpha_Q225,HSV_Q225);\nfloat Hue_Q277;\nfloat Saturation_Q277;\nfloat Value_Q277;\nfloat Alpha_Q277;\nvec3 HSV_Q277;\nTo_HSV_B225(Result_Q282,Hue_Q277,Saturation_Q277,Value_Q277,Alpha_Q277,HSV_Q277);\nfloat Result_Q260;\nCode_B260(Dot_Q222,Result_Q260);\n\nfloat AbsA_Q226=abs(Result_Q260);\n\nfloat MinAB_Q208=min(NotInShadow_Q217,NotInShadow_Q218);\n\nvec4 Sum_Q198=Reflected_Color_Q201+Reflected_Color_Q200;\n\nvec4 Sum_Q199=Indirect_Diffuse_Q201+Indirect_Color_Q200;\nvec3 HSV_Out_Q276;\nVaryHSV_B258(HSV_Q277,_Rim_Hue_Shift_,_Rim_Saturation_Shift_,_Rim_Value_Shift_,HSV_Out_Q276);\nfloat Out_Q264;\nRemap_Range_B264(-1.0,1.0,0.0,1.0,Result_Q260,Out_Q264);\n\nfloat Product_Q256;\nProduct_Q256=AbsA_Q226*_Hue_Shift_;\n\nfloat X_Q278;\nfloat Y_Q278;\nfloat Z_Q278;\nTo_XYZ_B224(HSV_Out_Q276,X_Q278,Y_Q278,Z_Q278);\n\nvec2 Vec2_Q262=vec2(Out_Q264,0.5);\nvec3 HSV_Out_Q258;\nVaryHSV_B258(HSV_Q225,Product_Q256,_Saturation_Shift_,_Value_Shift_,HSV_Out_Q258);\nvec4 Color_Q279;\nFrom_HSV_B223(X_Q278,Y_Q278,Z_Q278,0.0,Color_Q279);\n\nvec4 Color_Q261;\n#if IRIDESCENCE_ENABLED\nColor_Q261=texture(_Iridescence_Texture_,Vec2_Q262);\n#else\nColor_Q261=vec4(0,0,0,0);\n#endif\nfloat X_Q224;\nfloat Y_Q224;\nfloat Z_Q224;\nTo_XYZ_B224(HSV_Out_Q258,X_Q224,Y_Q224,Z_Q224);\n\nvec4 Result_Q281=_Rim_Intensity_*Color_Q279;\n\nvec4 Result_Q263=_Iridescence_Intensity_*Color_Q261;\nvec4 Color_Q223;\nFrom_HSV_B223(X_Q224,Y_Q224,Z_Q224,0.0,Color_Q223);\n\nvec4 Result_Q234=Result_Q241+(1.0-Result_Q241.a)*Color_Q223;\nvec4 Result_Q271;\nFragment_Main_B271(_Sun_Intensity_,_Sun_Theta_,_Sun_Phi_,New_Normal_Q229,Result_Q234,MaxAB_Q273,_Shininess_,Incident_Q189,_Horizon_Color_,_Sky_Color_,_Ground_Color_,_Indirect_Diffuse_,_Specular_,_Horizon_Power_,_Reflection_,Sum_Q198,Sum_Q199,_Sharpness_,Result_Q227,_Subsurface_,vec4(0,0,0,0),Result_Q281,Result_Q263,Result_Q271);\nvec4 Result_Q209;\nScale_RGB_B209(Result_Q271,MinAB_Q208,Result_Q209);\nvec4 sRGB_Q192;\nFastLinearTosRGB_B192(Result_Q209,sRGB_Q192);\n\nvec4 Result_Q181=Blob_Color_Q180+(1.0-Blob_Color_Q180.a)*sRGB_Q192;\n\nvec4 Result_Q190=Result_Q181; Result_Q190.a=1.0;\nvec4 Out_Color=Result_Q190;\nfloat Clip_Threshold=0.001;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";l.ShaderStore.ShadersStore.mrdlSliderThumbPixelShader=Ge;var Ue="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n#ifdef TANGENT\nattribute vec3 tangent;\n#else\nconst vec3 tangent=vec3(0.);\n#endif\nuniform float _Radius_;\nuniform float _Bevel_Front_;\nuniform float _Bevel_Front_Stretch_;\nuniform float _Bevel_Back_;\nuniform float _Bevel_Back_Stretch_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform bool _Bulge_Enabled_;\nuniform float _Bulge_Height_;\nuniform float _Bulge_Radius_;\nuniform float _Sun_Intensity_;\nuniform float _Sun_Theta_;\nuniform float _Sun_Phi_;\nuniform float _Indirect_Diffuse_;\nuniform vec4 _Albedo_;\nuniform float _Specular_;\nuniform float _Shininess_;\nuniform float _Sharpness_;\nuniform float _Subsurface_;\nuniform vec4 _Left_Color_;\nuniform vec4 _Right_Color_;\nuniform float _Reflection_;\nuniform float _Front_Reflect_;\nuniform float _Edge_Reflect_;\nuniform float _Power_;\n\nuniform vec4 _Sky_Color_;\nuniform vec4 _Horizon_Color_;\nuniform vec4 _Ground_Color_;\nuniform float _Horizon_Power_;\n\nuniform sampler2D _Reflection_Map_;\nuniform sampler2D _Indirect_Environment_;\n\nuniform float _Width_;\nuniform float _Fuzz_;\nuniform float _Min_Fuzz_;\nuniform float _Clip_Fade_;\nuniform float _Hue_Shift_;\nuniform float _Saturation_Shift_;\nuniform float _Value_Shift_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Left_Index_Pos_;\nuniform vec3 _Right_Index_Pos_;\nuniform vec3 _Left_Index_Middle_Pos_;\nuniform vec3 _Right_Index_Middle_Pos_;\n\nuniform sampler2D _Decal_;\nuniform vec2 _Decal_Scale_XY_;\nuniform bool _Decal_Front_Only_;\nuniform float _Rim_Intensity_;\nuniform sampler2D _Rim_Texture_;\nuniform float _Rim_Hue_Shift_;\nuniform float _Rim_Saturation_Shift_;\nuniform float _Rim_Value_Shift_;\n\nuniform float _Iridescence_Intensity_;\nuniform sampler2D _Iridescence_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\n\nvoid Object_To_World_Pos_B162(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid Object_To_World_Normal_B182(\nvec3 Nrm_Object,\nout vec3 Nrm_World)\n{\nNrm_World=(vec4(Nrm_Object,0.0)).xyz;\n}\n\n\nvoid Blob_Vertex_B173(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=(Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Blob_Position);\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Blob_Vertex_B174(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=(Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Blob_Position);\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Move_Verts_B280(\nfloat Anisotropy,\nvec3 P,\nfloat Radius,\nfloat Bevel,\nvec3 Normal_Object,\nfloat ScaleZ,\nfloat Stretch,\nout vec3 New_P,\nout vec2 New_UV,\nout float Radial_Gradient,\nout vec3 Radial_Dir,\nout vec3 New_Normal)\n{\nvec2 UV=P.xy*2.0+0.5;\nvec2 center=clamp(UV,0.0,1.0);\nvec2 delta=UV-center;\nfloat deltad=(length(delta)*2.0);\nfloat f=(Bevel+(Radius-Bevel)*Stretch)/Radius;\n\nfloat innerd=clamp(deltad*2.0,0.0,1.0);\nfloat outerd=clamp(deltad*2.0-1.0,0.0,1.0);\nfloat bevelAngle=outerd*3.14159*0.5;\nfloat sinb=sin(bevelAngle);\nfloat cosb=cos(bevelAngle);\nfloat beveld=(1.0-f)*innerd+f*sinb;\nfloat br=outerd;\nvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\nfloat dir=P.z<0.0001 ? 1.0 : -1.0;\n\nNew_UV=center+r2*((0.5-center)+normalize(delta+vec2(0.0,0.000001))*beveld*0.5);\nNew_P=vec3(New_UV-0.5,P.z+dir*(1.0-cosb)*Bevel*ScaleZ);\nRadial_Gradient=clamp((deltad-0.5)*2.0,0.0,1.0);\nRadial_Dir=vec3(delta*r2,0.0);\nvec3 beveledNormal=cosb*Normal_Object+sinb*vec3(delta.x,delta.y,0.0);\nNew_Normal=Normal_Object.z==0.0 ? Normal_Object : beveledNormal;\n}\n\n\nvoid Object_To_World_Dir_B210(\nvec3 Dir_Object,\nout vec3 Normal_World,\nout vec3 Normal_World_N,\nout float Normal_Length)\n{\nNormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nNormal_Length=length(Normal_World);\nNormal_World_N=Normal_World/Normal_Length;\n}\n\n\nvoid To_XYZ_B228(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\n\nvoid Conditional_Float_B243(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\n\nvoid Object_To_World_Dir_B178(\nvec3 Dir_Object,\nout vec3 Binormal_World,\nout vec3 Binormal_World_N,\nout float Binormal_Length)\n{\nBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nBinormal_Length=length(Binormal_World);\nBinormal_World_N=Binormal_World/Binormal_Length;\n}\n\n\nvoid Pick_Radius_B219(\nfloat Radius,\nfloat Radius_Top_Left,\nfloat Radius_Top_Right,\nfloat Radius_Bottom_Left,\nfloat Radius_Bottom_Right,\nvec3 Position,\nout float Result)\n{\nbool whichY=Position.y>0.0;\nResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\nResult*=Radius;\n}\n\n\nvoid Conditional_Float_B186(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\n\nvoid Greater_Than_B187(\nfloat Left,\nfloat Right,\nout bool Not_Greater_Than,\nout bool Greater_Than)\n{\nGreater_Than=Left>Right;\nNot_Greater_Than=!Greater_Than;\n}\n\n\nvoid Remap_Range_B255(\nfloat In_Min,\nfloat In_Max,\nfloat Out_Min,\nfloat Out_Max,\nfloat In,\nout float Out)\n{\nOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\n}\n\nvoid main()\n{\n\nvec2 XY_Q235;\nXY_Q235=(uv-vec2(0.5,0.5))*_Decal_Scale_XY_+vec2(0.5,0.5);\n\nvec3 Tangent_World_Q177;\nvec3 Tangent_World_N_Q177;\nfloat Tangent_Length_Q177;\nTangent_World_Q177=(world*vec4(vec3(1,0,0),0.0)).xyz;\nTangent_Length_Q177=length(Tangent_World_Q177);\nTangent_World_N_Q177=Tangent_World_Q177/Tangent_Length_Q177;\nvec3 Normal_World_Q210;\nvec3 Normal_World_N_Q210;\nfloat Normal_Length_Q210;\nObject_To_World_Dir_B210(vec3(0,0,1),Normal_World_Q210,Normal_World_N_Q210,Normal_Length_Q210);\nfloat X_Q228;\nfloat Y_Q228;\nfloat Z_Q228;\nTo_XYZ_B228(position,X_Q228,Y_Q228,Z_Q228);\n\nvec3 Nrm_World_Q176;\nNrm_World_Q176=normalize((world*vec4(normal,0.0)).xyz);\nvec3 Binormal_World_Q178;\nvec3 Binormal_World_N_Q178;\nfloat Binormal_Length_Q178;\nObject_To_World_Dir_B178(vec3(0,1,0),Binormal_World_Q178,Binormal_World_N_Q178,Binormal_Length_Q178);\n\nfloat Anisotropy_Q179=Tangent_Length_Q177/Binormal_Length_Q178;\nfloat Result_Q219;\nPick_Radius_B219(_Radius_,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q219);\n\nfloat Anisotropy_Q203=Binormal_Length_Q178/Normal_Length_Q210;\nbool Not_Greater_Than_Q187;\nbool Greater_Than_Q187;\nGreater_Than_B187(Z_Q228,0.0,Not_Greater_Than_Q187,Greater_Than_Q187);\n\nvec4 Linear_Q251;\nLinear_Q251.rgb=clamp(_Left_Color_.rgb*_Left_Color_.rgb,0.0,1.0);\nLinear_Q251.a=_Left_Color_.a;\n\nvec4 Linear_Q252;\nLinear_Q252.rgb=clamp(_Right_Color_.rgb*_Right_Color_.rgb,0.0,1.0);\nLinear_Q252.a=_Right_Color_.a;\n\nvec3 Difference_Q211=vec3(0,0,0)-Normal_World_N_Q210;\n\nvec4 Out_Color_Q184=vec4(X_Q228,Y_Q228,Z_Q228,1);\nfloat Result_Q186;\nConditional_Float_B186(Greater_Than_Q187,_Bevel_Back_,_Bevel_Front_,Result_Q186);\nfloat Result_Q244;\nConditional_Float_B186(Greater_Than_Q187,_Bevel_Back_Stretch_,_Bevel_Front_Stretch_,Result_Q244);\nvec3 New_P_Q280;\nvec2 New_UV_Q280;\nfloat Radial_Gradient_Q280;\nvec3 Radial_Dir_Q280;\nvec3 New_Normal_Q280;\nMove_Verts_B280(Anisotropy_Q179,position,Result_Q219,Result_Q186,normal,Anisotropy_Q203,Result_Q244,New_P_Q280,New_UV_Q280,Radial_Gradient_Q280,Radial_Dir_Q280,New_Normal_Q280);\n\nfloat X_Q248;\nfloat Y_Q248;\nX_Q248=New_UV_Q280.x;\nY_Q248=New_UV_Q280.y;\nvec3 Pos_World_Q162;\nObject_To_World_Pos_B162(New_P_Q280,Pos_World_Q162);\nvec3 Nrm_World_Q182;\nObject_To_World_Normal_B182(New_Normal_Q280,Nrm_World_Q182);\nvec4 Blob_Info_Q173;\n#if BLOB_ENABLE\nBlob_Vertex_B173(Pos_World_Q162,Nrm_World_Q176,Tangent_World_N_Q177,Binormal_World_N_Q178,_Blob_Position_,_Blob_Intensity_,_Blob_Near_Size_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_,_Blob_Fade_,Blob_Info_Q173);\n#else\nBlob_Info_Q173=vec4(0,0,0,0);\n#endif\nvec4 Blob_Info_Q174;\n#if BLOB_ENABLE_2\nBlob_Vertex_B174(Pos_World_Q162,Nrm_World_Q176,Tangent_World_N_Q177,Binormal_World_N_Q178,_Blob_Position_2_,_Blob_Intensity_,_Blob_Near_Size_2_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_2_,_Blob_Fade_2_,Blob_Info_Q174);\n#else\nBlob_Info_Q174=vec4(0,0,0,0);\n#endif\nfloat Out_Q255;\nRemap_Range_B255(0.0,1.0,0.0,1.0,X_Q248,Out_Q255);\nfloat X_Q236;\nfloat Y_Q236;\nfloat Z_Q236;\nTo_XYZ_B228(Nrm_World_Q182,X_Q236,Y_Q236,Z_Q236);\n\nvec4 Color_At_T_Q247=mix(Linear_Q251,Linear_Q252,Out_Q255);\n\nfloat Minus_F_Q237=-Z_Q236;\n\nfloat R_Q249;\nfloat G_Q249;\nfloat B_Q249;\nfloat A_Q249;\nR_Q249=Color_At_T_Q247.r; G_Q249=Color_At_T_Q247.g; B_Q249=Color_At_T_Q247.b; A_Q249=Color_At_T_Q247.a;\n\nfloat ClampF_Q238=clamp(0.0,Minus_F_Q237,1.0);\nfloat Result_Q243;\nConditional_Float_B243(_Decal_Front_Only_,ClampF_Q238,1.0,Result_Q243);\n\nvec4 Vec4_Q239=vec4(Result_Q243,Radial_Gradient_Q280,G_Q249,B_Q249);\nvec3 Position=Pos_World_Q162;\nvec3 Normal=Nrm_World_Q182;\nvec2 UV=XY_Q235;\nvec3 Tangent=Tangent_World_N_Q177;\nvec3 Binormal=Difference_Q211;\nvec4 Color=Out_Color_Q184;\nvec4 Extra1=Vec4_Q239;\nvec4 Extra2=Blob_Info_Q173;\nvec4 Extra3=Blob_Info_Q174;\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvColor=Color;\nvExtra1=Extra1;\nvExtra2=Extra2;\nvExtra3=Extra3;\n}";l.ShaderStore.ShadersStore.mrdlSliderThumbVertexShader=Ue;var Ye=function(e){function t(){var t=e.call(this)||this;return t.SKY_ENABLED=!0,t.BLOB_ENABLE_2=!0,t.IRIDESCENCE_ENABLED=!0,t._needNormals=!0,t._needUVs=!0,t.rebuild(),t}return o(t,e),t}(l.MaterialDefines),Xe=function(e){function t(i,n){var o=e.call(this,i,n)||this;return o.radius=.157,o.bevelFront=.065,o.bevelFrontStretch=.077,o.bevelBack=.031,o.bevelBackStretch=0,o.radiusTopLeft=1,o.radiusTopRight=1,o.radiusBottomLeft=1,o.radiusBottomRight=1,o.bulgeEnabled=!1,o.bulgeHeight=-.323,o.bulgeRadius=.73,o.sunIntensity=2,o.sunTheta=.937,o.sunPhi=.555,o.indirectDiffuse=1,o.albedo=new l.Color4(.0117647,.505882,.996078,1),o.specular=0,o.shininess=10,o.sharpness=0,o.subsurface=.31,o.leftGradientColor=new l.Color4(.0117647,.505882,.996078,1),o.rightGradientColor=new l.Color4(.0117647,.505882,.996078,1),o.reflection=.749,o.frontReflect=0,o.edgeReflect=.09,o.power=8.1,o.skyColor=new l.Color4(.0117647,.960784,.996078,1),o.horizonColor=new l.Color4(.0117647,.333333,.996078,1),o.groundColor=new l.Color4(0,.254902,.996078,1),o.horizonPower=1,o.width=.02,o.fuzz=.5,o.minFuzz=.001,o.clipFade=.01,o.hueShift=0,o.saturationShift=0,o.valueShift=0,o.blobPosition=new l.Vector3(0,0,.1),o.blobIntensity=.5,o.blobNearSize=.01,o.blobFarSize=.03,o.blobNearDistance=0,o.blobFarDistance=.08,o.blobFadeLength=.576,o.blobPulse=0,o.blobFade=1,o.blobPosition2=new l.Vector3(.2,0,.1),o.blobNearSize2=.01,o.blobPulse2=0,o.blobFade2=1,o.blobTexture=new l.Texture("",o.getScene()),o.leftIndexPosition=new l.Vector3(0,0,1),o.rightIndexPosition=new l.Vector3(-1,-1,-1),o.leftIndexMiddlePosition=new l.Vector3(0,0,0),o.rightIndexMiddlePosition=new l.Vector3(0,0,0),o.decalScaleXY=new l.Vector2(1.5,1.5),o.decalFrontOnly=!0,o.rimIntensity=.287,o.rimHueShift=0,o.rimSaturationShift=0,o.rimValueShift=-1,o.iridescenceIntensity=0,o.useGlobalLeftIndex=1,o.useGlobalRightIndex=1,o.globalLeftIndexTipProximity=0,o.globalRightIndexTipProximity=0,o.globalLeftIndexTipPosition=new l.Vector4(.5,0,-.55,1),o.globaRightIndexTipPosition=new l.Vector4(0,0,0,1),o.globalLeftThumbTipPosition=new l.Vector4(.5,0,-.55,1),o.globalRightThumbTipPosition=new l.Vector4(0,0,0,1),o.globalLeftIndexMiddlePosition=new l.Vector4(.5,0,-.55,1),o.globalRightIndexMiddlePosition=new l.Vector4(0,0,0,1),o.alphaMode=l.Constants.ALPHA_DISABLE,o.backFaceCulling=!1,o._blueGradientTexture=new l.Texture(t.BLUE_GRADIENT_TEXTURE_URL,n,!0,!1,l.Texture.NEAREST_SAMPLINGMODE),o}return o(t,e),t.prototype.needAlphaBlending=function(){return!1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,i){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t.materialDefines||(t.materialDefines=new Ye);var n=t.materialDefines,o=this.getScene();if(this._isReadyForSubMesh(t))return!0;var r=o.getEngine();if(l.MaterialHelper.PrepareDefinesForAttributes(e,n,!1,!1),n.isDirty){n.markAsProcessed(),o.resetCachedMaterial();var a=new l.EffectFallbacks;n.FOG&&a.addFallback(1,"FOG"),l.MaterialHelper.HandleFallbacksForShadows(n,a),n.IMAGEPROCESSINGPOSTPROCESS=o.imageProcessingConfiguration.applyByPostProcess;var s=[l.VertexBuffer.PositionKind];n.NORMAL&&s.push(l.VertexBuffer.NormalKind),n.UV1&&s.push(l.VertexBuffer.UVKind),n.UV2&&s.push(l.VertexBuffer.UV2Kind),n.VERTEXCOLOR&&s.push(l.VertexBuffer.ColorKind),n.TANGENT&&s.push(l.VertexBuffer.TangentKind),l.MaterialHelper.PrepareAttributesForInstances(s,n);var _=n.toString(),h=["world","viewProjection","cameraPosition","_Radius_","_Bevel_Front_","_Bevel_Front_Stretch_","_Bevel_Back_","_Bevel_Back_Stretch_","_Radius_Top_Left_","_Radius_Top_Right_","_Radius_Bottom_Left_","_Radius_Bottom_Right_","_Bulge_Enabled_","_Bulge_Height_","_Bulge_Radius_","_Sun_Intensity_","_Sun_Theta_","_Sun_Phi_","_Indirect_Diffuse_","_Albedo_","_Specular_","_Shininess_","_Sharpness_","_Subsurface_","_Left_Color_","_Right_Color_","_Reflection_","_Front_Reflect_","_Edge_Reflect_","_Power_","_Sky_Color_","_Horizon_Color_","_Ground_Color_","_Horizon_Power_","_Reflection_Map_","_Indirect_Environment_","_Width_","_Fuzz_","_Min_Fuzz_","_Clip_Fade_","_Hue_Shift_","_Saturation_Shift_","_Value_Shift_","_Blob_Position_","_Blob_Intensity_","_Blob_Near_Size_","_Blob_Far_Size_","_Blob_Near_Distance_","_Blob_Far_Distance_","_Blob_Fade_Length_","_Blob_Pulse_","_Blob_Fade_","_Blob_Texture_","_Blob_Position_2_","_Blob_Near_Size_2_","_Blob_Pulse_2_","_Blob_Fade_2_","_Left_Index_Pos_","_Right_Index_Pos_","_Left_Index_Middle_Pos_","_Right_Index_Middle_Pos_","_Decal_","_Decal_Scale_XY_","_Decal_Front_Only_","_Rim_Intensity_","_Rim_Texture_","_Rim_Hue_Shift_","_Rim_Saturation_Shift_","_Rim_Value_Shift_","_Iridescence_Intensity_","_Iridescence_Texture_","Use_Global_Left_Index","Use_Global_Right_Index","Global_Left_Index_Tip_Position","Global_Right_Index_Tip_Position","Global_Left_Thumb_Tip_Position","Global_Right_Thumb_Tip_Position","Global_Left_Index_Middle_Position;","Global_Right_Index_Middle_Position","Global_Left_Index_Tip_Proximity","Global_Right_Index_Tip_Proximity"],c=["_Rim_Texture_","_Iridescence_Texture_"],u=new Array;l.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:n,maxSimultaneousLights:4}),t.setEffect(o.getEngine().createEffect("mrdlSliderThumb",{attributes:s,uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:_,fallbacks:a,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},r),n)}return!(!t.effect||!t.effect.isReady()||(n._renderId=o.getRenderId(),t.effect._wasPreviouslyReady=!0,0))},t.prototype.bindForSubMesh=function(e,t,i){if(i.materialDefines){var n=i.effect;n&&(this._activeEffect=n,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",this.getScene().activeCamera.position),this._activeEffect.setFloat("_Radius_",this.radius),this._activeEffect.setFloat("_Bevel_Front_",this.bevelFront),this._activeEffect.setFloat("_Bevel_Front_Stretch_",this.bevelFrontStretch),this._activeEffect.setFloat("_Bevel_Back_",this.bevelBack),this._activeEffect.setFloat("_Bevel_Back_Stretch_",this.bevelBackStretch),this._activeEffect.setFloat("_Radius_Top_Left_",this.radiusTopLeft),this._activeEffect.setFloat("_Radius_Top_Right_",this.radiusTopRight),this._activeEffect.setFloat("_Radius_Bottom_Left_",this.radiusBottomLeft),this._activeEffect.setFloat("_Radius_Bottom_Right_",this.radiusBottomRight),this._activeEffect.setFloat("_Bulge_Enabled_",this.bulgeEnabled?1:0),this._activeEffect.setFloat("_Bulge_Height_",this.bulgeHeight),this._activeEffect.setFloat("_Bulge_Radius_",this.bulgeRadius),this._activeEffect.setFloat("_Sun_Intensity_",this.sunIntensity),this._activeEffect.setFloat("_Sun_Theta_",this.sunTheta),this._activeEffect.setFloat("_Sun_Phi_",this.sunPhi),this._activeEffect.setFloat("_Indirect_Diffuse_",this.indirectDiffuse),this._activeEffect.setDirectColor4("_Albedo_",this.albedo),this._activeEffect.setFloat("_Specular_",this.specular),this._activeEffect.setFloat("_Shininess_",this.shininess),this._activeEffect.setFloat("_Sharpness_",this.sharpness),this._activeEffect.setFloat("_Subsurface_",this.subsurface),this._activeEffect.setDirectColor4("_Left_Color_",this.leftGradientColor),this._activeEffect.setDirectColor4("_Right_Color_",this.rightGradientColor),this._activeEffect.setFloat("_Reflection_",this.reflection),this._activeEffect.setFloat("_Front_Reflect_",this.frontReflect),this._activeEffect.setFloat("_Edge_Reflect_",this.edgeReflect),this._activeEffect.setFloat("_Power_",this.power),this._activeEffect.setDirectColor4("_Sky_Color_",this.skyColor),this._activeEffect.setDirectColor4("_Horizon_Color_",this.horizonColor),this._activeEffect.setDirectColor4("_Ground_Color_",this.groundColor),this._activeEffect.setFloat("_Horizon_Power_",this.horizonPower),this._activeEffect.setTexture("_Reflection_Map_",new l.Texture("",this.getScene())),this._activeEffect.setTexture("_Indirect_Environment_",new l.Texture("",this.getScene())),this._activeEffect.setFloat("_Width_",this.width),this._activeEffect.setFloat("_Fuzz_",this.fuzz),this._activeEffect.setFloat("_Min_Fuzz_",this.minFuzz),this._activeEffect.setFloat("_Clip_Fade_",this.clipFade),this._activeEffect.setFloat("_Hue_Shift_",this.hueShift),this._activeEffect.setFloat("_Saturation_Shift_",this.saturationShift),this._activeEffect.setFloat("_Value_Shift_",this.valueShift),this._activeEffect.setVector3("_Blob_Position_",this.blobPosition),this._activeEffect.setFloat("_Blob_Intensity_",this.blobIntensity),this._activeEffect.setFloat("_Blob_Near_Size_",this.blobNearSize),this._activeEffect.setFloat("_Blob_Far_Size_",this.blobFarSize),this._activeEffect.setFloat("_Blob_Near_Distance_",this.blobNearDistance),this._activeEffect.setFloat("_Blob_Far_Distance_",this.blobFarDistance),this._activeEffect.setFloat("_Blob_Fade_Length_",this.blobFadeLength),this._activeEffect.setFloat("_Blob_Pulse_",this.blobPulse),this._activeEffect.setFloat("_Blob_Fade_",this.blobFade),this._activeEffect.setTexture("_Blob_Texture_",this.blobTexture),this._activeEffect.setVector3("_Blob_Position_2_",this.blobPosition2),this._activeEffect.setFloat("_Blob_Near_Size_2_",this.blobNearSize2),this._activeEffect.setFloat("_Blob_Pulse_2_",this.blobPulse2),this._activeEffect.setFloat("_Blob_Fade_2_",this.blobFade2),this._activeEffect.setVector3("_Left_Index_Pos_",this.leftIndexPosition),this._activeEffect.setVector3("_Right_Index_Pos_",this.rightIndexPosition),this._activeEffect.setVector3("_Left_Index_Middle_Pos_",this.leftIndexMiddlePosition),this._activeEffect.setVector3("_Right_Index_Middle_Pos_",this.rightIndexMiddlePosition),this._activeEffect.setTexture("_Decal_",new l.Texture("",this.getScene())),this._activeEffect.setVector2("_Decal_Scale_XY_",this.decalScaleXY),this._activeEffect.setFloat("_Decal_Front_Only_",this.decalFrontOnly?1:0),this._activeEffect.setFloat("_Rim_Intensity_",this.rimIntensity),this._activeEffect.setTexture("_Rim_Texture_",this._blueGradientTexture),this._activeEffect.setFloat("_Rim_Hue_Shift_",this.rimHueShift),this._activeEffect.setFloat("_Rim_Saturation_Shift_",this.rimSaturationShift),this._activeEffect.setFloat("_Rim_Value_Shift_",this.rimValueShift),this._activeEffect.setFloat("_Iridescence_Intensity_",this.iridescenceIntensity),this._activeEffect.setTexture("_Iridescence_Texture_",this._blueGradientTexture),this._activeEffect.setFloat("Use_Global_Left_Index",this.useGlobalLeftIndex),this._activeEffect.setFloat("Use_Global_Right_Index",this.useGlobalRightIndex),this._activeEffect.setVector4("Global_Left_Index_Tip_Position",this.globalLeftIndexTipPosition),this._activeEffect.setVector4("Global_Right_Index_Tip_Position",this.globaRightIndexTipPosition),this._activeEffect.setVector4("Global_Left_Thumb_Tip_Position",this.globalLeftThumbTipPosition),this._activeEffect.setVector4("Global_Right_Thumb_Tip_Position",this.globalRightThumbTipPosition),this._activeEffect.setVector4("Global_Left_Index_Middle_Position",this.globalLeftIndexMiddlePosition),this._activeEffect.setVector4("Global_Right_Index_Middle_Position",this.globalRightIndexMiddlePosition),this._activeEffect.setFloat("Global_Left_Index_Tip_Proximity",this.globalLeftIndexTipProximity),this._activeEffect.setFloat("Global_Right_Index_Tip_Proximity",this.globalRightIndexTipProximity),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var i=this;return l.SerializationHelper.Clone((function(){return new t(e,i.getScene())}),this)},t.prototype.serialize=function(){var e=l.SerializationHelper.Serialize(this);return e.customType="BABYLON.MRDLSliderThumbMaterial",e},t.prototype.getClassName=function(){return"MRDLSliderThumbMaterial"},t.Parse=function(e,i,n){return l.SerializationHelper.Parse((function(){return new t(e.name,i)}),e,i,n)},t.BLUE_GRADIENT_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/MRDL/mrtk-mrdl-blue-gradient.png",r([Object(l.serialize)()],t.prototype,"radius",void 0),r([Object(l.serialize)()],t.prototype,"bevelFront",void 0),r([Object(l.serialize)()],t.prototype,"bevelFrontStretch",void 0),r([Object(l.serialize)()],t.prototype,"bevelBack",void 0),r([Object(l.serialize)()],t.prototype,"bevelBackStretch",void 0),r([Object(l.serialize)()],t.prototype,"radiusTopLeft",void 0),r([Object(l.serialize)()],t.prototype,"radiusTopRight",void 0),r([Object(l.serialize)()],t.prototype,"radiusBottomLeft",void 0),r([Object(l.serialize)()],t.prototype,"radiusBottomRight",void 0),r([Object(l.serialize)()],t.prototype,"bulgeEnabled",void 0),r([Object(l.serialize)()],t.prototype,"bulgeHeight",void 0),r([Object(l.serialize)()],t.prototype,"bulgeRadius",void 0),r([Object(l.serialize)()],t.prototype,"sunIntensity",void 0),r([Object(l.serialize)()],t.prototype,"sunTheta",void 0),r([Object(l.serialize)()],t.prototype,"sunPhi",void 0),r([Object(l.serialize)()],t.prototype,"indirectDiffuse",void 0),r([Object(l.serialize)()],t.prototype,"albedo",void 0),r([Object(l.serialize)()],t.prototype,"specular",void 0),r([Object(l.serialize)()],t.prototype,"shininess",void 0),r([Object(l.serialize)()],t.prototype,"sharpness",void 0),r([Object(l.serialize)()],t.prototype,"subsurface",void 0),r([Object(l.serialize)()],t.prototype,"leftGradientColor",void 0),r([Object(l.serialize)()],t.prototype,"rightGradientColor",void 0),r([Object(l.serialize)()],t.prototype,"reflection",void 0),r([Object(l.serialize)()],t.prototype,"frontReflect",void 0),r([Object(l.serialize)()],t.prototype,"edgeReflect",void 0),r([Object(l.serialize)()],t.prototype,"power",void 0),r([Object(l.serialize)()],t.prototype,"skyColor",void 0),r([Object(l.serialize)()],t.prototype,"horizonColor",void 0),r([Object(l.serialize)()],t.prototype,"groundColor",void 0),r([Object(l.serialize)()],t.prototype,"horizonPower",void 0),r([Object(l.serialize)()],t.prototype,"width",void 0),r([Object(l.serialize)()],t.prototype,"fuzz",void 0),r([Object(l.serialize)()],t.prototype,"minFuzz",void 0),r([Object(l.serialize)()],t.prototype,"clipFade",void 0),r([Object(l.serialize)()],t.prototype,"hueShift",void 0),r([Object(l.serialize)()],t.prototype,"saturationShift",void 0),r([Object(l.serialize)()],t.prototype,"valueShift",void 0),r([Object(l.serialize)()],t.prototype,"blobPosition",void 0),r([Object(l.serialize)()],t.prototype,"blobIntensity",void 0),r([Object(l.serialize)()],t.prototype,"blobNearSize",void 0),r([Object(l.serialize)()],t.prototype,"blobFarSize",void 0),r([Object(l.serialize)()],t.prototype,"blobNearDistance",void 0),r([Object(l.serialize)()],t.prototype,"blobFarDistance",void 0),r([Object(l.serialize)()],t.prototype,"blobFadeLength",void 0),r([Object(l.serialize)()],t.prototype,"blobPulse",void 0),r([Object(l.serialize)()],t.prototype,"blobFade",void 0),r([Object(l.serialize)()],t.prototype,"blobPosition2",void 0),r([Object(l.serialize)()],t.prototype,"blobNearSize2",void 0),r([Object(l.serialize)()],t.prototype,"blobPulse2",void 0),r([Object(l.serialize)()],t.prototype,"blobFade2",void 0),r([Object(l.serialize)()],t.prototype,"blobTexture",void 0),r([Object(l.serialize)()],t.prototype,"leftIndexPosition",void 0),r([Object(l.serialize)()],t.prototype,"rightIndexPosition",void 0),r([Object(l.serialize)()],t.prototype,"leftIndexMiddlePosition",void 0),r([Object(l.serialize)()],t.prototype,"rightIndexMiddlePosition",void 0),r([Object(l.serialize)()],t.prototype,"decalScaleXY",void 0),r([Object(l.serialize)()],t.prototype,"decalFrontOnly",void 0),r([Object(l.serialize)()],t.prototype,"rimIntensity",void 0),r([Object(l.serialize)()],t.prototype,"rimHueShift",void 0),r([Object(l.serialize)()],t.prototype,"rimSaturationShift",void 0),r([Object(l.serialize)()],t.prototype,"rimValueShift",void 0),r([Object(l.serialize)()],t.prototype,"iridescenceIntensity",void 0),t}(l.PushMaterial);Object(l.RegisterClass)("BABYLON.GUI.MRDLSliderThumbMaterial",Xe);var Ke="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nuniform float _Radius_;\nuniform float _Line_Width_;\nuniform bool _Absolute_Sizes_;\nuniform float _Filter_Width_;\nuniform vec4 _Base_Color_;\nuniform vec4 _Line_Color_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform float _Rate_;\nuniform vec4 _Highlight_Color_;\nuniform float _Highlight_Width_;\nuniform vec4 _Highlight_Transform_;\nuniform float _Highlight_;\n\nuniform float _Iridescence_Intensity_;\nuniform float _Iridescence_Edge_Intensity_;\nuniform vec4 _Iridescence_Tint_;\nuniform sampler2D _Iridescent_Map_;\nuniform float _Angle_;\nuniform bool _Reflected_;\nuniform float _Frequency_;\nuniform float _Vertical_Offset_;\nuniform vec4 _Gradient_Color_;\nuniform vec4 _Top_Left_;\nuniform vec4 _Top_Right_;\nuniform vec4 _Bottom_Left_;\nuniform vec4 _Bottom_Right_;\n\nuniform float _Edge_Width_;\nuniform float _Edge_Power_;\nuniform float _Line_Gradient_Blend_;\nuniform float _Fade_Out_;\n\n\nvoid FastLinearTosRGB_B353(\nvec4 Linear,\nout vec4 sRGB)\n{\nsRGB.rgb=sqrt(clamp(Linear.rgb,0.0,1.0));\nsRGB.a=Linear.a;\n}\n\n\nvoid Round_Rect_Fragment_B332(\nfloat Radius,\nfloat Line_Width,\nvec4 Line_Color,\nfloat Filter_Width,\nvec2 UV,\nfloat Line_Visibility,\nvec4 Rect_Parms,\nvec4 Fill_Color,\nout vec4 Color)\n{\nfloat d=length(max(abs(UV)-Rect_Parms.xy,0.0));\nfloat dx=max(fwidth(d)*Filter_Width,0.00001);\n\nfloat g=min(Rect_Parms.z,Rect_Parms.w);\nfloat dgrad=max(fwidth(g)*Filter_Width,0.00001);\nfloat Inside_Rect=clamp(g/dgrad,0.0,1.0);\n\n\nfloat inner=clamp((d+dx*0.5-max(Radius-Line_Width,d-dx*0.5))/dx,0.0,1.0);\nColor=clamp(mix(Fill_Color,Line_Color,inner),0.0,1.0)*Inside_Rect;\n\n\n\n}\n\n\nvoid Iridescence_B343(\nvec3 Position,\nvec3 Normal,\nvec2 UV,\nvec3 Axis,\nvec3 Eye,\nvec4 Tint,\nsampler2D Texture,\nbool Reflected,\nfloat Frequency,\nfloat Vertical_Offset,\nout vec4 Color)\n{\nvec3 i=normalize(Position-Eye);\nvec3 r=reflect(i,Normal);\nfloat idota=dot(i,Axis);\nfloat idotr=dot(i,r);\nfloat x=Reflected ? idotr : idota;\nvec2 xy;\nxy.x=fract((x*Frequency+1.0)*0.5+UV.y*Vertical_Offset);\nxy.y=0.5;\nColor=texture(Texture,xy);\nColor.rgb*=Tint.rgb;\n}\n\n\nvoid Scale_RGB_B346(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Scale_RGB_B344(\nfloat Scalar,\nvec4 Color,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Line_Fragment_B362(\nvec4 Base_Color,\nvec4 Highlight_Color,\nfloat Highlight_Width,\nvec3 Line_Vertex,\nfloat Highlight,\nout vec4 Line_Color)\n{\nfloat k2=1.0-clamp(abs(Line_Vertex.y/Highlight_Width),0.0,1.0);\nLine_Color=mix(Base_Color,Highlight_Color,Highlight*k2);\n}\n\n\nvoid Edge_B356(\nvec4 RectParms,\nfloat Radius,\nfloat Line_Width,\nvec2 UV,\nfloat Edge_Width,\nfloat Edge_Power,\nout float Result)\n{\nfloat d=length(max(abs(UV)-RectParms.xy,0.0));\nfloat edge=1.0-clamp((1.0-d/(Radius-Line_Width))/Edge_Width,0.0,1.0);\nResult=pow(edge,Edge_Power);\n}\n\n\nvoid Gradient_B355(\nvec4 Gradient_Color,\nvec4 Top_Left,\nvec4 Top_Right,\nvec4 Bottom_Left,\nvec4 Bottom_Right,\nvec2 UV,\nout vec4 Result)\n{\nvec3 top=Top_Left.rgb+(Top_Right.rgb-Top_Left.rgb)*UV.x;\nvec3 bottom=Bottom_Left.rgb+(Bottom_Right.rgb-Bottom_Left.rgb)*UV.x;\nResult.rgb=Gradient_Color.rgb*(bottom+(top-bottom)*UV.y);\nResult.a=1.0;\n}\n\nvoid main()\n{\n\nfloat X_Q338;\nfloat Y_Q338;\nfloat Z_Q338;\nfloat W_Q338;\nX_Q338=vExtra2.x;\nY_Q338=vExtra2.y;\nZ_Q338=vExtra2.z;\nW_Q338=vExtra2.w;\nvec4 Color_Q343;\n#if IRIDESCENCE_ENABLE\nIridescence_B343(vPosition,vNormal,vUV,vBinormal,cameraPosition,_Iridescence_Tint_,_Iridescent_Map_,_Reflected_,_Frequency_,_Vertical_Offset_,Color_Q343);\n#else\nColor_Q343=vec4(0,0,0,0);\n#endif\nvec4 Result_Q344;\nScale_RGB_B344(_Iridescence_Intensity_,Color_Q343,Result_Q344);\nvec4 Line_Color_Q362;\nLine_Fragment_B362(_Line_Color_,_Highlight_Color_,_Highlight_Width_,vTangent,_Highlight_,Line_Color_Q362);\nfloat Result_Q356;\n#if EDGE_ONLY\nEdge_B356(vExtra1,Z_Q338,W_Q338,vUV,_Edge_Width_,_Edge_Power_,Result_Q356);\n#else\nResult_Q356=1.0;\n#endif\n\nvec2 Vec2_Q339=vec2(X_Q338,Y_Q338);\nvec4 Result_Q355;\nGradient_B355(_Gradient_Color_,_Top_Left_,_Top_Right_,_Bottom_Left_,_Bottom_Right_,Vec2_Q339,Result_Q355);\n\nvec4 Linear_Q348;\nLinear_Q348.rgb=clamp(Result_Q355.rgb*Result_Q355.rgb,0.0,1.0);\nLinear_Q348.a=Result_Q355.a;\nvec4 Result_Q346;\nScale_RGB_B346(Linear_Q348,Result_Q356,Result_Q346);\n\nvec4 Sum_Q345=Result_Q346+Result_Q344;\n\nvec4 Color_At_T_Q347=mix(Line_Color_Q362,Result_Q346,_Line_Gradient_Blend_);\n\nvec4 Base_And_Iridescent_Q350;\nBase_And_Iridescent_Q350=_Base_Color_+vec4(Sum_Q345.rgb,0.0);\n\nvec4 Sum_Q349=Color_At_T_Q347+_Iridescence_Edge_Intensity_*Color_Q343;\n\nvec4 Result_Q351=Sum_Q349; Result_Q351.a=1.0;\nvec4 Color_Q332;\nRound_Rect_Fragment_B332(Z_Q338,W_Q338,Result_Q351,_Filter_Width_,vUV,1.0,vExtra1,Base_And_Iridescent_Q350,Color_Q332);\n\nvec4 Result_Q354=_Fade_Out_*Color_Q332;\nvec4 sRGB_Q353;\nFastLinearTosRGB_B353(Result_Q354,sRGB_Q353);\nvec4 Out_Color=sRGB_Q353;\nfloat Clip_Threshold=0.001;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";l.ShaderStore.ShadersStore.mrdlBackplatePixelShader=Ke;var Ze="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 tangent;\nuniform float _Radius_;\nuniform float _Line_Width_;\nuniform bool _Absolute_Sizes_;\nuniform float _Filter_Width_;\nuniform vec4 _Base_Color_;\nuniform vec4 _Line_Color_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform float _Rate_;\nuniform vec4 _Highlight_Color_;\nuniform float _Highlight_Width_;\nuniform vec4 _Highlight_Transform_;\nuniform float _Highlight_;\n\nuniform float _Iridescence_Intensity_;\nuniform float _Iridescence_Edge_Intensity_;\nuniform vec4 _Iridescence_Tint_;\nuniform sampler2D _Iridescent_Map_;\nuniform float _Angle_;\nuniform bool _Reflected_;\nuniform float _Frequency_;\nuniform float _Vertical_Offset_;\nuniform vec4 _Gradient_Color_;\nuniform vec4 _Top_Left_;\nuniform vec4 _Top_Right_;\nuniform vec4 _Bottom_Left_;\nuniform vec4 _Bottom_Right_;\n\nuniform float _Edge_Width_;\nuniform float _Edge_Power_;\nuniform float _Line_Gradient_Blend_;\nuniform float _Fade_Out_;\n\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\n\nvoid Object_To_World_Pos_B314(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid Round_Rect_Vertex_B357(\nvec2 UV,\nfloat Radius,\nfloat Margin,\nfloat Anisotropy,\nfloat Gradient1,\nfloat Gradient2,\nvec3 Normal,\nvec4 Color_Scale_Translate,\nout vec2 Rect_UV,\nout vec4 Rect_Parms,\nout vec2 Scale_XY,\nout vec2 Line_UV,\nout vec2 Color_UV_Info)\n{\nScale_XY=vec2(Anisotropy,1.0);\nLine_UV=(UV-vec2(0.5,0.5));\nRect_UV=Line_UV*Scale_XY;\nRect_Parms.xy=Scale_XY*0.5-vec2(Radius,Radius)-vec2(Margin,Margin);\nRect_Parms.z=Gradient1;\nRect_Parms.w=Gradient2;\nColor_UV_Info=(Line_UV+vec2(0.5,0.5))*Color_Scale_Translate.xy+Color_Scale_Translate.zw;\n}\n\n\nvoid Line_Vertex_B333(\nvec2 Scale_XY,\nvec2 UV,\nfloat Time,\nfloat Rate,\nvec4 Highlight_Transform,\nout vec3 Line_Vertex)\n{\nfloat angle2=(Rate*Time)*2.0*3.1416;\nfloat sinAngle2=sin(angle2);\nfloat cosAngle2=cos(angle2);\nvec2 xformUV=UV*Highlight_Transform.xy+Highlight_Transform.zw;\nLine_Vertex.x=0.0;\nLine_Vertex.y=cosAngle2*xformUV.x-sinAngle2*xformUV.y;\nLine_Vertex.z=0.0;\n}\n\n\nvoid PickDir_B334(\nfloat Degrees,\nvec3 DirX,\nvec3 DirY,\nout vec3 Dir)\n{\n\nfloat a=Degrees*3.14159/180.0;\nDir=cos(a)*DirX+sin(a)*DirY;\n}\n\n\nvoid Move_Verts_B327(\nfloat Anisotropy,\nvec3 P,\nfloat Radius,\nout vec3 New_P,\nout vec2 New_UV,\nout float Radial_Gradient,\nout vec3 Radial_Dir)\n{\nvec2 UV=P.xy*2.0+0.5;\nvec2 center=clamp(UV,0.0,1.0);\nvec2 delta=UV-center;\nvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\nNew_UV=center+r2*(UV-2.0*center+0.5);\nNew_P=vec3(New_UV-0.5,P.z);\nRadial_Gradient=1.0-length(delta)*2.0;\nRadial_Dir=vec3(delta*r2,0.0);\n}\n\n\nvoid Pick_Radius_B336(\nfloat Radius,\nfloat Radius_Top_Left,\nfloat Radius_Top_Right,\nfloat Radius_Bottom_Left,\nfloat Radius_Bottom_Right,\nvec3 Position,\nout float Result)\n{\nbool whichY=Position.y>0.0;\nResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\nResult*=Radius;\n}\n\n\nvoid Edge_AA_Vertex_B328(\nvec3 Position_World,\nvec3 Position_Object,\nvec3 Normal_Object,\nvec3 Eye,\nfloat Radial_Gradient,\nvec3 Radial_Dir,\nvec3 Tangent,\nout float Gradient1,\nout float Gradient2)\n{\n\nvec3 I=(Eye-Position_World);\nvec3 T=(vec4(Tangent,0.0)).xyz;\nfloat g=(dot(T,I)<0.0) ? 0.0 : 1.0;\nif (Normal_Object.z==0.0) {\n\nGradient1=Position_Object.z>0.0 ? g : 1.0;\nGradient2=Position_Object.z>0.0 ? 1.0 : g;\n} else {\n\n\n\n\nGradient1=g+(1.0-g)*(Radial_Gradient);\nGradient2=1.0;\n}\n}\n\n\nvoid Object_To_World_Dir_B330(\nvec3 Dir_Object,\nout vec3 Binormal_World,\nout vec3 Binormal_World_N,\nout float Binormal_Length)\n{\nBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nBinormal_Length=length(Binormal_World);\nBinormal_World_N=Binormal_World/Binormal_Length;\n}\n\n\nvoid RelativeOrAbsoluteDetail_B341(\nfloat Nominal_Radius,\nfloat Nominal_LineWidth,\nbool Absolute_Measurements,\nfloat Height,\nout float Radius,\nout float Line_Width)\n{\nfloat scale=Absolute_Measurements ? 1.0/Height : 1.0;\nRadius=Nominal_Radius*scale;\nLine_Width=Nominal_LineWidth*scale;\n}\n\nvoid main()\n{\n\nvec3 Nrm_World_Q326;\nNrm_World_Q326=normalize((world*vec4(normal,0.0)).xyz);\n\nvec3 Tangent_World_Q329;\nvec3 Tangent_World_N_Q329;\nfloat Tangent_Length_Q329;\nTangent_World_Q329=(world*vec4(vec3(1,0,0),0.0)).xyz;\nTangent_Length_Q329=length(Tangent_World_Q329);\nTangent_World_N_Q329=Tangent_World_Q329/Tangent_Length_Q329;\nvec3 Binormal_World_Q330;\nvec3 Binormal_World_N_Q330;\nfloat Binormal_Length_Q330;\nObject_To_World_Dir_B330(vec3(0,1,0),Binormal_World_Q330,Binormal_World_N_Q330,Binormal_Length_Q330);\nfloat Radius_Q341;\nfloat Line_Width_Q341;\nRelativeOrAbsoluteDetail_B341(_Radius_,_Line_Width_,_Absolute_Sizes_,Binormal_Length_Q330,Radius_Q341,Line_Width_Q341);\nvec3 Dir_Q334;\nPickDir_B334(_Angle_,Tangent_World_N_Q329,Binormal_World_N_Q330,Dir_Q334);\nfloat Result_Q336;\nPick_Radius_B336(Radius_Q341,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q336);\n\nfloat Anisotropy_Q331=Tangent_Length_Q329/Binormal_Length_Q330;\n\nvec4 Out_Color_Q337=vec4(Result_Q336,Line_Width_Q341,0,1);\nvec3 New_P_Q327;\nvec2 New_UV_Q327;\nfloat Radial_Gradient_Q327;\nvec3 Radial_Dir_Q327;\nMove_Verts_B327(Anisotropy_Q331,position,Result_Q336,New_P_Q327,New_UV_Q327,Radial_Gradient_Q327,Radial_Dir_Q327);\nvec3 Pos_World_Q314;\nObject_To_World_Pos_B314(New_P_Q327,Pos_World_Q314);\nfloat Gradient1_Q328;\nfloat Gradient2_Q328;\n#if SMOOTH_EDGES\nEdge_AA_Vertex_B328(Pos_World_Q314,position,normal,cameraPosition,Radial_Gradient_Q327,Radial_Dir_Q327,tangent,Gradient1_Q328,Gradient2_Q328);\n#else\nGradient1_Q328=1.0;\nGradient2_Q328=1.0;\n#endif\nvec2 Rect_UV_Q357;\nvec4 Rect_Parms_Q357;\nvec2 Scale_XY_Q357;\nvec2 Line_UV_Q357;\nvec2 Color_UV_Info_Q357;\nRound_Rect_Vertex_B357(New_UV_Q327,Result_Q336,0.0,Anisotropy_Q331,Gradient1_Q328,Gradient2_Q328,normal,vec4(1,1,0,0),Rect_UV_Q357,Rect_Parms_Q357,Scale_XY_Q357,Line_UV_Q357,Color_UV_Info_Q357);\nvec3 Line_Vertex_Q333;\nLine_Vertex_B333(Scale_XY_Q357,Line_UV_Q357,(20.0),_Rate_,_Highlight_Transform_,Line_Vertex_Q333);\n\nfloat X_Q359;\nfloat Y_Q359;\nX_Q359=Color_UV_Info_Q357.x;\nY_Q359=Color_UV_Info_Q357.y;\n\nvec4 Vec4_Q358=vec4(X_Q359,Y_Q359,Result_Q336,Line_Width_Q341);\nvec3 Position=Pos_World_Q314;\nvec3 Normal=Nrm_World_Q326;\nvec2 UV=Rect_UV_Q357;\nvec3 Tangent=Line_Vertex_Q333;\nvec3 Binormal=Dir_Q334;\nvec4 Color=Out_Color_Q337;\nvec4 Extra1=Rect_Parms_Q357;\nvec4 Extra2=Vec4_Q358;\nvec4 Extra3=vec4(0,0,0,0);\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvExtra1=Extra1;\nvExtra2=Extra2;\n}";l.ShaderStore.ShadersStore.mrdlBackplateVertexShader=Ze;var qe=function(e){function t(){var t=e.call(this)||this;return t.IRIDESCENCE_ENABLED=!0,t.SMOOTH_EDGES=!0,t._needNormals=!0,t.rebuild(),t}return o(t,e),t}(l.MaterialDefines),$e=function(e){function t(i,n){var o=e.call(this,i,n)||this;return o.radius=.3,o.lineWidth=.003,o.absoluteSizes=!1,o._filterWidth=1,o.baseColor=new l.Color4(0,0,0,1),o.lineColor=new l.Color4(.2,.262745,.4,1),o.radiusTopLeft=1,o.radiusTopRight=1,o.radiusBottomLeft=1,o.radiusBottomRight=1,o._rate=0,o.highlightColor=new l.Color4(.239216,.435294,.827451,1),o.highlightWidth=0,o._highlightTransform=new l.Vector4(1,1,0,0),o._highlight=1,o.iridescenceIntensity=.45,o.iridescenceEdgeIntensity=1,o.iridescenceTint=new l.Color4(1,1,1,1),o._angle=-45,o.fadeOut=1,o._reflected=!0,o._frequency=1,o._verticalOffset=0,o.gradientColor=new l.Color4(.74902,.74902,.74902,1),o.topLeftGradientColor=new l.Color4(.00784314,.294118,.580392,1),o.topRightGradientColor=new l.Color4(.305882,0,1,1),o.bottomLeftGradientColor=new l.Color4(.133333,.258824,.992157,1),o.bottomRightGradientColor=new l.Color4(.176471,.176471,.619608,1),o.edgeWidth=.5,o.edgePower=1,o.edgeLineGradientBlend=.5,o.alphaMode=l.Constants.ALPHA_DISABLE,o.backFaceCulling=!1,o._iridescentMapTexture=new l.Texture(t.IRIDESCENT_MAP_TEXTURE_URL,n,!0,!1,l.Texture.NEAREST_SAMPLINGMODE),o}return o(t,e),t.prototype.needAlphaBlending=function(){return!1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,i){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t.materialDefines||(t.materialDefines=new qe);var n=t.materialDefines,o=this.getScene();if(this._isReadyForSubMesh(t))return!0;var r=o.getEngine();if(l.MaterialHelper.PrepareDefinesForAttributes(e,n,!1,!1),n.isDirty){n.markAsProcessed(),o.resetCachedMaterial();var a=new l.EffectFallbacks;n.FOG&&a.addFallback(1,"FOG"),l.MaterialHelper.HandleFallbacksForShadows(n,a),n.IMAGEPROCESSINGPOSTPROCESS=o.imageProcessingConfiguration.applyByPostProcess;var s=[l.VertexBuffer.PositionKind];n.NORMAL&&s.push(l.VertexBuffer.NormalKind),n.UV1&&s.push(l.VertexBuffer.UVKind),n.UV2&&s.push(l.VertexBuffer.UV2Kind),n.VERTEXCOLOR&&s.push(l.VertexBuffer.ColorKind),n.TANGENT&&s.push(l.VertexBuffer.TangentKind),l.MaterialHelper.PrepareAttributesForInstances(s,n);var _=n.toString(),h=["world","viewProjection","cameraPosition","_Radius_","_Line_Width_","_Absolute_Sizes_","_Filter_Width_","_Base_Color_","_Line_Color_","_Radius_Top_Left_","_Radius_Top_Right_","_Radius_Bottom_Left_","_Radius_Bottom_Right_","_Rate_","_Highlight_Color_","_Highlight_Width_","_Highlight_Transform_","_Highlight_","_Iridescence_Intensity_","_Iridescence_Edge_Intensity_","_Iridescence_Tint_","_Iridescent_Map_","_Angle_","_Reflected_","_Frequency_","_Vertical_Offset_","_Gradient_Color_","_Top_Left_","_Top_Right_","_Bottom_Left_","_Bottom_Right_","_Edge_Width_","_Edge_Power_","_Line_Gradient_Blend_","_Fade_Out_"],c=[],u=new Array;l.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:n,maxSimultaneousLights:4}),t.setEffect(o.getEngine().createEffect("mrdlBackplate",{attributes:s,uniformsNames:h,uniformBuffersNames:u,samplers:c,defines:_,fallbacks:a,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},r),n)}return!(!t.effect||!t.effect.isReady()||(n._renderId=o.getRenderId(),t.effect._wasPreviouslyReady=!0,0))},t.prototype.bindForSubMesh=function(e,t,i){if(i.materialDefines){var n=i.effect;n&&(this._activeEffect=n,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",this.getScene().activeCamera.position),this._activeEffect.setFloat("_Radius_",this.radius),this._activeEffect.setFloat("_Line_Width_",this.lineWidth),this._activeEffect.setFloat("_Absolute_Sizes_",this.absoluteSizes?1:0),this._activeEffect.setFloat("_Filter_Width_",this._filterWidth),this._activeEffect.setDirectColor4("_Base_Color_",this.baseColor),this._activeEffect.setDirectColor4("_Line_Color_",this.lineColor),this._activeEffect.setFloat("_Radius_Top_Left_",this.radiusTopLeft),this._activeEffect.setFloat("_Radius_Top_Right_",this.radiusTopRight),this._activeEffect.setFloat("_Radius_Bottom_Left_",this.radiusBottomLeft),this._activeEffect.setFloat("_Radius_Bottom_Right_",this.radiusBottomRight),this._activeEffect.setFloat("_Rate_",this._rate),this._activeEffect.setDirectColor4("_Highlight_Color_",this.highlightColor),this._activeEffect.setFloat("_Highlight_Width_",this.highlightWidth),this._activeEffect.setVector4("_Highlight_Transform_",this._highlightTransform),this._activeEffect.setFloat("_Highlight_",this._highlight),this._activeEffect.setFloat("_Iridescence_Intensity_",this.iridescenceIntensity),this._activeEffect.setFloat("_Iridescence_Edge_Intensity_",this.iridescenceEdgeIntensity),this._activeEffect.setDirectColor4("_Iridescence_Tint_",this.iridescenceTint),this._activeEffect.setTexture("_Iridescent_Map_",this._iridescentMapTexture),this._activeEffect.setFloat("_Angle_",this._angle),this._activeEffect.setFloat("_Reflected_",this._reflected?1:0),this._activeEffect.setFloat("_Frequency_",this._frequency),this._activeEffect.setFloat("_Vertical_Offset_",this._verticalOffset),this._activeEffect.setDirectColor4("_Gradient_Color_",this.gradientColor),this._activeEffect.setDirectColor4("_Top_Left_",this.topLeftGradientColor),this._activeEffect.setDirectColor4("_Top_Right_",this.topRightGradientColor),this._activeEffect.setDirectColor4("_Bottom_Left_",this.bottomLeftGradientColor),this._activeEffect.setDirectColor4("_Bottom_Right_",this.bottomRightGradientColor),this._activeEffect.setFloat("_Edge_Width_",this.edgeWidth),this._activeEffect.setFloat("_Edge_Power_",this.edgePower),this._activeEffect.setFloat("_Line_Gradient_Blend_",this.edgeLineGradientBlend),this._activeEffect.setFloat("_Fade_Out_",this.fadeOut),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var i=this;return l.SerializationHelper.Clone((function(){return new t(e,i.getScene())}),this)},t.prototype.serialize=function(){var e=l.SerializationHelper.Serialize(this);return e.customType="BABYLON.MRDLBackplateMaterial",e},t.prototype.getClassName=function(){return"MRDLBackplateMaterial"},t.Parse=function(e,i,n){return l.SerializationHelper.Parse((function(){return new t(e.name,i)}),e,i,n)},t.IRIDESCENT_MAP_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/MRDL/mrtk-mrdl-backplate-iridescence.png",r([Object(l.serialize)()],t.prototype,"radius",void 0),r([Object(l.serialize)()],t.prototype,"lineWidth",void 0),r([Object(l.serialize)()],t.prototype,"absoluteSizes",void 0),r([Object(l.serialize)()],t.prototype,"baseColor",void 0),r([Object(l.serialize)()],t.prototype,"lineColor",void 0),r([Object(l.serialize)()],t.prototype,"radiusTopLeft",void 0),r([Object(l.serialize)()],t.prototype,"radiusTopRight",void 0),r([Object(l.serialize)()],t.prototype,"radiusBottomLeft",void 0),r([Object(l.serialize)()],t.prototype,"radiusBottomRight",void 0),r([Object(l.serialize)()],t.prototype,"highlightColor",void 0),r([Object(l.serialize)()],t.prototype,"highlightWidth",void 0),r([Object(l.serialize)()],t.prototype,"iridescenceIntensity",void 0),r([Object(l.serialize)()],t.prototype,"iridescenceEdgeIntensity",void 0),r([Object(l.serialize)()],t.prototype,"iridescenceTint",void 0),r([Object(l.serialize)()],t.prototype,"fadeOut",void 0),r([Object(l.serialize)()],t.prototype,"gradientColor",void 0),r([Object(l.serialize)()],t.prototype,"topLeftGradientColor",void 0),r([Object(l.serialize)()],t.prototype,"topRightGradientColor",void 0),r([Object(l.serialize)()],t.prototype,"bottomLeftGradientColor",void 0),r([Object(l.serialize)()],t.prototype,"bottomRightGradientColor",void 0),r([Object(l.serialize)()],t.prototype,"edgeWidth",void 0),r([Object(l.serialize)()],t.prototype,"edgePower",void 0),r([Object(l.serialize)()],t.prototype,"edgeLineGradientBlend",void 0),t}(l.PushMaterial);Object(l.RegisterClass)("BABYLON.GUI.MRDLBackplateMaterial",$e);var Je=function(e){function t(t,i){var n=e.call(this,t)||this;return n.onValueChangedObservable=new l.Observable,n._sliderBackplateVisible=i||!1,n._minimum=0,n._maximum=100,n._step=0,n._value=50,n}return o(t,e),Object.defineProperty(t.prototype,"mesh",{get:function(){return this.node?this._sliderThumb:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minimum",{get:function(){return this._minimum},set:function(e){this._minimum!==e&&(this._minimum=Math.max(e,0),this._value=Math.max(Math.min(this._value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this._maximum},set:function(e){this._maximum!==e&&(this._maximum=Math.max(e,this._minimum),this._value=Math.max(Math.min(this._value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(e){this._step!==e&&(this._step=Math.max(Math.min(e,this._maximum-this._minimum),0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value!==e&&(this._value=Math.max(Math.min(e,this._maximum),this._minimum),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this.node?this._sliderBar.position.x-this._sliderBar.scaling.x/2:-.5},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.node?this._sliderBar.position.x+this._sliderBar.scaling.x/2:.5},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliderBarMaterial",{get:function(){return this._sliderBarMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliderThumbMaterial",{get:function(){return this._sliderThumbMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliderBackplateMaterial",{get:function(){return this._sliderBackplateMaterial},enumerable:!1,configurable:!0}),t.prototype._createNode=function(e){var i=this,n=Object(l.CreateBox)(this.name+"_sliderbackplate",{width:1,height:1,depth:1},e);return n.isPickable=!1,n.visibility=0,n.scaling=new l.Vector3(1,.5,.8),l.SceneLoader.ImportMeshAsync(void 0,t.MODEL_BASE_URL,t.MODEL_FILENAME,e).then((function(e){var t=e.meshes[1],o=e.meshes[1].clone(i.name+"_sliderbar",n),r=e.meshes[1].clone(i.name+"_sliderthumb",n);t.visibility=0,i._sliderBackplateVisible&&(t.visibility=1,t.name=i.name+"_sliderbackplate",t.isPickable=!1,t.scaling.x=1,t.scaling.z=.2,t.parent=n,i._sliderBackplateMaterial&&(t.material=i._sliderBackplateMaterial),i._sliderBackplate=t),o&&(o.parent=n,o.position.z=-.1,o.scaling=new l.Vector3(.8,.04,.3),o.isPickable=!1,i._sliderBarMaterial&&(o.material=i._sliderBarMaterial),i._sliderBar=o),r&&(r.parent=n,r.isPickable=!0,r.position.z=-.115,r.scaling=new l.Vector3(.025,.3,.6),r.position.x=i._convertToPosition(i.value),r.addBehavior(i._createBehavior()),i._sliderThumbMaterial&&(r.material=i._sliderThumbMaterial),i._sliderThumb=r)})),this._affectMaterial(n),n},t.prototype._affectMaterial=function(e){var t,i,n;this._sliderBackplateMaterial=null!==(t=this._sliderBackplateMaterial)&&void 0!==t?t:new $e(this.name+"_sliderbackplate_material",e.getScene()),this._sliderBarMaterial=null!==(i=this._sliderBarMaterial)&&void 0!==i?i:new We(this.name+"_sliderbar_material",e.getScene()),this._sliderThumbMaterial=null!==(n=this._sliderThumbMaterial)&&void 0!==n?n:new Xe(this.name+"_sliderthumb_material",e.getScene())},t.prototype._createBehavior=function(){var e=this,t=new l.PointerDragBehavior({dragAxis:l.Vector3.Right()});return t.moveAttached=!1,t.onDragObservable.add((function(t){var i=e._sliderThumb.position.x+t.dragDistance/e.scaling.x;e._sliderThumb.position.x=Math.max(Math.min(i,e.end),e.start),e.value=e._convertToValue(e._sliderThumb.position.x)})),t.onDragEndObservable.add((function(t){e._sliderThumb.position.x=e._convertToPosition(e.value)})),t},t.prototype._convertToPosition=function(e){var t=(e-this.minimum)/(this.maximum-this.minimum)*(this.end-this.start)+this.start;return Math.min(Math.max(t,this.start),this.end)},t.prototype._convertToValue=function(e){var t=(e-this.start)/(this.end-this.start)*(this.maximum-this.minimum);return t=this.step?Math.round(t/this.step)*this.step:t,Math.max(Math.min(this.minimum+t,this._maximum),this._minimum)},t.prototype.dispose=function(){var t,i,n,o,r,a;e.prototype.dispose.call(this),null===(t=this._sliderBar)||void 0===t||t.dispose(),null===(i=this._sliderThumb)||void 0===i||i.dispose(),null===(n=this._sliderBarMaterial)||void 0===n||n.dispose(),null===(o=this._sliderThumbMaterial)||void 0===o||o.dispose(),null===(r=this._sliderBackplate)||void 0===r||r.dispose(),null===(a=this._sliderBackplateMaterial)||void 0===a||a.dispose()},t.MODEL_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.MODEL_FILENAME="mrtk-fluent-backplate.glb",t}(rt),et=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._radius=5,t}return o(t,e),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){var t=this;this._radius!==e&&(this._radius=e,l.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._mapGridNode=function(e,t){var i=e.mesh;if(i){var n=this._sphericalMapping(t);switch(e.position=n,this.orientation){case le.FACEORIGIN_ORIENTATION:i.lookAt(new l.Vector3(2*n.x,2*n.y,2*n.z));break;case le.FACEORIGINREVERSED_ORIENTATION:i.lookAt(new l.Vector3(-n.x,-n.y,-n.z));break;case le.FACEFORWARD_ORIENTATION:break;case le.FACEFORWARDREVERSED_ORIENTATION:i.rotate(l.Axis.Y,Math.PI,l.Space.LOCAL)}}},t.prototype._sphericalMapping=function(e){var t=new l.Vector3(0,0,this._radius),i=e.y/this._radius,n=-e.x/this._radius;return l.Matrix.RotationYawPitchRollToRef(n,i,0,l.TmpVectors.Matrix[0]),l.Vector3.TransformNormal(t,l.TmpVectors.Matrix[0])},t}(_e),tt=function(e){function t(t){void 0===t&&(t=!1);var i=e.call(this)||this;return i._isVertical=!1,i.margin=.1,i._isVertical=t,i}return o(t,e),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){var t=this;this._isVertical!==e&&(this._isVertical=e,l.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._arrangeChildren=function(){for(var e,t=0,i=0,n=0,o=[],r=l.Matrix.Invert(this.node.computeWorldMatrix(!0)),a=0,s=this._children;a<s.length;a++)if((f=s[a]).mesh){n++,f.mesh.computeWorldMatrix(!0),f.mesh.getWorldMatrix().multiplyToRef(r,l.TmpVectors.Matrix[0]);var _=f.mesh.getBoundingInfo().boundingBox,h=l.Vector3.TransformNormal(_.extendSize,l.TmpVectors.Matrix[0]);o.push(h),this._isVertical?i+=h.y:t+=h.x}this._isVertical?i+=(n-1)*this.margin/2:t+=(n-1)*this.margin/2,e=this._isVertical?-i:-t;for(var c=0,u=0,d=this._children;u<d.length;u++){var f;(f=d[u]).mesh&&(n--,h=o[c++],this._isVertical?(f.position.y=e+h.y,f.position.x=0,e+=2*h.y):(f.position.x=e+h.x,f.position.y=0,e+=2*h.x),e+=n>0?this.margin:0)}},t}(le),it=function(e){function t(t,i){var n=e.call(this,i,t)||this;return n._currentMesh=t,n.pointerEnterAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(1.1)},n.pointerOutAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(1/1.1)},n.pointerDownAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(.95)},n.pointerUpAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(1/.95)},n}return o(t,e),t.prototype._getTypeName=function(){return"TouchMeshButton3D"},t.prototype._createNode=function(e){var t=this;return this._currentMesh.getChildMeshes().forEach((function(e){t._injectGUI3DReservedDataStore(e).control=t})),this._currentMesh},t.prototype._affectMaterial=function(e){},t}(ve),nt=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._isPressed=!1,n.onToggleOnObservable=new l.Observable,n.onToggleOffObservable=new l.Observable,n.onPointerUpObservable.add((function(e){n._onToggle(e)})),n}return o(t,e),t.prototype._onToggle=function(e){this._isPressed=!this._isPressed,this._isPressed?this.onToggleOnObservable.notifyObservers(e):this.onToggleOffObservable.notifyObservers(e)},t.prototype._getTypeName=function(){return"TouchToggleButton3D"},t.prototype._createNode=function(t){return e.prototype._createNode.call(this,t)},t.prototype._affectMaterial=function(t){e.prototype._affectMaterial.call(this,t)},t.prototype.dispose=function(){this.onToggleOnObservable.clear(),this.onToggleOffObservable.clear(),e.prototype.dispose.call(this)},t}(ve),ot=function(e){function t(t,i){void 0===i&&(i=!0);var n=e.call(this,t)||this;return n._shareMaterials=i,n}return o(t,e),Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._model.renderingGroupId},set:function(e){this._model.renderingGroupId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this._material},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shareMaterials",{get:function(){return this._shareMaterials},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"HolographicBackplate"},t.prototype._createNode=function(e){var i,n=this,o=Object(l.CreateBox)((null!==(i=this.name)&&void 0!==i?i:"HolographicBackplate")+"_CollisionMesh",{width:1,height:1,depth:1},e);return o.isPickable=!0,o.visibility=0,l.SceneLoader.ImportMeshAsync(void 0,t.MODEL_BASE_URL,t.MODEL_FILENAME,e).then((function(e){var t=e.meshes[1];t.name=n.name+"_frontPlate",t.isPickable=!1,t.parent=o,n._material&&(t.material=n._material),n._model=t})),o},t.prototype._createMaterial=function(e){this._material=new De(this.name+" Material",e.getScene())},t.prototype._affectMaterial=function(e){this._shareMaterials?this._host._touchSharedMaterials.fluentBackplateMaterial?this._material=this._host._touchSharedMaterials.fluentBackplateMaterial:(this._createMaterial(e),this._host._touchSharedMaterials.fluentBackplateMaterial=this._material):this._createMaterial(e)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.shareMaterials||this._material.dispose(),this._model.dispose()},t.MODEL_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.MODEL_FILENAME="mrtk-fluent-backplate.glb",t}(rt),at=function(){function e(e){var t=this;this._customControlScaling=1,this._lastControlOver={},this._lastControlDown={},this.onPickedPointChangedObservable=new l.Observable,this.onPickingObservable=new l.Observable,this._sharedMaterials={},this._touchSharedMaterials={},this._scene=e||l.EngineStore.LastCreatedScene,this._sceneDisposeObserver=this._scene.onDisposeObservable.add((function(){t._sceneDisposeObserver=null,t._utilityLayer=null,t.dispose()})),this._utilityLayer=l.UtilityLayerRenderer._CreateDefaultUtilityLayerFromScene(this._scene),this._utilityLayer.onlyCheckPointerDownEvents=!1,this._utilityLayer.pickUtilitySceneFirst=!1,this._utilityLayer.mainSceneTrackerPredicate=function(e){var t,i,n;return e&&(null===(n=null===(i=null===(t=e.reservedDataStore)||void 0===t?void 0:t.GUI3D)||void 0===i?void 0:i.control)||void 0===n?void 0:n._node)},this._rootContainer=new le("RootContainer"),this._rootContainer._host=this;var i=this._utilityLayer.utilityLayerScene;this._pointerOutObserver=this._utilityLayer.onPointerOutObservable.add((function(e){t._handlePointerOut(e,!0)})),this._pointerObserver=i.onPointerObservable.add((function(e,i){t._doPicking(e)})),this._utilityLayer.utilityLayerScene.autoClear=!1,this._utilityLayer.utilityLayerScene.autoClearDepthAndStencil=!1,new l.HemisphericLight("hemi",l.Vector3.Up(),this._utilityLayer.utilityLayerScene)}return Object.defineProperty(e.prototype,"scene",{get:function(){return this._scene},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"utilityLayer",{get:function(){return this._utilityLayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controlScaling",{get:function(){return this._customControlScaling},set:function(e){if(this._customControlScaling!==e&&e>0){var t=e/this._customControlScaling;this._customControlScaling=e,this._rootContainer.children.forEach((function(i){i.scaling.scaleInPlace(t),1!==e&&(i._isScaledByManager=!0)}))}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useRealisticScaling",{get:function(){return this.controlScaling===e.MRTK_REALISTIC_SCALING},set:function(t){this.controlScaling=t?e.MRTK_REALISTIC_SCALING:1},enumerable:!1,configurable:!0}),e.prototype._handlePointerOut=function(e,t){var i=this._lastControlOver[e];i&&(i._onPointerOut(i),delete this._lastControlOver[e]),t&&this._lastControlDown[e]&&(this._lastControlDown[e].forcePointerUp(),delete this._lastControlDown[e]),this.onPickedPointChangedObservable.notifyObservers(null)},e.prototype._doPicking=function(e){var t,i,n;if(!this._utilityLayer||!this._utilityLayer.shouldRender||!this._utilityLayer.utilityLayerScene.activeCamera)return!1;var o=e.event,r=o.pointerId||0,a=o.button,s=e.pickInfo;if(s&&this.onPickingObservable.notifyObservers(s.pickedMesh),!s||!s.hit)return this._handlePointerOut(r,e.type===l.PointerEventTypes.POINTERUP),!1;s.pickedPoint&&this.onPickedPointChangedObservable.notifyObservers(s.pickedPoint);var _=null===(i=null===(t=s.pickedMesh.reservedDataStore)||void 0===t?void 0:t.GUI3D)||void 0===i?void 0:i.control;return _&&!_._processObservables(e.type,s.pickedPoint,(null===(n=s.originMesh)||void 0===n?void 0:n.position)||null,r,a)&&e.type===l.PointerEventTypes.POINTERMOVE&&(this._lastControlOver[r]&&this._lastControlOver[r]._onPointerOut(this._lastControlOver[r]),delete this._lastControlOver[r]),e.type===l.PointerEventTypes.POINTERUP&&(this._lastControlDown[o.pointerId]&&(this._lastControlDown[o.pointerId].forcePointerUp(),delete this._lastControlDown[o.pointerId]),"touch"===o.pointerType&&this._handlePointerOut(r,!1)),!0},Object.defineProperty(e.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),e.prototype.containsControl=function(e){return this._rootContainer.containsControl(e)},e.prototype.addControl=function(e){return this._rootContainer.addControl(e),1!==this._customControlScaling&&(e.scaling.scaleInPlace(this._customControlScaling),e._isScaledByManager=!0),this},e.prototype.removeControl=function(e){return this._rootContainer.removeControl(e),e._isScaledByManager&&(e.scaling.scaleInPlace(1/this._customControlScaling),e._isScaledByManager=!1),this},e.prototype.dispose=function(){for(var e in this._rootContainer.dispose(),this._sharedMaterials)this._sharedMaterials.hasOwnProperty(e)&&this._sharedMaterials[e].dispose();for(var e in this._sharedMaterials={},this._touchSharedMaterials)this._touchSharedMaterials.hasOwnProperty(e)&&this._touchSharedMaterials[e].dispose();this._touchSharedMaterials={},this._pointerOutObserver&&this._utilityLayer&&(this._utilityLayer.onPointerOutObservable.remove(this._pointerOutObserver),this._pointerOutObserver=null),this.onPickedPointChangedObservable.clear(),this.onPickingObservable.clear();var t=this._utilityLayer?this._utilityLayer.utilityLayerScene:null;t&&this._pointerObserver&&(t.onPointerObservable.remove(this._pointerObserver),this._pointerObserver=null),this._scene&&this._sceneDisposeObserver&&(this._scene.onDisposeObservable.remove(this._sceneDisposeObserver),this._sceneDisposeObserver=null),this._utilityLayer&&this._utilityLayer.dispose()},e.MRTK_REALISTIC_SCALING=.032,e}()},function(e,t,i){"use strict";i.r(t),function(e){var n=i(1);i.d(t,"Button",(function(){return n.Button})),i.d(t,"Checkbox",(function(){return n.Checkbox})),i.d(t,"ColorPicker",(function(){return n.ColorPicker})),i.d(t,"Container",(function(){return n.Container})),i.d(t,"Control",(function(){return n.Control})),i.d(t,"Ellipse",(function(){return n.Ellipse})),i.d(t,"FocusableButton",(function(){return n.FocusableButton})),i.d(t,"Grid",(function(){return n.Grid})),i.d(t,"Image",(function(){return n.Image})),i.d(t,"InputText",(function(){return n.InputText})),i.d(t,"InputPassword",(function(){return n.InputPassword})),i.d(t,"Line",(function(){return n.Line})),i.d(t,"MultiLine",(function(){return n.MultiLine})),i.d(t,"RadioButton",(function(){return n.RadioButton})),i.d(t,"StackPanel",(function(){return n.StackPanel})),i.d(t,"SelectorGroup",(function(){return n.SelectorGroup})),i.d(t,"CheckboxGroup",(function(){return n.CheckboxGroup})),i.d(t,"RadioGroup",(function(){return n.RadioGroup})),i.d(t,"SliderGroup",(function(){return n.SliderGroup})),i.d(t,"SelectionPanel",(function(){return n.SelectionPanel})),i.d(t,"ScrollViewer",(function(){return n.ScrollViewer})),i.d(t,"TextWrapping",(function(){return n.TextWrapping})),i.d(t,"TextBlock",(function(){return n.TextBlock})),i.d(t,"TextWrapper",(function(){return n.TextWrapper})),i.d(t,"ToggleButton",(function(){return n.ToggleButton})),i.d(t,"KeyPropertySet",(function(){return n.KeyPropertySet})),i.d(t,"VirtualKeyboard",(function(){return n.VirtualKeyboard})),i.d(t,"Rectangle",(function(){return n.Rectangle})),i.d(t,"DisplayGrid",(function(){return n.DisplayGrid})),i.d(t,"BaseSlider",(function(){return n.BaseSlider})),i.d(t,"Slider",(function(){return n.Slider})),i.d(t,"ImageBasedSlider",(function(){return n.ImageBasedSlider})),i.d(t,"ScrollBar",(function(){return n.ScrollBar})),i.d(t,"ImageScrollBar",(function(){return n.ImageScrollBar})),i.d(t,"name",(function(){return n.name})),i.d(t,"AdvancedDynamicTexture",(function(){return n.AdvancedDynamicTexture})),i.d(t,"AdvancedDynamicTextureInstrumentation",(function(){return n.AdvancedDynamicTextureInstrumentation})),i.d(t,"Vector2WithInfo",(function(){return n.Vector2WithInfo})),i.d(t,"Matrix2D",(function(){return n.Matrix2D})),i.d(t,"Measure",(function(){return n.Measure})),i.d(t,"MultiLinePoint",(function(){return n.MultiLinePoint})),i.d(t,"Style",(function(){return n.Style})),i.d(t,"ValueAndUnit",(function(){return n.ValueAndUnit})),i.d(t,"XmlLoader",(function(){return n.XmlLoader})),i.d(t,"AbstractButton3D",(function(){return n.AbstractButton3D})),i.d(t,"Button3D",(function(){return n.Button3D})),i.d(t,"Container3D",(function(){return n.Container3D})),i.d(t,"Control3D",(function(){return n.Control3D})),i.d(t,"CylinderPanel",(function(){return n.CylinderPanel})),i.d(t,"HolographicButton",(function(){return n.HolographicButton})),i.d(t,"HolographicSlate",(function(){return n.HolographicSlate})),i.d(t,"HandMenu",(function(){return n.HandMenu})),i.d(t,"MeshButton3D",(function(){return n.MeshButton3D})),i.d(t,"NearMenu",(function(){return n.NearMenu})),i.d(t,"PlanePanel",(function(){return n.PlanePanel})),i.d(t,"ScatterPanel",(function(){return n.ScatterPanel})),i.d(t,"Slider3D",(function(){return n.Slider3D})),i.d(t,"SpherePanel",(function(){return n.SpherePanel})),i.d(t,"StackPanel3D",(function(){return n.StackPanel3D})),i.d(t,"TouchButton3D",(function(){return n.TouchButton3D})),i.d(t,"TouchMeshButton3D",(function(){return n.TouchMeshButton3D})),i.d(t,"TouchHolographicButton",(function(){return n.TouchHolographicButton})),i.d(t,"TouchHolographicMenu",(function(){return n.TouchHolographicMenu})),i.d(t,"TouchToggleButton3D",(function(){return n.TouchToggleButton3D})),i.d(t,"VolumeBasedPanel",(function(){return n.VolumeBasedPanel})),i.d(t,"HolographicBackplate",(function(){return n.HolographicBackplate})),i.d(t,"FluentMaterialDefines",(function(){return n.FluentMaterialDefines})),i.d(t,"FluentMaterial",(function(){return n.FluentMaterial})),i.d(t,"FluentButtonMaterial",(function(){return n.FluentButtonMaterial})),i.d(t,"FluentBackplateMaterial",(function(){return n.FluentBackplateMaterial})),i.d(t,"HandleMaterial",(function(){return n.HandleMaterial})),i.d(t,"MRDLSliderBarMaterial",(function(){return n.MRDLSliderBarMaterial})),i.d(t,"MRDLSliderThumbMaterial",(function(){return n.MRDLSliderThumbMaterial})),i.d(t,"MRDLBackplateMaterial",(function(){return n.MRDLBackplateMaterial})),i.d(t,"SlateGizmo",(function(){return n.SlateGizmo})),i.d(t,"HandleState",(function(){return n.HandleState})),i.d(t,"GizmoHandle",(function(){return n.GizmoHandle})),i.d(t,"SideHandle",(function(){return n.SideHandle})),i.d(t,"CornerHandle",(function(){return n.CornerHandle})),i.d(t,"GUI3DManager",(function(){return n.GUI3DManager})),i.d(t,"Vector3WithInfo",(function(){return n.Vector3WithInfo}));var o=void 0!==e?e:"undefined"!=typeof window?window:void 0;void 0!==o&&(o.BABYLON=o.BABYLON||{},o.BABYLON.GUI=n)}.call(this,i(3))},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i}]))}).call(this,n(29))}}]);