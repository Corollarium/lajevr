(window.webpackJsonp=window.webpackJsonp||[]).push([[13,16],{194:function(e,t,n){"use strict";n.r(t);var r={data:function(){return{headerOverlay:!1,head:{title:"",description:""}}},watch:{headerOverlay:function(e,t){this.$root.$emit("headerOverlay",e)}},mounted:function(){this.$root.$emit("headerOverlay",this.headerOverlay)},head:function(){return{title:this.head.title,meta:[{hid:"description",name:"description",content:this.head.description}]}}},o=n(4),component=Object(o.a)(r,(function(){var e=this.$createElement;return(this._self._c||e)("div")}),[],!1,null,null,null);t.default=component.exports},211:function(e,t,n){"use strict";n(35),n(15),n(21),n(38),n(36),n(37);var r=n(95),o=n(96),c=(n(27),n(193));function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var h=function(){function e(t,n,o){Object(r.a)(this,e),this.id=t,this.position=n,this.velocity=o,this.force=new c.Vector3(0,0,0)}return Object(o.a)(e,[{key:"orientation",get:function(){return this.velocity.normalize()}}]),e}(),f=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(r.a)(this,e),this.cohesion=.3,this.separation=.4,this.alignment=1,this.separationMinDistance=3,this.maxSpeed=1,this.boundsMin=new c.Vector3(n.x-l,n.y-l,n.z-l),this.boundsMax=new c.Vector3(n.x+l,n.y+l,n.z+l),this.calculateBounds(),this.otherForces=[],this.boids=[],this.debug={show:!1,influences:[],arrows:[]},this.center=n.clone(),this.avgVel=new c.Vector3(0,0,0),this.reset(t,o,d)}return Object(o.a)(e,[{key:"reset",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n||(n=new c.Vector3(.3,0,.3)),this.boids=[];for(var r=n.length(),i=0;i<e;i++){var o=this.center.add(new c.Vector3((Math.random()-.5)*t,(Math.random()-.5)*t,(Math.random()-.5)*t)),l=new c.Vector3(n.x+(Math.random()-.5)/10*r,n.y+(Math.random()-.5)/10*r,n.z+(Math.random()-.5)/10*r),d=new h(i,o,l);this.boids.push(d)}}},{key:"calculateBounds",value:function(){this.sizeVector=new c.Vector3(Math.abs(this.boundsMax.x-this.boundsMin.x),Math.abs(this.boundsMax.y-this.boundsMin.y),Math.abs(this.boundsMax.z-this.boundsMin.z))}},{key:"update",value:function(e){var t=this;this._updateCenter(),this.boids.forEach((function(n){var r=t._forceCentreMass(n),o=t._forceSeparation(n),c=t._forceMatchVelocity(n),l=t._forceBoundaries(n),d=r.add(o).add(c).add(l);t.otherForces.forEach((function(e){d.add(e(t,n))})),n.force.copyFrom(d),n.velocity.addInPlace(d.scale(e)),n.position.addInPlace(n.velocity.scale(e))})),this._updateDebug()}},{key:"_updateCenter",value:function(){if(this.boids.length){var e=new c.Vector3(0,0,0),t=new c.Vector3(0,0,0);this.boids.forEach((function(n){e.addInPlace(n.position),t.addInPlace(n.velocity)})),e.scaleInPlace(1/this.boids.length),t.scaleInPlace(1/this.boids.length),this.center=e,this.avgVel=t}}},{key:"_forceCentreMass",value:function(e){return this.center.subtract(e.position).scale(this.cohesion)}},{key:"_forceSeparation",value:function(e){var t=this,n=new c.Vector3(0,0,0);return this.boids.forEach((function(r){if(e.id!==r.id){var o=e.position.subtract(r.position),c=o.length();c<t.separationMinDistance&&n.addInPlace(o.scale(t.separationMinDistance-c))}})),n.scale(this.separation)}},{key:"_forceMatchVelocity",value:function(e){return this.avgVel.subtract(e.velocity).scale(this.alignment)}},{key:"_forceBoundaries",value:function(e){var t=new c.Vector3(0,0,0),n=.04;return e.position.x<this.boundsMin.x+.1*this.sizeVector.x?t.x=n:e.position.x>this.boundsMax.x-.1*this.sizeVector.x&&(t.x=-.04),e.position.y<this.boundsMin.y+.1*this.sizeVector.y?t.y=n:e.position.y>this.boundsMax.y-.1*this.sizeVector.y&&(t.y=-.04),e.position.z<this.boundsMin.z+.1*this.sizeVector.z?t.z=n:e.position.z>this.boundsMax.z-.1*this.sizeVector.z&&(t.z=-.04),t}},{key:"addForce",value:function(e){this.otherForces.push(e)}},{key:"showDebug",value:function(e){if(!this.debug.show){var t=new c.StandardMaterial("debug_center",e);t.diffuseColor=c.Color3.FromHexString("#FF00FF"),this.debug.center=c.MeshBuilder.CreateSphere("center",{diameter:.1,segments:8}),this.debug.center.material=t;var n=new c.StandardMaterial("debug_bbox",e);n.emissiveColor=c.Color3.FromHexString("#00FF00"),n.disableLighting=!0,n.wireframe=!0,this.debug.bbox=c.MeshBuilder.CreateBox("boids_bbox",{},e),this.debug.bbox.scaling.x=Math.abs(this.boundsMax.x-this.boundsMin.x),this.debug.bbox.scaling.y=Math.abs(this.boundsMax.y-this.boundsMin.y),this.debug.bbox.scaling.z=Math.abs(this.boundsMax.z-this.boundsMin.z),this.debug.bbox.position=this.boundsMin.add(this.boundsMax.subtract(this.boundsMin).scale(.5)),this.debug.bbox.material=n;var r=new c.StandardMaterial("debug_wireframe",e);r.diffuseColor=c.Color3.FromHexString("#FFFFFF"),r.wireframe=!0;var o,i=0,d=l(this.boids);try{for(d.s();!(o=d.n()).done;){var h=o.value;h.debug={},h.debug.force=c.MeshBuilder.CreateTube("boid_arrow_".concat(i),{path:[h.position.add(h.velocity),h.position.clone()],radius:.01,updatable:!0},e),h.debug.influence=c.MeshBuilder.CreateSphere("boid_influence_".concat(i),{diameter:1,segments:8}),h.debug.influence.scaling.setAll(this.separationMinDistance),h.debug.influence.material=r,i++}}catch(e){d.e(e)}finally{d.f()}this.debug.show=!0,this._updateDebug()}}},{key:"hideDebug",value:function(e){this.debug.show=!1,this.debug.center=void 0;var t,n=l(this.boids);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.debug&&(r.debug.force.dispose(),r.debug.influence.dispose(),r.debug={})}}catch(e){n.e(e)}finally{n.f()}}},{key:"_updateDebug",value:function(){if(this.debug.show){this.debug.center.position.copyFrom(this.center);var e,t=l(this.boids);try{for(t.s();!(e=t.n()).done;){var n=e.value,path=[n.position.add(n.velocity.scale(10)),n.position.clone()];n.debug.force=c.MeshBuilder.CreateTube(n.debug.force.name,{path:path,radius:.01,instance:n.debug.force}),n.debug.influence.position.copyFrom(n.position)}}catch(e){t.e(e)}finally{t.f()}}}},{key:"gui",value:function(e){var t=this,n=c.GUI,r=n.AdvancedDynamicTexture.CreateFullscreenUI("UI",void 0,void 0,e),o=new n.StackPanel;o.width="220px",o.horizontalAlignment=n.Control.HORIZONTAL_ALIGNMENT_RIGHT,o.verticalAlignment=n.Control.VERTICAL_ALIGNMENT_CENTER,r.addControl(o);var l=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},header=new n.TextBlock;header.text="".concat(e," ").concat(t[e]),header.height="30px",header.color="white",o.addControl(header);var l=new n.Slider;l.minimum=0,l.maximum=r,l.value=t[e],l.height="20px",l.width="200px";var d=function(e,header,t){return function(n){e[t]=n,header.text="".concat(t," ").concat(n),c.apply(e)}}(t,header,e);l.onValueChangedObservable.add(d),o.addControl(l)};l("cohesion",1.5),l("separation"),l("alignment"),l("separationMinDistance",50,(function(e){t.debug.center&&t.boids.forEach((function(e){e.debug.influence.scaling.setAll(t.separationMinDistance)}))}));var header=new n.TextBlock;header.text="show debug helpers",header.height="30px",header.color="white",o.addControl(header);var d=new n.Checkbox;d.width="20px",d.height="20px",d.isChecked=this.debug.show,d.color="green",d.onIsCheckedChangedObservable.add((function(n){n?t.showDebug(e):t.hideDebug(e)})),o.addControl(d)}}]),e}();t.a=f},212:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));n(213);var r=n(95),o=n(96),c=n(221),l=n(222),d=n(214),h=n(193);function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var o=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var v=function(e){Object(c.a)(n,e);var t=f(n);function n(e,o){var c,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(r.a)(this,n),(c=t.call(this,e,"/oceanPostProcess",["time","fov","resolution","cameraPosition","cameraRotation","worldScale","lightDirection"],["positionSampler","reflectionSampler","refractionSampler","skyTexture"],{width:l.width||o.getEngine().getRenderWidth(),height:l.height||o.getEngine().getRenderHeight()},l.isPipeline?null:o,h.Texture.TRILINEAR_SAMPLINGMODE,o.getEngine(),!1))._time=0,c.worldScale=1,c._cameraRotation=h.Vector3.Zero(),c._cameraViewMatrix=h.Matrix.Identity(),c._reflectionEnabled=!1,c._refractionEnabled=!1,c._skyTexture=null,c._camera=o,c._options=l,c.reflectionTexture=null,c.refractionTexture=null,c._geometryRenderer=o.getScene().enableGeometryBufferRenderer(1),c.light="light"in l?l.light:null,c._geometryRenderer&&c._geometryRenderer.isSupported?c._geometryRenderer.enablePosition=!0:c.updateEffect("#define NOT_SUPPORTED\n"),c.onApply=function(e){if(c._geometryRenderer&&c._geometryRenderer.isSupported){var t=o.getEngine(),n=o.getScene();c._time+=.001*t.getDeltaTime(),e.setFloat("time",c._time);e.setVector2("resolution",new h.Vector2(t.getRenderWidth()/1,t.getRenderHeight()/1)),n&&(e.setVector3("cameraPosition",o.globalPosition),c._computeCameraRotation(o),e.setVector3("cameraRotation",c._cameraRotation),e.setVector3("lightDirection",c.light?c.light.direction:new h.Vector3(.2,-1,0)),e.setFloat("fov",o.fov),e.setFloat("worldScale",c.worldScale),e.setTexture("positionSampler",c._geometryRenderer.getGBuffer().textures[2]),c._reflectionEnabled&&e.setTexture("reflectionSampler",c.reflectionTexture),c._refractionEnabled&&e.setTexture("refractionSampler",c.refractionTexture),c._skyTexture&&e.setTexture("skyTexture",c._skyTexture))}},c}return Object(o.a)(n,[{key:"reflectionEnabled",get:function(){return this._reflectionEnabled},set:function(e){if(this._reflectionEnabled!==e){this._reflectionEnabled=e,e&&!this.reflectionTexture&&(this.reflectionTexture=new h.MirrorTexture("oceanPostProcessReflection",this._options.reflectionSize||{width:512,height:512},this._camera.getScene()),this.reflectionTexture.mirrorPlane=h.Plane.FromPositionAndNormal(h.Vector3.Zero(),new h.Vector3(0,-1,0))),this.updateEffect(this._getDefines());var t=this.getCamera().getScene().customRenderTargets;if(e)t.push(this.reflectionTexture);else{var n=t.indexOf(this.reflectionTexture);-1!==n&&t.splice(n,1)}}}},{key:"refractionEnabled",get:function(){return this._refractionEnabled},set:function(e){if(this._refractionEnabled!==e){this._refractionEnabled=e,e&&!this.refractionTexture&&(this.refractionTexture=new h.RenderTargetTexture("oceanPostProcessRefraction",this._options.refractionSize||{width:512,height:512},this._camera.getScene())),this.updateEffect(this._getDefines());var t=this.getCamera().getScene().customRenderTargets;if(e)t.push(this.refractionTexture);else{var n=t.indexOf(this.refractionTexture);-1!==n&&t.splice(n,1)}}}},{key:"skyTexture",set:function(e){this._skyTexture=e,this.updateEffect(this._getDefines())}},{key:"isSupported",get:function(){return null!==this._geometryRenderer&&this._geometryRenderer.isSupported}},{key:"_getDefines",value:function(){var e=[];return this._reflectionEnabled&&e.push("#define REFLECTION_ENABLED"),this._refractionEnabled&&e.push("#define REFRACTION_ENABLED"),this._skyTexture&&e.push("#define SKY_ENABLED"),e.join("\n")}},{key:"_computeCameraRotation",value:function(e){e.upVector.normalize();var t=e.getTarget();e._initialFocalDistance=t.subtract(e.position).length(),e.position.z===t.z&&(e.position.z+=h.Epsilon);var n=t.subtract(e.position);e._viewMatrix.invertToRef(this._cameraViewMatrix),this._cameraRotation.x=Math.atan(this._cameraViewMatrix.m[6]/this._cameraViewMatrix.m[10]),n.x>=0?this._cameraRotation.y=-Math.atan(n.z/n.x)+Math.PI/2:this._cameraRotation.y=-Math.atan(n.z/n.x)-Math.PI/2,this._cameraRotation.z=0,isNaN(this._cameraRotation.x)&&(this._cameraRotation.x=0),isNaN(this._cameraRotation.y)&&(this._cameraRotation.y=0),isNaN(this._cameraRotation.z)&&(this._cameraRotation.z=0)}}]),n}(h.PostProcess)},249:function(e,t,n){var content=n(339);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(34).default)("72bc25af",content,!0,{sourceMap:!1})},334:function(e,t,n){"use strict";n.r(t),t.default="#ifdef CAUSTIC\n\n#define TAU 6.28318530718\n#define MAX_ITER 5\n#define SPEED 0.3\n#define SCALE 30.0\n#define FOG_DENSITY 2.2\n#define FOG_DISTANCE_CORRECTION 2.5 // move the far plane closer\nconst vec3 COLOR_INFINITE = vec3(0.0, 0.5, 0.85);\n\n#define csb(f, con, sat, bri) mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), f*bri)), f*bri, sat), con)\n\nfloat fogFactorExp(\n  const float dist,\n  const float density\n) {\n  return 1.0 - clamp(exp2(-density * dist), 0.0, 1.0);\n}\n\nvec4 caustic(vec2 uv) {\n  vec2 p = mod(uv*TAU, TAU)-250.0;\n  float t = time * SPEED + 23.0;\n\n  vec2 i = vec2(p);\n  float c = 1.0;\n  float inten = .005;\n\n  for (int n = 0; n < MAX_ITER; n++) {\n    float t = t * (1.0 - (3.5 / float(n+1)));\n    i = p + vec2(cos(t - i.x) + sin(t + i.y), sin(t - i.y) + cos(t + i.x));\n    c += 1.0/length(vec2(p.x / (sin(i.x+t)/inten),p.y / (cos(i.y+t)/inten)));\n  }\n\n  c /= float(MAX_ITER);\n  c = 1.17-pow(c, 1.4);\n  vec3 color = vec3(pow(abs(c), 8.0));\n  color = clamp(color + vec3(0.0, 0.0, 0.0), 0.0, 1.0);\n\n  float alpha=0.5;\n  float contrast=0.0;\n  color = mix(color, vec3(1.0,1.0,1.0),contrast);\n  //color.a = alpha;\n  vec4 color4 = vec4(color,0.0);\n\n  return color4;\n}\n\n\n#endif\n"},335:function(e,t,n){"use strict";n.r(t),t.default="#define CAUSTIC_FOG\n\n#ifdef CAUSTIC\n\n  if (vPositionW.y < 0.0) {\n    float normalizedDistance = (gl_FragCoord.z / gl_FragCoord.w) / 100.0;\n    vec4 causticFinalColor = gl_FragColor;\n\n    // calculate the caustic\n    if (vNormalW.y > 0.0) {\n      vec2 causticCoord = vec2(fract(vPositionW.x/SCALE), fract(vPositionW.z/SCALE));\n      // scale by normal to make caustic less pronounced for more vertical faces.\n      vec4 caustic = clamp(caustic(causticCoord), 0.0, 1.0) * vNormalW.y;\n\n      causticFinalColor.rgb = mix(causticFinalColor.rgb, caustic.rgb, clamp(caustic.a * 0.5 * normalizedDistance, 0.2, 0.7)); // caustics + texture\n    }\n\n#ifdef CAUSTIC_FOG\n    float fogFactor = clamp(\n      fogFactorExp(normalizedDistance, FOG_DENSITY * FOG_DISTANCE_CORRECTION),\n      0.0,\n      1.0\n    );\n    causticFinalColor.rgb = mix(\n      causticFinalColor.rgb,\n      COLOR_INFINITE,\n      fogFactor\n    );\n#endif\n    // color, saturation, brightness\n    gl_FragColor.rgb = causticFinalColor.rgb;\n    // gl_FragColor.rgb = csb(causticFinalColor.rgb, 1.1, 1.05, 1.22);\n\n  }\n#endif\n"},336:function(e,t,n){"use strict";n.r(t),t.default="#ifdef CAUSTIC\n\n\n#endif\n"},337:function(e,t,n){"use strict";n.r(t),t.default="#ifdef CAUSTIC\n#endif\n"},338:function(e,t,n){"use strict";n(249)},339:function(e,t,n){var r=n(33)(!1);r.push([e.i,"#underwater[data-v-4193fcb0]{height:100vh;width:100%;position:relative}#underwater-3d[data-v-4193fcb0]{height:100vh;width:100vw}#underwater-debug[data-v-4193fcb0]{left:0;z-index:1000}#underwater-debug[data-v-4193fcb0],#underwater-hud[data-v-4193fcb0]{position:absolute;top:0;padding:10px;border-radius:10px;background:#000;color:#fff;text-align:right}#underwater-hud[data-v-4193fcb0]{right:0;width:160px;height:220px;z-index:10;font-family:monospace}@media (max-width:640px){#underwater-hud[data-v-4193fcb0]{width:120px;height:160px}}#underwater-hud span[data-v-4193fcb0]{display:inline-block}#underwater-hud #underwater-hud-compass[data-v-4193fcb0],#underwater-hud #underwater-hud-time[data-v-4193fcb0]{margin-top:10px}#underwater-hud #underwater-hud-compass-value[data-v-4193fcb0],#underwater-hud #underwater-hud-depth-value[data-v-4193fcb0],#underwater-hud #underwater-hud-time-value[data-v-4193fcb0]{line-height:.9;font-size:42px;font-family:monospace}@media (max-width:640px){#underwater-hud #underwater-hud-compass-value[data-v-4193fcb0],#underwater-hud #underwater-hud-depth-value[data-v-4193fcb0],#underwater-hud #underwater-hud-time-value[data-v-4193fcb0]{font-size:24px}}#underwater-hud #underwater-hud-depth-ascent[data-v-4193fcb0]{-ms-writing-mode:tb-rl;writing-mode:vertical-rl}#underwater-hud #underwater-hud-compass-name[data-v-4193fcb0],#underwater-hud #underwater-hud-depth-name[data-v-4193fcb0],#underwater-hud #underwater-hud-time-name[data-v-4193fcb0]{color:#4c70ff}#underwater-hud #underwater-hud-depth-unit[data-v-4193fcb0],#underwater-hud #underwater-hud-time-unit[data-v-4193fcb0]{vertical-align:top}.button-giant[data-v-4193fcb0]{line-height:1.2em;border-radius:10px;font-size:32px;background:#004;color:#fff;text-align:center;padding:14px}#underwater-fullscreen[data-v-4193fcb0]{position:absolute;top:20px;left:0;margin:0;z-index:1;max-width:80%}#underwater-instructions[data-v-4193fcb0]{position:absolute;top:0;left:0;bottom:0;right:0;z-index:1000;color:#fff;display:flex;justify-content:center;align-items:center;background-color:rgba(0,0,0,.4);flex-direction:column;text-align:center;padding:20px}#underwater-instructions p[data-v-4193fcb0]{font-size:200%}#underwater-settings[data-v-4193fcb0]{position:absolute;bottom:0;right:0;padding:10px;z-index:1000;color:#fff;text-align:right}#underwater-settings svg[data-v-4193fcb0]{cursor:pointer}",""]),e.exports=r},421:function(e,t,n){"use strict";n.r(t);var r=n(6);n(44);function o(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function c(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((r=r.apply(e,t||[])).next())}))}const c=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","radeon r9 200","sgx 543","sgx543"],l=e=>e.toLowerCase().replace(/^angle ?\((.+)\)*$/,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,""),d="undefined"==typeof window,h=(()=>{if(d)return;const{userAgent:e,platform:t,maxTouchPoints:n}=window.navigator,r=/(iphone|ipod|ipad)/i.test(e),a="iPad"===t||"MacIntel"===t&&n>0&&!window.MSStream;return{isIpad:a,isMobile:/android/i.test(e)||r||a,isSafari12:/Version\/12.+Safari/.test(e)}})(),f=[],v=[],m=(e,t)=>{if(e===t)return 0;const n=e;e.length>t.length&&(e=t,t=n);let r=e.length,o=t.length;for(;r>0&&e.charCodeAt(~-r)===t.charCodeAt(~-o);)r--,o--;let a,c=0;for(;c<r&&e.charCodeAt(c)===t.charCodeAt(c);)c++;if(r-=c,o-=c,0===r)return o;let l,d,s=0,g=0,p=0;for(;g<r;)v[g]=e.charCodeAt(c+g),f[g]=++g;for(;p<o;)for(a=t.charCodeAt(c+p),l=p++,s=p,g=0;g<r;g++)d=a===v[g]?l:l+1,l=f[g],s=f[g]=l>s?d>s?s+1:d:d>l?l+1:d;return s},C=({mobileTiers:i=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:t={},glContext:n,failIfMajorPerformanceCaveat:s=!1,benchmarksURL:g="https://unpkg.com/detect-gpu@3.1.27/dist/benchmarks"}={})=>o(void 0,void 0,void 0,(function*(){const p={};if(d)return{tier:0,type:"SSR"};const{isIpad:u=!!(null==h?void 0:h.isIpad),isMobile:r=!!(null==h?void 0:h.isMobile),screenSize:f=window.screen,loadBenchmarks:v=(e=>o(void 0,void 0,void 0,(function*(){const t=yield fetch(`${g}/${e}`).then((e=>e.json()));return t.shift(),t})))}=t;let{renderer:C}=t;const w=(e,t,n,o,c)=>({device:c,fps:o,gpu:n,isMobile:r,tier:e,type:t});let M,y="";if(C)C=l(C),M=[C];else{const e=n||((e,t=!1)=>{const n={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:t,powerPreference:"high-performance",stencil:!1};e&&delete n.powerPreference;const r=window.document.createElement("canvas"),o=r.getContext("webgl",n)||r.getContext("experimental-webgl",n);return null!=o?o:void 0})(null==h?void 0:h.isSafari12,s);if(!e)return w(0,"WEBGL_UNSUPPORTED");const t=e.getExtension("WEBGL_debug_renderer_info");if(t&&(C=e.getParameter(t.UNMASKED_RENDERER_WEBGL)),!C)return w(1,"FALLBACK");y=C,C=l(C),M=((e,t,n)=>"apple gpu"===t?((e,t,n)=>{let r=[t];if(n){const t="\n      precision highp float;\n      attribute vec3 aPosition;\n      varying float vvv;\n      void main() {\n        vvv = 0.31622776601683794;\n        gl_Position = vec4(aPosition, 1.0);\n      }\n    ",n="\n      precision highp float;\n      varying float vvv;\n      void main() {\n        vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;\n        enc = fract(enc);\n        enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n        gl_FragColor = enc;\n      }\n    ",a=e.createShader(35633),i=e.createShader(35632),o=e.createProgram();if(i&&a&&o){e.shaderSource(a,t),e.shaderSource(i,n),e.compileShader(a),e.compileShader(i),e.attachShader(o,a),e.attachShader(o,i),e.linkProgram(o),e.detachShader(o,a),e.detachShader(o,i),e.deleteShader(a),e.deleteShader(i),e.useProgram(o);const c=e.createBuffer();e.bindBuffer(34962,c),e.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const l=e.getAttribLocation(o,"aPosition");e.vertexAttribPointer(l,3,5126,!1,0,0),e.enableVertexAttribArray(l),e.clearColor(1,1,1,1),e.clear(16384),e.viewport(0,0,1,1),e.drawArrays(4,0,3);const d=new Uint8Array(4);e.readPixels(0,0,1,1,6408,5121,d),e.deleteProgram(o),e.deleteBuffer(c),r={801621810:(null==h?void 0:h.isIpad)?["apple a12x gpu"]:["apple a11 gpu","apple a12 gpu","apple a13 gpu","apple a14 gpu"],8016218135:(null==h?void 0:h.isIpad)?["apple a9x gpu","apple a10 gpu","apple a10x gpu"]:["apple a9 gpu","apple a10 gpu"]}[d.join("")]||r}}return r})(e,t,n):[t])(e,C,r)}const b=(yield Promise.all(M.map((e=>o(void 0,void 0,void 0,(function*(){const t=(e=>{const t=r?["adreno","apple","mali-t","mali","nvidia","powervr"]:["intel","amd","radeon","nvidia","geforce"];for(const n of t)if(e.includes(n))return n})(e);if(!t)return;const n=`${r?"m":"d"}-${t}.json`,o=p[n]=p[n]||v(n);let c;try{c=yield o}catch(t){return}const a=(e=>{var t;const n=(e=e.replace(/\([^)]+\)/,"")).match(/\d+/)||e.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return null!==(t=null==n?void 0:n.join("").replace(/\W|amd/g,""))&&void 0!==t?t:""})(e),i="apple"===t;let l=c.filter((([,e])=>e===a));l.length||(l=c.filter((([t])=>t.includes(e))));const d=l.length;if(0===d)return;let h,[s,,,g]=d>1?l.map((t=>[t,m(e,t[0])])).sort((([,e],[,t])=>e-t))[0][0]:l[0],C=Number.MAX_VALUE;const{devicePixelRatio:w}=window,M=f.width*w*(f.height*w);i&&r&&(g=g.filter((([,,,e])=>{var t;return(null!==(t=null==e?void 0:e.indexOf(u?"ipad":"iphone"))&&void 0!==t?t:-1)>-1})));for(const e of g){const[t,n]=e,r=t*n,o=Math.abs(M-r);o<C&&(C=o,h=e)}if(!h)return;const[,,y,b]=h;return[C,y,s,b]})))))).filter((e=>!!e));if(!b.length){const e=c.find((e=>C.includes(e)));return e?w(0,"BLOCKLISTED",e):w(1,"FALLBACK",`${C} (${y})`)}const[,x,_,T]=b.sort((([e=Number.MAX_VALUE],[t=Number.MAX_VALUE])=>e-t))[0];if(-1===x)return w(0,"BLOCKLISTED",_,x,T);const S=r?i:e;let E=0;for(let e=0;e<S.length;e++)x>=S[e]&&(E=e);return w(E,"BENCHMARK",_,x,T)}));var w=n(194),M=(n(213),n(21),n(38),n(95)),y=n(96),x=n(221),_=n(222),T=n(214),S=(n(36),n(15),n(37),n(35),n(40),n(27),n(39),n(70),n(71),n(210),n(193)),E=(n(206),n(247)),A=n(212),P=n(211);function I(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(T.a)(e);if(t){var o=Object(T.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(_.a)(this,n)}}var z=n(334),O=n(335),N=n(336),L=n(337),F=function(e,t,n){return new S.Vector3(e,t,n)},B=function(e){Object(x.a)(n,e);var t=R(n);function n(e){var r;return Object(M.a)(this,n),(r=t.call(this,e,"Caustic",200,{CAUSTIC:!0,NORMAL:!0}))._isEnabled=!1,r.markAllAsDirty=e._dirtyCallbacks[S.Constants.MATERIAL_AllDirtyFlag],r}return Object(y.a)(n,[{key:"isEnabled",get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,this._enable(this._isEnabled))}},{key:"prepareDefines",value:function(e,t,n){e.CAUSTIC=this._isEnabled,e.NORMAL|=this._isEnabled}},{key:"getClassName",value:function(){return"CausticPluginMaterial"}},{key:"getUniforms",value:function(){return{ubo:[{name:"time",size:1,type:"float"}],fragment:"#ifdef CAUSTIC\n            uniform float time;\n        #endif"}}},{key:"bindForSubMesh",value:function(e,t,r,o){this._isEnabled&&e.updateFloat("time",n.time)}},{key:"getCustomCode",value:function(e){return"fragment"===e?{CUSTOM_FRAGMENT_DEFINITIONS:z.default,CUSTOM_FRAGMENT_MAIN_END:O.default}:"vertex"===e?{CUSTOM_VERTEX_DEFINITIONS:N.default,CUSTOM_VERTEX_MAIN_END:L.default}:null}}]),n}(S.MaterialPluginBase);B.time=0;var D=function(){function e(t){var n=this;Object(M.a)(this,e),this.base="",this.engine=null,this.scene=null,this.camera=null,this.assetsManager=null,this.sunLight=null,this.oceanPostProcess=null,this.rebuildOceanTexture=!0,this.audioDiver=null,this.audioOcean=null,this.debugState=!1,this.turtles=[],this.animTour=null,S.GUI=E;var r=document.getElementById("underwater-3d");document.onfullscreenchange=function(e){t.isFullscreen=!!document.fullscreenElement},this.base=t.base,this.bootScene(r,t),this.lights(),this.materials(),this.composer();var o=[this.loadTerrain(),this.loadMoreiaBarco(),this.loadDiverBoat(),this.loadTurtle()],c=this.loadBoidsModel(this.base+"models/","sargentinho.glb",30,new S.Vector3(-33.12,-17.2,12.19),new S.Vector3(-2.12,-7.2,42.19),[{from:1,to:30,name:"swim"}]);o.push(c.promise),Promise.all(o).then((function(){console.log("all loaded")})),this.assetsManager.load(),t.$route.query.debug&&(this.debugState=!0,this.camera.speed=.5,this.debugUtils(),S.Engine.audioEngine.setGlobalVolume(0));var l=new Date,d=!1,h=0;this.engine.runRenderLoop((function(){var e=(new Date-l)/1e3,r=n.engine.getDeltaTime()/1e3;n.camera.position.y>.6&&(n.camera.position.y=.6);var o=n.camera.position.y<=0;if(d!==o&&(d=o),h++%8&&(t.depth=d?(-n.camera.position.y).toFixed(1):0,t.time=e,t.ascentSpeed=(n.camera.position.y-n.lastDepth)/r,t.orientationDegrees=180*n.camera.rotation.y/Math.PI,t.fps=n.engine.getFps().toFixed()),n.lastDepth=n.camera.position.y,t.$route.query.debug){var f=document.getElementById("inspector-host");f&&(f.style.position="absolute")}B.time=e,c.update(r),n.scene.render(),t.snapshotRequested&&(t.snapshotRequested=!1)})),window.addEventListener("resize",(function(){return n.resize()}))}var t;return Object(y.a)(e,[{key:"share",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("underwater-3d").toDataURL(),n=function(){var a=document.createElement("a"),e=(new Date).toJSON().slice(0,19).replaceAll(":","-");a.setAttribute("download","LajeDeSantos-"+e+".png"),a.setAttribute("href",t.replace("image/png","application/octet-stream")),a.click()},!navigator.canShare){e.next=20;break}return e.next=5,fetch(t);case 5:return e.next=7,e.sent.blob();case 7:return r=e.sent,o=new File([r],"lajedesantos.png",{type:r.type}),c={title:"Laje de Santos",url:"https://lajedesantos.net",files:[o]},e.prev=10,e.next=13,navigator.share(c);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),n();case 18:e.next=21;break;case 20:n();case 21:case"end":return e.stop()}}),e,null,[[10,15]])}))),function(){return t.apply(this,arguments)})},{key:"beforeDestroy",value:function(){document.onfullscreenchange=null,this.engine.stopRenderLoop(),this.audioDiver&&(this.audioDiver.pause(),this.audioDiver=null),this.audioOcean&&(this.audioOcean.pause(),this.audioOcean=null),this.scene.dispose(),this.scene=null,this.engine=null}},{key:"createPathForAnimation",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,r=new S.Path3D(t.getPoints()),o=r.getTangents(),c=(r.getNormals(),r.getBinormals()),l=r.getCurve(),d=new S.Animation("cameraPos","position",n,S.Animation.ANIMATIONTYPE_VECTOR3),h=[],f=new S.Animation("cameraRot","rotationQuaternion",n,S.Animation.ANIMATIONTYPE_QUATERNION),v=[],i=0;i<l.length;i++){var m=l[i],C=o[i],w=c[i],M=S.Quaternion.FromLookDirectionRH(C,w);h.push({frame:i*n,value:m}),v.push({frame:i*n,value:M})}d.setKeys(h),f.setKeys(v),e.animations.push(d),e.animations.push(f);var y=this.scene.beginAnimation(e,0,n*l.length,!0);return y}},{key:"bootScene",value:function(e,t){var n=this;function r(){this.loadingUIText="Mergulho na Laje de Santos"}t.isTouch="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,r.prototype.displayLoadingUI=function(){alert(this.loadingUIText)},r.prototype.hideLoadingUI=function(){alert("Loaded!")},this.engine=new S.Engine(e,!0),this.engine.loadingUIText="Mergulho na Laje de Santos",this.scene=new S.Scene(this.engine),this.scene.clearColor=new S.Color4(0,.5,.85,0);var o=new S.Vector3(-15.51978616737642,.6,29.13296827068854);this.camera=new S.UniversalCamera("Camera",o,this.scene),this.guidedTour(),this.animTour.pause(),t.isTouch&&this.joystick(),this.camera.applyGravity=!1,this.camera.speed=.05,this.camera.ellipsoid=new S.Vector3(.5,1,.5),this.camera.keysUp.push("w".charCodeAt(0)),this.camera.keysUp.push("W".charCodeAt(0)),this.scene.onKeyboardObservable.add((function(e){switch(S.Engine.audioEngine.audioContext&&S.Engine.audioEngine.audioContext.resume(),e.type){case S.KeyboardEventTypes.KEYDOWN:console.log("KEY DOWN: ",e.event.key);break;case S.KeyboardEventTypes.KEYUP:console.log("KEY UP: ",e.event.keyCode)}})),this.camera.minZ=.1,this.camera.maxZ=700,this.camera.setTarget(new S.Vector3(-12.89001753167552,1.708562384403646,25.710433418293825)),this.camera.attachControl(e,!0),this.scene.collisionsEnabled=!0,this.camera.checkCollisions=!0,this.scene.autoClear=!1,this.scene.autoClearDepthAndStencil=!1,this.assetsManager=new S.AssetsManager(this.scene),this.assetsManager.onTaskErrorObservable.add((function(e){console.error("task failed",e.name,e.errorObject.message,e.errorObject.exception)})),this.assetsManager.onTaskSuccessObservable.add((function(e){console.log("task successful",e.name)})),this.assetsManager.onProgress=function(e,t,r){n.engine.loadingUIText="We are loading the scene. "+e+" out of "+t+" items still need to be loaded."}}},{key:"sceneOptimizer",value:function(){var e=S.SceneOptimizerOptions.HighDegradationAllowed();e.optimizations=e.optimizations.filter((function(e){return!e.getDescription().includes("Merging similar meshes")}));S.SceneOptimizer.OptimizeAsync(this.scene,e)}},{key:"debugUtils",value:function(){this.scene.debugLayer.show()}},{key:"instrumentation",value:function(){var e=new S.EngineInstrumentation(this.engine);e.captureGPUFrameTime=!0,e.captureShaderCompilationTime=!0;var i=0;this.scene.registerBeforeRender((function(){i%30==0&&console.log("current frame time (GPU): "+(1e-6*e.gpuFrameTimeCounter.current).toFixed(2)+"ms\naverage frame time (GPU): "+(1e-6*e.gpuFrameTimeCounter.average).toFixed(2)+"ms\ntotal shader compilation time: "+e.shaderCompilationTimeCounter.total.toFixed(2)+"ms\naverage shader compilation time: "+e.shaderCompilationTimeCounter.average.toFixed(2)+"ms\ncompiler shaders count: "+e.shaderCompilationTimeCounter.count),i++}))}},{key:"joystick",value:function(){var e=this,t=new S.ArcRotateCamera("BGCamera",Math.PI/2+Math.PI/7,Math.PI/2,100,new S.Vector3(0,20,0),this.scene);this.scene.activeCameras=[this.camera,t],t.layerMask=268435456;var n=E.AdvancedDynamicTexture.CreateFullscreenUI("UI",!0,this.scene);n.layer.layerMask=268435456;var r=0,o=0,c=0,l=0,d=-5,h=M("leftThumb",2,"blue",null);h.height="200px",h.width="200px",h.isPointerBlocker=!0,h.horizontalAlignment=S.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,h.verticalAlignment=S.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,h.alpha=.4,h.left=5,h.top=d;var f=M("leftInnerThumb",4,"blue",null);f.height="80px",f.width="80px",f.isPointerBlocker=!0,f.horizontalAlignment=S.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,f.verticalAlignment=S.GUI.Control.VERTICAL_ALIGNMENT_CENTER;var v=M("leftPuck",0,"blue","blue");v.height="60px",v.width="60px",v.isPointerBlocker=!0,v.horizontalAlignment=S.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,v.verticalAlignment=S.GUI.Control.VERTICAL_ALIGNMENT_CENTER,h.onPointerDownObservable.add((function(e){v.isVisible=!0,v.floatLeft=e.x-.5*h._currentMeasure.width-5,v.left=v.floatLeft,v.floatTop=n._canvas.height-e.y-.5*h._currentMeasure.height+d,v.top=-1*v.floatTop,v.isDown=!0,h.alpha=.9})),h.onPointerUpObservable.add((function(e){r=0,o=0,v.isDown=!1,v.isVisible=!1,h.alpha=.4})),h.onPointerMoveObservable.add((function(e){v.isDown&&(r=e.x-.5*h._currentMeasure.width-5,o=n._canvas.height-e.y-.5*h._currentMeasure.height+d,v.floatLeft=r,v.floatTop=-1*o,v.left=v.floatLeft,v.top=v.floatTop)})),n.addControl(h),h.addControl(f),h.addControl(v),v.isVisible=!1;var m=M("rightThumb",2,"red",null);m.height="200px",m.width="200px",m.isPointerBlocker=!0,m.horizontalAlignment=S.GUI.Control.HORIZONTAL_ALIGNMENT_RIGHT,m.verticalAlignment=S.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,m.alpha=.4,m.left=-5,m.top=d;var C=M("rightInnerThumb",4,"red",null);C.height="80px",C.width="80px",C.isPointerBlocker=!0,C.horizontalAlignment=S.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,C.verticalAlignment=S.GUI.Control.VERTICAL_ALIGNMENT_CENTER;var w=M("rightPuck",0,"red","red");function M(e,t,n,r,o){var rect=new S.GUI.Ellipse;return rect.name=e,rect.thickness=t,rect.color=n,rect.background=r,rect.paddingLeft="0px",rect.paddingRight="0px",rect.paddingTop="0px",rect.paddingBottom="0px",rect}w.height="60px",w.width="60px",w.isPointerBlocker=!0,w.horizontalAlignment=S.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,w.verticalAlignment=S.GUI.Control.VERTICAL_ALIGNMENT_CENTER,m.onPointerDownObservable.add((function(e){w.isVisible=!0,w.floatLeft=n._canvas.width-e.x-.5*m._currentMeasure.width-5,w.left=-1*w.floatLeft,w.floatTop=n._canvas.height-e.y-.5*m._currentMeasure.height+d,w.top=-1*w.floatTop,w.isDown=!0,m.alpha=.9})),m.onPointerUpObservable.add((function(e){c=0,l=0,w.isDown=!1,w.isVisible=!1,m.alpha=.4})),m.onPointerMoveObservable.add((function(e){w.isDown&&(c=n._canvas.width-e.x-.5*m._currentMeasure.width-5,l=n._canvas.height-e.y-.5*m._currentMeasure.height+d,w.floatLeft=-1*c,w.floatTop=-1*l,w.left=w.floatLeft,w.top=w.floatTop)})),n.addControl(m),m.addControl(C),m.addControl(w),w.isVisible=!1,this.scene.registerBeforeRender((function(){r>=0&&e.camera.position.addInPlace(e.camera.getDirection(S.Vector3.Forward()).scale(r/1e3)),e.camera.cameraRotation.y+=c/25e3*-1,e.camera.cameraRotation.x+=l/25e3*-1}))}},{key:"resize",value:function(){this.engine&&this.engine.resize(),this.rebuildOceanTexture=!0}},{key:"lights",value:function(){var e=new S.HemisphericLight("light1",new S.Vector3(0,1,0),this.scene);e.diffuse=S.Color3.FromHexString("#CCCCCC"),e.intensity=.4,this.sunLight=new S.DirectionalLight("DirectionalLight",new S.Vector3(-.5,-1,.6).normalize(),this.scene),this.sunLight.diffuse=S.Color3.FromHexString("#FFFFFF"),this.sunLight.intensity=.8}},{key:"materials",value:function(){S.RegisterMaterialPlugin("Caustic",(function(e){return e.caustic=new B(e),e.caustic.isEnabled=!0,e.caustic}))}},{key:"composer",value:function(){var e=new S.PostProcessRenderPipeline(this.engine,"pipeline"),t=new S.Texture(this.base+"textures/half_kloofendal_48d_partly_cloudy_4k.jpg",this.scene,!1,!0,S.Texture.NEAREST_NEAREST),n=this.loadOceanPP();this.oceanPostProcess=n,this.oceanPostProcess.skyTexture=t;var r=new S.FxaaPostProcess("fxaa",1,null,null,this.engine),o=[this.oceanPostProcess,r],c=new S.PostProcessRenderEffect(this.engine,"renderLayer",(function(){return o}));e.addEffect(c),this.scene.postProcessRenderPipelineManager.addPipeline(e),this.scene.postProcessRenderPipelineManager.attachCamerasToRenderPipeline("pipeline",this.camera)}},{key:"loadOceanPP",value:function(){var e=function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))},t={width:e(this.camera.getEngine().getRenderWidth()),height:e(this.camera.getEngine().getRenderHeight()),light:this.sunLight};t.width>2048&&(t.width=2048),t.height>2048&&(t.height=2048),t.isPipeline=!0;var n=new A.a("myOcean",this.camera,t);return n.reflectionEnabled=!1,n.refractionEnabled=!1,n.worldScale=.2,n}},{key:"addToSceneAndCaustic",value:function(e){e.forEach((function(e){e.material&&e.material.pluginManager.getPlugin("Caustic")&&(e.material.pluginManager.getPlugin("Caustic").isEnabled=!0)}))}},{key:"loadTerrain",value:function(){var e=this;return new Promise((function(t,n){var r=[],o=[],c=[],l=[],d=null,h=!1,f=function(){d&&h&&r.length&&(r[1].thinInstanceSetBuffer("matrix",d,16),e.addToSceneAndCaustic([r[1]]),t())};e.assetsManager.addMeshTask("rocks",null,e.base+"models/ilha/","rocks.glb").onSuccess=function(e){e.loadedMeshes.forEach((function(e){"rockLow1"!==e.name&&"rockLow1.001"!==e.name&&"rockLow1.002"!==e.name||(e.freezeWorldMatrix(),e.material,r.push(e))})),f()},e.assetsManager.addTextFileTask("rocksMatrices",e.base+"models/ilha/rocks.base64").onSuccess=function(e){d=new Float32Array(S.DecodeBase64ToBinary(e.text)),f()},e.assetsManager.addMeshTask("terrain",null,e.base+"models/ilha/","ilha03.glb").onSuccess=function(t){var n,r=[],d=I(t.loadedMeshes);try{for(d.s();!(n=d.n()).done;){var v=n.value;v.name.includes("rock")?(v.computeWorldMatrix(),o.push(v.getAbsolutePivotPoint()),c.push(v.rotationQuaternion),l.push(v.absoluteScaling),v.dispose()):v.freezeWorldNormals?(v.doNotSyncBoundingInfo=!0,v.material&&v.material.freeze(),v.alwaysSelectAsActiveMesh=!0,v.cullingStrategy=S.AbstractMesh.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION,v.convertToUnIndexedMesh(),v.freezeNormals(),v.freezeWorldMatrix(),r.push(v),e.sunLight.includedOnlyMeshes.push(v)):v.material&&r.push(v)}}catch(e){d.e(e)}finally{d.f()}e.addToSceneAndCaustic(r);S.Mesh.MergeMeshes(r,!0,!0,void 0,!1,!0);h=!0,f()}}))}},{key:"loadMoreiaBarco",value:function(){var e=this;return new Promise((function(t,n){e.assetsManager.addMeshTask("barcoMoreia",null,e.base+"models/","moreia-20210912.glb").onSuccess=function(n){var r,o=[],c=I(n.loadedMeshes);try{for(c.s();!(r=c.n()).done;){var l=r.value;l.position=new S.Vector3(-14.12,-17.2,27.19),l.material&&(l.material.backFaceCulling=!1,l.material.freeze(),o.push(l)),l.alwaysSelectAsActiveMesh=!0,l.cullingStrategy=S.AbstractMesh.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION,l.freezeNormals(),l.freezeWorldMatrix()}}catch(e){c.e(e)}finally{c.f()}e.addToSceneAndCaustic(o),t()}}))}},{key:"loadTurtle",value:function(){var e=this;return new Promise((function(t,n){var r=S.Curve3.CreateCubicBezier(F(-22,-10,27),F(-20,-12,31),F(-18,-11,33),F(-14,-10,35),100);r=(r=r.continue(S.Curve3.CreateCubicBezier(F(-14,-10,35),F(-12,-11,33),F(-10,-12,31),F(-6,-10,27),100))).continue(S.Curve3.CreateCubicBezier(F(-22,-10,27),F(-20,-12,31),F(-18,-11,33),F(-14,-10,35),100)),e.assetsManager.addMeshTask("tartaruga",null,e.base+"models/tartaruga/","tartaruga.glb").onSuccess=function(n){var o,c=[],l=I(n.loadedMeshes);try{for(l.s();!(o=l.n()).done;){var d=o.value;d.position=new S.Vector3(-14.12,-12.2,36.19),d.material?(d.material.backFaceCulling=!1,d.material.freeze(),c.push(d)):e.createPathForAnimation(d,r,30)}}catch(e){l.e(e)}finally{l.f()}e.addToSceneAndCaustic(c),t()}}))}},{key:"loadAudio",value:function(){var e=this;return new Promise((function(t,n){var r=function(){e.audioDiver&&e.audioOcean&&t()};e.assetsManager.addBinaryFileTask("sound_diver",e.base+"audio/156011__hdvideoguy__scubadiving-01.mp3").onSuccess=function(t){r(),e.audioDiver=new S.Sound("sound_diver",t.data,e.scene,(function(){}),{autoplay:!1,loop:!0})},e.assetsManager.addBinaryFileTask("sound_ocean",e.base+"audio/435668__byjoshberry__ocean-waves-hitting-bow-of-moving-boat.mp3").onSuccess=function(t){r(),e.audioOcean=new S.Sound("sound_ocean",t.data,e.scene,(function(){}),{autoplay:!1,loop:!0})}}))}},{key:"loadDiverBoat",value:function(){var e=this;return new Promise((function(t,n){e.assetsManager.addMeshTask("diver_with_boat",null,e.base+"models/licensed/","diver_with_boat.glb").onSuccess=function(e){var n,r=I(e.loadedMeshes);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.position=new S.Vector3(-14.12,.5,27.19),o.material&&o.material.freeze(),o.alwaysSelectAsActiveMesh=!0}}catch(e){r.e(e)}finally{r.f()}t()}}))}},{key:"loadDiverBoatBig",value:function(){var e=this;return new Promise((function(t,n){e.assetsManager.addMeshTask("diver_boatBig",null,e.base+"models/licensed/","dive_boat.glb").onSuccess=function(e){var n,r=[],o=I(e.loadedMeshes);try{for(o.s();!(n=o.n()).done;){var c=n.value;c.position=new S.Vector3(-12.12,.5,27.19),c.material&&(r.push(c),c.material.freeze())}}catch(e){o.e(e)}finally{o.f()}S.Mesh.MergeMeshes(r,!0,!0,void 0,!1,!0);t()}}))}},{key:"buildTourCurve",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=S.Curve3.CreateCubicBezier(F(-14.000991821289062,.6574481725692749,32.9548454284668),F(-13.996825218200684,.6574481725692749,32.940956115722656),F(-14.024413108825684,.6509860754013062,32.55100631713867),F(-14.265217781066895,.6574481725692749,32.1165657043457),2*e);if(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.continue(S.Curve3.CreateCubicBezier(F(-14.265217781066895,.6574481725692749,32.1165657043457),F(-14.617867469787598,.6669116616249084,31.480342864990234),F(-14.76079273223877,.6602444648742676,31.185121536254883),F(-15.39233112335205,.6574481725692749,30.998979568481445),2*e))).continue(S.Curve3.CreateCubicBezier(F(-15.39233112335205,.6574481725692749,30.998979568481445),F(-16.32655906677246,.6533116698265076,30.723621368408203),F(-15.986363410949707,.6559959650039673,30.843740463256836),F(-17.039472579956055,.6574481725692749,30.793241500854492),2*e))).continue(S.Curve3.CreateCubicBezier(F(-17.039472579956055,.6574481725692749,30.793241500854492),F(-17.613088607788086,.6582391858100891,30.765735626220703),F(-18.787918090820312,.7090924382209778,31.120275497436523),F(-19.45874786376953,.6574481725692749,31.953659057617188),2*e))).continue(S.Curve3.CreateCubicBezier(F(-19.45874786376953,.6574481725692749,31.953659057617188),F(-20.582807540893555,.570911705493927,33.35009765625),F(-20.595529556274414,.5830461978912354,33.503726959228516),F(-20.97544288635254,.5849096775054932,34.53799819946289),2*e))).continue(S.Curve3.CreateCubicBezier(F(-20.97544288635254,.5849096775054932,34.53799819946289),F(-21.649211883544922,.5882145166397095,36.37226104736328),F(-23.628690719604492,-6.161035537719727,36.41096115112305),F(-24.54960060119629,-8.274001121520996,36.62228775024414),10*e))).continue(S.Curve3.CreateCubicBezier(F(-24.54960060119629,-8.274001121520996,36.62228775024414),F(-25.451812744140625,-10.344067573547363,36.829322814941406),F(-27.573389053344727,-14.756925582885742,37.26560592651367),F(-28.528148651123047,-15.673060417175293,37.828033447265625),10*e))).continue(S.Curve3.CreateCubicBezier(F(-28.528148651123047,-15.673060417175293,37.828033447265625),F(-29.777053833007812,-16.871440887451172,38.56373596191406),F(-32.11470413208008,-25.681499481201172,40.03419876098633),F(-32.840545654296875,-25.814899444580078,43.99205780029297),10*e))).continue(S.Curve3.CreateCubicBezier(F(-32.840545654296875,-25.814899444580078,43.99205780029297),F(-33.69413375854492,-25.971776962280273,48.64649963378906),F(-28.42091941833496,-24.62757110595703,48.84748840332031),F(-24.238296508789062,-24.533470153808594,49.35893249511719),10*e))).continue(S.Curve3.CreateCubicBezier(F(-24.238296508789062,-24.533470153808594,49.35893249511719),F(-21.416982650756836,-24.469995498657227,49.70391845703125),F(-19.669851303100586,-28.618223190307617,51.122745513916016),F(-15.405399322509766,-28.663742065429688,51.464935302734375),10*e))).continue(S.Curve3.CreateCubicBezier(F(-15.405399322509766,-28.663742065429688,51.464935302734375),F(-11.700185775756836,-28.703290939331055,51.76224899291992),F(4.163280963897705,-29.118030548095703,53.839454650878906),F(9.77834415435791,-29.24734115600586,53.75956344604492),10*e))).continue(S.Curve3.CreateCubicBezier(F(9.77834415435791,-29.24734115600586,53.75956344604492),F(12.323244094848633,-29.30594825744629,53.72335433959961),F(34.324214935302734,-28.774940490722656,53.16682434082031),F(35.215423583984375,-28.626699447631836,52.58649444580078),10*e))).continue(S.Curve3.CreateCubicBezier(F(35.215423583984375,-28.626699447631836,52.58649444580078),F(37.8231315612793,-28.192941665649414,50.888427734375),F(34.41352844238281,-29.60319709777832,47.74901580810547),F(32.4602165222168,-29.006301879882812,47.55818557739258),12*e))).continue(S.Curve3.CreateCubicBezier(F(32.4602165222168,-29.006301879882812,47.55818557739258),F(30.66159439086914,-28.456676483154297,47.382469177246094),F(27.096359252929688,-22.143463134765625,46.32563400268555),F(25.767629623413086,-22.49676513671875,46.324798583984375),35*e))).continue(S.Curve3.CreateCubicBezier(F(25.767629623413086,-22.49676513671875,46.324798583984375),F(24.790449142456055,-22.756591796875,46.32418441772461),F(25.13022804260254,-22.687040328979492,46.32514953613281),F(24.48270606994629,-22.862226486206055,46.324798583984375),12*e))).continue(S.Curve3.CreateCubicBezier(F(24.48270606994629,-22.862226486206055,46.324798583984375),F(23.835824966430664,-23.03723907470703,46.32444763183594),F(23.69356918334961,-23.088525772094727,46.30103302001953),F(23.530864715576172,-23.132951736450195,46.28840255737305),12*e))).continue(S.Curve3.CreateCubicBezier(F(23.530864715576172,-23.132951736450195,46.28840255737305),F(23.2147159576416,-23.219274520874023,46.263858795166016),F(22.348297119140625,-23.454551696777344,46.024391174316406),F(22.190568923950195,-23.514163970947266,45.969688415527344),12*e))).continue(S.Curve3.CreateCubicBezier(F(22.190568923950195,-23.514163970947266,45.969688415527344),F(21.83151626586914,-23.649866104125977,45.84516143798828),F(21.54167938232422,-23.722084045410156,45.64944076538086),F(21.29722023010254,-23.768253326416016,45.215946197509766),12*e))).continue(S.Curve3.CreateCubicBezier(F(21.29722023010254,-23.768253326416016,45.215946197509766),F(20.75515365600586,-23.870630264282227,44.25471115112305),F(21.91973876953125,-20.524686813354492,44.111183166503906),F(21.654382705688477,-20.24751091003418,43.035552978515625),25*e))).continue(S.Curve3.CreateCubicBezier(F(21.654382705688477,-20.24751091003418,43.035552978515625),F(21.36979866027832,-19.95025062561035,41.881980895996094),F(22.352222442626953,-19.41952133178711,37.2213020324707),F(19.967266082763672,-19.586599349975586,36.990013122558594),12*e))).continue(S.Curve3.CreateCubicBezier(F(19.967266082763672,-19.586599349975586,36.990013122558594),F(19.027652740478516,-19.652423858642578,36.89889144897461),F(18.879961013793945,-19.715564727783203,37.3553581237793),F(18.84793472290039,-19.586599349975586,37.765037536621094),12*e))).continue(S.Curve3.CreateCubicBezier(F(18.84793472290039,-19.586599349975586,37.765037536621094),F(18.710838317871094,-19.034528732299805,39.51877975463867),F(18.392507553100586,-16.224327087402344,45.301544189453125),F(18.567825317382812,-16.186500549316406,47.885353088378906),20*e))).continue(S.Curve3.CreateCubicBezier(F(18.567825317382812,-16.186500549316406,47.885353088378906),F(18.62300682067871,-16.17459487915039,48.6986083984375),F(18.189916610717773,-16.184980392456055,49.76185607910156),F(17.739166259765625,-16.186500549316406,49.763301849365234),12*e))).continue(S.Curve3.CreateCubicBezier(F(17.739166259765625,-16.186500549316406,49.763301849365234),F(16.58254051208496,-16.190401077270508,49.76701354980469),F(16.68396759033203,-16.162899017333984,49.7675895690918),F(15.579561233520508,-16.186500549316406,49.763301849365234),10*e))).continue(S.Curve3.CreateCubicBezier(F(15.579561233520508,-16.186500549316406,49.763301849365234),F(14.60368537902832,-16.207355499267578,49.75951385498047),F(13.634191513061523,-18.864173889160156,49.7774658203125),F(13.331958770751953,-19.70728302001953,49.78619384765625),12*e))).continue(S.Curve3.CreateCubicBezier(F(13.331958770751953,-19.70728302001953,49.78619384765625),F(13.154287338256836,-20.20291519165039,49.791324615478516),F(12.666264533996582,-22.241924285888672,49.71502685546875),F(11.681337356567383,-22.338699340820312,49.763301849365234),10*e))).continue(S.Curve3.CreateCubicBezier(F(11.681337356567383,-22.338699340820312,49.763301849365234),F(10.767630577087402,-22.428476333618164,49.80808639526367),F(9.653884887695312,-22.32814598083496,49.167022705078125),F(8.721243858337402,-22.338699340820312,48.86186981201172),12*e))).continue(S.Curve3.CreateCubicBezier(F(8.721243858337402,-22.338699340820312,48.86186981201172),F(7.542423248291016,-22.35203742980957,48.47616958618164),F(6.642915725708008,-22.440385818481445,47.85281753540039),F(4.561910629272461,-22.338699340820312,46.823883056640625),12*e))).continue(S.Curve3.CreateCubicBezier(F(4.561910629272461,-22.338699340820312,46.823883056640625),F(3.463308334350586,-22.285017013549805,46.28068923950195),F(-5.716817855834961,-21.53879737854004,44.55055236816406),F(-9.495468139648438,-21.54129981994629,44.76640319824219),10*e))).continue(S.Curve3.CreateCubicBezier(F(-9.495468139648438,-21.54129981994629,44.76640319824219),F(-10.935624122619629,-21.542253494262695,44.848670959472656),F(-11.790102005004883,-21.538429260253906,44.75456237792969),F(-12.089763641357422,-21.54129981994629,44.4488525390625),10*e))).continue(S.Curve3.CreateCubicBezier(F(-12.089763641357422,-21.54129981994629,44.4488525390625),F(-12.822487831115723,-21.54831886291504,43.70133972167969),F(-12.75212574005127,-21.536161422729492,43.70689010620117),F(-12.931273460388184,-21.54129981994629,42.8768310546875),10*e))).continue(S.Curve3.CreateCubicBezier(F(-12.931273460388184,-21.54129981994629,42.8768310546875),F(-13.29143238067627,-21.5516300201416,41.20808029174805),F(-12.23647689819336,-21.32982063293457,40.1552848815918),F(-12.932861328125,-20.70451545715332,39.73333740234375),12*e))).continue(S.Curve3.CreateCubicBezier(F(-12.932861328125,-20.70451545715332,39.73333740234375),F(-15.162277221679688,-18.702653884887695,38.38250732421875),F(-13.46361255645752,-5.522161960601807,36.02260208129883),F(-13.783821105957031,-.4981536865234375,35.190345764160156),75*e))).continue(S.Curve3.CreateCubicBezier(F(-13.783821105957031,-.4981536865234375,35.190345764160156),F(-13.845514297485352,.46980082988739014,35.029998779296875),F(-14.010433197021484,.5489194393157959,33.86442565917969),F(-14.010494232177734,.6567957401275635,32.98194885253906),5*e)),this.debugState){var n=S.Mesh.CreateSphere("cPoint0",16,.01,this.scene);n.position=F(-14.000991821289062,.6574481725692749,32.9548454284668);var r=new S.StandardMaterial("sp0Material",this.scene);r.diffuseColor=new S.Color3(1,1,1),r.specularColor=new S.Color3(0,0,0),n.material=r;var o=S.Mesh.CreateSphere("cPoint00",16,.01,this.scene);o.position=F(-14.265217781066895,.6574481725692749,32.1165657043457);var c=new S.StandardMaterial("sp00Material",this.scene);c.diffuseColor=new S.Color3(1,1,1),c.specularColor=new S.Color3(0,0,0),o.material=r;var l=S.Mesh.CreateSphere("cPoint1",16,.01,this.scene);l.position=F(-15.39233112335205,.6574481725692749,30.998979568481445);var d=new S.StandardMaterial("sp1Material",this.scene);d.diffuseColor=new S.Color3(1,1,0),d.specularColor=new S.Color3(0,0,0),l.material=d;var h=S.Mesh.CreateSphere("cPoint2",16,.01,this.scene);h.position=F(-17.039472579956055,.6574481725692749,30.793241500854492);var f=new S.StandardMaterial("sp2Material",this.scene);f.diffuseColor=new S.Color3(1,0,0),f.specularColor=new S.Color3(0,0,0),h.material=f;var v=S.Mesh.CreateSphere("cPoint3",16,.01,this.scene);v.position=F(-19.45874786376953,.6574481725692749,31.953659057617188);var m=new S.StandardMaterial("sp3Material",this.scene);m.diffuseColor=new S.Color3(0,1,0),m.specularColor=new S.Color3(0,0,0),v.material=m;var C=S.Mesh.CreateSphere("cPoint4",16,.01,this.scene);C.position=F(-20.97544288635254,.5849096775054932,34.53799819946289);var w=new S.StandardMaterial("sp4Material",this.scene);w.diffuseColor=new S.Color3(1,1,1),w.specularColor=new S.Color3(0,0,0),C.material=w;var M=S.Mesh.CreateSphere("cPoint5",16,.01,this.scene);M.position=F(-24.54960060119629,-8.274001121520996,36.62228775024414);var y=new S.StandardMaterial("sp5Material",this.scene);y.diffuseColor=new S.Color3(1,1,0),y.specularColor=new S.Color3(0,0,0),M.material=y;var x=S.Mesh.CreateSphere("cPoint6",16,.01,this.scene);x.position=F(-28.528148651123047,-15.673060417175293,37.828033447265625);var _=new S.StandardMaterial("sp6Material",this.scene);_.diffuseColor=new S.Color3(1,0,0),_.specularColor=new S.Color3(0,0,0),x.material=_;var T=S.Mesh.CreateSphere("cPoint7",16,.01,this.scene);T.position=F(-32.840545654296875,-25.814899444580078,43.99205780029297);var E=new S.StandardMaterial("sp7Material",this.scene);E.diffuseColor=new S.Color3(0,1,0),E.specularColor=new S.Color3(0,0,0),T.material=E;var A=S.Mesh.CreateSphere("cPoint8",16,.01,this.scene);A.position=F(-24.238296508789062,-24.533470153808594,49.35893249511719);var P=new S.StandardMaterial("sp8Material",this.scene);P.diffuseColor=new S.Color3(1,1,1),P.specularColor=new S.Color3(0,0,0),A.material=P;var I=S.Mesh.CreateSphere("cPoint9",16,.01,this.scene);I.position=F(-15.405399322509766,-28.663742065429688,51.464935302734375);var k=new S.StandardMaterial("sp9Material",this.scene);k.diffuseColor=new S.Color3(1,1,0),k.specularColor=new S.Color3(0,0,0),I.material=k;var R=S.Mesh.CreateSphere("cPoint10",16,.01,this.scene);R.position=F(9.77834415435791,-29.24734115600586,53.75956344604492);var z=new S.StandardMaterial("sp10Material",this.scene);z.diffuseColor=new S.Color3(1,0,0),z.specularColor=new S.Color3(0,0,0),R.material=z;var O=S.Mesh.CreateSphere("cPoint11",16,.01,this.scene);O.position=F(35.215423583984375,-28.626699447631836,52.58649444580078);var N=new S.StandardMaterial("sp11Material",this.scene);N.diffuseColor=new S.Color3(0,1,0),N.specularColor=new S.Color3(0,0,0),O.material=N;var L=S.Mesh.CreateSphere("cPoint12",16,.01,this.scene);L.position=F(32.4602165222168,-29.006301879882812,47.55818557739258);var B=new S.StandardMaterial("sp12Material",this.scene);B.diffuseColor=new S.Color3(1,1,1),B.specularColor=new S.Color3(0,0,0),L.material=B;var D=S.Mesh.CreateSphere("cPoint13",16,.01,this.scene);D.position=F(25.767629623413086,-22.49676513671875,46.324798583984375);var V=new S.StandardMaterial("sp13Material",this.scene);V.diffuseColor=new S.Color3(1,1,0),V.specularColor=new S.Color3(0,0,0),D.material=V;var U=S.Mesh.CreateSphere("cPoint14",16,.01,this.scene);U.position=F(24.48270606994629,-22.862226486206055,46.324798583984375);var G=new S.StandardMaterial("sp14Material",this.scene);G.diffuseColor=new S.Color3(1,0,0),G.specularColor=new S.Color3(0,0,0),U.material=G;var j=S.Mesh.CreateSphere("cPoint15",16,.01,this.scene);j.position=F(23.530864715576172,-23.132951736450195,46.28840255737305);var W=new S.StandardMaterial("sp15Material",this.scene);W.diffuseColor=new S.Color3(0,1,0),W.specularColor=new S.Color3(0,0,0),j.material=W;var $=S.Mesh.CreateSphere("cPoint16",16,.01,this.scene);$.position=F(22.190568923950195,-23.514163970947266,45.969688415527344);var H=new S.StandardMaterial("sp16Material",this.scene);H.diffuseColor=new S.Color3(1,1,1),H.specularColor=new S.Color3(0,0,0),$.material=H;var K=S.Mesh.CreateSphere("cPoint17",16,.01,this.scene);K.position=F(21.29722023010254,-23.768253326416016,45.215946197509766);var Q=new S.StandardMaterial("sp17Material",this.scene);Q.diffuseColor=new S.Color3(1,1,0),Q.specularColor=new S.Color3(0,0,0),K.material=Q;var Z=S.Mesh.CreateSphere("cPoint18",16,.01,this.scene);Z.position=F(21.654382705688477,-20.24751091003418,43.035552978515625);var Y=new S.StandardMaterial("sp18Material",this.scene);Y.diffuseColor=new S.Color3(1,0,0),Y.specularColor=new S.Color3(0,0,0),Z.material=Y;var X=S.Mesh.CreateSphere("cPoint19",16,.01,this.scene);X.position=F(19.967266082763672,-19.586599349975586,36.990013122558594);var J=new S.StandardMaterial("sp19Material",this.scene);J.diffuseColor=new S.Color3(0,1,0),J.specularColor=new S.Color3(0,0,0),X.material=J;var ee=S.Mesh.CreateSphere("cPoint20",16,.01,this.scene);ee.position=F(18.84793472290039,-19.586599349975586,37.765037536621094);var te=new S.StandardMaterial("sp20Material",this.scene);te.diffuseColor=new S.Color3(1,1,1),te.specularColor=new S.Color3(0,0,0),ee.material=te;var ne=S.Mesh.CreateSphere("cPoint21",16,.01,this.scene);ne.position=F(18.567825317382812,-16.186500549316406,47.885353088378906);var re=new S.StandardMaterial("sp21Material",this.scene);re.diffuseColor=new S.Color3(1,1,0),re.specularColor=new S.Color3(0,0,0),ne.material=re;var ae=S.Mesh.CreateSphere("cPoint22",16,.01,this.scene);ae.position=F(17.739166259765625,-16.186500549316406,49.763301849365234);var ie=new S.StandardMaterial("sp22Material",this.scene);ie.diffuseColor=new S.Color3(1,0,0),ie.specularColor=new S.Color3(0,0,0),ae.material=ie;var oe=S.Mesh.CreateSphere("cPoint23",16,.01,this.scene);oe.position=F(15.579561233520508,-16.186500549316406,49.763301849365234);var se=new S.StandardMaterial("sp23Material",this.scene);se.diffuseColor=new S.Color3(0,1,0),se.specularColor=new S.Color3(0,0,0),oe.material=se;var ce=S.Mesh.CreateSphere("cPoint24",16,.01,this.scene);ce.position=F(13.331958770751953,-19.70728302001953,49.78619384765625);var le=new S.StandardMaterial("sp24Material",this.scene);le.diffuseColor=new S.Color3(1,1,1),le.specularColor=new S.Color3(0,0,0),ce.material=le;var ue=S.Mesh.CreateSphere("cPoint25",16,.01,this.scene);ue.position=F(11.681337356567383,-22.338699340820312,49.763301849365234);var de=new S.StandardMaterial("sp25Material",this.scene);de.diffuseColor=new S.Color3(1,1,0),de.specularColor=new S.Color3(0,0,0),ue.material=de;var he=S.Mesh.CreateSphere("cPoint26",16,.01,this.scene);he.position=F(8.721243858337402,-22.338699340820312,48.86186981201172);var fe=new S.StandardMaterial("sp26Material",this.scene);fe.diffuseColor=new S.Color3(1,0,0),fe.specularColor=new S.Color3(0,0,0),he.material=fe;var pe=S.Mesh.CreateSphere("cPoint27",16,.01,this.scene);pe.position=F(4.561910629272461,-22.338699340820312,46.823883056640625);var ve=new S.StandardMaterial("sp27Material",this.scene);ve.diffuseColor=new S.Color3(0,1,0),ve.specularColor=new S.Color3(0,0,0),pe.material=ve;var me=S.Mesh.CreateSphere("cPoint28",16,.01,this.scene);me.position=F(-9.495468139648438,-21.54129981994629,44.76640319824219);var ge=new S.StandardMaterial("sp28Material",this.scene);ge.diffuseColor=new S.Color3(1,1,1),ge.specularColor=new S.Color3(0,0,0),me.material=ge;var Ce=S.Mesh.CreateSphere("cPoint29",16,.01,this.scene);Ce.position=F(-12.089763641357422,-21.54129981994629,44.4488525390625);var be=new S.StandardMaterial("sp29Material",this.scene);be.diffuseColor=new S.Color3(1,1,0),be.specularColor=new S.Color3(0,0,0),Ce.material=be;var we=S.Mesh.CreateSphere("cPoint30",16,.01,this.scene);we.position=F(-12.931273460388184,-21.54129981994629,42.8768310546875);var Me=new S.StandardMaterial("sp30Material",this.scene);Me.diffuseColor=new S.Color3(1,0,0),Me.specularColor=new S.Color3(0,0,0),we.material=Me;var ye=S.Mesh.CreateSphere("cPoint31",16,.01,this.scene);ye.position=F(-12.932861328125,-20.70451545715332,39.73333740234375);var xe=new S.StandardMaterial("sp31Material",this.scene);xe.diffuseColor=new S.Color3(0,1,0),xe.specularColor=new S.Color3(0,0,0),ye.material=xe;var _e=S.Mesh.CreateSphere("cPoint32",16,.01,this.scene);_e.position=F(-13.783821105957031,-.4981536865234375,35.190345764160156);var Te=new S.StandardMaterial("sp32Material",this.scene);Te.diffuseColor=new S.Color3(1,1,1),Te.specularColor=new S.Color3(0,0,0),_e.material=Te;var Se=S.Mesh.CreateSphere("cPoint33",16,.01,this.scene);Se.position=F(-14.010494232177734,.6567957401275635,32.98194885253906);var Ee=new S.StandardMaterial("sp33Material",this.scene);Ee.diffuseColor=new S.Color3(1,1,0),Ee.specularColor=new S.Color3(0,0,0),Se.material=Ee;var Ae=S.Mesh.CreateLines("bezier",t.getPoints(),this.scene,!1);Ae.color.r=1,Ae.color.g=1}return t}},{key:"guidedTour",value:function(){var e=this.buildTourCurve();this.camera.updateUpVectorFromRotation=!0,this.animTour=this.createPathForAnimation(this.camera,e,60)}},{key:"pauseTour",value:function(){this.animTour&&(this.animTour._paused?this.animTour.restart():this.animTour.pause())}},{key:"quitTour",value:function(){this.animTour.stop(),this.animTour.goToFrame(0)}},{key:"loadBoidsModel",value:function(e,t,n,r,o,c){var l=this,d=new P.a(n,r.add(o.subtract(r).scale(.5)),1,30);d.boundsMin=r,d.boundsMax=o,d.calculateBounds(),d.reset(30,1),d.cohesion=.001,d.alignment=.03,d.separationMinDistance=.5,d.maxSpeed=1;for(var h=null,f=new Float32Array(16*n),v=S.Matrix.Identity(),i=0;i<n;i++)v.copyToArray(f,16*i);new Float32Array(4*n);var p=S.SceneLoader.ImportMeshAsync("",e,t,this.scene,void 0).then((function(e){var t,n=e.meshes,r=I(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.material&&o.material.freeze(),o.freezeWorldMatrix()}}catch(e){r.e(e)}finally{r.f()}var c=n[0];h=n[1],c.scaling.z=1,c.scaling.y=1,c.scaling.x=1,c.rotationQuaternion.y=0,h.parent.rotationQuaternion.x=1,h.parent.rotationQuaternion.y=0,h.parent.rotationQuaternion.z=0,h.parent.rotationQuaternion.w=0,h.parent.rotationQuaternion.normalize(),h.computeWorldMatrix(),h.thinInstanceSetBuffer("matrix",f,16),l.addToSceneAndCaustic(n)})).catch((function(e){console.error(e)}));return{models:[h],boidsManager:d,promise:p,update:function(e,t,n){var r=new S.Vector3(1,1,1),o=new S.Vector3(1,1,1),c=new S.Vector3(0,-1,0),l=S.Matrix.Identity(),d=S.Quaternion.Zero(),v=new S.Vector3(1,1,1),m=new S.Vector3(1,1,1);return function(t){if(h){e.update(t);for(var C=0;C<n;C++){var w=e.boids[C];w.velocity.normalizeToRef(o),S.Vector3.CrossToRef(o,c,m),S.Vector3.CrossToRef(m,o,v),S.Quaternion.RotationQuaternionFromAxisToRef(m,o,v,d),S.Matrix.ComposeToRef(r,d,w.position,l),l.copyToArray(f,16*C)}h.thinInstanceSetBuffer("matrix",f,16)}}}(d,0,n)}}},{key:"random",value:function(e,t){return Math.random()*(t-e)+e}},{key:"clamp",value:function(e,t,n){return Math.min(Math.max(e,t),n)}}]),e}(),V={props:{},data:function(){return{isFullscreen:!1,isTouch:!1,started:!1,snapshotRequested:!1,ascentSpeed:0,depth:0,time:0,air:100,fps:0,volume:0,mute:!1,orientationDegrees:0}},computed:{base:function(){return this.$router.options.base},ascentSpeedColor:function(){return this.ascentSpeed<1/60?"#000":this.ascentSpeed<.1||this.ascentSpeed<.2?"#0f0":this.ascentSpeed<.3?"#ff0":"#f00"},ascentSpeedGraph:function(){return 0===this.depth?"":this.ascentSpeed<1/60||this.ascentSpeed<.1?"<":this.ascentSpeed<.2?"<<":this.ascentSpeed<.3?"<<<":"<<<<"},playing:function(){return!!this.underwater&&(!!this.underwater.animTour&&!this.underwater.animTour._paused)}},mounted:function(){this.underwater=new D(this)},beforeDestroy:function(){this.underwater&&this.underwater.beforeDestroy(),this.underwater=null},methods:{fullscreen:function(){document.getElementById("underwater").requestFullscreen()},start:function(){this.started=!0,this.fullscreen()},toggleVolume:function(){this.mute=!this.mute,this.mute?(this.volume=S.Engine.audioEngine.getGlobalVolume(),S.Engine.audioEngine.setGlobalVolume(0)):S.Engine.audioEngine.setGlobalVolume(this.volume)},toggleGuidedTour:function(){this.playing=!this.playing,this.underwater.animTour||(this.playing=!0),this.playing?(console.log("Guided Tour Requested"),this.underwater.animTour?this.underwater.pauseTour():this.underwater.guidedTour()):(console.log("Guided Tour Paused"),this.underwater.pauseTour())},stopGuidedTour:function(){this.playing=!1,this.underwater.quitTour()}}},U=(n(338),n(4)),component=Object(U.a)(V,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"underwater"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.toggleGuidedTour.apply(null,arguments)}}},[n("canvas",{attrs:{id:"underwater-3d","touch-action":"none"}}),e._v(" "),n("div",{attrs:{id:"underwater-debug"}},[e._v("\n    "+e._s(e.fps)+" fps\n  ")]),e._v(" "),n("button",{directives:[{name:"show",rawName:"v-show",value:!e.isFullscreen&&e.started,expression:"!isFullscreen && started"}],staticClass:"button-giant",attrs:{id:"underwater-fullscreen"},on:{click:e.fullscreen}},[n("i18n",[e._v("Ficar em tela cheia")])],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.started,expression:"!started"}],attrs:{id:"underwater-instructions"}},[e.isTouch?n("p",[n("i18n",[e._v("\n        Use os joysticks azul e vermelho para girar e nadar.\n      ")])],1):n("p",[n("i18n",[e._v("\n        Torne-se um mergulhador e explore a Laje de Santos.\n      ")]),e._v(" "),n("br"),e._v(" "),n("i18n",[e._v("\n        Clique Com o Boto Esquerdo do Mouse e Arraste para Olhar ao Redor.\n      ")]),e._v(" "),n("br"),e._v(" "),n("i18n",[e._v("\n        Aperte 'W' para nadar.\n      ")])],1),e._v(" "),n("button",{staticClass:"button-giant",attrs:{id:"underwater-start"},on:{click:e.start}},[n("i18n",[e._v("Iniciar")])],1)]),e._v(" "),n("div",{attrs:{id:"underwater-hud"}},[n("div",{attrs:{id:"underwater-hud-depth"}},[n("span",{attrs:{id:"underwater-hud-depth-name"}},[n("i18n",[e._v("Profundidade")])],1),n("br"),e._v(" "),n("span",{style:{color:e.ascentSpeedColor},attrs:{id:"underwater-hud-depth-ascent"}},[e._v(e._s(e.ascentSpeedGraph))]),e._v(" "),n("span",{attrs:{id:"underwater-hud-depth-value"}},[e._v(e._s(e.depth))]),e._v(" "),n("span",{attrs:{id:"underwater-hud-depth-unit"}},[e._v("m")])]),e._v(" "),n("div",{attrs:{id:"underwater-hud-time"}},[n("span",{attrs:{id:"underwater-hud-time-name"}},[n("i18n",[e._v("Tempo")])],1),n("br"),e._v(" "),n("span",{attrs:{id:"underwater-hud-time-value"}},[e._v(e._s(parseInt(e.time/60,10))+":"+e._s(parseInt(e.time%60,10).toString().padStart(2,"0")))])]),e._v(" "),n("div",{attrs:{id:"underwater-hud-compass"}},[n("span",{attrs:{id:"underwater-hud-compass-name"}},[n("i18n",[e._v("Compasso")])],1),n("br"),e._v(" "),n("span",{attrs:{id:"underwater-hud-compass-value"}},[e._v(e._s((parseInt(e.orientationDegrees)%360+360)%360))])])]),e._v(" "),n("div",{attrs:{id:"underwater-settings"}},[n("font-awesome-icon",{attrs:{icon:["fas","camera"],size:"2x"},on:{click:function(t){e.snapshotRequested=!0}}}),e._v(" "),n("font-awesome-layers",{staticClass:"fa-2x",on:{click:e.toggleVolume}},[n("font-awesome-icon",{attrs:{icon:["fas","volume-up"],transform:"shrink-6"}}),e._v(" "),n("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:e.mute,expression:"mute"}],staticStyle:{color:"Tomato"},attrs:{icon:"ban"}})],1),e._v(" "),n("font-awesome-layers",{staticClass:"fa-2x",on:{click:e.toggleGuidedTour}},[n("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:!e.playing,expression:"!playing"}],attrs:{icon:["fas","play"],transform:"shrink-6"}}),e._v(" "),n("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:e.playing,expression:"playing"}],attrs:{icon:["fas","pause"],transform:"shrink-6"}})],1)],1)])}),[],!1,null,"4193fcb0",null),G={components:{Underwater:component.exports},extends:w.default,data:function(){return{gpuTierLoaded:!1,gpuTier:{tier:-1,isMobile:!1,type:"",fps:0,gpu:""}}},mounted:function(){this.head.title=this.$gettext("Mergulho virtual"),this.head.description=this.$gettext("Mergulho em realidade virtual na Laje de Santos"),this.getGpuTier()},methods:{getGpuTier:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C();case 2:n=t.sent,e.$set(e,"gpuTier",n),e.gpuTierLoaded=!0;case 5:case"end":return t.stop()}}),t)})))()}}},j=Object(U.a)(G,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("article",[n("section",[n("h1",[n("i18n",[e._v("Mergulho virtual")])],1),e._v(" "),n("p",[n("i18n",[e._v("\n        Experimente um mergulho virtual na Laje de Santos e veja o naufrgio Moreia e a vida.\n         preciso que seu aparelho tenha suporte a 3D para executar este ambiente com bom\n        desempenho. Expectativa de desempenho:\n      ")]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:!e.gpuTierLoaded,expression:"!gpuTierLoaded"}]},[n("i18n",[e._v("Testando desempenho...")])],1),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.gpuTierLoaded,expression:"gpuTierLoaded"}],staticStyle:{"font-weight":"bold"}},[0===e.gpuTier.tier?n("span",[n("i18n",[e._v("Muito baixo desempenho, muito devagar ou no funcionar")])],1):1===e.gpuTier.tier?n("span",[n("i18n",[e._v("Baixo desempenho, devagar")])],1):2===e.gpuTier.tier?n("span",[n("i18n",[e._v("Mdio desempenho")])],1):3===e.gpuTier.tier?n("span",[n("i18n",[e._v("timo desempenho")])],1):e._e()])],1),e._v(" "),n("Underwater")],1)])}),[],!1,null,null,null);t.default=j.exports}}]);